using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(sin(x)^3*(a*cos(x)+b*sin(x)), x) == :(1//4*a*sin(x)^4+3//8*b*x+-3//8*b*cos(x)*sin(x)+-1//4*b*sin(x)^3*cos(x))
@test integrate(sin(x)^2*(a*cos(x)+b*sin(x)), x) == :(-1*b*cos(x)+1//3*a*sin(x)^3+1//3*b*cos(x)^3)
@test integrate((a*cos(x)+b*sin(x))*sin(x), x) == :((1/2)*a*sin(x)^2+(1/2)*b*x+-1//2*b*cos(x)*sin(x))
@test integrate(a*cos(x)+b*sin(x), x) == :(a*sin(x)+-1*b*cos(x))
@test integrate((a*cos(x)+b*sin(x))*csc(x), x) == :(a*log(sin(x))+b*x)
@test integrate(csc(x)^2*(a*cos(x)+b*sin(x)), x) == :(-1*a*csc(x)+-1*b*arctanh(cos(x)))
@test integrate(csc(x)^3*(a*cos(x)+b*sin(x)), x) == :(-1*b*cot(x)+-1//2*a*csc(x)^2)
@test integrate((a*cos(x)+b*sin(x))^-1*sin(x)^3, x) == :(b*x*(2*a^2+2*b^2)^-1+-1*a*(2*a^2+2*b^2)^-1*sin(x)^2+-1*a^3*(a^2+b^2)^-2*log(a*cos(x)+b*sin(x))+b*x*a^2*(a^2+b^2)^-2+-1*b*(2*a^2+2*b^2)^-1*cos(x)*sin(x))
@test integrate((a*cos(x)+b*sin(x))^-1*sin(x)^2, x) == :(-1*a*(a^2+b^2)^-1*sin(x)+-1*b*(a^2+b^2)^-1*cos(x)+-1*a^2*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-1*sin(x), x) == :(b*x*(a^2+b^2)^-1+-1*a*(a^2+b^2)^-1*log(a*cos(x)+b*sin(x)))
@test integrate((a*cos(x)+b*sin(x))^-1, x) == :(-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-1*csc(x), x) == :(a^-1*log(sin(x))+-1*a^-1*log(a*cos(x)+b*sin(x)))
@test integrate((a*cos(x)+b*sin(x))^-1*csc(x)^2, x) == :(-1*a^-1*csc(x)+b*a^-2*arctanh(cos(x))+-1*a^-2*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-1*csc(x)^3, x) == :(-1//2*a^-1*csc(x)^2+b*a^-2*cot(x)+a^-3*(a^2+b^2)*log(sin(x))+-1*a^-3*(a^2+b^2)*log(a*cos(x)+b*sin(x)))
@test integrate((a*cos(x)+b*sin(x))^-2*sin(x)^3, x) == :((1/2)*(a^2+b^2)^-2*(a*cos(x)+b*sin(x))^-1*(3*a*(a^2+-1*b^2)+a*(a^2+b^2)*cos(2x)+-1*b*(a^2+b^2)*sin(2x))+6*b*a^2*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*x))))
@test integrate((a*cos(x)+b*sin(x))^-2*sin(x)^2, x) == :(a*(b+a*cot(x))^-1*(a^2+b^2)^-1+-1*x*(a^2+b^2)^-2*(a^2+-1*b^2)+-2*a*b*(a^2+b^2)^-2*log(a*cos(x)+b*sin(x)))
@test integrate((a*cos(x)+b*sin(x))^-2*sin(x), x) == :(a*(a^2+b^2)^-1*(a*cos(x)+b*sin(x))^-1+-1*b*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-2, x) == :(a^-1*(a*cos(x)+b*sin(x))^-1*sin(x))
@test integrate((a*cos(x)+b*sin(x))^-2*csc(x), x) == :(a^-1*(a*cos(x)+b*sin(x))^-1+-1*a^-2*arctanh(cos(x))+b*a^-2*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-2*csc(x)^2, x) == :(-1*a^-2*cot(x)+-1*(a+b*tan(x))^-1*(b^-1+b*a^-2)+-2*b*a^-3*log(tan(x))+2*b*a^-3*log(a+b*tan(x)))
@test integrate((a*cos(x)+b*sin(x))^-2*csc(x)^3, x) == :(-1//2*a^-2*arctanh(cos(x))+a^-3*(a*cos(x)+b*sin(x))^-1*(a^2+b^2)+-1*a^-4*(a^2+b^2)*arctanh(cos(x))+-2*a^-4*b^2*arctanh(cos(x))+2*b*a^-3*csc(x)+-1//2*a^-2*cot(x)*csc(x)+3*b*a^-4*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-3*sin(x)^3, x) == :(a*(b+a*cot(x))^-2*(2*a^2+2*b^2)^-1+a*(a^2+b^2)^-3*(a^2+-3*b^2)*log(a*cos(x)+b*sin(x))+-1*b*x*(a^2+b^2)^-3*(-1*b^2+3*a^2)+2*a*b*(b+a*cot(x))^-1*(a^2+b^2)^-2)
@test integrate((a*cos(x)+b*sin(x))^-3*sin(x)^2, x) == :(-1*(a^2+b^2)^-5//2*(a^2+-2*b^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*x)))+(1/2)*a*(a^2+b^2)^-2*(a*cos(x)+b*sin(x))^-2*((a^2+4*b^2)*sin(x)+3*a*b*cos(x)))
@test integrate((a*cos(x)+b*sin(x))^-3, x) == :(-1//2*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x)))+-1*(2*a^2+2*b^2)^-1*(a*cos(x)+b*sin(x))^-2*(b*cos(x)+-1*a*sin(x)))
@test integrate((a*cos(x)+b*sin(x))^-3*csc(x), x) == :(a^-3*log(tan(x))+(a+b*tan(x))^-1*(a^-2+-1*b^-2)+(1/2)*(a+b*tan(x))^-2*(a^-1+a*b^-2)+-1*a^-3*log(a+b*tan(x)))
@test integrate((a*cos(x)+b*sin(x))^-3*csc(x)^2, x) == :(-1*a^-3*csc(x)+-1*a^-4*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x)))+-2*b*a^-3*(a*cos(x)+b*sin(x))^-1+3*b*a^-4*arctanh(cos(x))+-1//2*a^-2*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x)))+-1//2*a^-2*(a*cos(x)+b*sin(x))^-2*(b*cos(x)+-1*a*sin(x))+-2*a^-4*b^2*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-3*csc(x)^3, x) == :(-1//2*a^-3*cot(x)^2+a^-5*(2*a^2+6*b^2)*log(tan(x))+-1*a^-5*(2*a^2+6*b^2)*log(a+b*tan(x))+3*b*a^-4*cot(x)+(1/2)*a^-3*b^-2*(a+b*tan(x))^-2*(a^2+b^2)^2+-1*a^-4*b^-2*(a+b*tan(x))^-1*(a^2+b^2)*(a^2+-3*b^2))
@test integrate(cos(c+d*x)^5*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(5//16*a*x+-1//6*b*d^-1*cos(c+d*x)^6+1//6*a*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//16*a*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a*d^-1*cos(c+d*x)^3*sin(c+d*x))
@test integrate(cos(c+d*x)^4*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(a*d^-1*sin(c+d*x)+-2//3*a*d^-1*sin(c+d*x)^3+-1//5*b*d^-1*cos(c+d*x)^5+1//5*a*d^-1*sin(c+d*x)^5)
@test integrate(cos(c+d*x)^3*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(3//8*a*x+-1//4*b*d^-1*cos(c+d*x)^4+1//4*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate(cos(c+d*x)^2*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(a*d^-1*sin(c+d*x)+-1//3*a*d^-1*sin(c+d*x)^3+-1//3*b*d^-1*cos(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))*cos(c+d*x), x) == :((1/2)*a*x+(1/2)*b*d^-1*sin(c+d*x)^2+(1/2)*a*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate(a*cos(c+d*x)+b*sin(c+d*x), x) == :(a*d^-1*sin(c+d*x)+-1*b*d^-1*cos(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))*sec(c+d*x), x) == :(a*x+-1*b*d^-1*log(cos(c+d*x)))
@test integrate(sec(c+d*x)^2*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(a*d^-1*arctanh(sin(c+d*x))+b*d^-1*sec(c+d*x))
@test integrate(sec(c+d*x)^3*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+(1/2)*b*d^-1*sec(c+d*x)^2)
@test integrate(sec(c+d*x)^4*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :((1/2)*a*d^-1*arctanh(sin(c+d*x))+1//3*b*d^-1*sec(c+d*x)^3+(1/2)*a*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate(sec(c+d*x)^5*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+1//3*a*d^-1*tan(c+d*x)^3+1//4*b*d^-1*sec(c+d*x)^4)
@test integrate(sec(c+d*x)^6*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(1//5*b*d^-1*sec(c+d*x)^5+3//8*a*d^-1*arctanh(sin(c+d*x))+1//4*a*d^-1*sec(c+d*x)^3*tan(c+d*x)+3//8*a*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate(sec(c+d*x)^7*(a*cos(c+d*x)+b*sin(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+1//5*a*d^-1*tan(c+d*x)^5+1//6*b*d^-1*sec(c+d*x)^6+2//3*a*d^-1*tan(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*cos(c+d*x)^5, x) == :(a^2*d^-1*sin(c+d*x)+-1*a^2*d^-1*sin(c+d*x)^3+-2//5*b^2*d^-1*sin(c+d*x)^5+-1//7*a^2*d^-1*sin(c+d*x)^7+1//3*b^2*d^-1*sin(c+d*x)^3+1//7*b^2*d^-1*sin(c+d*x)^7+3//5*a^2*d^-1*sin(c+d*x)^5+-2//7*a*b*d^-1*cos(c+d*x)^7)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*cos(c+d*x)^4, x) == :(1//16*x*b^2+5//16*x*a^2+-1//3*a*b*d^-1*cos(c+d*x)^6+-1//6*b^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+1//6*a^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+1//16*b^2*d^-1*cos(c+d*x)*sin(c+d*x)+1//24*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x)+5//16*a^2*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a^2*d^-1*cos(c+d*x)^3*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*cos(c+d*x)^3, x) == :(a^2*d^-1*sin(c+d*x)+-2//3*a^2*d^-1*sin(c+d*x)^3+-1//5*b^2*d^-1*sin(c+d*x)^5+1//3*b^2*d^-1*sin(c+d*x)^3+1//5*a^2*d^-1*sin(c+d*x)^5+-2//5*a*b*d^-1*cos(c+d*x)^5)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*cos(c+d*x)^2, x) == :(1//8*x*b^2+3//8*x*a^2+-1//2*a*b*d^-1*cos(c+d*x)^4+-1//4*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//4*a^2*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//8*b^2*d^-1*cos(c+d*x)*sin(c+d*x)+3//8*a^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*cos(c+d*x), x) == :(a^2*d^-1*sin(c+d*x)+-1//3*a^2*d^-1*sin(c+d*x)^3+1//3*b^2*d^-1*sin(c+d*x)^3+-2//3*a*b*d^-1*cos(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2, x) == :(x*((1/2)*a^2+(1/2)*b^2)+-1//2*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x), x) == :(a^2*d^-1*sin(c+d*x)+b^2*d^-1*arctanh(sin(c+d*x))+-1*b^2*d^-1*sin(c+d*x)+-2*a*b*d^-1*cos(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^2, x) == :(x*(a^2+-1*b^2)+b^2*d^-1*tan(c+d*x)+-2*a*b*d^-1*log(cos(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^3, x) == :(a^2*d^-1*arctanh(sin(c+d*x))+-1//2*b^2*d^-1*arctanh(sin(c+d*x))+(1/2)*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+2*a*b*d^-1*sec(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^4, x) == :(1//3*b^-1*d^-1*(b+a*cot(c+d*x))^3*tan(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^5, x) == :((1/2)*a^2*d^-1*arctanh(sin(c+d*x))+-1//8*b^2*d^-1*arctanh(sin(c+d*x))+(1/2)*a^2*d^-1*sec(c+d*x)*tan(c+d*x)+-1//8*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+1//4*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+2//3*a*b*d^-1*sec(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^6, x) == :(a^2*d^-1*tan(c+d*x)+1//3*d^-1*tan(c+d*x)^3*(a^2+b^2)+1//5*b^2*d^-1*tan(c+d*x)^5+a*b*d^-1*tan(c+d*x)^2+(1/2)*a*b*d^-1*tan(c+d*x)^4)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^7, x) == :(-1//16*b^2*d^-1*arctanh(sin(c+d*x))+3//8*a^2*d^-1*arctanh(sin(c+d*x))+-1//16*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-1//24*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//4*a^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//6*b^2*d^-1*sec(c+d*x)^5*tan(c+d*x)+2//5*a*b*d^-1*sec(c+d*x)^5+3//8*a^2*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^8, x) == :(a^2*d^-1*tan(c+d*x)+1//3*d^-1*tan(c+d*x)^3*(b^2+2*a^2)+1//5*d^-1*tan(c+d*x)^5*(a^2+2*b^2)+1//7*b^2*d^-1*tan(c+d*x)^7+a*b*d^-1*tan(c+d*x)^2+a*b*d^-1*tan(c+d*x)^4+1//3*a*b*d^-1*tan(c+d*x)^6)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*cos(c+d*x)^5, x) == :(35//128*x*a^3+-1//6*b^3*d^-1*cos(c+d*x)^6+1//8*b^3*d^-1*cos(c+d*x)^8+15//128*a*x*b^2+-3//8*b*a^2*d^-1*cos(c+d*x)^8+1//8*a^3*d^-1*cos(c+d*x)^7*sin(c+d*x)+7//48*a^3*d^-1*cos(c+d*x)^5*sin(c+d*x)+35//128*a^3*d^-1*cos(c+d*x)*sin(c+d*x)+35//192*a^3*d^-1*cos(c+d*x)^3*sin(c+d*x)+-3//8*a*b^2*d^-1*cos(c+d*x)^7*sin(c+d*x)+1//16*a*b^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//64*a*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x)+15//128*a*b^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*cos(c+d*x)^4, x) == :(a^3*d^-1*sin(c+d*x)+-1*a^3*d^-1*sin(c+d*x)^3+-1//5*b^3*d^-1*cos(c+d*x)^5+-1//7*a^3*d^-1*sin(c+d*x)^7+1//7*b^3*d^-1*cos(c+d*x)^7+3//5*a^3*d^-1*sin(c+d*x)^5+a*b^2*d^-1*sin(c+d*x)^3+-6//5*a*b^2*d^-1*sin(c+d*x)^5+-3//7*b*a^2*d^-1*cos(c+d*x)^7+3//7*a*b^2*d^-1*sin(c+d*x)^7)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*cos(c+d*x)^3, x) == :(5//16*x*a^3+-1//6*b^3*d^-1*sin(c+d*x)^6+1//4*b^3*d^-1*sin(c+d*x)^4+3//16*a*x*b^2+-1//2*b*a^2*d^-1*cos(c+d*x)^6+1//6*a^3*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//16*a^3*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a^3*d^-1*cos(c+d*x)^3*sin(c+d*x)+-1//2*a*b^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+1//8*a*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//16*a*b^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*cos(c+d*x)^2, x) == :(a^3*d^-1*sin(c+d*x)+-2//3*a^3*d^-1*sin(c+d*x)^3+-1//3*b^3*d^-1*cos(c+d*x)^3+1//5*a^3*d^-1*sin(c+d*x)^5+1//5*b^3*d^-1*cos(c+d*x)^5+a*b^2*d^-1*sin(c+d*x)^3+-3//5*a*b^2*d^-1*sin(c+d*x)^5+-3//5*b*a^2*d^-1*cos(c+d*x)^5)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*cos(c+d*x), x) == :(1//4*d^-1*(b+a*cot(c+d*x))^3*sin(c+d*x)^4+3//8*a*x*(a^2+b^2)+3//8*a*d^-1*sin(c+d*x)^2*(a+-1*b*cot(c+d*x))*(b+a*cot(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3, x) == :(1//3*d^-1*(b*cos(c+d*x)+-1*a*sin(c+d*x))^3+-1*d^-1*(a^2+b^2)*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x), x) == :(b^3*d^-1*log(tan(c+d*x))+(1/2)*a*x*(a^2+3*b^2)+(1/2)*d^-1*sin(c+d*x)^2*(b*(-1*b^2+3*a^2)+a*(a^2+-3*b^2)*cot(c+d*x))+-1*b^3*d^-1*log(sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^2, x) == :(a^3*d^-1*sin(c+d*x)+b^3*d^-1*cos(c+d*x)+b^3*d^-1*sec(c+d*x)+-3*a*b^2*d^-1*sin(c+d*x)+-3*b*a^2*d^-1*cos(c+d*x)+3*a*b^2*d^-1*arctanh(sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^3, x) == :(a*x*(a^2+-3*b^2)+(1/2)*b*d^-1*(a+b*tan(c+d*x))^2+-1*b*d^-1*(-1*b^2+3*a^2)*log(cos(c+d*x))+2*a*b^2*d^-1*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^4, x) == :(a^3*d^-1*arctanh(sin(c+d*x))+-1*b^3*d^-1*sec(c+d*x)+1//3*b^3*d^-1*sec(c+d*x)^3+3*b*a^2*d^-1*sec(c+d*x)+-3//2*a*b^2*d^-1*arctanh(sin(c+d*x))+3//2*a*b^2*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^5, x) == :(1//4*b^-1*d^-1*(b+a*cot(c+d*x))^4*tan(c+d*x)^4)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^6, x) == :((1/2)*a^3*d^-1*arctanh(sin(c+d*x))+-1//3*b^3*d^-1*sec(c+d*x)^3+1//5*b^3*d^-1*sec(c+d*x)^5+b*a^2*d^-1*sec(c+d*x)^3+(1/2)*a^3*d^-1*sec(c+d*x)*tan(c+d*x)+-3//8*a*b^2*d^-1*arctanh(sin(c+d*x))+-3//8*a*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+3//4*a*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^7, x) == :(a^3*d^-1*tan(c+d*x)+1//6*b^3*d^-1*tan(c+d*x)^6+1//3*a*d^-1*tan(c+d*x)^3*(a^2+3*b^2)+1//4*b*d^-1*tan(c+d*x)^4*(b^2+3*a^2)+3//2*b*a^2*d^-1*tan(c+d*x)^2+3//5*a*b^2*d^-1*tan(c+d*x)^5)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^8, x) == :(-1//5*b^3*d^-1*sec(c+d*x)^5+1//7*b^3*d^-1*sec(c+d*x)^7+3//8*a^3*d^-1*arctanh(sin(c+d*x))+-3//16*a*b^2*d^-1*arctanh(sin(c+d*x))+1//4*a^3*d^-1*sec(c+d*x)^3*tan(c+d*x)+3//5*b*a^2*d^-1*sec(c+d*x)^5+3//8*a^3*d^-1*sec(c+d*x)*tan(c+d*x)+(1/2)*a*b^2*d^-1*sec(c+d*x)^5*tan(c+d*x)+-3//16*a*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-1//8*a*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^9, x) == :(a^3*d^-1*tan(c+d*x)+1//8*b^3*d^-1*tan(c+d*x)^8+1//3*a*d^-1*tan(c+d*x)^3*(2*a^2+3*b^2)+1//4*b*d^-1*tan(c+d*x)^4*(b^2+6*a^2)+1//5*a*d^-1*tan(c+d*x)^5*(a^2+6*b^2)+1//6*b*d^-1*tan(c+d*x)^6*(2*b^2+3*a^2)+3//2*b*a^2*d^-1*tan(c+d*x)^2+3//7*a*b^2*d^-1*tan(c+d*x)^7)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^10, x) == :(-1//7*b^3*d^-1*sec(c+d*x)^7+1//9*b^3*d^-1*sec(c+d*x)^9+5//16*a^3*d^-1*arctanh(sin(c+d*x))+-15//128*a*b^2*d^-1*arctanh(sin(c+d*x))+1//6*a^3*d^-1*sec(c+d*x)^5*tan(c+d*x)+3//7*b*a^2*d^-1*sec(c+d*x)^7+5//16*a^3*d^-1*sec(c+d*x)*tan(c+d*x)+5//24*a^3*d^-1*sec(c+d*x)^3*tan(c+d*x)+-15//128*a*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-5//64*a*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+-1//16*a*b^2*d^-1*sec(c+d*x)^5*tan(c+d*x)+3//8*a*b^2*d^-1*sec(c+d*x)^7*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^11, x) == :(a^3*d^-1*tan(c+d*x)+1//10*b^3*d^-1*tan(c+d*x)^10+a*d^-1*tan(c+d*x)^3*(a^2+b^2)+(1/2)*b*d^-1*tan(c+d*x)^6*(b^2+3*a^2)+1//3*a*b^2*d^-1*tan(c+d*x)^9+1//4*b*d^-1*tan(c+d*x)^4*(b^2+9*a^2)+1//7*a*d^-1*tan(c+d*x)^7*(a^2+9*b^2)+3//2*b*a^2*d^-1*tan(c+d*x)^2+3//5*a*d^-1*tan(c+d*x)^5*(a^2+3*b^2)+3//8*b*d^-1*tan(c+d*x)^8*(a^2+b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*cos(c+d*x)^5, x) == :(a^4*d^-1*sin(c+d*x)+-4//3*a^4*d^-1*sin(c+d*x)^3+-4//7*a^4*d^-1*sin(c+d*x)^7+-2//7*b^4*d^-1*sin(c+d*x)^7+1//5*b^4*d^-1*sin(c+d*x)^5+1//9*a^4*d^-1*sin(c+d*x)^9+1//9*b^4*d^-1*sin(c+d*x)^9+6//5*a^4*d^-1*sin(c+d*x)^5+2*a^2*b^2*d^-1*sin(c+d*x)^3+-18//5*a^2*b^2*d^-1*sin(c+d*x)^5+-4//7*a*b^3*d^-1*cos(c+d*x)^7+-4//9*b*a^3*d^-1*cos(c+d*x)^9+-2//3*a^2*b^2*d^-1*sin(c+d*x)^9+4//9*a*b^3*d^-1*cos(c+d*x)^9+18//7*a^2*b^2*d^-1*sin(c+d*x)^7)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*cos(c+d*x)^4, x) == :(3//128*x*b^4+35//128*x*a^4+15//64*x*a^2*b^2+(1/2)*a*b^3*d^-1*cos(c+d*x)^8+-2//3*a*b^3*d^-1*cos(c+d*x)^6+-1//2*b*a^3*d^-1*cos(c+d*x)^8+-1//8*b^4*d^-1*cos(c+d*x)^5*sin(c+d*x)^3+-1//16*b^4*d^-1*cos(c+d*x)^5*sin(c+d*x)+1//8*a^4*d^-1*cos(c+d*x)^7*sin(c+d*x)+1//64*b^4*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//128*b^4*d^-1*cos(c+d*x)*sin(c+d*x)+7//48*a^4*d^-1*cos(c+d*x)^5*sin(c+d*x)+35//128*a^4*d^-1*cos(c+d*x)*sin(c+d*x)+35//192*a^4*d^-1*cos(c+d*x)^3*sin(c+d*x)+-3//4*a^2*b^2*d^-1*cos(c+d*x)^7*sin(c+d*x)+1//8*a^2*b^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//32*a^2*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x)+15//64*a^2*b^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*cos(c+d*x)^3, x) == :(a^4*d^-1*sin(c+d*x)+-1*a^4*d^-1*sin(c+d*x)^3+-1//7*a^4*d^-1*sin(c+d*x)^7+-1//7*b^4*d^-1*sin(c+d*x)^7+1//5*b^4*d^-1*sin(c+d*x)^5+3//5*a^4*d^-1*sin(c+d*x)^5+2*a^2*b^2*d^-1*sin(c+d*x)^3+-12//5*a^2*b^2*d^-1*sin(c+d*x)^5+-4//5*a*b^3*d^-1*cos(c+d*x)^5+-4//7*b*a^3*d^-1*cos(c+d*x)^7+4//7*a*b^3*d^-1*cos(c+d*x)^7+6//7*a^2*b^2*d^-1*sin(c+d*x)^7)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*cos(c+d*x)^2, x) == :(1//16*x*b^4+5//16*x*a^4+3//8*x*a^2*b^2+a*b^3*d^-1*sin(c+d*x)^4+-2//3*a*b^3*d^-1*sin(c+d*x)^6+-2//3*b*a^3*d^-1*cos(c+d*x)^6+-1//6*b^4*d^-1*cos(c+d*x)^3*sin(c+d*x)^3+-1//8*b^4*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//6*a^4*d^-1*cos(c+d*x)^5*sin(c+d*x)+1//16*b^4*d^-1*cos(c+d*x)*sin(c+d*x)+5//16*a^4*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a^4*d^-1*cos(c+d*x)^3*sin(c+d*x)+-1*a^2*b^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+1//4*a^2*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a^2*b^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*cos(c+d*x), x) == :(a^4*d^-1*sin(c+d*x)+-2//3*a^4*d^-1*sin(c+d*x)^3+1//5*a^4*d^-1*sin(c+d*x)^5+1//5*b^4*d^-1*sin(c+d*x)^5+2*a^2*b^2*d^-1*sin(c+d*x)^3+-6//5*a^2*b^2*d^-1*sin(c+d*x)^5+-4//3*a*b^3*d^-1*cos(c+d*x)^3+-4//5*b*a^3*d^-1*cos(c+d*x)^5+4//5*a*b^3*d^-1*cos(c+d*x)^5)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4, x) == :(3//8*x*(a^2+b^2)^2+-1//4*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^3*(b*cos(c+d*x)+-1*a*sin(c+d*x))+-1//8*d^-1*(3*a^2+3*b^2)*(a*cos(c+d*x)+b*sin(c+d*x))*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x), x) == :(a^4*d^-1*sin(c+d*x)+b^4*d^-1*arctanh(sin(c+d*x))+-1*b^4*d^-1*sin(c+d*x)+-1//3*a^4*d^-1*sin(c+d*x)^3+-1//3*b^4*d^-1*sin(c+d*x)^3+-4*a*b^3*d^-1*cos(c+d*x)+2*a^2*b^2*d^-1*sin(c+d*x)^3+-4//3*b*a^3*d^-1*cos(c+d*x)^3+4//3*a*b^3*d^-1*cos(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^2, x) == :(x*((1/2)*a^4+-3//2*b^4+3*a^2*b^2)+b^4*d^-1*tan(c+d*x)+(1/2)*d^-1*sin(c+d*x)^2*((a^4+b^4+-6*a^2*b^2)*cot(c+d*x)+4*a*b*(a^2+-1*b^2))+-4*a*b^3*d^-1*log(sin(c+d*x))+4*a*b^3*d^-1*log(tan(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^3, x) == :(a^4*d^-1*sin(c+d*x)+-3//2*b^4*d^-1*arctanh(sin(c+d*x))+3//2*b^4*d^-1*sin(c+d*x)+(1/2)*b^4*d^-1*tan(c+d*x)^2*sin(c+d*x)+-6*a^2*b^2*d^-1*sin(c+d*x)+-4*b*a^3*d^-1*cos(c+d*x)+4*a*b^3*d^-1*cos(c+d*x)+4*a*b^3*d^-1*sec(c+d*x)+6*a^2*b^2*d^-1*arctanh(sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^4, x) == :(x*(a^4+b^4+-6*a^2*b^2)+1//3*b*d^-1*(a+b*tan(c+d*x))^3+a*b*d^-1*(a+b*tan(c+d*x))^2+b^2*d^-1*(-1*b^2+3*a^2)*tan(c+d*x)+-4*a*b*d^-1*(a^2+-1*b^2)*log(cos(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^5, x) == :(a^4*d^-1*arctanh(sin(c+d*x))+3//8*b^4*d^-1*arctanh(sin(c+d*x))+-4*a*b^3*d^-1*sec(c+d*x)+-3*a^2*b^2*d^-1*arctanh(sin(c+d*x))+4*b*a^3*d^-1*sec(c+d*x)+-3//8*b^4*d^-1*sec(c+d*x)*tan(c+d*x)+1//4*b^4*d^-1*tan(c+d*x)^3*sec(c+d*x)+4//3*a*b^3*d^-1*sec(c+d*x)^3+3*a^2*b^2*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^6, x) == :(1//5*b^-1*d^-1*(b+a*cot(c+d*x))^5*tan(c+d*x)^5)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^7, x) == :((1/2)*a^4*d^-1*arctanh(sin(c+d*x))+1//16*b^4*d^-1*arctanh(sin(c+d*x))+(1/2)*a^4*d^-1*sec(c+d*x)*tan(c+d*x)+-4//3*a*b^3*d^-1*sec(c+d*x)^3+-3//4*a^2*b^2*d^-1*arctanh(sin(c+d*x))+-1//8*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//6*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)^3+1//16*b^4*d^-1*sec(c+d*x)*tan(c+d*x)+4//3*b*a^3*d^-1*sec(c+d*x)^3+4//5*a*b^3*d^-1*sec(c+d*x)^5+-3//4*a^2*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+3//2*a^2*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^8, x) == :(a^4*d^-1*tan(c+d*x)+1//7*b^4*d^-1*tan(c+d*x)^7+2*b*a^3*d^-1*tan(c+d*x)^2+1//3*a^2*d^-1*tan(c+d*x)^3*(a^2+6*b^2)+1//5*b^2*d^-1*tan(c+d*x)^5*(b^2+6*a^2)+2//3*a*b^3*d^-1*tan(c+d*x)^6+a*b*d^-1*tan(c+d*x)^4*(a^2+b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^9, x) == :(3//8*a^4*d^-1*arctanh(sin(c+d*x))+3//128*b^4*d^-1*arctanh(sin(c+d*x))+-4//5*a*b^3*d^-1*sec(c+d*x)^5+-3//8*a^2*b^2*d^-1*arctanh(sin(c+d*x))+-1//16*b^4*d^-1*sec(c+d*x)^5*tan(c+d*x)+1//4*a^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//8*b^4*d^-1*sec(c+d*x)^5*tan(c+d*x)^3+1//64*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+3//8*a^4*d^-1*sec(c+d*x)*tan(c+d*x)+3//128*b^4*d^-1*sec(c+d*x)*tan(c+d*x)+4//5*b*a^3*d^-1*sec(c+d*x)^5+4//7*a*b^3*d^-1*sec(c+d*x)^7+a^2*b^2*d^-1*sec(c+d*x)^5*tan(c+d*x)+-3//8*a^2*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-1//4*a^2*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^10, x) == :(a^4*d^-1*tan(c+d*x)+1//5*d^-1*tan(c+d*x)^5*(a^4+b^4+12*a^2*b^2)+1//9*b^4*d^-1*tan(c+d*x)^9+(1/2)*a*b^3*d^-1*tan(c+d*x)^8+2*b*a^3*d^-1*tan(c+d*x)^2+2//3*a^2*d^-1*tan(c+d*x)^3*(a^2+3*b^2)+2//7*b^2*d^-1*tan(c+d*x)^7*(b^2+3*a^2)+a*b*d^-1*tan(c+d*x)^4*(b^2+2*a^2)+2//3*a*b*d^-1*tan(c+d*x)^6*(a^2+2*b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^11, x) == :(3//256*b^4*d^-1*arctanh(sin(c+d*x))+5//16*a^4*d^-1*arctanh(sin(c+d*x))+-15//64*a^2*b^2*d^-1*arctanh(sin(c+d*x))+-4//7*a*b^3*d^-1*sec(c+d*x)^7+-3//80*b^4*d^-1*sec(c+d*x)^7*tan(c+d*x)+1//6*a^4*d^-1*sec(c+d*x)^5*tan(c+d*x)+1//10*b^4*d^-1*sec(c+d*x)^7*tan(c+d*x)^3+1//128*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//160*b^4*d^-1*sec(c+d*x)^5*tan(c+d*x)+3//256*b^4*d^-1*sec(c+d*x)*tan(c+d*x)+4//7*b*a^3*d^-1*sec(c+d*x)^7+4//9*a*b^3*d^-1*sec(c+d*x)^9+5//16*a^4*d^-1*sec(c+d*x)*tan(c+d*x)+5//24*a^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+-15//64*a^2*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-5//32*a^2*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+-1//8*a^2*b^2*d^-1*sec(c+d*x)^5*tan(c+d*x)+3//4*a^2*b^2*d^-1*sec(c+d*x)^7*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^4*sec(c+d*x)^12, x) == :(a^4*d^-1*tan(c+d*x)+1//5*d^-1*tan(c+d*x)^5*(b^4+3*a^4+18*a^2*b^2)+1//7*d^-1*tan(c+d*x)^7*(a^4+3*b^4+18*a^2*b^2)+1//11*b^4*d^-1*tan(c+d*x)^11+a^2*d^-1*tan(c+d*x)^3*(a^2+2*b^2)+2*b*a^3*d^-1*tan(c+d*x)^2+1//3*b^2*d^-1*tan(c+d*x)^9*(b^2+2*a^2)+2//5*a*b^3*d^-1*tan(c+d*x)^10+a*b*d^-1*tan(c+d*x)^4*(b^2+3*a^2)+(1/2)*a*b*d^-1*tan(c+d*x)^8*(a^2+3*b^2)+2*a*b*d^-1*tan(c+d*x)^6*(a^2+b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*cos(c+d*x)^5, x) == :(63//256*x*a^5+-1//4*b^5*d^-1*sin(c+d*x)^8+1//6*b^5*d^-1*sin(c+d*x)^6+1//10*b^5*d^-1*sin(c+d*x)^10+15//256*a*x*b^4+35//128*x*a^3*b^2+a^2*b^3*d^-1*cos(c+d*x)^10+-5//4*a^2*b^3*d^-1*cos(c+d*x)^8+-1//2*b*a^4*d^-1*cos(c+d*x)^10+1//10*a^5*d^-1*cos(c+d*x)^9*sin(c+d*x)+9//80*a^5*d^-1*cos(c+d*x)^7*sin(c+d*x)+21//128*a^5*d^-1*cos(c+d*x)^3*sin(c+d*x)+21//160*a^5*d^-1*cos(c+d*x)^5*sin(c+d*x)+63//256*a^5*d^-1*cos(c+d*x)*sin(c+d*x)+-1*a^3*b^2*d^-1*cos(c+d*x)^9*sin(c+d*x)+-3//16*a*b^4*d^-1*cos(c+d*x)^7*sin(c+d*x)+-1//2*a*b^4*d^-1*cos(c+d*x)^7*sin(c+d*x)^3+1//8*a^3*b^2*d^-1*cos(c+d*x)^7*sin(c+d*x)+1//32*a*b^4*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//128*a*b^4*d^-1*cos(c+d*x)^3*sin(c+d*x)+7//48*a^3*b^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+15//256*a*b^4*d^-1*cos(c+d*x)*sin(c+d*x)+35//128*a^3*b^2*d^-1*cos(c+d*x)*sin(c+d*x)+35//192*a^3*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*cos(c+d*x)^4, x) == :(a^5*d^-1*sin(c+d*x)+-4//3*a^5*d^-1*sin(c+d*x)^3+-4//7*a^5*d^-1*sin(c+d*x)^7+-1//5*b^5*d^-1*cos(c+d*x)^5+-1//9*b^5*d^-1*cos(c+d*x)^9+1//9*a^5*d^-1*sin(c+d*x)^9+2//7*b^5*d^-1*cos(c+d*x)^7+6//5*a^5*d^-1*sin(c+d*x)^5+a*b^4*d^-1*sin(c+d*x)^5+-6*a^3*b^2*d^-1*sin(c+d*x)^5+-10//7*a*b^4*d^-1*sin(c+d*x)^7+-10//7*a^2*b^3*d^-1*cos(c+d*x)^7+-10//9*a^3*b^2*d^-1*sin(c+d*x)^9+-5//9*b*a^4*d^-1*cos(c+d*x)^9+5//9*a*b^4*d^-1*sin(c+d*x)^9+10//3*a^3*b^2*d^-1*sin(c+d*x)^3+10//9*a^2*b^3*d^-1*cos(c+d*x)^9+30//7*a^3*b^2*d^-1*sin(c+d*x)^7)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*cos(c+d*x)^3, x) == :(35//128*x*a^5+-1//8*b^5*d^-1*sin(c+d*x)^8+1//6*b^5*d^-1*sin(c+d*x)^6+15//128*a*x*b^4+25//64*x*a^3*b^2+-5//3*a^2*b^3*d^-1*cos(c+d*x)^6+-5//8*b*a^4*d^-1*cos(c+d*x)^8+1//8*a^5*d^-1*cos(c+d*x)^7*sin(c+d*x)+5//4*a^2*b^3*d^-1*cos(c+d*x)^8+7//48*a^5*d^-1*cos(c+d*x)^5*sin(c+d*x)+35//128*a^5*d^-1*cos(c+d*x)*sin(c+d*x)+35//192*a^5*d^-1*cos(c+d*x)^3*sin(c+d*x)+-5//4*a^3*b^2*d^-1*cos(c+d*x)^7*sin(c+d*x)+-5//8*a*b^4*d^-1*cos(c+d*x)^5*sin(c+d*x)^3+-5//16*a*b^4*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//24*a^3*b^2*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//64*a*b^4*d^-1*cos(c+d*x)^3*sin(c+d*x)+15//128*a*b^4*d^-1*cos(c+d*x)*sin(c+d*x)+25//64*a^3*b^2*d^-1*cos(c+d*x)*sin(c+d*x)+25//96*a^3*b^2*d^-1*cos(c+d*x)^3*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*cos(c+d*x)^2, x) == :(a^5*d^-1*sin(c+d*x)+-1*a^5*d^-1*sin(c+d*x)^3+-1//3*b^5*d^-1*cos(c+d*x)^3+-1//7*a^5*d^-1*sin(c+d*x)^7+-1//7*b^5*d^-1*cos(c+d*x)^7+2//5*b^5*d^-1*cos(c+d*x)^5+3//5*a^5*d^-1*sin(c+d*x)^5+a*b^4*d^-1*sin(c+d*x)^5+-4*a^3*b^2*d^-1*sin(c+d*x)^5+-2*a^2*b^3*d^-1*cos(c+d*x)^5+-5//7*a*b^4*d^-1*sin(c+d*x)^7+-5//7*b*a^4*d^-1*cos(c+d*x)^7+10//3*a^3*b^2*d^-1*sin(c+d*x)^3+10//7*a^2*b^3*d^-1*cos(c+d*x)^7+10//7*a^3*b^2*d^-1*sin(c+d*x)^7)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*cos(c+d*x), x) == :(1//6*d^-1*(b+a*cot(c+d*x))^5*sin(c+d*x)^6+5//16*a*x*(a^2+b^2)^2+5//24*a*d^-1*(b+a*cot(c+d*x))^3*sin(c+d*x)^4*(a+-1*b*cot(c+d*x))+5//16*a*d^-1*sin(c+d*x)^2*(a+-1*b*cot(c+d*x))*(b+a*cot(c+d*x))*(a^2+b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5, x) == :(-1//5*d^-1*(b*cos(c+d*x)+-1*a*sin(c+d*x))^5+-1*d^-1*(a^2+b^2)^2*(b*cos(c+d*x)+-1*a*sin(c+d*x))+1//3*d^-1*(b*cos(c+d*x)+-1*a*sin(c+d*x))^3*(2*a^2+2*b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x), x) == :(b^5*d^-1*log(tan(c+d*x))+-1*b^5*d^-1*log(sin(c+d*x))+-1//4*d^-1*sin(c+d*x)^4*(b*(b^4+5*a^4+-10*a^2*b^2)+a*(a^4+5*b^4+-10*a^2*b^2)*cot(c+d*x))+1//8*a*x*(3*a^4+15*b^4+10*a^2*b^2)+1//8*d^-1*sin(c+d*x)^2*(4*b*(-1*b^4+5*a^4)+5*a*(a^2+b^2)*(a^2+-3*b^2)*cot(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^2, x) == :(a^5*d^-1*sin(c+d*x)+b^5*d^-1*sec(c+d*x)+2*b^5*d^-1*cos(c+d*x)+-1//3*a^5*d^-1*sin(c+d*x)^3+-1//3*b^5*d^-1*cos(c+d*x)^3+-10*a^2*b^3*d^-1*cos(c+d*x)+-5*a*b^4*d^-1*sin(c+d*x)+5*a*b^4*d^-1*arctanh(sin(c+d*x))+-5//3*a*b^4*d^-1*sin(c+d*x)^3+-5//3*b*a^4*d^-1*cos(c+d*x)^3+10//3*a^2*b^3*d^-1*cos(c+d*x)^3+10//3*a^3*b^2*d^-1*sin(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^3, x) == :((1/2)*a*x*(a^4+-15*b^4+10*a^2*b^2)+(1/2)*b^5*d^-1*tan(c+d*x)^2+(1/2)*d^-1*sin(c+d*x)^2*(b*(b^4+5*a^4+-10*a^2*b^2)+a*(a^4+5*b^4+-10*a^2*b^2)*cot(c+d*x))+-2*b^3*d^-1*(-1*b^2+5*a^2)*log(sin(c+d*x))+2*b^3*d^-1*(-1*b^2+5*a^2)*log(tan(c+d*x))+5*a*b^4*d^-1*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^4, x) == :(a^5*d^-1*sin(c+d*x)+-1*b^5*d^-1*cos(c+d*x)+-2*b^5*d^-1*sec(c+d*x)+1//3*b^5*d^-1*sec(c+d*x)^3+-10*a^3*b^2*d^-1*sin(c+d*x)+-5*b*a^4*d^-1*cos(c+d*x)+10*a^2*b^3*d^-1*cos(c+d*x)+10*a^2*b^3*d^-1*sec(c+d*x)+10*a^3*b^2*d^-1*arctanh(sin(c+d*x))+-15//2*a*b^4*d^-1*arctanh(sin(c+d*x))+15//2*a*b^4*d^-1*sin(c+d*x)+5//2*a*b^4*d^-1*tan(c+d*x)^2*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^5, x) == :(a*x*(a^4+5*b^4+-10*a^2*b^2)+1//4*b*d^-1*(a+b*tan(c+d*x))^4+(1/2)*b*d^-1*(a+b*tan(c+d*x))^2*(-1*b^2+3*a^2)+-1*b*d^-1*(b^4+5*a^4+-10*a^2*b^2)*log(cos(c+d*x))+2//3*a*b*d^-1*(a+b*tan(c+d*x))^3+4*a*b^2*d^-1*(a^2+-1*b^2)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^6, x) == :(a^5*d^-1*arctanh(sin(c+d*x))+b^5*d^-1*sec(c+d*x)+-2//3*b^5*d^-1*sec(c+d*x)^3+1//5*b^5*d^-1*sec(c+d*x)^5+-10*a^2*b^3*d^-1*sec(c+d*x)+-5*a^3*b^2*d^-1*arctanh(sin(c+d*x))+5*b*a^4*d^-1*sec(c+d*x)+10//3*a^2*b^3*d^-1*sec(c+d*x)^3+15//8*a*b^4*d^-1*arctanh(sin(c+d*x))+5*a^3*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-15//8*a*b^4*d^-1*sec(c+d*x)*tan(c+d*x)+5//4*a*b^4*d^-1*tan(c+d*x)^3*sec(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^7, x) == :(1//6*b^-1*d^-1*(b+a*cot(c+d*x))^6*tan(c+d*x)^6)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^8, x) == :((1/2)*a^5*d^-1*arctanh(sin(c+d*x))+-2//5*b^5*d^-1*sec(c+d*x)^5+1//3*b^5*d^-1*sec(c+d*x)^3+1//7*b^5*d^-1*sec(c+d*x)^7+(1/2)*a^5*d^-1*sec(c+d*x)*tan(c+d*x)+2*a^2*b^3*d^-1*sec(c+d*x)^5+-10//3*a^2*b^3*d^-1*sec(c+d*x)^3+-5//4*a^3*b^2*d^-1*arctanh(sin(c+d*x))+5//3*b*a^4*d^-1*sec(c+d*x)^3+5//16*a*b^4*d^-1*arctanh(sin(c+d*x))+-5//4*a^3*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-5//8*a*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+5//2*a^3*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+5//6*a*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)^3+5//16*a*b^4*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^9, x) == :(a^5*d^-1*tan(c+d*x)+1//8*b^5*d^-1*tan(c+d*x)^8+1//3*a^3*d^-1*tan(c+d*x)^3*(a^2+10*b^2)+1//6*b^3*d^-1*tan(c+d*x)^6*(b^2+10*a^2)+5//2*b*a^4*d^-1*tan(c+d*x)^2+5//7*a*b^4*d^-1*tan(c+d*x)^7+a*b^2*d^-1*tan(c+d*x)^5*(b^2+2*a^2)+5//4*b*a^2*d^-1*tan(c+d*x)^4*(a^2+2*b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^10, x) == :(-2//7*b^5*d^-1*sec(c+d*x)^7+1//5*b^5*d^-1*sec(c+d*x)^5+1//9*b^5*d^-1*sec(c+d*x)^9+3//8*a^5*d^-1*arctanh(sin(c+d*x))+b*a^4*d^-1*sec(c+d*x)^5+-2*a^2*b^3*d^-1*sec(c+d*x)^5+-5//8*a^3*b^2*d^-1*arctanh(sin(c+d*x))+1//4*a^5*d^-1*sec(c+d*x)^3*tan(c+d*x)+3//8*a^5*d^-1*sec(c+d*x)*tan(c+d*x)+10//7*a^2*b^3*d^-1*sec(c+d*x)^7+15//128*a*b^4*d^-1*arctanh(sin(c+d*x))+-5//8*a^3*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-5//12*a^3*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+-5//16*a*b^4*d^-1*sec(c+d*x)^5*tan(c+d*x)+5//3*a^3*b^2*d^-1*sec(c+d*x)^5*tan(c+d*x)+5//8*a*b^4*d^-1*sec(c+d*x)^5*tan(c+d*x)^3+5//64*a*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+15//128*a*b^4*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^11, x) == :(a^5*d^-1*tan(c+d*x)+1//10*b^5*d^-1*tan(c+d*x)^10+1//4*b^3*d^-1*tan(c+d*x)^8*(b^2+5*a^2)+1//5*a*d^-1*tan(c+d*x)^5*(a^4+5*b^4+20*a^2*b^2)+1//6*b*d^-1*tan(c+d*x)^6*(b^4+5*a^4+20*a^2*b^2)+2//3*a^3*d^-1*tan(c+d*x)^3*(a^2+5*b^2)+5//2*b*a^4*d^-1*tan(c+d*x)^2+5//9*a*b^4*d^-1*tan(c+d*x)^9+5//2*b*a^2*d^-1*tan(c+d*x)^4*(a^2+b^2)+10//7*a*b^2*d^-1*tan(c+d*x)^7*(a^2+b^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^5*sec(c+d*x)^12, x) == :(-2//9*b^5*d^-1*sec(c+d*x)^9+1//7*b^5*d^-1*sec(c+d*x)^7+1//11*b^5*d^-1*sec(c+d*x)^11+5//16*a^5*d^-1*arctanh(sin(c+d*x))+-25//64*a^3*b^2*d^-1*arctanh(sin(c+d*x))+-10//7*a^2*b^3*d^-1*sec(c+d*x)^7+1//6*a^5*d^-1*sec(c+d*x)^5*tan(c+d*x)+5//7*b*a^4*d^-1*sec(c+d*x)^7+5//16*a^5*d^-1*sec(c+d*x)*tan(c+d*x)+5//24*a^5*d^-1*sec(c+d*x)^3*tan(c+d*x)+10//9*a^2*b^3*d^-1*sec(c+d*x)^9+15//256*a*b^4*d^-1*arctanh(sin(c+d*x))+(1/2)*a*b^4*d^-1*sec(c+d*x)^7*tan(c+d*x)^3+-25//64*a^3*b^2*d^-1*sec(c+d*x)*tan(c+d*x)+-25//96*a^3*b^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+-5//24*a^3*b^2*d^-1*sec(c+d*x)^5*tan(c+d*x)+-3//16*a*b^4*d^-1*sec(c+d*x)^7*tan(c+d*x)+1//32*a*b^4*d^-1*sec(c+d*x)^5*tan(c+d*x)+5//4*a^3*b^2*d^-1*sec(c+d*x)^7*tan(c+d*x)+5//128*a*b^4*d^-1*sec(c+d*x)^3*tan(c+d*x)+15//256*a*b^4*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*cos(c+d*x)^5, x) == :(3*a*x*(8*a^2+8*b^2)^-1+a*x*b^4*(a^2+b^2)^-3+b*d^-1*(4*a^2+4*b^2)^-1*cos(c+d*x)^4+b^5*d^-1*(a^2+b^2)^-3*log(a*cos(c+d*x)+b*sin(c+d*x))+(1/2)*a*x*b^2*(a^2+b^2)^-2+(1/2)*b^3*d^-1*(a^2+b^2)^-2*cos(c+d*x)^2+a*d^-1*(4*a^2+4*b^2)^-1*cos(c+d*x)^3*sin(c+d*x)+3*a*d^-1*(8*a^2+8*b^2)^-1*cos(c+d*x)*sin(c+d*x)+(1/2)*a*b^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*cos(c+d*x)^4, x) == :(a*d^-1*(a^2+b^2)^-1*sin(c+d*x)+b*d^-1*(3*a^2+3*b^2)^-1*cos(c+d*x)^3+b^3*d^-1*(a^2+b^2)^-2*cos(c+d*x)+-1*a*d^-1*(3*a^2+3*b^2)^-1*sin(c+d*x)^3+-1*b^4*d^-1*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+a*b^2*d^-1*(a^2+b^2)^-2*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*cos(c+d*x)^3, x) == :(a*x*(2*a^2+2*b^2)^-1+a*x*b^2*(a^2+b^2)^-2+b*d^-1*(2*a^2+2*b^2)^-1*cos(c+d*x)^2+b^3*d^-1*(a^2+b^2)^-2*log(a*cos(c+d*x)+b*sin(c+d*x))+a*d^-1*(2*a^2+2*b^2)^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*cos(c+d*x)^2, x) == :(a*d^-1*(a^2+b^2)^-1*sin(c+d*x)+b*d^-1*(a^2+b^2)^-1*cos(c+d*x)+-1*b^2*d^-1*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*cos(c+d*x), x) == :(a*x*(a^2+b^2)^-1+b*d^-1*(a^2+b^2)^-1*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1, x) == :(-1*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*sec(c+d*x), x) == :(b^-1*d^-1*log(a*cos(c+d*x)+b*sin(c+d*x))+-1*b^-1*d^-1*log(cos(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*sec(c+d*x)^2, x) == :(b^-1*d^-1*sec(c+d*x)+-1*a*b^-2*d^-1*arctanh(sin(c+d*x))+-1*b^-2*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*sec(c+d*x)^3, x) == :((1/2)*b^-1*d^-1*sec(c+d*x)^2+b^-3*d^-1*(a^2+b^2)*log(a*cos(c+d*x)+b*sin(c+d*x))+-1*a*b^-2*d^-1*tan(c+d*x)+-1*b^-3*d^-1*(a^2+b^2)*log(cos(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*sec(c+d*x)^4, x) == :(1//3*b^-1*d^-1*sec(c+d*x)^3+b^-3*d^-1*(a^2+b^2)*sec(c+d*x)+-1*b^-4*d^-1*(a^2+b^2)^3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-1//2*a*b^-2*d^-1*arctanh(sin(c+d*x))+-1*a*b^-4*d^-1*(a^2+b^2)*arctanh(sin(c+d*x))+-1//2*a*b^-2*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*sec(c+d*x)^5, x) == :(1//4*b^-1*d^-1*sec(c+d*x)^4+b^-5*d^-1*(a^2+b^2)^2*log(a*cos(c+d*x)+b*sin(c+d*x))+(1/2)*b^-3*d^-1*sec(c+d*x)^2*(a^2+b^2)+-1*a*b^-2*d^-1*tan(c+d*x)+-1*b^-5*d^-1*(a^2+b^2)^2*log(cos(c+d*x))+-1//3*a*b^-2*d^-1*tan(c+d*x)^3+-1*a*b^-4*d^-1*(a^2+b^2)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-1*sec(c+d*x)^6, x) == :(1//5*b^-1*d^-1*sec(c+d*x)^5+b^-5*d^-1*(a^2+b^2)^2*sec(c+d*x)+-1*b^-6*d^-1*(a^2+b^2)^5//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-3//8*a*b^-2*d^-1*arctanh(sin(c+d*x))+1//3*b^-3*d^-1*sec(c+d*x)^3*(a^2+b^2)+-1*a*b^-6*d^-1*(a^2+b^2)^2*arctanh(sin(c+d*x))+-3//8*a*b^-2*d^-1*sec(c+d*x)*tan(c+d*x)+-1//2*a*b^-4*d^-1*(a^2+b^2)*arctanh(sin(c+d*x))+-1//4*a*b^-2*d^-1*sec(c+d*x)^3*tan(c+d*x)+-1//2*a*b^-4*d^-1*(a^2+b^2)*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*cos(c+d*x)^4, x) == :((1/2)*x*(a^2+b^2)^-3*(a^4+-3*b^4+6*a^2*b^2)+-1//2*d^-1*(a^2+b^2)^-2*sin(c+d*x)^2*(-1*(a^2+-1*b^2)*cot(c+d*x)+2*a*b)+a^-1*b^4*d^-1*(b+a*cot(c+d*x))^-1*(a^2+b^2)^-2+4*a*b^3*d^-1*(a^2+b^2)^-3*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*cos(c+d*x)^3, x) == :(d^-1*(a^2+b^2)^-2*(a^2+-1*b^2)*sin(c+d*x)+-1*b^3*d^-1*(a^2+b^2)^-2*(a*cos(c+d*x)+b*sin(c+d*x))^-1+-3*a*b^2*d^-1*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+2*a*b*d^-1*(a^2+b^2)^-2*cos(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*cos(c+d*x)^2, x) == :(x*(a^2+b^2)^-2*(a^2+-1*b^2)+-1*b*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-1+2*a*b*d^-1*(a^2+b^2)^-2*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*cos(c+d*x), x) == :(-1*a*d^-1*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-1*b*d^-1*(a^2+b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2, x) == :(a^-1*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*sec(c+d*x), x) == :(b^-2*d^-1*arctanh(sin(c+d*x))+-1*b^-1*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1+a*b^-2*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*sec(c+d*x)^2, x) == :(b^-2*d^-1*tan(c+d*x)+d^-1*(b+a*cot(c+d*x))^-1*(a^-1+a*b^-2)+-2*a*b^-3*d^-1*log(b+a*cot(c+d*x))+-2*a*b^-3*d^-1*log(tan(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*sec(c+d*x)^3, x) == :((1/2)*b^-2*d^-1*arctanh(sin(c+d*x))+b^-4*d^-1*(a^2+b^2)*arctanh(sin(c+d*x))+(1/2)*b^-2*d^-1*sec(c+d*x)*tan(c+d*x)+-1*b^-3*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1*(a^2+b^2)+-2*a*b^-3*d^-1*sec(c+d*x)+2*a^2*b^-4*d^-1*arctanh(sin(c+d*x))+3*a*b^-4*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-2*sec(c+d*x)^4, x) == :(1//3*b^-2*d^-1*tan(c+d*x)^3+b^-4*d^-1*(2*b^2+3*a^2)*tan(c+d*x)+-1*a*b^-3*d^-1*tan(c+d*x)^2+a^-1*b^-4*d^-1*(b+a*cot(c+d*x))^-1*(a^2+b^2)^2+-4*a*b^-5*d^-1*(a^2+b^2)*log(b+a*cot(c+d*x))+-4*a*b^-5*d^-1*(a^2+b^2)*log(tan(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*cos(c+d*x)^4, x) == :(a*d^-1*(a^2+b^2)^-3*(a^2+-3*b^2)*sin(c+d*x)+b*d^-1*(a^2+b^2)^-3*(-1*b^2+3*a^2)*cos(c+d*x)+-3*b^2*d^-1*(a^2+b^2)^-7//2*(-1*b^2+4*a^2)*arctanh((a^2+b^2)^-1//2*(b+-1*a*tan((1/2)*c+(1/2)*d*x)))+(1/2)*a^-1*b^4*d^-1*(a^2+b^2)^-2*(a*cos(c+d*x)+b*sin(c+d*x))^-2*sin(c+d*x)+-1//2*a^-1*b^3*d^-1*(a^2+b^2)^-3*(a*cos(c+d*x)+b*sin(c+d*x))^-1*(b^2+8*a^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*cos(c+d*x)^3, x) == :(a*x*(a^2+b^2)^-3*(a^2+-3*b^2)+-1*b*d^-1*(a+b*tan(c+d*x))^-2*(2*a^2+2*b^2)^-1+b*d^-1*(a^2+b^2)^-3*(-1*b^2+3*a^2)*log(a*cos(c+d*x)+b*sin(c+d*x))+-2*a*b*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-2)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*cos(c+d*x)^2, x) == :((1/2)*d^-1*(a^2+b^2)^-5//2*(-2*b^2+4*a^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x)))+-1//2*b*d^-1*(a^2+b^2)^-2*(a*cos(c+d*x)+b*sin(c+d*x))^-2*((b^2+4*a^2)*cos(c+d*x)+3*a*b*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3, x) == :(-1//2*d^-1*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-1*d^-1*(2*a^2+2*b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*sec(c+d*x), x) == :(b^-3*d^-1*log(b+a*cot(c+d*x))+b^-3*d^-1*log(tan(c+d*x))+d^-1*(b+a*cot(c+d*x))^-1*(a^-2+-1*b^-2)+-1//2*d^-1*(b+a*cot(c+d*x))^-2*(b^-1+b*a^-2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*sec(c+d*x)^2, x) == :(b^-3*d^-1*sec(c+d*x)+-1*b^-4*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-3*a*b^-4*d^-1*arctanh(sin(c+d*x))+2*a*b^-3*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1+-1//2*b^-2*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-1//2*b^-2*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(b*cos(c+d*x)+-1*a*sin(c+d*x))+-2*a^2*b^-4*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*sec(c+d*x)^3, x) == :((1/2)*b^-3*d^-1*tan(c+d*x)^2+b^-5*d^-1*(2*b^2+6*a^2)*log(b+a*cot(c+d*x))+b^-5*d^-1*(2*b^2+6*a^2)*log(tan(c+d*x))+-3*a*b^-4*d^-1*tan(c+d*x)+-1//2*a^-2*b^-3*d^-1*(b+a*cot(c+d*x))^-2*(a^2+b^2)^2+-1*a^-2*b^-4*d^-1*(b+a*cot(c+d*x))^-1*(a^2+b^2)*(-1*b^2+3*a^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*sec(c+d*x)^4, x) == :(1//3*b^-3*d^-1*sec(c+d*x)^3+b^-5*d^-1*(2*a^2+2*b^2)*sec(c+d*x)+-4*a^3*b^-6*d^-1*arctanh(sin(c+d*x))+-2*b^-6*d^-1*(a^2+b^2)^3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+4*a^2*b^-5*d^-1*sec(c+d*x)+-3//2*a*b^-4*d^-1*arctanh(sin(c+d*x))+-1//2*b^-4*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-8*a^2*b^-6*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-6*a*b^-6*d^-1*(a^2+b^2)*arctanh(sin(c+d*x))+4*a*b^-5*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1*(a^2+b^2)+-3//2*a*b^-4*d^-1*sec(c+d*x)*tan(c+d*x)+-1//2*b^-4*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(a^2+b^2)*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-3*sec(c+d*x)^5, x) == :(1//4*b^-3*d^-1*tan(c+d*x)^4+(1/2)*b^-5*d^-1*tan(c+d*x)^2*(3*b^2+6*a^2)+-1*a*b^-4*d^-1*tan(c+d*x)^3+b^-7*d^-1*(b^2+5*a^2)*(3*a^2+3*b^2)*log(b+a*cot(c+d*x))+b^-7*d^-1*(b^2+5*a^2)*(3*a^2+3*b^2)*log(tan(c+d*x))+-1*a*b^-6*d^-1*(9*b^2+10*a^2)*tan(c+d*x)+-1//2*a^-2*b^-5*d^-1*(b+a*cot(c+d*x))^-2*(a^2+b^2)^3+-1*a^-2*b^-6*d^-1*(b+a*cot(c+d*x))^-1*(a^2+b^2)^2*(-1*b^2+5*a^2))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*cos(c+d*x)^4, x) == :(x*(a^2+b^2)^-4*(a^4+b^4+-6*a^2*b^2)+-1*b*d^-1*(a+b*tan(c+d*x))^-3*(3*a^2+3*b^2)^-1+-1*a*b*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-2+-1*b*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-3*(-1*b^2+3*a^2)+4*a*b*d^-1*(a^2+b^2)^-4*(a^2+-1*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*cos(c+d*x)^3, x) == :(1//6*d^-1*(a^2+b^2)^-3*(a*cos(c+d*x)+b*sin(c+d*x))^-3*((-3*b^5+-9*b*a^4+3*a^2*b^3)*cos(2c+2*d*x)+(1/2)*b*(b^2+-9*a^2)*(2*a^2+2*b^2+3*a*b*sin(2c+2*d*x)))+a*d^-1*(a^2+b^2)^-7//2*(-3*b^2+2*a^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x))))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*cos(c+d*x)^2, x) == :(-1//3*b^-1*d^-1*(b+a*cot(c+d*x))^-3*cot(c+d*x)^3)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*cos(c+d*x), x) == :(-1*b*d^-1*(3*a^2+3*b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-3+-1//2*a*d^-1*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-1//2*a*d^-1*(a^2+b^2)^-2*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4, x) == :(-1*d^-1*(3*a^2+3*b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-3*(b*cos(c+d*x)+-1*a*sin(c+d*x))+2//3*a^-1*d^-1*(a^2+b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1*sin(c+d*x))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*sec(c+d*x), x) == :(b^-4*d^-1*arctanh(sin(c+d*x))+-1*b^-3*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1+-1//3*b^-1*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-3+a*b^-4*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+(1/2)*a*b^-2*d^-1*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+(1/2)*a*b^-2*d^-1*(a^2+b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*sec(c+d*x)^2, x) == :(b^-4*d^-1*tan(c+d*x)+d^-1*(b+a*cot(c+d*x))^-1*(a^-3+3*a*b^-4)+d^-1*(b+a*cot(c+d*x))^-2*(a*b^-3+-1*b*a^-3)+-4*a*b^-5*d^-1*log(b+a*cot(c+d*x))+-4*a*b^-5*d^-1*log(tan(c+d*x))+1//3*a^-3*b^-2*d^-1*(b+a*cot(c+d*x))^-3*(a^2+b^2)^2)
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*sec(c+d*x)^3, x) == :((1/2)*b^-4*d^-1*arctanh(sin(c+d*x))+b^-6*d^-1*(2*a^2+2*b^2)*arctanh(sin(c+d*x))+(1/2)*b^-4*d^-1*sec(c+d*x)*tan(c+d*x)+-1*b^-5*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1*(2*a^2+2*b^2)+-4*a*b^-5*d^-1*sec(c+d*x)+-4*a^2*b^-5*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1+8*a^2*b^-6*d^-1*arctanh(sin(c+d*x))+-1//3*b^-3*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-3*(a^2+b^2)+4*a^3*b^-6*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+6*a*b^-6*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+3//2*a*b^-4*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+3//2*a*b^-4*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a*cos(c+d*x)+b*sin(c+d*x))^-4*sec(c+d*x)^4, x) == :(1//3*b^-4*d^-1*tan(c+d*x)^3+b^-6*d^-1*(3*b^2+10*a^2)*tan(c+d*x)+-2*a*b^-5*d^-1*tan(c+d*x)^2+a^-3*b^-6*d^-1*(b+a*cot(c+d*x))^-1*(b^6+10*a^6+9*a^4*b^2)+a^-3*b^-5*d^-1*(b+a*cot(c+d*x))^-2*(-1*b^6+2*a^6+3*a^4*b^2)+-4*a*b^-7*d^-1*(3*b^2+5*a^2)*log(b+a*cot(c+d*x))+-4*a*b^-7*d^-1*(3*b^2+5*a^2)*log(tan(c+d*x))+1//3*a^-3*b^-4*d^-1*(b+a*cot(c+d*x))^-3*(a^2+b^2)^3)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*cos(c+d*x)^5, x) == :(5//16*x*a^-1+1//6*im*a^-1*d^-1*cos(c+d*x)^6+1//6*a^-1*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//16*a^-1*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a^-1*d^-1*cos(c+d*x)^3*sin(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*cos(c+d*x)^4, x) == :(a^-1*d^-1*sin(c+d*x)+-2//3*a^-1*d^-1*sin(c+d*x)^3+1//5*a^-1*d^-1*sin(c+d*x)^5+1//5*im*a^-1*d^-1*cos(c+d*x)^5)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*cos(c+d*x)^3, x) == :(3//8*x*a^-1+1//4*im*a^-1*d^-1*cos(c+d*x)^4+1//4*a^-1*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a^-1*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*cos(c+d*x)^2, x) == :(a^-1*d^-1*sin(c+d*x)+-1//3*a^-1*d^-1*sin(c+d*x)^3+1//3*im*a^-1*d^-1*cos(c+d*x)^3)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*cos(c+d*x), x) == :((1/2)*x*a^-1+(1/2)*im*d^-1*(a*cos(c+d*x)+im*a*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1, x) == :(im*d^-1*(a*cos(c+d*x)+im*a*sin(c+d*x))^-1)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*sec(c+d*x), x) == :(x*a^-1+im*a^-1*d^-1*log(cos(c+d*x)))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*sec(c+d*x)^2, x) == :(a^-1*d^-1*arctanh(sin(c+d*x))+-1*im*a^-1*d^-1*sec(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*sec(c+d*x)^3, x) == :(a^-1*d^-1*tan(c+d*x)+-1//2*im*a^-1*d^-1*sec(c+d*x)^2)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*sec(c+d*x)^4, x) == :((1/2)*a^-1*d^-1*arctanh(sin(c+d*x))+(1/2)*a^-1*d^-1*sec(c+d*x)*tan(c+d*x)+-1//3*im*a^-1*d^-1*sec(c+d*x)^3)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*sec(c+d*x)^5, x) == :(a^-1*d^-1*tan(c+d*x)+1//3*a^-1*d^-1*tan(c+d*x)^3+-1//4*im*a^-1*d^-1*sec(c+d*x)^4)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*sec(c+d*x)^6, x) == :(3//8*a^-1*d^-1*arctanh(sin(c+d*x))+-1//5*im*a^-1*d^-1*sec(c+d*x)^5+1//4*a^-1*d^-1*sec(c+d*x)^3*tan(c+d*x)+3//8*a^-1*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-1*sec(c+d*x)^7, x) == :(a^-1*d^-1*tan(c+d*x)+1//5*a^-1*d^-1*tan(c+d*x)^5+2//3*a^-1*d^-1*tan(c+d*x)^3+-1//6*im*a^-1*d^-1*sec(c+d*x)^6)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*cos(c+d*x)^5, x) == :(a^-2*d^-1*sin(c+d*x)^5+a^-2*d^-1*sin(c+d*x)+-4//3*a^-2*d^-1*sin(c+d*x)^3+-2//7*a^-2*d^-1*sin(c+d*x)^7+2//7*im*a^-2*d^-1*cos(c+d*x)^7)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*cos(c+d*x)^4, x) == :(1//4*x*a^-2+-1//12*a^-2*d^-1*(im+cot(c+d*x))^-3+-1//16*a^-2*d^-1*(im+-1*cot(c+d*x))^-1+11//16*a^-2*d^-1*(im+cot(c+d*x))^-1+-3//8*im*a^-2*d^-1*(im+cot(c+d*x))^-2)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*cos(c+d*x)^3, x) == :(a^-2*d^-1*sin(c+d*x)+-1*a^-2*d^-1*sin(c+d*x)^3+2//5*a^-2*d^-1*sin(c+d*x)^5+2//5*im*a^-2*d^-1*cos(c+d*x)^5)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*cos(c+d*x)^2, x) == :(1//4*x*a^-2+1//4*im*d^-1*(a*cos(c+d*x)+im*a*sin(c+d*x))^-2*cos(c+d*x)^2+1//4*im*d^-1*(a^2*cos(c+d*x)+im*a^2*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*cos(c+d*x), x) == :(a^-2*d^-1*sin(c+d*x)+-2//3*a^-2*d^-1*sin(c+d*x)^3+2//3*im*a^-2*d^-1*cos(c+d*x)^3)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2, x) == :((1/2)*im*d^-1*(a*cos(c+d*x)+im*a*sin(c+d*x))^-2)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*sec(c+d*x), x) == :(-1*a^-2*d^-1*arctanh(sin(c+d*x))+2*a^-2*d^-1*sin(c+d*x)+2*im*a^-2*d^-1*cos(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*sec(c+d*x)^2, x) == :(2*x*a^-2+-1*a^-2*d^-1*tan(c+d*x)+-2*im*a^-2*d^-1*log(tan(c+d*x))+2*im*a^-2*d^-1*log(sin(c+d*x)))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*sec(c+d*x)^3, x) == :(3//2*a^-2*d^-1*arctanh(sin(c+d*x))+-2*im*a^-2*d^-1*sec(c+d*x)+-1//2*a^-2*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*sec(c+d*x)^4, x) == :(-1//3*im*a^-2*d^-1*(im+-1*cot(c+d*x))^3*tan(c+d*x)^3)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*sec(c+d*x)^5, x) == :(5//8*a^-2*d^-1*arctanh(sin(c+d*x))+-2//3*im*a^-2*d^-1*sec(c+d*x)^3+-1//4*a^-2*d^-1*sec(c+d*x)^3*tan(c+d*x)+5//8*a^-2*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-2*sec(c+d*x)^6, x) == :(a^-2*d^-1*tan(c+d*x)+-1//5*a^-2*d^-1*tan(c+d*x)^5+-1*im*a^-2*d^-1*tan(c+d*x)^2+-1//2*im*a^-2*d^-1*tan(c+d*x)^4)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*cos(c+d*x)^5, x) == :(5//32*x*a^-3+-1//3*a^-3*d^-1*(im+cot(c+d*x))^-3+-1//32*a^-3*d^-1*(im+-1*cot(c+d*x))^-1+13//16*a^-3*d^-1*(im+cot(c+d*x))^-1+-23//32*im*a^-3*d^-1*(im+cot(c+d*x))^-2+1//16*im*a^-3*d^-1*(im+cot(c+d*x))^-4)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*cos(c+d*x)^4, x) == :(a^-3*d^-1*sin(c+d*x)+-2*a^-3*d^-1*sin(c+d*x)^3+-4//7*a^-3*d^-1*sin(c+d*x)^7+9//5*a^-3*d^-1*sin(c+d*x)^5+-1//5*im*a^-3*d^-1*cos(c+d*x)^5+4//7*im*a^-3*d^-1*cos(c+d*x)^7)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*cos(c+d*x)^3, x) == :(1//8*x*a^-3+1//6*im*d^-1*(a*cos(c+d*x)+im*a*sin(c+d*x))^-3*cos(c+d*x)^3+1//8*im*d^-1*(a^3*cos(c+d*x)+im*a^3*sin(c+d*x))^-1*cos(c+d*x)+1//8*im*a^-1*d^-1*(a*cos(c+d*x)+im*a*sin(c+d*x))^-2*cos(c+d*x)^2)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*cos(c+d*x)^2, x) == :(a^-3*d^-1*sin(c+d*x)+-5//3*a^-3*d^-1*sin(c+d*x)^3+4//5*a^-3*d^-1*sin(c+d*x)^5+-1//3*im*a^-3*d^-1*cos(c+d*x)^3+4//5*im*a^-3*d^-1*cos(c+d*x)^5)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*cos(c+d*x), x) == :((1/2)*im*a^-3*d^-1*(im+cot(c+d*x))^-2*cot(c+d*x)^2)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3, x) == :(1//3*im*d^-1*(a*cos(c+d*x)+im*a*sin(c+d*x))^-3)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*sec(c+d*x), x) == :(-1*x*a^-3+2*a^-3*d^-1*(im+cot(c+d*x))^-1+im*a^-3*d^-1*log(tan(c+d*x))+-1*im*a^-3*d^-1*log(sin(c+d*x)))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*sec(c+d*x)^2, x) == :(-3*a^-3*d^-1*arctanh(sin(c+d*x))+4*a^-3*d^-1*sin(c+d*x)+im*a^-3*d^-1*sec(c+d*x)+4*im*a^-3*d^-1*cos(c+d*x))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*sec(c+d*x)^3, x) == :(4*x*a^-3+-3*a^-3*d^-1*tan(c+d*x)+(1/2)*im*a^-3*d^-1*tan(c+d*x)^2+-4*im*a^-3*d^-1*log(tan(c+d*x))+4*im*a^-3*d^-1*log(sin(c+d*x)))
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*sec(c+d*x)^4, x) == :(5//2*a^-3*d^-1*arctanh(sin(c+d*x))+-4*im*a^-3*d^-1*sec(c+d*x)+-3//2*a^-3*d^-1*sec(c+d*x)*tan(c+d*x)+1//3*im*a^-3*d^-1*sec(c+d*x)^3)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*sec(c+d*x)^5, x) == :(1//4*im*a^-3*d^-1*(im+-1*cot(c+d*x))^4*tan(c+d*x)^4)
@test integrate((a*cos(c+d*x)+im*a*sin(c+d*x))^-3*sec(c+d*x)^6, x) == :(7//8*a^-3*d^-1*arctanh(sin(c+d*x))+-4//3*im*a^-3*d^-1*sec(c+d*x)^3+-3//4*a^-3*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//5*im*a^-3*d^-1*sec(c+d*x)^5+7//8*a^-3*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((sec(x)+tan(x))^-1, x) == :(log(1+sin(x)))
@test integrate((sec(x)+tan(x))^-1*sin(x), x) == :(-1*log(1+sin(x))+sin(x))
@test integrate((sec(x)+tan(x))^-1*cos(x), x) == :(x+cos(x))
@test integrate((sec(x)+tan(x))^-1*tan(x), x) == :(x+(1+sin(x))^-1*cos(x))
@test integrate((sec(x)+tan(x))^-1*cot(x), x) == :(-1x+-1*arctanh(cos(x)))
@test integrate((sec(x)+tan(x))^-1*sec(x), x) == :(-1*(1+sin(x))^-1*cos(x))
@test integrate((sec(x)+tan(x))^-1*csc(x), x) == :(-1*log(1+sin(x))+log(sin(x)))
@test integrate((-1*tan(x)+sec(x))^-1, x) == :(-1*log(1+-1*sin(x)))
@test integrate((-1*tan(x)+sec(x))^-1*sin(x), x) == :(-1*log(1+-1*sin(x))+-1*sin(x))
@test integrate((-1*tan(x)+sec(x))^-1*cos(x), x) == :(x+-1*cos(x))
@test integrate((-1*tan(x)+sec(x))^-1*tan(x), x) == :(-1x+(1+-1*sin(x))^-1*cos(x))
@test integrate((-1*tan(x)+sec(x))^-1*cot(x), x) == :(x+-1*arctanh(cos(x)))
@test integrate((-1*tan(x)+sec(x))^-1*sec(x), x) == :((1+-1*sin(x))^-1*cos(x))
@test integrate((-1*tan(x)+sec(x))^-1*csc(x), x) == :(-1*log(1+-1*sin(x))+log(sin(x)))
@test integrate((cot(c+d*x)+csc(c+d*x))*csc(c+d*x), x) == :(-1*d^-1*cot(c+d*x)+-1*d^-1*csc(c+d*x))
@test integrate((cot(x)+csc(x))^-1*sin(x), x) == :(x+-1*sin(x))
@test integrate((cot(x)+csc(x))^-1*cos(x), x) == :(-1*cos(x)+log(1+cos(x)))
@test integrate((cot(x)+csc(x))^-1*tan(x), x) == :(-1x+arctanh(sin(x)))
@test integrate((cot(x)+csc(x))^-1*cot(x), x) == :(x+-1*(1+cos(x))^-1*sin(x))
@test integrate((cot(x)+csc(x))^-1*sec(x), x) == :(-1*log(cos(x))+log(1+cos(x)))
@test integrate((cot(x)+csc(x))^-1*csc(x), x) == :((1+cos(x))^-1*sin(x))
@test integrate((-1*cot(x)+csc(x))^-1*sin(x), x) == :(x+sin(x))
@test integrate((-1*cot(x)+csc(x))^-1*cos(x), x) == :(cos(x)+log(1+-1*cos(x)))
@test integrate((-1*cot(x)+csc(x))^-1*tan(x), x) == :(x+arctanh(sin(x)))
@test integrate((-1*cot(x)+csc(x))^-1*cot(x), x) == :(-1x+-1*(1+-1*cos(x))^-1*sin(x))
@test integrate((-1*cot(x)+csc(x))^-1*sec(x), x) == :(-1*log(cos(x))+log(1+-1*cos(x)))
@test integrate((-1*cot(x)+csc(x))^-1*csc(x), x) == :(-1*(1+-1*cos(x))^-1*sin(x))
@test integrate((csc(c+d*x)+sin(c+d*x))^-1, x) == :(-1//2*2^(1/2)*d^-1*arctanh((1/2)*2^(1/2)*cos(c+d*x)))
@test integrate((csc(c+d*x)+sin(c+d*x))^-1*sin(c+d*x), x) == :(x+-1//2*x*2^(1/2)+-1//2*2^(1/2)*d^-1*arctan((1+2^(1/2)+sin(c+d*x)^2)^-1*cos(c+d*x)*sin(c+d*x)))
@test integrate((csc(c+d*x)+sin(c+d*x))^-1*cos(c+d*x), x) == :((1/2)*d^-1*log(1+sin(c+d*x)^2))
@test integrate((csc(c+d*x)+sin(c+d*x))^-1*tan(c+d*x), x) == :((1/2)*d^-1*arctanh(sin(c+d*x))+-1//2*d^-1*arctan(sin(c+d*x)))
@test integrate((csc(c+d*x)+sin(c+d*x))^-1*cot(c+d*x), x) == :(d^-1*arctan(sin(c+d*x)))
@test integrate((csc(c+d*x)+sin(c+d*x))^-1*sec(c+d*x), x) == :((1/2)*d^-1*arctanh(sin(c+d*x)^2))
@test integrate((csc(c+d*x)+sin(c+d*x))^-1*csc(c+d*x), x) == :((1/2)*x*2^(1/2)+(1/2)*2^(1/2)*d^-1*arctan((1+2^(1/2)+sin(c+d*x)^2)^-1*cos(c+d*x)*sin(c+d*x)))
@test integrate((-1*sin(c+d*x)+csc(c+d*x))^-1, x) == :(d^-1*sec(c+d*x))
@test integrate((-1*sin(c+d*x)+csc(c+d*x))^-1*sin(c+d*x), x) == :(-1x+d^-1*tan(c+d*x))
@test integrate((-1*sin(c+d*x)+csc(c+d*x))^-1*cos(c+d*x), x) == :(-1*d^-1*log(cos(c+d*x)))
@test integrate((-1*sin(c+d*x)+csc(c+d*x))^-1*tan(c+d*x), x) == :(-1//2*d^-1*arctanh(sin(c+d*x))+(1/2)*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((-1*sin(c+d*x)+csc(c+d*x))^-1*cot(c+d*x), x) == :(d^-1*arctanh(sin(c+d*x)))
@test integrate((-1*sin(c+d*x)+csc(c+d*x))^-1*sec(c+d*x), x) == :((1/2)*d^-1*sec(c+d*x)^2)
@test integrate((-1*sin(c+d*x)+csc(c+d*x))^-1*csc(c+d*x), x) == :(d^-1*tan(c+d*x))
@test integrate(cos(c+d*x)^3*(a*sin(c+d*x)+b*tan(c+d*x)), x) == :(-1//3*b*d^-1*cos(c+d*x)^3+-1//4*a*d^-1*cos(c+d*x)^4)
@test integrate(cos(c+d*x)^2*(a*sin(c+d*x)+b*tan(c+d*x)), x) == :((1/2)*b*d^-1*sin(c+d*x)^2+-1//3*a*d^-1*cos(c+d*x)^3)
@test integrate(a*sin(c+d*x)+b*tan(c+d*x), x) == :(-1*a*d^-1*cos(c+d*x)+-1*b*d^-1*log(cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))*sec(c+d*x), x) == :(b*d^-1*sec(c+d*x)+-1*a*d^-1*log(cos(c+d*x)))
@test integrate(sec(c+d*x)^2*(a*sin(c+d*x)+b*tan(c+d*x)), x) == :(a*d^-1*sec(c+d*x)+(1/2)*b*d^-1*sec(c+d*x)^2)
@test integrate(sec(c+d*x)^3*(a*sin(c+d*x)+b*tan(c+d*x)), x) == :((1/2)*a*d^-1*sec(c+d*x)^2+1//3*b*d^-1*sec(c+d*x)^3)
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^2*cos(c+d*x)^3, x) == :(1//4*a*b*x+1//5*d^-1*(b+a*cos(c+d*x))^2*sin(c+d*x)^3+1//30*d^-1*sin(c+d*x)^3*(b^2+4*a^2)+1//10*b*d^-1*sin(c+d*x)^3*(b+a*cos(c+d*x))+-1//4*a*b*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^2*cos(c+d*x)^2, x) == :(x*((1/2)*b^2+1//8*a^2)+-1//8*d^-1*(a^2+4*b^2)*cos(c+d*x)*sin(c+d*x)+1//4*a*d^-1*sin(c+d*x)^3*(b+a*cos(c+d*x))+5//12*a*b*d^-1*sin(c+d*x)^3)
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^2*cos(c+d*x), x) == :(a*b*x+b^2*d^-1*arctanh(sin(c+d*x))+-1//3*d^-1*(b+a*cos(c+d*x))^2*sin(c+d*x)+1//3*d^-1*(a^2+-2*b^2)*sin(c+d*x)+-1//3*a*b*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^2, x) == :((1/2)*x*a^2+-1*x*b^2+b^2*d^-1*tan(c+d*x)+-2*a*b*d^-1*sin(c+d*x)+2*a*b*d^-1*arctanh(sin(c+d*x))+-1//2*a^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^2*sec(c+d*x), x) == :((1/2)*d^-1*(-1*b^2+2*a^2)*arctanh(sin(c+d*x))+-2*a*b*x+-3//2*a^2*d^-1*sin(c+d*x)+a*b*d^-1*tan(c+d*x)+(1/2)*d^-1*(b+a*cos(c+d*x))^2*sec(c+d*x)*tan(c+d*x))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^2*sec(c+d*x)^2, x) == :(-1*x*a^2+1//3*d^-1*(-1*b^2+2*a^2)*tan(c+d*x)+-1*a*b*d^-1*arctanh(sin(c+d*x))+1//3*d^-1*(b+a*cos(c+d*x))^2*sec(c+d*x)^2*tan(c+d*x)+1//3*a*b*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^2*sec(c+d*x)^3, x) == :(-1//8*d^-1*(b^2+4*a^2)*arctanh(sin(c+d*x))+-2//3*a*b*d^-1*tan(c+d*x)+1//4*d^-1*(b+a*cos(c+d*x))^2*sec(c+d*x)^3*tan(c+d*x)+1//8*d^-1*(-1*b^2+2*a^2)*sec(c+d*x)*tan(c+d*x)+1//6*a*b*d^-1*sec(c+d*x)^2*tan(c+d*x))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3*cos(c+d*x)^3, x) == :(1//6*a^-3*d^-1*(b+a*cos(c+d*x))^6+-2//5*b*a^-3*d^-1*(b+a*cos(c+d*x))^5+-1//4*a^-3*d^-1*(b+a*cos(c+d*x))^4*(a^2+-1*b^2))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3*cos(c+d*x)^2, x) == :(-1*b^3*d^-1*log(cos(c+d*x))+1//5*a^3*d^-1*cos(c+d*x)^5+-3*a*b^2*d^-1*cos(c+d*x)+-1//2*b*d^-1*cos(c+d*x)^2*(-1*b^2+3*a^2)+-1//3*a*d^-1*cos(c+d*x)^3*(a^2+-3*b^2)+3//4*b*a^2*d^-1*cos(c+d*x)^4)
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3*cos(c+d*x), x) == :(b^3*d^-1*sec(c+d*x)+1//4*a^3*d^-1*cos(c+d*x)^4+b*a^2*d^-1*cos(c+d*x)^3+-1*b*d^-1*(-1*b^2+3*a^2)*cos(c+d*x)+-3*a*b^2*d^-1*log(cos(c+d*x))+-1//2*a*d^-1*cos(c+d*x)^2*(a^2+-3*b^2))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3, x) == :((1/2)*b^3*d^-1*sec(c+d*x)^2+1//3*a^3*d^-1*cos(c+d*x)^3+-1*a*d^-1*(a^2+-3*b^2)*cos(c+d*x)+-1*b*d^-1*(-1*b^2+3*a^2)*log(cos(c+d*x))+3*a*b^2*d^-1*sec(c+d*x)+3//2*b*a^2*d^-1*cos(c+d*x)^2)
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3*sec(c+d*x), x) == :((1/2)*a^3*d^-1*cos(c+d*x)^2+1//3*b^3*d^-1*sec(c+d*x)^3+b*d^-1*(-1*b^2+3*a^2)*sec(c+d*x)+-1*a*d^-1*(a^2+-3*b^2)*log(cos(c+d*x))+3*b*a^2*d^-1*cos(c+d*x)+3//2*a*b^2*d^-1*sec(c+d*x)^2)
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3*sec(c+d*x)^2, x) == :(a^3*d^-1*cos(c+d*x)+1//4*b^3*d^-1*sec(c+d*x)^4+a*b^2*d^-1*sec(c+d*x)^3+a*d^-1*(a^2+-3*b^2)*sec(c+d*x)+(1/2)*b*d^-1*sec(c+d*x)^2*(-1*b^2+3*a^2)+3*b*a^2*d^-1*log(cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3*sec(c+d*x)^3, x) == :(a^3*d^-1*log(cos(c+d*x))+1//5*b^3*d^-1*sec(c+d*x)^5+(1/2)*a*d^-1*sec(c+d*x)^2*(a^2+-3*b^2)+-3*b*a^2*d^-1*sec(c+d*x)+1//3*b*d^-1*sec(c+d*x)^3*(-1*b^2+3*a^2)+3//4*a*b^2*d^-1*sec(c+d*x)^4)
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-1*cos(c+d*x)^3, x) == :(d^-1*(-2b+2a)^-1*log(1+cos(c+d*x))+d^-1*(2a+2b)^-1*log(1+-1*cos(c+d*x))+(1/2)*a^-1*d^-1*cos(c+d*x)^2+-1*b*a^-2*d^-1*cos(c+d*x)+-1*a^-3*b^4*d^-1*(a^2+-1*b^2)^-1*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-1*cos(c+d*x)^2, x) == :(a^-1*d^-1*cos(c+d*x)+d^-1*(2a+2b)^-1*log(1+-1*cos(c+d*x))+-1*d^-1*(-2b+2a)^-1*log(1+cos(c+d*x))+a^-2*b^3*d^-1*(a^2+-1*b^2)^-1*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-1*cos(c+d*x), x) == :(d^-1*(-2b+2a)^-1*log(1+cos(c+d*x))+d^-1*(2a+2b)^-1*log(1+-1*cos(c+d*x))+-1*a^-1*b^2*d^-1*(a^2+-1*b^2)^-1*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-1, x) == :(d^-1*(2a+2b)^-1*log(1+-1*cos(c+d*x))+-1*d^-1*(-2b+2a)^-1*log(1+cos(c+d*x))+b*d^-1*(a^2+-1*b^2)^-1*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-1*sec(c+d*x), x) == :(d^-1*(-2b+2a)^-1*log(1+cos(c+d*x))+d^-1*(2a+2b)^-1*log(1+-1*cos(c+d*x))+-1*a*d^-1*(a^2+-1*b^2)^-1*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-1*sec(c+d*x)^2, x) == :(d^-1*(2a+2b)^-1*log(1+-1*cos(c+d*x))+-1*b^-1*d^-1*log(cos(c+d*x))+-1*d^-1*(-2b+2a)^-1*log(1+cos(c+d*x))+a^2*b^-1*d^-1*(a^2+-1*b^2)^-1*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-1*sec(c+d*x)^3, x) == :(b^-1*d^-1*sec(c+d*x)+d^-1*(-2b+2a)^-1*log(1+cos(c+d*x))+d^-1*(2a+2b)^-1*log(1+-1*cos(c+d*x))+a*b^-2*d^-1*log(cos(c+d*x))+-1*a^3*b^-2*d^-1*(a^2+-1*b^2)^-1*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-2*cos(c+d*x)^3, x) == :(-1*a^-2*d^-1*sin(c+d*x)+2*b*x*a^-3+-1//2*d^-1*(1+-1*cos(c+d*x))^-1*(a+b)^-2*sin(c+d*x)+-1//2*d^-1*(1+cos(c+d*x))^-1*(a+-1b)^-2*sin(c+d*x)+-1*a^-2*b^5*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-2*sin(c+d*x)+2*a^-3*b^6*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x))+2*a^-3*b^4*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*(-3*b^2+5*a^2)*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-2*cos(c+d*x)^2, x) == :(-1*x*a^-2+(1/2)*d^-1*(1+cos(c+d*x))^-1*(a+-1b)^-2*sin(c+d*x)+-1//2*d^-1*(1+-1*cos(c+d*x))^-1*(a+b)^-2*sin(c+d*x)+a^-1*b^4*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-2*sin(c+d*x)+-2*a^-2*b^5*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x))+-4*a^-2*b^3*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*(-1*b^2+2*a^2)*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-2*cos(c+d*x), x) == :(-1//2*d^-1*(1+-1*cos(c+d*x))^-1*(a+b)^-2*sin(c+d*x)+-1//2*d^-1*(1+cos(c+d*x))^-1*(a+-1b)^-2*sin(c+d*x)+-1*b^3*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-2*sin(c+d*x)+2*a^-1*b^4*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x))+2*a^-1*b^2*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*(-1*b^2+3*a^2)*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-2, x) == :((1/2)*d^-1*(1+cos(c+d*x))^-1*(a+-1b)^-2*sin(c+d*x)+-1//2*d^-1*(1+-1*cos(c+d*x))^-1*(a+b)^-2*sin(c+d*x)+-2*b^3*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x))+a*b^2*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-2*sin(c+d*x)+-4*b*a^2*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-2*sec(c+d*x), x) == :(-1*d^-1*(a^2+-1*b^2)^-2*(a^2+2*b^2+-3*a*b*cos(c+d*x))*csc(c+d*x)+-1*b*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-1*csc(c+d*x)+2*a*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*(a^2+2*b^2)*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-2*sec(c+d*x)^2, x) == :(d^-1*(a^2+-1*b^2)^-2*(-1*(b^2+2*a^2)*cos(c+d*x)+3*a*b)*csc(c+d*x)+a*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-1*csc(c+d*x)+-6*b*a^2*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-2*sec(c+d*x)^3, x) == :(b^-2*d^-1*arctanh(sin(c+d*x))+-1//2*d^-1*(1+-1*cos(c+d*x))^-1*(a+b)^-2*sin(c+d*x)+-1//2*d^-1*(1+cos(c+d*x))^-1*(a+-1b)^-2*sin(c+d*x)+2*a^3*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x))+-1*a^4*b^-1*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-2*sin(c+d*x)+-2*a^3*b^-2*d^-1*(a+b)^-5//2*(a+-1b)^-5//2*(a^2+-3*b^2)*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-3*cos(c+d*x)^3, x) == :(-1//2*d^-1*(a^2+-1*b^2)^-3*csc(c+d*x)^2*(a*(a^2+3*b^2)+-1*b*(b^2+3*a^2)*cos(c+d*x))+-1//4*d^-1*(a+b)^-4*(2a+5b)*log(1+-1*cos(c+d*x))+-1//4*d^-1*(a+-1b)^-4*(-5b+2a)*log(1+cos(c+d*x))+(1/2)*a^-3*b^6*d^-1*(b+a*cos(c+d*x))^-2*(a^2+-1*b^2)^-2+-1*a^-3*b^4*d^-1*(a^2+-1*b^2)^-4*(b^4+15*a^4+-4*a^2*b^2)*log(b+a*cos(c+d*x))+-2*a^-3*b^5*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-3*(-1*b^2+3*a^2))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-3*cos(c+d*x)^2, x) == :((1/2)*d^-1*(a^2+-1*b^2)^-3*csc(c+d*x)^2*(b*(b^2+3*a^2)+-1*a*(a^2+3*b^2)*cos(c+d*x))+-1//4*d^-1*(a+b)^-4*(a+4b)*log(1+-1*cos(c+d*x))+1//4*d^-1*(a+-1b)^-4*(a+-4b)*log(1+cos(c+d*x))+2*b^3*d^-1*(a^2+-1*b^2)^-4*(b^2+5*a^2)*log(b+a*cos(c+d*x))+-1//2*a^-2*b^5*d^-1*(b+a*cos(c+d*x))^-2*(a^2+-1*b^2)^-2+a^-2*b^4*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-3*(-1*b^2+5*a^2))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-3*cos(c+d*x), x) == :(-3//4*b*d^-1*(a+b)^-4*log(1+-1*cos(c+d*x))+-1//2*d^-1*(a^2+-1*b^2)^-3*csc(c+d*x)^2*(a*(a^2+3*b^2)+-1*b*(b^2+3*a^2)*cos(c+d*x))+3//4*b*d^-1*(a+-1b)^-4*log(1+cos(c+d*x))+(1/2)*a^-1*b^4*d^-1*(b+a*cos(c+d*x))^-2*(a^2+-1*b^2)^-2+-4*a*b^3*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-3+-6*a*b^2*d^-1*(a^2+-1*b^2)^-4*(a^2+b^2)*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-3, x) == :((1/2)*d^-1*(a^2+-1*b^2)^-3*csc(c+d*x)^2*(b*(b^2+3*a^2)+-1*a*(a^2+3*b^2)*cos(c+d*x))+-1//2*b^3*d^-1*(b+a*cos(c+d*x))^-2*(a^2+-1*b^2)^-2+-1//4*d^-1*(a+-1b)^-4*(a+2b)*log(1+cos(c+d*x))+1//4*d^-1*(a+b)^-4*(a+-2b)*log(1+-1*cos(c+d*x))+b*d^-1*(a^2+-1*b^2)^-4*(b^4+3*a^4+8*a^2*b^2)*log(b+a*cos(c+d*x))+b^2*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-3*(b^2+3*a^2))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-3*sec(c+d*x), x) == :(-1//2*d^-1*(a^2+-1*b^2)^-3*csc(c+d*x)^2*(a*(a^2+3*b^2)+-1*b*(b^2+3*a^2)*cos(c+d*x))+1//4*d^-1*(a+b)^-4*(-1b+2a)*log(1+-1*cos(c+d*x))+1//4*d^-1*(a+-1b)^-4*(b+2a)*log(1+cos(c+d*x))+(1/2)*a*b^2*d^-1*(b+a*cos(c+d*x))^-2*(a^2+-1*b^2)^-2+-1*a*d^-1*(a^2+-1*b^2)^-4*(a^4+3*b^4+8*a^2*b^2)*log(b+a*cos(c+d*x))+-2*a*b*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-3*(a^2+b^2))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-3*sec(c+d*x)^2, x) == :(-3//4*a*d^-1*(a+-1b)^-4*log(1+cos(c+d*x))+3//4*a*d^-1*(a+b)^-4*log(1+-1*cos(c+d*x))+d^-1*(b+a*cos(c+d*x))^-2*(-2*b^2+2*a^2)^-1*csc(c+d*x)^2*(b+-1*a*cos(c+d*x))+-3//2*b*a^2*d^-1*(b+a*cos(c+d*x))^-2*(a^2+-1*b^2)^-2+3//2*a^2*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-3*(a^2+3*b^2)+6*b*a^2*d^-1*(a^2+-1*b^2)^-4*(a^2+b^2)*log(b+a*cos(c+d*x)))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^-3*sec(c+d*x)^3, x) == :(1//4*d^-1*(a+b)^-4*(b+4a)*log(1+-1*cos(c+d*x))+1//4*d^-1*(a+-1b)^-4*(-1b+4a)*log(1+cos(c+d*x))+(1/2)*a*d^-1*(b+a*cos(c+d*x))^-2*(a^2+-1*b^2)^-2*(b^2+2*a^2)+-1*d^-1*(b+a*cos(c+d*x))^-2*(-2*b^2+2*a^2)^-1*csc(c+d*x)^2*(a+-1*b*cos(c+d*x))+-2*a^3*d^-1*(a^2+-1*b^2)^-4*(a^2+5*b^2)*log(b+a*cos(c+d*x))+-1//2*a*b*d^-1*(b+a*cos(c+d*x))^-1*(a^2+-1*b^2)^-3*(b^2+11*a^2))
@test integrate((a*sin(c+d*x)+b*tan(c+d*x))^3*cos(c+d*x)^m, x) == :(a^3*d^-1*(3+m)^-1*cos(c+d*x)^(3+m)+b^3*d^-1*(2+-1m)^-1*cos(c+d*x)^(-2+m)+-1*a*d^-1*(1+m)^-1*cos(c+d*x)^(1+m)*(a^2+-3*b^2)+-1*b*d^-1*m^-1*cos(c+d*x)^m*(-1*b^2+3*a^2)+3*a*b^2*d^-1*(1+-1m)^-1*cos(c+d*x)^(-1+m)+3*b*a^2*d^-1*(2+m)^-1*cos(c+d*x)^(2+m))
@test integrate(cos(c+d*x)^m*(a*sin(c+d*x)+b*tan(c+d*x)), x) == :(-1*a*d^-1*(1+m)^-1*cos(c+d*x)^(1+m)+-1*b*d^-1*m^-1*cos(c+d*x)^m)
@test integrate((a*cos(x)+b*sin(x))^-1*cos(x)*sin(x), x) == :(b*(a^2+b^2)^-1*sin(x)+-1*a*(a^2+b^2)^-1*cos(x)+a*b*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-1*sin(x)^2*cos(x), x) == :(a*x*(2*a^2+2*b^2)^-1+b*(2*a^2+2*b^2)^-1*sin(x)^2+b*a^2*(a^2+b^2)^-2*log(a*cos(x)+b*sin(x))+-1*a*x*b^2*(a^2+b^2)^-2+-1*a*(2*a^2+2*b^2)^-1*cos(x)*sin(x))
@test integrate((a*cos(x)+b*sin(x))^-1*sin(x)^3*cos(x), x) == :(a*(3*a^2+3*b^2)^-1*cos(x)^3+b*(3*a^2+3*b^2)^-1*sin(x)^3+-1*a*(a^2+b^2)^-1*cos(x)+a*b^2*(a^2+b^2)^-2*cos(x)+b*a^2*(a^2+b^2)^-2*sin(x)+b*a^3*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-1*cos(x)^2*sin(x), x) == :(a*(2*a^2+2*b^2)^-1*sin(x)^2+b*x*(2*a^2+2*b^2)^-1+b*(2*a^2+2*b^2)^-1*cos(x)*sin(x)+-1*a*b^2*(a^2+b^2)^-2*log(a*cos(x)+b*sin(x))+-1*b*x*a^2*(a^2+b^2)^-2)
@test integrate((a*cos(x)+b*sin(x))^-1*cos(x)^2*sin(x)^2, x) == :(a*(3*a^2+3*b^2)^-1*sin(x)^3+-1*b*(3*a^2+3*b^2)^-1*cos(x)^3+b*a^2*(a^2+b^2)^-2*cos(x)+-1*a*b^2*(a^2+b^2)^-2*sin(x)+-1*a^2*b^2*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
@test integrate((a*cos(x)+b*sin(x))^-1*cos(x)^2*sin(x)^3, x) == :(a*(4*a^2+4*b^2)^-1*sin(x)^4+b*x*(8*a^2+8*b^2)^-1+b*(8*a^2+8*b^2)^-1*cos(x)*sin(x)+x*a^2*b^3*(a^2+b^2)^-3+-1*b*(4*a^2+4*b^2)^-1*cos(x)^3*sin(x)+-1*a^3*b^2*(a^2+b^2)^-3*log(a*cos(x)+b*sin(x))+-1//2*a*b^2*(a^2+b^2)^-2*sin(x)^2+-1//2*b*x*a^2*(a^2+b^2)^-2+(1/2)*b*a^2*(a^2+b^2)^-2*cos(x)*sin(x))
@test integrate((a*cos(x)+b*sin(x))^-1*cos(x)^3*sin(x), x) == :(b*(a^2+b^2)^-1*sin(x)+-1*a*(3*a^2+3*b^2)^-1*cos(x)^3+-1*b*(3*a^2+3*b^2)^-1*sin(x)^3+a*b^3*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x)))+-1*a*b^2*(a^2+b^2)^-2*cos(x)+-1*b*a^2*(a^2+b^2)^-2*sin(x))
@test integrate((a*cos(x)+b*sin(x))^-1*cos(x)^3*sin(x)^2, x) == :(a*x*(8*a^2+8*b^2)^-1+-1*b*(4*a^2+4*b^2)^-1*cos(x)^4+a*(8*a^2+8*b^2)^-1*cos(x)*sin(x)+x*a^3*b^2*(a^2+b^2)^-3+a^2*b^3*(a^2+b^2)^-3*log(a*cos(x)+b*sin(x))+-1*a*(4*a^2+4*b^2)^-1*cos(x)^3*sin(x)+-1//2*a*x*b^2*(a^2+b^2)^-2+-1//2*b*a^2*(a^2+b^2)^-2*sin(x)^2+-1//2*a*b^2*(a^2+b^2)^-2*cos(x)*sin(x))
@test integrate((a*cos(x)+b*sin(x))^-1*cos(x)^3*sin(x)^3, x) == :(a*(5*a^2+5*b^2)^-1*cos(x)^5+b*(3*a^2+3*b^2)^-1*sin(x)^3+-1*a*(3*a^2+3*b^2)^-1*cos(x)^3+-1*b*(5*a^2+5*b^2)^-1*sin(x)^5+a^2*b^3*(a^2+b^2)^-3*sin(x)+a^3*b^3*(a^2+b^2)^-7//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x)))+-1*a^3*b^2*(a^2+b^2)^-3*cos(x)+-1//3*b*a^2*(a^2+b^2)^-2*sin(x)^3+1//3*a*b^2*(a^2+b^2)^-2*cos(x)^3)
@test integrate((a*sin(x)+b*cos(x))^-1*tan(x), x) == :(a^-1*arctanh(sin(x))+b*a^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(a*cos(x)+-1*b*sin(x))))
@test integrate((a*sin(x)+b*cos(x))^-1*cot(x), x) == :(-1*b^-1*arctanh(cos(x))+a*b^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(a*cos(x)+-1*b*sin(x))))

using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(x^2*sin(a+b*x+c*x^2), x) == :(-1//2*x*c^-1*cos(a+b*x+c*x^2)+1//4*b*c^-2*cos(a+b*x+c*x^2)+-1//4*2^(1/2)*pi^(1/2)*c^-3//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1)+1//4*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
@test integrate(x*sin(a+b*x+c*x^2), x) == :(-1//2*c^-1*cos(a+b*x+c*x^2)+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
@test integrate(sin(a+b*x+c*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*c^-1//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+(1/2)*2^(1/2)*pi^(1/2)*c^-1//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
@test integrate(x^-2*sin(a+b*x+c*x^2)+-1*b*x^-1*cos(a+b*x+c*x^2), x) == :(-1*x^-1*sin(a+b*x+c*x^2)+2^(1/2)*pi^(1/2)*c^(1/2)*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+-1*2^(1/2)*pi^(1/2)*c^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
@test integrate(x^2*sin(a+b*x+-1*c*x^2), x) == :((1/2)*x*c^-1*cos(a+b*x+-1*c*x^2)+1//4*b*c^-2*cos(a+b*x+-1*c*x^2)+1//4*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+1//4*2^(1/2)*pi^(1/2)*c^-3//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1)+-1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1)+1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x)))
@test integrate(x*sin(a+b*x+-1*c*x^2), x) == :((1/2)*c^-1*cos(a+b*x+-1*c*x^2)+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1)+1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x)))
@test integrate(sin(a+b*x+-1*c*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*c^-1//2*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+-1//2*2^(1/2)*pi^(1/2)*c^-1//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
@test integrate(x^-2*sin(a+b*x+-1*c*x^2)+-1*b*x^-1*cos(a+b*x+-1*c*x^2), x) == :(-1*x^-1*sin(a+b*x+-1*c*x^2)+2^(1/2)*pi^(1/2)*c^(1/2)*cos(a+1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+2^(1/2)*pi^(1/2)*c^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
@test integrate(x^2*sin(1//4+x+x^2), x) == :(1//4*cos(1//4+x+x^2)+-1//2*x*cos(1//4+x+x^2)+1//4*2^(1/2)*pi^(1/2)*fresnelc((1/2)*2^(1/2)*pi^-1//2*(1+2x))+1//8*2^(1/2)*pi^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*(1+2x)))
@test integrate(x*sin(1//4+x+x^2), x) == :(-1//2*cos(1//4+x+x^2)+-1//4*2^(1/2)*pi^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*(1+2x)))
@test integrate(sin(1//4+x+x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*(1+2x)))
@test integrate(x^2*sin(a+b*x+c*x^2)^2, x) == :(1//6*x^3+-1//8*x*c^-1*sin(2a+2*b*x+2*c*x^2)+1//16*b*c^-2*sin(2a+2*b*x+2*c*x^2)+1//16*pi^(1/2)*c^-3//2*cos(2a+-1//2*b^2*c^-1)*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))+1//16*pi^(1/2)*c^-3//2*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1)+-1//16*pi^(1/2)*b^2*c^-5//2*cos(2a+-1//2*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x))+1//16*pi^(1/2)*b^2*c^-5//2*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1))
@test integrate(x*sin(a+b*x+c*x^2)^2, x) == :(1//4*x^2+-1//8*c^-1*sin(2a+2*b*x+2*c*x^2)+-1//8*b*pi^(1/2)*c^-3//2*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1)+1//8*b*pi^(1/2)*c^-3//2*cos(2a+-1//2*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x)))
@test integrate(sin(a+b*x+c*x^2)^2, x) == :((1/2)*x+-1//4*pi^(1/2)*c^-1//2*cos(2a+-1//2*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x))+1//4*pi^(1/2)*c^-1//2*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1))
@test integrate(x^2*sin(a+b*x+-1*c*x^2)^2, x) == :(1//6*x^3+1//8*x*c^-1*sin(2a+-2*c*x^2+2*b*x)+1//16*b*c^-2*sin(2a+-2*c*x^2+2*b*x)+-1//16*pi^(1/2)*c^-3//2*cos(2a+(1/2)*b^2*c^-1)*fresnels(pi^-1//2*c^-1//2*(b+-2*c*x))+1//16*pi^(1/2)*c^-3//2*fresnelc(pi^-1//2*c^-1//2*(b+-2*c*x))*sin(2a+(1/2)*b^2*c^-1)+1//16*pi^(1/2)*b^2*c^-5//2*cos(2a+(1/2)*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+-2*c*x))+1//16*pi^(1/2)*b^2*c^-5//2*fresnels(pi^-1//2*c^-1//2*(b+-2*c*x))*sin(2a+(1/2)*b^2*c^-1))
@test integrate(x*sin(a+b*x+-1*c*x^2)^2, x) == :(1//4*x^2+1//8*c^-1*sin(2a+-2*c*x^2+2*b*x)+1//8*b*pi^(1/2)*c^-3//2*cos(2a+(1/2)*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+-2*c*x))+1//8*b*pi^(1/2)*c^-3//2*fresnels(pi^-1//2*c^-1//2*(b+-2*c*x))*sin(2a+(1/2)*b^2*c^-1))
@test integrate(sin(a+b*x+-1*c*x^2)^2, x) == :((1/2)*x+1//4*pi^(1/2)*c^-1//2*cos(2a+(1/2)*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+-2*c*x))+1//4*pi^(1/2)*c^-1//2*fresnels(pi^-1//2*c^-1//2*(b+-2*c*x))*sin(2a+(1/2)*b^2*c^-1))
@test integrate(x^2*sin(1//4+x+x^2)^2, x) == :(1//6*x^3+1//16*sin(1/2+2x+2*x^2)+-1//8*x*sin(1/2+2x+2*x^2)+-1//16*pi^(1/2)*fresnelc(pi^-1//2*(1+2x))+1//16*pi^(1/2)*fresnels(pi^-1//2*(1+2x)))
@test integrate(x*sin(1//4+x+x^2)^2, x) == :(-1//8*sin(1/2+2x+2*x^2)+1//4*x^2+1//8*pi^(1/2)*fresnelc(pi^-1//2*(1+2x)))
@test integrate(sin(1//4+x+x^2)^2, x) == :((1/2)*x+-1//4*pi^(1/2)*fresnelc(pi^-1//2*(1+2x)))
@test integrate((d+e*x)^2*sin(a+b*x+c*x^2), x) == :(-1//2*e*c^-1*(d+e*x)*cos(a+b*x+c*x^2)+-1//4*e*c^-2*(-1*b*e+2*c*d)*cos(a+b*x+c*x^2)+-1//4*2^(1/2)*pi^(1/2)*c^-3//2*e^2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1)+1//4*2^(1/2)*pi^(1/2)*c^-3//2*e^2*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//8*2^(1/2)*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//8*2^(1/2)*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
@test integrate((d+e*x)*sin(a+b*x+c*x^2), x) == :(-1//2*e*c^-1*cos(a+b*x+c*x^2)+1//4*2^(1/2)*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//4*2^(1/2)*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
@test integrate(sin(a+b*x+c*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*c^-1//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+(1/2)*2^(1/2)*pi^(1/2)*c^-1//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
@test integrate((d+e*x)^2*sin(a+b*x+c*x^2)^2, x) == :(1//6*e^-1*(d+e*x)^3+-1//8*e*c^-1*(d+e*x)*sin(2a+2*b*x+2*c*x^2)+-1//16*e*c^-2*(-1*b*e+2*c*d)*sin(2a+2*b*x+2*c*x^2)+-1//16*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*cos(2a+-1//2*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x))+1//16*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1)+1//16*pi^(1/2)*c^-3//2*e^2*cos(2a+-1//2*b^2*c^-1)*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))+1//16*pi^(1/2)*c^-3//2*e^2*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1))
@test integrate(sin(a+b*x+c*x^2)^2*(d+e*x), x) == :(1//4*e^-1*(d+e*x)^2+-1//8*e*c^-1*sin(2a+2*b*x+2*c*x^2)+-1//8*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*cos(2a+-1//2*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x))+1//8*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1))
@test integrate(sin(a+b*x+c*x^2)^2, x) == :((1/2)*x+-1//4*pi^(1/2)*c^-1//2*cos(2a+-1//2*b^2*c^-1)*fresnelc(pi^-1//2*c^-1//2*(b+2*c*x))+1//4*pi^(1/2)*c^-1//2*fresnels(pi^-1//2*c^-1//2*(b+2*c*x))*sin(2a+-1//2*b^2*c^-1))

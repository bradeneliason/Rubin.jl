using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((a+a*sin(c+d*x))^7//2, x) == :(-256//35*a^4*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)+-64//35*a^3*d^-1*(a+a*sin(c+d*x))^(1/2)*cos(c+d*x)+-24//35*a^2*d^-1*(a+a*sin(c+d*x))^3//2*cos(c+d*x)+-2//7*a*d^-1*(a+a*sin(c+d*x))^5//2*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^5//2, x) == :(-64//15*a^3*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)+-16//15*a^2*d^-1*(a+a*sin(c+d*x))^(1/2)*cos(c+d*x)+-2//5*a*d^-1*(a+a*sin(c+d*x))^3//2*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^3//2, x) == :(-8//3*a^2*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)+-2//3*a*d^-1*(a+a*sin(c+d*x))^(1/2)*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^(1/2), x) == :(-2*a*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1//2, x) == :(-1*2^(1/2)*a^-1//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-3//2, x) == :(-1//2*d^-1*(a+a*sin(c+d*x))^-3//2*cos(c+d*x)+-1//4*2^(1/2)*a^-3//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-5//2, x) == :(-1//4*d^-1*(a+a*sin(c+d*x))^-5//2*cos(c+d*x)+-3//16*a^-1*d^-1*(a+a*sin(c+d*x))^-3//2*cos(c+d*x)+-3//32*2^(1/2)*a^-5//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)))
@test integrate((5+3*sin(c+d*x))^-1, x) == :(1//4*x+(1/2)*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x)))
@test integrate((5+3*sin(c+d*x))^-2, x) == :(5//64*x+5//32*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+3//16*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((5+3*sin(c+d*x))^-3, x) == :(59//2048*x+59//1024*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+3//32*d^-1*(5+3*sin(c+d*x))^-2*cos(c+d*x)+45//512*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((5+3*sin(c+d*x))^-4, x) == :(385//32768*x+385//16384*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+1//16*d^-1*(5+3*sin(c+d*x))^-3*cos(c+d*x)+25//512*d^-1*(5+3*sin(c+d*x))^-2*cos(c+d*x)+311//8192*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((5+-3*sin(c+d*x))^-1, x) == :(1//4*x+-1//2*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x)))
@test integrate((5+-3*sin(c+d*x))^-2, x) == :(5//64*x+-5//32*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x))+-3//16*d^-1*(5+-3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((5+-3*sin(c+d*x))^-3, x) == :(59//2048*x+-59//1024*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x))+-45//512*d^-1*(5+-3*sin(c+d*x))^-1*cos(c+d*x)+-3//32*d^-1*(5+-3*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((5+-3*sin(c+d*x))^-4, x) == :(385//32768*x+-385//16384*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x))+-311//8192*d^-1*(5+-3*sin(c+d*x))^-1*cos(c+d*x)+-25//512*d^-1*(5+-3*sin(c+d*x))^-2*cos(c+d*x)+-1//16*d^-1*(5+-3*sin(c+d*x))^-3*cos(c+d*x))
@test integrate((-5+3*sin(c+d*x))^-1, x) == :(-1//4*x+(1/2)*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x)))
@test integrate((-5+3*sin(c+d*x))^-2, x) == :(5//64*x+-5//32*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x))+-3//16*d^-1*(5+-3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-5+3*sin(c+d*x))^-3, x) == :(-59//2048*x+59//1024*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x))+3//32*d^-1*(5+-3*sin(c+d*x))^-2*cos(c+d*x)+45//512*d^-1*(5+-3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-5+3*sin(c+d*x))^-4, x) == :(385//32768*x+-385//16384*d^-1*arctan((3+-1*sin(c+d*x))^-1*cos(c+d*x))+-311//8192*d^-1*(5+-3*sin(c+d*x))^-1*cos(c+d*x)+-25//512*d^-1*(5+-3*sin(c+d*x))^-2*cos(c+d*x)+-1//16*d^-1*(5+-3*sin(c+d*x))^-3*cos(c+d*x))
@test integrate((-5+-3*sin(c+d*x))^-1, x) == :(-1//4*x+-1//2*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x)))
@test integrate((-5+-3*sin(c+d*x))^-2, x) == :(5//64*x+5//32*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+3//16*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-5+-3*sin(c+d*x))^-3, x) == :(-59//2048*x+-59//1024*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+-45//512*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x)+-3//32*d^-1*(5+3*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((-5+-3*sin(c+d*x))^-4, x) == :(385//32768*x+385//16384*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+1//16*d^-1*(5+3*sin(c+d*x))^-3*cos(c+d*x)+25//512*d^-1*(5+3*sin(c+d*x))^-2*cos(c+d*x)+311//8192*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((3+5*sin(c+d*x))^-1, x) == :(-1//4*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x))+1//4*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x)))
@test integrate((3+5*sin(c+d*x))^-2, x) == :(-3//64*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+3//64*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x))+-5//16*d^-1*(3+5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((3+5*sin(c+d*x))^-3, x) == :(-43//2048*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x))+43//2048*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+-5//32*d^-1*(3+5*sin(c+d*x))^-2*cos(c+d*x)+45//512*d^-1*(3+5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((3+5*sin(c+d*x))^-4, x) == :(-279//32768*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+279//32768*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x))+-995//24576*d^-1*(3+5*sin(c+d*x))^-1*cos(c+d*x)+-5//48*d^-1*(3+5*sin(c+d*x))^-3*cos(c+d*x)+25//512*d^-1*(3+5*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((3+-5*sin(c+d*x))^-1, x) == :(-1//4*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+1//4*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x)))
@test integrate((3+-5*sin(c+d*x))^-2, x) == :(-3//64*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x))+3//64*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+5//16*d^-1*(3+-5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((3+-5*sin(c+d*x))^-3, x) == :(-43//2048*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+43//2048*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x))+-45//512*d^-1*(3+-5*sin(c+d*x))^-1*cos(c+d*x)+5//32*d^-1*(3+-5*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((3+-5*sin(c+d*x))^-4, x) == :(-279//32768*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x))+279//32768*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+-25//512*d^-1*(3+-5*sin(c+d*x))^-2*cos(c+d*x)+5//48*d^-1*(3+-5*sin(c+d*x))^-3*cos(c+d*x)+995//24576*d^-1*(3+-5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-3+5*sin(c+d*x))^-1, x) == :(-1//4*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x))+1//4*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x)))
@test integrate((-3+5*sin(c+d*x))^-2, x) == :(-3//64*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x))+3//64*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+5//16*d^-1*(3+-5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-3+5*sin(c+d*x))^-3, x) == :(-43//2048*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x))+43//2048*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+-5//32*d^-1*(3+-5*sin(c+d*x))^-2*cos(c+d*x)+45//512*d^-1*(3+-5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-3+5*sin(c+d*x))^-4, x) == :(-279//32768*d^-1*log(-1*sin((1/2)*c+(1/2)*d*x)+3*cos((1/2)*c+(1/2)*d*x))+279//32768*d^-1*log(-3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+-25//512*d^-1*(3+-5*sin(c+d*x))^-2*cos(c+d*x)+5//48*d^-1*(3+-5*sin(c+d*x))^-3*cos(c+d*x)+995//24576*d^-1*(3+-5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-3+-5*sin(c+d*x))^-1, x) == :(-1//4*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+1//4*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x)))
@test integrate((-3+-5*sin(c+d*x))^-2, x) == :(-3//64*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+3//64*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x))+-5//16*d^-1*(3+5*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((-3+-5*sin(c+d*x))^-3, x) == :(-43//2048*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+43//2048*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x))+-45//512*d^-1*(3+5*sin(c+d*x))^-1*cos(c+d*x)+5//32*d^-1*(3+5*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((-3+-5*sin(c+d*x))^-4, x) == :(-279//32768*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+279//32768*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x))+-995//24576*d^-1*(3+5*sin(c+d*x))^-1*cos(c+d*x)+-5//48*d^-1*(3+5*sin(c+d*x))^-3*cos(c+d*x)+25//512*d^-1*(3+5*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^7//2, x) == :(-2//7*b*d^-1*(a+b*sin(c+d*x))^5//2*cos(c+d*x)+-24//35*a*b*d^-1*(a+b*sin(c+d*x))^3//2*cos(c+d*x)+-2//105*b*d^-1*(a+b*sin(c+d*x))^(1/2)*(25*b^2+71*a^2)*cos(c+d*x)+-1//105*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^(1/2)*(a+b*sin(c+d*x))^-1//2*(-50*b^4+142*a^4+-92*a^2*b^2)*Elliptic.F((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1)+32//105*a*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^-1//2*(a+b*sin(c+d*x))^(1/2)*(11*a^2+13*b^2)*Elliptic.E((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1))
@test integrate((a+b*sin(c+d*x))^5//2, x) == :(-2//5*b*d^-1*(a+b*sin(c+d*x))^3//2*cos(c+d*x)+-16//15*a*b*d^-1*(a+b*sin(c+d*x))^(1/2)*cos(c+d*x)+1//15*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^-1//2*(a+b*sin(c+d*x))^(1/2)*(18*b^2+46*a^2)*Elliptic.E((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1)+-16//15*a*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^(1/2)*(a+b*sin(c+d*x))^-1//2*(a^2+-1*b^2)*Elliptic.F((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1))
@test integrate((a+b*sin(c+d*x))^3//2, x) == :(-2//3*b*d^-1*(a+b*sin(c+d*x))^(1/2)*cos(c+d*x)+-1//3*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^(1/2)*(a+b*sin(c+d*x))^-1//2*(-2*b^2+2*a^2)*Elliptic.F((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1)+8//3*a*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^-1//2*(a+b*sin(c+d*x))^(1/2)*Elliptic.E((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1))
@test integrate((a+b*sin(c+d*x))^(1/2), x) == :(2*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^-1//2*(a+b*sin(c+d*x))^(1/2)*Elliptic.E((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1))
@test integrate((a+b*sin(c+d*x))^-1//2, x) == :(2*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^(1/2)*(a+b*sin(c+d*x))^-1//2*Elliptic.F((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1))
@test integrate((a+b*sin(c+d*x))^-3//2, x) == :(2*b*d^-1*(a+b*sin(c+d*x))^-1//2*(a^2+-1*b^2)^-1*cos(c+d*x)+2*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^-1//2*(a+b*sin(c+d*x))^(1/2)*(a^2+-1*b^2)^-1*Elliptic.E((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1))
@test integrate((a+b*sin(c+d*x))^-5//2, x) == :(-2*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^(1/2)*(a+b*sin(c+d*x))^-1//2*(-3*b^2+3*a^2)^-1*Elliptic.F((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1)+2*b*d^-1*(a+b*sin(c+d*x))^-3//2*(-3*b^2+3*a^2)^-1*cos(c+d*x)+8//3*a*b*d^-1*(a+b*sin(c+d*x))^-1//2*(a^2+-1*b^2)^-2*cos(c+d*x)+8//3*a*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^-1//2*(a+b*sin(c+d*x))^(1/2)*(a^2+-1*b^2)^-2*Elliptic.E((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1))
@test integrate((a+b*sin(c+d*x))^-7//2, x) == :(2*b*d^-1*(a+b*sin(c+d*x))^-5//2*(-5*b^2+5*a^2)^-1*cos(c+d*x)+-16//15*a*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^(1/2)*(a+b*sin(c+d*x))^-1//2*(a^2+-1*b^2)^-2*Elliptic.F((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1)+1//15*d^-1*((a+b)^-1*(a+b*sin(c+d*x)))^-1//2*(a+b*sin(c+d*x))^(1/2)*(a^2+-1*b^2)^-3*(18*b^2+46*a^2)*Elliptic.E((1/2)*c+-1//4*pi+(1/2)*d*x,2*b*(a+b)^-1)+2//15*b*d^-1*(a+b*sin(c+d*x))^-1//2*(a^2+-1*b^2)^-3*(9*b^2+23*a^2)*cos(c+d*x)+16//15*a*b*d^-1*(a+b*sin(c+d*x))^-3//2*(a^2+-1*b^2)^-2*cos(c+d*x))

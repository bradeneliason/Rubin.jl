using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((a+a*sin(e+f*x))^2*sin(e+f*x)^3*(c+-1*c*sin(e+f*x)), x) == :(1//16*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+1//5*c*a^2*f^-1*cos(e+f*x)^5+-1//16*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x)+-1//24*c*a^2*f^-1*sin(e+f*x)^3*cos(e+f*x)+1//6*c*a^2*f^-1*sin(e+f*x)^5*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*sin(e+f*x)^2*(c+-1*c*sin(e+f*x)), x) == :(1//8*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+1//5*c*a^2*f^-1*cos(e+f*x)^5+-1//8*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x)+1//4*c*a^2*f^-1*sin(e+f*x)^3*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*(c+-1*c*sin(e+f*x))*sin(e+f*x), x) == :(1//8*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+-1//8*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x)+1//4*c*a^2*f^-1*sin(e+f*x)^3*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*(c+-1*c*sin(e+f*x)), x) == :((1/2)*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+(1/2)*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*(c+-1*c*sin(e+f*x))*csc(e+f*x), x) == :((1/2)*c*x*a^2+c*a^2*f^-1*cos(e+f*x)+-1*c*a^2*f^-1*arctanh(cos(e+f*x))+(1/2)*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^2*(c+-1*c*sin(e+f*x)), x) == :(-1*c*x*a^2+c*a^2*f^-1*cos(e+f*x)+-1*c*a^2*f^-1*arctanh(cos(e+f*x))+-1*c*a^2*f^-1*cot(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^3*(c+-1*c*sin(e+f*x)), x) == :(-1*c*x*a^2+(1/2)*c*a^2*f^-1*arctanh(cos(e+f*x))+-1*c*a^2*f^-1*cot(e+f*x)+-1//2*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^4*(c+-1*c*sin(e+f*x)), x) == :((1/2)*c*a^2*f^-1*arctanh(cos(e+f*x))+-1//3*c*a^2*f^-1*cot(e+f*x)^3+-1//2*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^5*(c+-1*c*sin(e+f*x)), x) == :(-1//3*c*a^2*f^-1*cot(e+f*x)^3+1//8*c*a^2*f^-1*arctanh(cos(e+f*x))+-1//4*c*a^2*f^-1*csc(e+f*x)^3*cot(e+f*x)+1//8*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^6*(c+-1*c*sin(e+f*x)), x) == :(-1//3*c*a^2*f^-1*cot(e+f*x)^3+-1//5*c*a^2*f^-1*cot(e+f*x)^5+1//8*c*a^2*f^-1*arctanh(cos(e+f*x))+-1//4*c*a^2*f^-1*csc(e+f*x)^3*cot(e+f*x)+1//8*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^7*(c+-1*c*sin(e+f*x)), x) == :(-1//3*c*a^2*f^-1*cot(e+f*x)^3+-1//5*c*a^2*f^-1*cot(e+f*x)^5+1//16*c*a^2*f^-1*arctanh(cos(e+f*x))+-1//6*c*a^2*f^-1*csc(e+f*x)^5*cot(e+f*x)+1//16*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x)+1//24*c*a^2*f^-1*csc(e+f*x)^3*cot(e+f*x))
@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-1*sin(e+f*x)^-1, x) == :(-2*a^(1/2)*c^-1*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+2*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x))
@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1*sin(e+f*x)^-1, x) == :(-2*a^-1//2*c^-1*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+a^-1*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x)+(1/2)*2^(1/2)*a^-1//2*c^-1*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-1, x) == :(2*a^(1/2)*c^-1*f^-1*g^(1/2)*arctan(a^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+2*c^-1*f^-1*(g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x))
@test integrate((g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-1, x) == :(2*c^-1*f^-1*g^-1*(g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x))
@test integrate((g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1, x) == :(a^-1*c^-1*f^-1*(g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x)+(1/2)*2^(1/2)*a^-1//2*c^-1*f^-1*g^(1/2)*arctan((1/2)*2^(1/2)*a^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1, x) == :(-1//2*2^(1/2)*a^-1//2*c^-1*f^-1*g^-1//2*arctan((1/2)*2^(1/2)*a^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+a^-1*c^-1*f^-1*g^-1*(g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x))
@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^(1/2)*sin(e+f*x)^-1, x) == :(f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^(1/2)*log(sin(e+f*x))*sec(e+f*x))
@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-1//2*sin(e+f*x)^-1, x) == :(c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^(1/2)*log(sin(e+f*x))*sec(e+f*x)+-1*a*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(1+-1*sin(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^(1/2)*sin(e+f*x)^-1, x) == :(a^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^(1/2)*log(sin(e+f*x))*sec(e+f*x)+-1*c*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(1+sin(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*sin(e+f*x)^-1, x) == :(f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(tan(e+f*x)))
@test integrate((a+a*sin(e+f*x))^(1/2)*(c+d*sin(e+f*x))^-1*sin(e+f*x)^-1, x) == :(-2*a^(1/2)*c^-1*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+2*a^(1/2)*c^-1*d^(1/2)*f^-1*(c+d)^-1//2*arctanh(a^(1/2)*d^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d)^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1*sin(e+f*x)^-1, x) == :(-2*a^-1//2*c^-1*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+2^(1/2)*a^-1//2*f^-1*(c+-1d)^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-2*a^-1//2*c^-1*d^3//2*f^-1*(c+d)^-1//2*(c+-1d)^-1*arctanh(a^(1/2)*d^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d)^-1//2*cos(e+f*x)))
@test integrate((g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^(1/2)*(c+d*sin(e+f*x))^-1, x) == :(-2*a^(1/2)*d^-1*f^-1*g^(1/2)*arctan(a^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+2*a^(1/2)*c^(1/2)*d^-1*f^-1*g^(1/2)*(c+d)^-1//2*arctan(a^(1/2)*c^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*(c+d)^-1//2*cos(e+f*x)))
@test integrate((g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^(1/2)*(c+d*sin(e+f*x))^-1, x) == :(-2*a^(1/2)*c^-1//2*f^-1*g^-1//2*(c+d)^-1//2*arctan(a^(1/2)*c^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*(c+d)^-1//2*cos(e+f*x)))
@test integrate((g*sin(e+f*x))^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1, x) == :(2^(1/2)*a^-1//2*f^-1*g^(1/2)*(c+-1d)^-1*arctan((1/2)*2^(1/2)*a^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-2*a^-1//2*c^(1/2)*f^-1*g^(1/2)*(c+d)^-1//2*(c+-1d)^-1*arctan(a^(1/2)*c^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*(c+d)^-1//2*cos(e+f*x)))
@test integrate((g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1, x) == :(-1*2^(1/2)*a^-1//2*f^-1*g^-1//2*(c+-1d)^-1*arctan((1/2)*2^(1/2)*a^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+2*d*a^-1//2*c^-1//2*f^-1*g^-1//2*(c+d)^-1//2*(c+-1d)^-1*arctan(a^(1/2)*c^(1/2)*g^(1/2)*(g*sin(e+f*x))^-1//2*(a+a*sin(e+f*x))^-1//2*(c+d)^-1//2*cos(e+f*x)))
@test integrate((g*sin(e+f*x))^-1//2*(a+b*sin(e+f*x))^(1/2)*(c+c*sin(e+f*x))^-1, x) == :(-1*c^-1*f^-1*(g*sin(e+f*x))^-1//2*((1+sin(e+f*x))^-1*sin(e+f*x))^(1/2)*((1+sin(e+f*x))^-1*(a+b)^-1*(a+b*sin(e+f*x)))^-1//2*(a+b*sin(e+f*x))^(1/2)*Elliptic.E(arcsin((1+sin(e+f*x))^-1*cos(e+f*x)),-1*(a+b)^-1*(a+-1b)))
@test integrate((g*sin(e+f*x))^(1/2)*(a+b*sin(e+f*x))^-1//2*(c+c*sin(e+f*x))^-1, x) == :(g*c^-1*f^-1*(g*sin(e+f*x))^-1//2*((1+sin(e+f*x))^-1*sin(e+f*x))^(1/2)*((1+sin(e+f*x))^-1*(a+b)^-1*(a+b*sin(e+f*x)))^-1//2*(a+-1b)^-1*(a+b*sin(e+f*x))^(1/2)*Elliptic.E(arcsin((1+sin(e+f*x))^-1*cos(e+f*x)),-1*(a+b)^-1*(a+-1b))+-2*c^-1*f^-1*g^(1/2)*(a*(a+b)^-1*(1+-1*csc(e+f*x)))^(1/2)*(a*(a+-1b)^-1*(1+csc(e+f*x)))^(1/2)*(a+b)^(1/2)*(a+-1b)^-1*Elliptic.F(arcsin(g^(1/2)*(g*sin(e+f*x))^-1//2*(a+b)^-1//2*(a+b*sin(e+f*x))^(1/2)),-1*(a+-1b)^-1*(a+b))*tan(e+f*x))
@test integrate((g*sin(e+f*x))^-1//2*(a+b*sin(e+f*x))^-1//2*(c+c*sin(e+f*x))^-1, x) == :(-1*c^-1*f^-1*(g*sin(e+f*x))^-1//2*((1+sin(e+f*x))^-1*sin(e+f*x))^(1/2)*((1+sin(e+f*x))^-1*(a+b)^-1*(a+b*sin(e+f*x)))^-1//2*(a+-1b)^-1*(a+b*sin(e+f*x))^(1/2)*Elliptic.E(arcsin((1+sin(e+f*x))^-1*cos(e+f*x)),-1*(a+b)^-1*(a+-1b))+2*b*a^-1*c^-1*f^-1*g^-1//2*(a*(a+b)^-1*(1+-1*csc(e+f*x)))^(1/2)*(a*(a+-1b)^-1*(1+csc(e+f*x)))^(1/2)*(a+b)^(1/2)*(a+-1b)^-1*Elliptic.F(arcsin(g^(1/2)*(g*sin(e+f*x))^-1//2*(a+b)^-1//2*(a+b*sin(e+f*x))^(1/2)),-1*(a+-1b)^-1*(a+b))*tan(e+f*x))
@test integrate((a+a*sin(e+f*x))^(1/2)*(c+d*sin(e+f*x))^(1/2)*sin(e+f*x)^-1, x) == :(-2*a^(1/2)*c^(1/2)*f^-1*arctanh(a^(1/2)*c^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1//2*cos(e+f*x))+-2*a^(1/2)*d^(1/2)*f^-1*arctan(a^(1/2)*d^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^(1/2)*(c+d*sin(e+f*x))^-1//2*sin(e+f*x)^-1, x) == :(-2*a^(1/2)*c^-1//2*f^-1*arctanh(a^(1/2)*c^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^(1/2)*sin(e+f*x)^-1, x) == :(-2*a^-1//2*c^(1/2)*f^-1*arctanh(a^(1/2)*c^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1//2*cos(e+f*x))+2^(1/2)*a^-1//2*f^-1*(c+-1d)^(1/2)*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+-1d)^(1/2)*(c+d*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1//2*sin(e+f*x)^-1, x) == :(-2*a^-1//2*c^-1//2*f^-1*arctanh(a^(1/2)*c^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+d*sin(e+f*x))^-1//2*cos(e+f*x))+2^(1/2)*a^-1//2*f^-1*(c+-1d)^-1//2*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*(c+-1d)^(1/2)*(c+d*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+b*sin(e+f*x))^-2*(c+d*sin(e+f*x))^-1*sin(e+f*x)^2, x) == :(2*c^2*f^-1*(c^2+-1*d^2)^-1//2*(b*c+-1*a*d)^-2*arctan((c^2+-1*d^2)^-1//2*(d+c*tan((1/2)*e+(1/2)*f*x)))+a^2*f^-1*(a+b*sin(e+f*x))^-1*(a^2+-1*b^2)^-1*(b*c+-1*a*d)^-1*cos(e+f*x)+-2*a*f^-1*(a^2+-1*b^2)^-3//2*(b*c+-1*a*d)^-2*(c*a^2+-2*c*b^2+a*b*d)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*e+(1/2)*f*x))))

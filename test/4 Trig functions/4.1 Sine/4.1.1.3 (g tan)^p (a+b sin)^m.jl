using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(tan(c+d*x)^5*(a+a*sin(c+d*x)), x) == :(-1*a*d^-1*sin(c+d*x)+-1*a^2*d^-1*(a+-1*a*sin(c+d*x))^-1+-23//16*a*d^-1*log(1+-1*sin(c+d*x))+1//8*a^2*d^-1*(a+a*sin(c+d*x))^-1+1//8*a^3*d^-1*(a+-1*a*sin(c+d*x))^-2+7//16*a*d^-1*log(1+sin(c+d*x)))
@test integrate(tan(c+d*x)^3*(a+a*sin(c+d*x)), x) == :(a*d^-1*sin(c+d*x)+(1/2)*a^2*d^-1*(a+-1*a*sin(c+d*x))^-1+-1//4*a*d^-1*log(1+sin(c+d*x))+5//4*a*d^-1*log(1+-1*sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))*tan(c+d*x), x) == :(-1*a*d^-1*log(1+-1*sin(c+d*x))+-1*a*d^-1*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))*cot(c+d*x), x) == :(a*d^-1*log(sin(c+d*x))+a*d^-1*sin(c+d*x))
@test integrate(cot(c+d*x)^3*(a+a*sin(c+d*x)), x) == :(-1*a*d^-1*csc(c+d*x)+-1*a*d^-1*log(sin(c+d*x))+-1*a*d^-1*sin(c+d*x)+-1//2*a*d^-1*csc(c+d*x)^2)
@test integrate(cot(c+d*x)^5*(a+a*sin(c+d*x)), x) == :(a*d^-1*csc(c+d*x)^2+a*d^-1*log(sin(c+d*x))+a*d^-1*sin(c+d*x)+2*a*d^-1*csc(c+d*x)+-1//3*a*d^-1*csc(c+d*x)^3+-1//4*a*d^-1*csc(c+d*x)^4)
@test integrate(cot(c+d*x)^7*(a+a*sin(c+d*x)), x) == :(a*d^-1*csc(c+d*x)^3+-1*a*d^-1*log(sin(c+d*x))+-1*a*d^-1*sin(c+d*x)+-3*a*d^-1*csc(c+d*x)+-3//2*a*d^-1*csc(c+d*x)^2+-1//5*a*d^-1*csc(c+d*x)^5+-1//6*a*d^-1*csc(c+d*x)^6+3//4*a*d^-1*csc(c+d*x)^4)
@test integrate(tan(c+d*x)^6*(a+a*sin(c+d*x)), x) == :(-1*a*x+a*d^-1*cos(c+d*x)+a*d^-1*tan(c+d*x)+-1*a*d^-1*sec(c+d*x)^3+3*a*d^-1*sec(c+d*x)+-1//3*a*d^-1*tan(c+d*x)^3+1//5*a*d^-1*sec(c+d*x)^5+1//5*a*d^-1*tan(c+d*x)^5)
@test integrate(tan(c+d*x)^4*(a+a*sin(c+d*x)), x) == :(a*x+-1*a*d^-1*cos(c+d*x)+-1*a*d^-1*tan(c+d*x)+-2*a*d^-1*sec(c+d*x)+1//3*a*d^-1*sec(c+d*x)^3+1//3*a*d^-1*tan(c+d*x)^3)
@test integrate(tan(c+d*x)^2*(a+a*sin(c+d*x)), x) == :(-1*a*x+a*d^-1*cos(c+d*x)+a*d^-1*(1+-1*sin(c+d*x))^-1*cos(c+d*x))
@test integrate(cot(c+d*x)^2*(a+a*sin(c+d*x)), x) == :(-1*a*x+a*d^-1*cos(c+d*x)+-1*a*d^-1*arctanh(cos(c+d*x))+-1*a*d^-1*cot(c+d*x))
@test integrate(cot(c+d*x)^4*(a+a*sin(c+d*x)), x) == :(a*x+a*d^-1*cot(c+d*x)+-3//2*a*d^-1*cos(c+d*x)+-1//3*a*d^-1*cot(c+d*x)^3+3//2*a*d^-1*arctanh(cos(c+d*x))+-1//2*a*d^-1*cot(c+d*x)^2*cos(c+d*x))
@test integrate(cot(c+d*x)^6*(a+a*sin(c+d*x)), x) == :(-1*a*x+-1*a*d^-1*cot(c+d*x)+-15//8*a*d^-1*arctanh(cos(c+d*x))+-1//5*a*d^-1*cot(c+d*x)^5+1//3*a*d^-1*cot(c+d*x)^3+15//8*a*d^-1*cos(c+d*x)+-1//4*a*d^-1*cot(c+d*x)^4*cos(c+d*x)+5//8*a*d^-1*cot(c+d*x)^2*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^2*tan(c+d*x)^5, x) == :(-2*a^2*d^-1*sin(c+d*x)+-31//8*a^2*d^-1*log(1+-1*sin(c+d*x))+-9//4*a^3*d^-1*(a+-1*a*sin(c+d*x))^-1+-1//2*a^2*d^-1*sin(c+d*x)^2+-1//8*a^2*d^-1*log(1+sin(c+d*x))+1//4*a^4*d^-1*(a+-1*a*sin(c+d*x))^-2)
@test integrate((a+a*sin(c+d*x))^2*tan(c+d*x)^3, x) == :(a^3*d^-1*(a+-1*a*sin(c+d*x))^-1+(1/2)*a^2*d^-1*sin(c+d*x)^2+2*a^2*d^-1*sin(c+d*x)+3*a^2*d^-1*log(1+-1*sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^2*tan(c+d*x), x) == :(-2*a^2*d^-1*log(1+-1*sin(c+d*x))+-2*a^2*d^-1*sin(c+d*x)+-1//2*a^2*d^-1*sin(c+d*x)^2)
@test integrate((a+a*sin(c+d*x))^2*cot(c+d*x)^3, x) == :(-1//2*a^-2*d^-1*(a+a*sin(c+d*x))^4*csc(c+d*x)^2)
@test integrate((a+a*sin(c+d*x))^2*cot(c+d*x)^7, x) == :((1/2)*a^2*d^-1*csc(c+d*x)^4+-6*a^2*d^-1*csc(c+d*x)+-2*a^2*d^-1*sin(c+d*x)+2*a^2*d^-1*csc(c+d*x)^3+2*a^2*d^-1*log(sin(c+d*x))+-2//5*a^2*d^-1*csc(c+d*x)^5+-1//2*a^2*d^-1*sin(c+d*x)^2+-1//6*a^2*d^-1*csc(c+d*x)^6)
@test integrate((a+a*sin(c+d*x))^2*tan(c+d*x)^6, x) == :(-9//2*x*a^2+-2*a^2*d^-1*sec(c+d*x)^3+2*a^2*d^-1*cos(c+d*x)+6*a^2*d^-1*sec(c+d*x)+-3//2*a^2*d^-1*tan(c+d*x)^3+2//5*a^2*d^-1*sec(c+d*x)^5+9//2*a^2*d^-1*tan(c+d*x)+9//10*a^2*d^-1*tan(c+d*x)^5+-1//2*a^2*d^-1*sin(c+d*x)^2*tan(c+d*x)^5)
@test integrate((a+a*sin(c+d*x))^2*tan(c+d*x)^4, x) == :(7//2*x*a^2+-16//3*a^2*d^-1*cos(c+d*x)+-7//2*a^2*d^-1*cos(c+d*x)*sin(c+d*x)+-8//3*a^2*d^-1*(1+-1*sin(c+d*x))^-1*sin(c+d*x)^2*cos(c+d*x)+1//3*a^4*d^-1*(a+-1*a*sin(c+d*x))^-2*sin(c+d*x)^3*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^2*tan(c+d*x)^2, x) == :(-5//2*x*a^2+2*a^2*d^-1*cos(c+d*x)+(1/2)*a^2*d^-1*cos(c+d*x)*sin(c+d*x)+2*a^2*d^-1*(1+-1*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^2, x) == :(3//2*x*a^2+-2*a^2*d^-1*cos(c+d*x)+-1//2*a^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^2*cot(c+d*x)^2, x) == :(-1//2*x*a^2+-1*a^2*d^-1*cot(c+d*x)+-2*a^2*d^-1*arctanh(cos(c+d*x))+2*a^2*d^-1*cos(c+d*x)+(1/2)*a^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^2*cot(c+d*x)^4, x) == :(-1//2*x*a^2+-2*a^2*d^-1*cos(c+d*x)+3*a^2*d^-1*arctanh(cos(c+d*x))+-1//3*a^2*d^-1*cot(c+d*x)^3+-1*a^2*d^-1*cot(c+d*x)*csc(c+d*x)+-1//2*a^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^3*tan(c+d*x)^7, x) == :(7*a^3*d^-1*sin(c+d*x)+-13//8*a^5*d^-1*(a+-1*a*sin(c+d*x))^-2+-1//16*a^3*d^-1*log(1+sin(c+d*x))+1//3*a^3*d^-1*sin(c+d*x)^3+1//6*a^6*d^-1*(a+-1*a*sin(c+d*x))^-3+3//2*a^3*d^-1*sin(c+d*x)^2+71//8*a^4*d^-1*(a+-1*a*sin(c+d*x))^-1+209//16*a^3*d^-1*log(1+-1*sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^3*tan(c+d*x)^3, x) == :(2*a^4*d^-1*(a+-1*a*sin(c+d*x))^-1+5*a^3*d^-1*sin(c+d*x)+7*a^3*d^-1*log(1+-1*sin(c+d*x))+1//3*a^3*d^-1*sin(c+d*x)^3+3//2*a^3*d^-1*sin(c+d*x)^2)
@test integrate((a+a*sin(c+d*x))^3*tan(c+d*x), x) == :(-4*a^3*d^-1*log(1+-1*sin(c+d*x))+-4*a^3*d^-1*sin(c+d*x)+-3//2*a^3*d^-1*sin(c+d*x)^2+-1//3*a^3*d^-1*sin(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^3*cot(c+d*x)^3, x) == :(-3*a^3*d^-1*csc(c+d*x)+-2*a^3*d^-1*sin(c+d*x)+2*a^3*d^-1*log(sin(c+d*x))+-3//2*a^3*d^-1*sin(c+d*x)^2+-1//2*a^3*d^-1*csc(c+d*x)^2+-1//3*a^3*d^-1*sin(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^3*tan(c+d*x)^6, x) == :(-23//2*x*a^3+-136//15*a^3*d^-1*cos(c+d*x)^3+136//5*a^3*d^-1*cos(c+d*x)+23//2*a^3*d^-1*cos(c+d*x)*sin(c+d*x)+-13//15*a^5*d^-1*(a+-1*a*sin(c+d*x))^-2*sin(c+d*x)^4*cos(c+d*x)+1//5*a^6*d^-1*(a+-1*a*sin(c+d*x))^-3*sin(c+d*x)^5*cos(c+d*x)+23//3*a^6*d^-1*(a^3+-1*a^3*sin(c+d*x))^-1*sin(c+d*x)^3*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^3*tan(c+d*x)^4, x) == :(17//2*x*a^3+-6*a^3*d^-1*cos(c+d*x)+1//3*a^3*d^-1*cos(c+d*x)^3+-25//3*a^3*d^-1*(1+-1*sin(c+d*x))^-1*cos(c+d*x)+-3//2*a^3*d^-1*cos(c+d*x)*sin(c+d*x)+2//3*a^3*d^-1*(1+-1*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^3*tan(c+d*x)^2, x) == :(-11//2*x*a^3+5*a^3*d^-1*cos(c+d*x)+-1//3*a^3*d^-1*cos(c+d*x)^3+4*a^3*d^-1*(1+-1*sin(c+d*x))^-1*cos(c+d*x)+3//2*a^3*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^3, x) == :(5//2*x*a^3+-4*a^3*d^-1*cos(c+d*x)+1//3*a^3*d^-1*cos(c+d*x)^3+-3//2*a^3*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^3*cot(c+d*x)^2, x) == :((1/2)*x*a^3+-1*a^3*d^-1*cot(c+d*x)+-3*a^3*d^-1*arctanh(cos(c+d*x))+3*a^3*d^-1*cos(c+d*x)+-1//3*a^3*d^-1*cos(c+d*x)^3+3//2*a^3*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^4*tan(c+d*x)^5, x) == :(a^6*d^-1*(a+-1*a*sin(c+d*x))^-2+-25*a^4*d^-1*log(1+-1*sin(c+d*x))+-16*a^4*d^-1*sin(c+d*x)+-11*a^5*d^-1*(a+-1*a*sin(c+d*x))^-1+-9//2*a^4*d^-1*sin(c+d*x)^2+-4//3*a^4*d^-1*sin(c+d*x)^3+-1//4*a^4*d^-1*sin(c+d*x)^4)
@test integrate((a+a*sin(c+d*x))^4*tan(c+d*x)^3, x) == :(4*a^4*d^-1*sin(c+d*x)^2+4*a^5*d^-1*(a+-1*a*sin(c+d*x))^-1+12*a^4*d^-1*sin(c+d*x)+16*a^4*d^-1*log(1+-1*sin(c+d*x))+1//4*a^4*d^-1*sin(c+d*x)^4+4//3*a^4*d^-1*sin(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^4*tan(c+d*x), x) == :(-8*a^4*d^-1*log(1+-1*sin(c+d*x))+-8*a^4*d^-1*sin(c+d*x)+-7//2*a^4*d^-1*sin(c+d*x)^2+-4//3*a^4*d^-1*sin(c+d*x)^3+-1//4*a^4*d^-1*sin(c+d*x)^4)
@test integrate((a+a*sin(c+d*x))^4*cot(c+d*x)^3, x) == :(-4*a^4*d^-1*csc(c+d*x)+5*a^4*d^-1*log(sin(c+d*x))+-5//2*a^4*d^-1*sin(c+d*x)^2+-4//3*a^4*d^-1*sin(c+d*x)^3+-1//2*a^4*d^-1*csc(c+d*x)^2+-1//4*a^4*d^-1*sin(c+d*x)^4)
@test integrate((a+a*sin(c+d*x))^4*tan(c+d*x)^4, x) == :(163//8*x*a^4+-16*a^4*d^-1*cos(c+d*x)+4//3*a^4*d^-1*cos(c+d*x)^3+-56//3*a^4*d^-1*(1+-1*sin(c+d*x))^-1*cos(c+d*x)+-35//8*a^4*d^-1*cos(c+d*x)*sin(c+d*x)+-1//4*a^4*d^-1*sin(c+d*x)^3*cos(c+d*x)+4//3*a^4*d^-1*(1+-1*sin(c+d*x))^-2*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^4*tan(c+d*x)^2, x) == :(-95//8*x*a^4+12*a^4*d^-1*cos(c+d*x)+-4//3*a^4*d^-1*cos(c+d*x)^3+8*a^4*d^-1*(1+-1*sin(c+d*x))^-1*cos(c+d*x)+1//4*a^4*d^-1*sin(c+d*x)^3*cos(c+d*x)+31//8*a^4*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^4, x) == :(35//8*x*a^4+-8*a^4*d^-1*cos(c+d*x)+4//3*a^4*d^-1*cos(c+d*x)^3+-27//8*a^4*d^-1*cos(c+d*x)*sin(c+d*x)+-1//4*a^4*d^-1*sin(c+d*x)^3*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^4*cot(c+d*x)^2, x) == :(17//8*x*a^4+-1*a^4*d^-1*cot(c+d*x)+-4*a^4*d^-1*arctanh(cos(c+d*x))+4*a^4*d^-1*cos(c+d*x)+-4//3*a^4*d^-1*cos(c+d*x)^3+1//4*a^4*d^-1*sin(c+d*x)^3*cos(c+d*x)+23//8*a^4*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^4*cot(c+d*x)^4, x) == :(-61//8*x*a^4+-5*a^4*d^-1*cot(c+d*x)+2*a^4*d^-1*arctanh(cos(c+d*x))+-1//3*a^4*d^-1*cot(c+d*x)^3+4//3*a^4*d^-1*cos(c+d*x)^3+-2*a^4*d^-1*cot(c+d*x)*csc(c+d*x)+-19//8*a^4*d^-1*cos(c+d*x)*sin(c+d*x)+-1//4*a^4*d^-1*sin(c+d*x)^3*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^4*cot(c+d*x)^6, x) == :(97//8*x*a^4+-4*a^4*d^-1*cos(c+d*x)+10*a^4*d^-1*cot(c+d*x)+-5//3*a^4*d^-1*cot(c+d*x)^3+-4//3*a^4*d^-1*cos(c+d*x)^3+-1//5*a^4*d^-1*cot(c+d*x)^5+5//2*a^4*d^-1*arctanh(cos(c+d*x))+-1*a^4*d^-1*csc(c+d*x)^3*cot(c+d*x)+1//4*a^4*d^-1*sin(c+d*x)^3*cos(c+d*x)+5//2*a^4*d^-1*cot(c+d*x)*csc(c+d*x)+15//8*a^4*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*tan(c+d*x)^7, x) == :(-35//128*a^-1*d^-1*arctanh(sin(c+d*x))+1//8*a^-1*d^-1*tan(c+d*x)^8+-35//192*a^-1*d^-1*tan(c+d*x)^3*sec(c+d*x)+-1//8*a^-1*d^-1*tan(c+d*x)^7*sec(c+d*x)+7//48*a^-1*d^-1*tan(c+d*x)^5*sec(c+d*x)+35//128*a^-1*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*tan(c+d*x)^5, x) == :(1//6*a^-1*d^-1*tan(c+d*x)^6+5//16*a^-1*d^-1*arctanh(sin(c+d*x))+-5//16*a^-1*d^-1*sec(c+d*x)*tan(c+d*x)+-1//6*a^-1*d^-1*tan(c+d*x)^5*sec(c+d*x)+5//24*a^-1*d^-1*tan(c+d*x)^3*sec(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*tan(c+d*x)^3, x) == :(-3//8*a^-1*d^-1*arctanh(sin(c+d*x))+1//4*a^-1*d^-1*tan(c+d*x)^4+-1//4*a^-1*d^-1*tan(c+d*x)^3*sec(c+d*x)+3//8*a^-1*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x), x) == :(a^-1*d^-1*log(sin(c+d*x))+-1*a^-1*d^-1*log(1+sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^3, x) == :(a^-1*d^-1*csc(c+d*x)+-1//2*a^-1*d^-1*csc(c+d*x)^2)
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^5, x) == :(-1*a^-1*d^-1*csc(c+d*x)+-1//4*a^-1*d^-1*cot(c+d*x)^4+1//3*a^-1*d^-1*csc(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^7, x) == :(a^-1*d^-1*csc(c+d*x)+-2//3*a^-1*d^-1*csc(c+d*x)^3+-1//6*a^-1*d^-1*cot(c+d*x)^6+1//5*a^-1*d^-1*csc(c+d*x)^5)
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^9, x) == :(a^-1*d^-1*csc(c+d*x)^3+-1*a^-1*d^-1*csc(c+d*x)+-3//5*a^-1*d^-1*csc(c+d*x)^5+-1//8*a^-1*d^-1*cot(c+d*x)^8+1//7*a^-1*d^-1*csc(c+d*x)^7)
@test integrate((a+a*sin(c+d*x))^-1*tan(c+d*x)^6, x) == :(a^-1*d^-1*sec(c+d*x)+-1*a^-1*d^-1*sec(c+d*x)^3+-1//7*a^-1*d^-1*sec(c+d*x)^7+1//7*a^-1*d^-1*tan(c+d*x)^7+3//5*a^-1*d^-1*sec(c+d*x)^5)
@test integrate((a+a*sin(c+d*x))^-1*tan(c+d*x)^4, x) == :(-1*a^-1*d^-1*sec(c+d*x)+-1//5*a^-1*d^-1*sec(c+d*x)^5+1//5*a^-1*d^-1*tan(c+d*x)^5+2//3*a^-1*d^-1*sec(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^-1*tan(c+d*x)^2, x) == :(a^-1*d^-1*sec(c+d*x)+-1//3*a^-1*d^-1*sec(c+d*x)^3+1//3*a^-1*d^-1*tan(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^-1, x) == :(-1*d^-1*(a+a*sin(c+d*x))^-1*cos(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^2, x) == :(a^-1*d^-1*arctanh(cos(c+d*x))+-1*a^-1*d^-1*cot(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^4, x) == :(-1//2*a^-1*d^-1*arctanh(cos(c+d*x))+-1//3*a^-1*d^-1*cot(c+d*x)^3+(1/2)*a^-1*d^-1*cot(c+d*x)*csc(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^6, x) == :(-1//5*a^-1*d^-1*cot(c+d*x)^5+3//8*a^-1*d^-1*arctanh(cos(c+d*x))+-3//8*a^-1*d^-1*cot(c+d*x)*csc(c+d*x)+1//4*a^-1*d^-1*cot(c+d*x)^3*csc(c+d*x))
@test integrate((a+a*sin(c+d*x))^-1*cot(c+d*x)^8, x) == :(-5//16*a^-1*d^-1*arctanh(cos(c+d*x))+-1//7*a^-1*d^-1*cot(c+d*x)^7+-5//24*a^-1*d^-1*cot(c+d*x)^3*csc(c+d*x)+1//6*a^-1*d^-1*cot(c+d*x)^5*csc(c+d*x)+5//16*a^-1*d^-1*cot(c+d*x)*csc(c+d*x))
@test integrate((a+a*sin(c+d*x))^-2*tan(c+d*x)^7, x) == :(-1//4*d^-1*(a+a*sin(c+d*x))^-2+-1//32*d^-1*(a+-1*a*sin(c+d*x))^-2+21//256*d^-1*(a^2+-1*a^2*sin(c+d*x))^-1+35//256*d^-1*(a^2+a^2*sin(c+d*x))^-1+-7//128*a^-2*d^-1*arctanh(sin(c+d*x))+-5//64*a^2*d^-1*(a+a*sin(c+d*x))^-4+1//80*a^3*d^-1*(a+a*sin(c+d*x))^-5+1//192*a*d^-1*(a+-1*a*sin(c+d*x))^-3+19//96*a*d^-1*(a+a*sin(c+d*x))^-3)
@test integrate((a+a*sin(c+d*x))^-2*tan(c+d*x)^5, x) == :(-5//32*d^-1*(a^2+a^2*sin(c+d*x))^-1+-5//64*d^-1*(a^2+-1*a^2*sin(c+d*x))^-1+1//4*d^-1*(a+a*sin(c+d*x))^-2+1//64*d^-1*(a+-1*a*sin(c+d*x))^-2+-7//48*a*d^-1*(a+a*sin(c+d*x))^-3+1//32*a^2*d^-1*(a+a*sin(c+d*x))^-4+5//64*a^-2*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-2*tan(c+d*x)^3, x) == :(-1//4*d^-1*(a+a*sin(c+d*x))^-2+1//16*d^-1*(a^2+-1*a^2*sin(c+d*x))^-1+3//16*d^-1*(a^2+a^2*sin(c+d*x))^-1+-1//8*a^-2*d^-1*arctanh(sin(c+d*x))+1//12*a*d^-1*(a+a*sin(c+d*x))^-3)
@test integrate((a+a*sin(c+d*x))^-2*tan(c+d*x), x) == :(-1//4*d^-1*(a^2+a^2*sin(c+d*x))^-1+1//4*d^-1*(a+a*sin(c+d*x))^-2+1//4*a^-2*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-2*cot(c+d*x), x) == :(d^-1*(a^2+a^2*sin(c+d*x))^-1+a^-2*d^-1*log(sin(c+d*x))+-1*a^-2*d^-1*log(1+sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-2*cot(c+d*x)^3, x) == :(-2*a^-2*d^-1*log(1+sin(c+d*x))+2*a^-2*d^-1*csc(c+d*x)+2*a^-2*d^-1*log(sin(c+d*x))+-1//2*a^-2*d^-1*csc(c+d*x)^2)
@test integrate((a+a*sin(c+d*x))^-2*cot(c+d*x)^5, x) == :(-1//2*a^-2*d^-1*csc(c+d*x)^2+-1//4*a^-2*d^-1*csc(c+d*x)^4+2//3*a^-2*d^-1*csc(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^-2*cot(c+d*x)^7, x) == :((1/2)*a^-2*d^-1*csc(c+d*x)^2+-2//3*a^-2*d^-1*csc(c+d*x)^3+-1//6*a^-2*d^-1*csc(c+d*x)^6+2//5*a^-2*d^-1*csc(c+d*x)^5)
@test integrate((a+a*sin(c+d*x))^-2*cot(c+d*x)^9, x) == :(-4//5*a^-2*d^-1*csc(c+d*x)^5+-1//2*a^-2*d^-1*csc(c+d*x)^2+-1//8*a^-2*d^-1*csc(c+d*x)^8+1//4*a^-2*d^-1*csc(c+d*x)^4+1//6*a^-2*d^-1*csc(c+d*x)^6+2//3*a^-2*d^-1*csc(c+d*x)^3+2//7*a^-2*d^-1*csc(c+d*x)^7)
@test integrate((a+a*sin(c+d*x))^-2*cot(c+d*x)^11, x) == :((1/2)*a^-2*d^-1*csc(c+d*x)^2+-6//7*a^-2*d^-1*csc(c+d*x)^7+-2//3*a^-2*d^-1*csc(c+d*x)^3+-1//2*a^-2*d^-1*csc(c+d*x)^4+-1//10*a^-2*d^-1*csc(c+d*x)^10+1//4*a^-2*d^-1*csc(c+d*x)^8+2//9*a^-2*d^-1*csc(c+d*x)^9+6//5*a^-2*d^-1*csc(c+d*x)^5)
@test integrate((a+a*sin(c+d*x))^-2*cot(c+d*x)^13, x) == :(-8//5*a^-2*d^-1*csc(c+d*x)^5+-8//9*a^-2*d^-1*csc(c+d*x)^9+-1//2*a^-2*d^-1*csc(c+d*x)^2+-1//3*a^-2*d^-1*csc(c+d*x)^6+-1//4*a^-2*d^-1*csc(c+d*x)^8+-1//12*a^-2*d^-1*csc(c+d*x)^12+2//3*a^-2*d^-1*csc(c+d*x)^3+2//11*a^-2*d^-1*csc(c+d*x)^11+3//4*a^-2*d^-1*csc(c+d*x)^4+3//10*a^-2*d^-1*csc(c+d*x)^10+12//7*a^-2*d^-1*csc(c+d*x)^7)
@test integrate((a+a*sin(c+d*x))^-3*tan(c+d*x)^5, x) == :(-5//128*d^-1*(a^3+a^3*sin(c+d*x))^-1+-1//32*d^-1*(a^3+-1*a^3*sin(c+d*x))^-1+1//6*d^-1*(a+a*sin(c+d*x))^-3+-7//64*a*d^-1*(a+a*sin(c+d*x))^-4+-5//64*a^-1*d^-1*(a+a*sin(c+d*x))^-2+1//40*a^2*d^-1*(a+a*sin(c+d*x))^-5+1//128*a^-1*d^-1*(a+-1*a*sin(c+d*x))^-2+1//128*a^-3*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-3*tan(c+d*x)^3, x) == :(-1//6*d^-1*(a+a*sin(c+d*x))^-3+1//16*d^-1*(a^3+a^3*sin(c+d*x))^-1+1//32*d^-1*(a^3+-1*a^3*sin(c+d*x))^-1+-1//32*a^-3*d^-1*arctanh(sin(c+d*x))+1//16*a*d^-1*(a+a*sin(c+d*x))^-4+3//32*a^-1*d^-1*(a+a*sin(c+d*x))^-2)
@test integrate((a+a*sin(c+d*x))^-3*tan(c+d*x), x) == :(-1//8*d^-1*(a^3+a^3*sin(c+d*x))^-1+1//6*d^-1*(a+a*sin(c+d*x))^-3+-1//8*a^-1*d^-1*(a+a*sin(c+d*x))^-2+1//8*a^-3*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-3*cot(c+d*x), x) == :(d^-1*(a^3+a^3*sin(c+d*x))^-1+a^-3*d^-1*log(sin(c+d*x))+(1/2)*a^-1*d^-1*(a+a*sin(c+d*x))^-2+-1*a^-3*d^-1*log(1+sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-3*cot(c+d*x)^3, x) == :(2*d^-1*(a^3+a^3*sin(c+d*x))^-1+-5*a^-3*d^-1*log(1+sin(c+d*x))+3*a^-3*d^-1*csc(c+d*x)+5*a^-3*d^-1*log(sin(c+d*x))+-1//2*a^-3*d^-1*csc(c+d*x)^2)
@test integrate((a+a*sin(c+d*x))^-3*cot(c+d*x)^5, x) == :(a^-3*d^-1*csc(c+d*x)^3+-4*a^-3*d^-1*log(1+sin(c+d*x))+-2*a^-3*d^-1*csc(c+d*x)^2+4*a^-3*d^-1*csc(c+d*x)+4*a^-3*d^-1*log(sin(c+d*x))+-1//4*a^-3*d^-1*csc(c+d*x)^4)
@test integrate((a+a*sin(c+d*x))^-3*cot(c+d*x)^7, x) == :(-3//4*a^-3*d^-1*csc(c+d*x)^4+-1//6*a^-3*d^-1*csc(c+d*x)^6+1//3*a^-3*d^-1*csc(c+d*x)^3+3//5*a^-3*d^-1*csc(c+d*x)^5)
@test integrate((a+a*sin(c+d*x))^-3*cot(c+d*x)^9, x) == :(-2//5*a^-3*d^-1*csc(c+d*x)^5+-1//3*a^-3*d^-1*csc(c+d*x)^3+-1//3*a^-3*d^-1*csc(c+d*x)^6+-1//8*a^-3*d^-1*csc(c+d*x)^8+3//4*a^-3*d^-1*csc(c+d*x)^4+3//7*a^-3*d^-1*csc(c+d*x)^7)
@test integrate((a+a*sin(c+d*x))^-3*cot(c+d*x)^11, x) == :(-5//7*a^-3*d^-1*csc(c+d*x)^7+-3//4*a^-3*d^-1*csc(c+d*x)^4+-1//8*a^-3*d^-1*csc(c+d*x)^8+-1//10*a^-3*d^-1*csc(c+d*x)^10+1//3*a^-3*d^-1*csc(c+d*x)^3+1//3*a^-3*d^-1*csc(c+d*x)^9+1//5*a^-3*d^-1*csc(c+d*x)^5+5//6*a^-3*d^-1*csc(c+d*x)^6)
@test integrate((a+a*sin(c+d*x))^-3*cot(c+d*x)^13, x) == :(-8//9*a^-3*d^-1*csc(c+d*x)^9+-4//3*a^-3*d^-1*csc(c+d*x)^6+-1//3*a^-3*d^-1*csc(c+d*x)^3+-1//12*a^-3*d^-1*csc(c+d*x)^12+3//4*a^-3*d^-1*csc(c+d*x)^4+3//4*a^-3*d^-1*csc(c+d*x)^8+3//11*a^-3*d^-1*csc(c+d*x)^11+6//7*a^-3*d^-1*csc(c+d*x)^7)
@test integrate((a+a*sin(c+d*x))^-4*tan(c+d*x)^5, x) == :(-5//256*d^-1*(a^2+a^2*sin(c+d*x))^-2+-3//256*d^-1*(a^4+-1*a^4*sin(c+d*x))^-1+-1//256*d^-1*(a^4+a^4*sin(c+d*x))^-1+1//8*d^-1*(a+a*sin(c+d*x))^-4+1//256*d^-1*(a^2+-1*a^2*sin(c+d*x))^-2+-7//80*a*d^-1*(a+a*sin(c+d*x))^-5+-5//96*a^-1*d^-1*(a+a*sin(c+d*x))^-3+-1//128*a^-4*d^-1*arctanh(sin(c+d*x))+1//48*a^2*d^-1*(a+a*sin(c+d*x))^-6)
@test integrate((a+a*sin(c+d*x))^-4*tan(c+d*x)^3, x) == :(-1//8*d^-1*(a+a*sin(c+d*x))^-4+1//32*d^-1*(a^2+a^2*sin(c+d*x))^-2+1//64*d^-1*(a^4+a^4*sin(c+d*x))^-1+1//64*d^-1*(a^4+-1*a^4*sin(c+d*x))^-1+1//16*a^-1*d^-1*(a+a*sin(c+d*x))^-3+1//20*a*d^-1*(a+a*sin(c+d*x))^-5)
@test integrate((a+a*sin(c+d*x))^-4*tan(c+d*x), x) == :(-1//16*d^-1*(a^2+a^2*sin(c+d*x))^-2+-1//16*d^-1*(a^4+a^4*sin(c+d*x))^-1+1//8*d^-1*(a+a*sin(c+d*x))^-4+-1//12*a^-1*d^-1*(a+a*sin(c+d*x))^-3+1//16*a^-4*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+a*sin(c+d*x))^-4*cot(c+d*x)^3, x) == :(d^-1*(a^2+a^2*sin(c+d*x))^-2+5*d^-1*(a^4+a^4*sin(c+d*x))^-1+-9*a^-4*d^-1*log(1+sin(c+d*x))+4*a^-4*d^-1*csc(c+d*x)+9*a^-4*d^-1*log(sin(c+d*x))+-1//2*a^-4*d^-1*csc(c+d*x)^2)
@test integrate((a+a*sin(c+d*x))^-4*cot(c+d*x)^7, x) == :(-8*a^-4*d^-1*log(1+sin(c+d*x))+-4*a^-4*d^-1*csc(c+d*x)^2+8*a^-4*d^-1*csc(c+d*x)+8*a^-4*d^-1*log(sin(c+d*x))+-7//4*a^-4*d^-1*csc(c+d*x)^4+-1//6*a^-4*d^-1*csc(c+d*x)^6+4//5*a^-4*d^-1*csc(c+d*x)^5+8//3*a^-4*d^-1*csc(c+d*x)^3)
@test integrate((a+a*sin(c+d*x))^-4*tan(c+d*x)^2, x) == :(-8//9*a^-4*d^-1*sec(c+d*x)^9+-4//5*a^-4*d^-1*sec(c+d*x)^5+1//3*a^-4*d^-1*tan(c+d*x)^3+8//9*a^-4*d^-1*tan(c+d*x)^9+9//5*a^-4*d^-1*tan(c+d*x)^5+12//7*a^-4*d^-1*sec(c+d*x)^7+16//7*a^-4*d^-1*tan(c+d*x)^7)
@test integrate((a+a*sin(e+f*x))^(1/2)*tan(e+f*x)^2, x) == :(5*f^-1*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x)+-2*a^-1*f^-1*(a+a*sin(e+f*x))^3//2*sec(e+f*x)+-1//2*2^(1/2)*a^(1/2)*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^(1/2)*cot(e+f*x)^2, x) == :(-1*a^(1/2)*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-1*f^-1*(a+a*sin(e+f*x))^(1/2)*cot(e+f*x)+3*a*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^(1/2)*cot(e+f*x)^4, x) == :(11//8*a^(1/2)*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-2*a*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)+-1//3*f^-1*(a+a*sin(e+f*x))^(1/2)*csc(e+f*x)^2*cot(e+f*x)+11//8*a*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)+-1//12*a*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^3//2*tan(e+f*x)^2, x) == :(7//3*f^-1*(a+a*sin(e+f*x))^3//2*sec(e+f*x)+-2//3*a^-1*f^-1*(a+a*sin(e+f*x))^5//2*sec(e+f*x)+11//3*a^2*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^3//2*cot(e+f*x)^2, x) == :(-1*f^-1*(a+a*sin(e+f*x))^3//2*cot(e+f*x)+-3*a^3//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+5//3*a*f^-1*(a+a*sin(e+f*x))^(1/2)*cos(e+f*x)+11//3*a^2*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^3//2*cot(e+f*x)^4, x) == :(37//8*a^3//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-8//3*a^2*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)+-2//3*a*f^-1*(a+a*sin(e+f*x))^(1/2)*cos(e+f*x)+-1//3*f^-1*(a+a*sin(e+f*x))^3//2*csc(e+f*x)^2*cot(e+f*x)+29//24*a^2*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)+-1//4*a*f^-1*(a+a*sin(e+f*x))^(1/2)*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^5//2*tan(e+f*x)^2, x) == :(9//5*f^-1*(a+a*sin(e+f*x))^5//2*sec(e+f*x)+-2//5*a^-1*f^-1*(a+a*sin(e+f*x))^7//2*sec(e+f*x)+31//15*a^2*f^-1*(a+a*sin(e+f*x))^(1/2)*cos(e+f*x)+124//15*a^3*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^5//2*cot(e+f*x)^2, x) == :(-1*f^-1*(a+a*sin(e+f*x))^5//2*cot(e+f*x)+-5*a^5//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+7//5*a*f^-1*(a+a*sin(e+f*x))^3//2*cos(e+f*x)+31//15*a^2*f^-1*(a+a*sin(e+f*x))^(1/2)*cos(e+f*x)+49//15*a^3*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))
@test integrate((a+a*sin(e+f*x))^5//2*cot(e+f*x)^4, x) == :(55//8*a^5//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-16//15*a^2*f^-1*(a+a*sin(e+f*x))^(1/2)*cos(e+f*x)+-9//40*a^3*f^-1*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)+-2//5*a*f^-1*(a+a*sin(e+f*x))^3//2*cos(e+f*x)+-1//3*f^-1*(a+a*sin(e+f*x))^5//2*csc(e+f*x)^2*cot(e+f*x)+17//24*a^2*f^-1*(a+a*sin(e+f*x))^(1/2)*cot(e+f*x)+-5//12*a*f^-1*(a+a*sin(e+f*x))^3//2*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^-1//2*tan(e+f*x)^2, x) == :(-1//2*f^-1*(a+a*sin(e+f*x))^-1//2*sec(e+f*x)+3//4*a^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*sec(e+f*x)+5//8*2^(1/2)*a^-1//2*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-1//2*cot(e+f*x)^2, x) == :(a^-1//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-1*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x))
@test integrate((a+a*sin(e+f*x))^-1//2*cot(e+f*x)^4, x) == :(-7//8*a^-1//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+9//8*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)+-1//3*f^-1*(a+a*sin(e+f*x))^-1//2*csc(e+f*x)^2*cot(e+f*x)+1//12*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^-3//2*tan(e+f*x)^2, x) == :(-1//4*f^-1*(a+a*sin(e+f*x))^-3//2*sec(e+f*x)+1//32*f^-1*(a+a*sin(e+f*x))^-3//2*cos(e+f*x)+1//64*2^(1/2)*a^-3//2*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+5//8*a^-1*f^-1*(a+a*sin(e+f*x))^-1//2*sec(e+f*x))
@test integrate((a+a*sin(e+f*x))^-3//2*cot(e+f*x)^2, x) == :(3*a^-3//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-1*a^-1*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)+-2*2^(1/2)*a^-3//2*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-3//2*cot(e+f*x)^4, x) == :(-1//8*a^-3//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-1//8*a^-1*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)+-1//3*a^-2*f^-1*(a+a*sin(e+f*x))^(1/2)*csc(e+f*x)^2*cot(e+f*x)+11//12*a^-1*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^-5//2*tan(e+f*x)^2, x) == :(-1//6*f^-1*(a+a*sin(e+f*x))^-5//2*sec(e+f*x)+-11//128*a^-1*f^-1*(a+a*sin(e+f*x))^-3//2*cos(e+f*x)+-11//256*2^(1/2)*a^-5//2*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+11//96*a^-2*f^-1*(a+a*sin(e+f*x))^-1//2*sec(e+f*x)+17//48*a^-1*f^-1*(a+a*sin(e+f*x))^-3//2*sec(e+f*x))
@test integrate((a+a*sin(e+f*x))^-5//2*cot(e+f*x)^2, x) == :(5*a^-5//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-1*a^-1*f^-1*(a+a*sin(e+f*x))^-3//2*cot(e+f*x)+-2*a^-1*f^-1*(a+a*sin(e+f*x))^-3//2*cos(e+f*x)+-7//2*2^(1/2)*a^-5//2*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x)))
@test integrate((a+a*sin(e+f*x))^-5//2*cot(e+f*x)^4, x) == :(45//8*a^-5//2*f^-1*arctanh(a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-4*2^(1/2)*a^-5//2*f^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(e+f*x))^-1//2*cos(e+f*x))+-19//8*a^-2*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)+-1//3*a^-2*f^-1*(a+a*sin(e+f*x))^-1//2*csc(e+f*x)^2*cot(e+f*x)+13//12*a^-2*f^-1*(a+a*sin(e+f*x))^-1//2*cot(e+f*x)*csc(e+f*x))
@test integrate((a+a*sin(e+f*x))^1//3*tan(e+f*x)^4, x) == :(-361//126*f^-1*(a+a*sin(e+f*x))^1//3*sec(e+f*x)+361//63*f^-1*(a+a*sin(e+f*x))^1//3*(1+-1*sin(e+f*x))*sec(e+f*x)+-1//42*f^-1*(a+a*sin(e+f*x))^-2//3*(a+-1*a*sin(e+f*x))^-1*(65*a^2+-142*a^2*sin(e+f*x))*sec(e+f*x)+-3*a^2*f^-1*(a+a*sin(e+f*x))^-2//3*(a+-1*a*sin(e+f*x))^-1*sin(e+f*x)^2*tan(e+f*x)+1//63*f^-1*(a+a*sin(e+f*x))^2//3*(2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-1*(1+-1*sin(e+f*x))*(361+361*3^(1/2))*sec(e+f*x)+3//2*a^2*f^-1*(a+a*sin(e+f*x))^-2//3*(a+-1*a*sin(e+f*x))^-1*sin(e+f*x)*tan(e+f*x)+-361//63*2^1//3*3^1//4*a^-2//3*f^-1*((2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-2*((a+a*sin(e+f*x))^2//3+2^2//3*a^2//3+2^1//3*a^1//3*(a+a*sin(e+f*x))^1//3))^(1/2)*(-1*(a+a*sin(e+f*x))^1//3*(2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-2*(-1*(a+a*sin(e+f*x))^1//3+2^1//3*a^1//3))^-1//2*(a+a*sin(e+f*x))^2//3*(-1*(a+a*sin(e+f*x))^1//3+2^1//3*a^1//3)*Elliptic.E(arccos((2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-1*(2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+-1*3^(1/2)))),1/2+1//4*3^(1/2))*sec(e+f*x)+-1//378*2^1//3*3^3//4*a^-2//3*f^-1*((2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-2*((a+a*sin(e+f*x))^2//3+2^2//3*a^2//3+2^1//3*a^1//3*(a+a*sin(e+f*x))^1//3))^(1/2)*(-1*(a+a*sin(e+f*x))^1//3*(2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-2*(-1*(a+a*sin(e+f*x))^1//3+2^1//3*a^1//3))^-1//2*(a+a*sin(e+f*x))^2//3*(361+-361*3^(1/2))*(-1*(a+a*sin(e+f*x))^1//3+2^1//3*a^1//3)*Elliptic.F(arccos((2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-1*(2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+-1*3^(1/2)))),1/2+1//4*3^(1/2))*sec(e+f*x))
@test integrate((a+a*sin(e+f*x))^-1//3*tan(e+f*x)^4, x) == :(973//396*f^-1*(a+a*sin(e+f*x))^-1//3*sec(e+f*x)+-973//495*f^-1*(a+a*sin(e+f*x))^-1//3*(1+-1*sin(e+f*x))*sec(e+f*x)+-1//132*f^-1*(1+-1*sin(e+f*x))^-1*(a+a*sin(e+f*x))^-4//3*(95a+356*a*sin(e+f*x))*sec(e+f*x)+3*a^2*f^-1*(a+a*sin(e+f*x))^-4//3*(a+-1*a*sin(e+f*x))^-1*sin(e+f*x)^2*tan(e+f*x)+3//4*a^2*f^-1*(a+a*sin(e+f*x))^-4//3*(a+-1*a*sin(e+f*x))^-1*sin(e+f*x)*tan(e+f*x)+973//2970*2^2//3*3^3//4*a^-4//3*f^-1*((2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-2*((a+a*sin(e+f*x))^2//3+2^2//3*a^2//3+2^1//3*a^1//3*(a+a*sin(e+f*x))^1//3))^(1/2)*(-1*(a+a*sin(e+f*x))^1//3*(2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-2*(-1*(a+a*sin(e+f*x))^1//3+2^1//3*a^1//3))^-1//2*(a+a*sin(e+f*x))^2//3*(-1*(a+a*sin(e+f*x))^1//3+2^1//3*a^1//3)*Elliptic.F(arccos((2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+3^(1/2)))^-1*(2^1//3*a^1//3+-1*(a+a*sin(e+f*x))^1//3*(1+-1*3^(1/2)))),1/2+1//4*3^(1/2))*sec(e+f*x))
@test integrate(tan(c+d*x)^3*(a+b*sin(c+d*x)), x) == :((1/2)*d^-1*tan(c+d*x)^2*(a+b*sin(c+d*x))+1//4*d^-1*(-3b+2a)*log(1+sin(c+d*x))+1//4*d^-1*(2a+3b)*log(1+-1*sin(c+d*x))+3//2*b*d^-1*sin(c+d*x))
@test integrate((a+b*sin(c+d*x))*tan(c+d*x), x) == :(-1*b*d^-1*sin(c+d*x)+-1//2*d^-1*(a+b)*log(1+-1*sin(c+d*x))+-1//2*d^-1*(a+-1b)*log(1+sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))*cot(c+d*x), x) == :(a*d^-1*log(sin(c+d*x))+b*d^-1*sin(c+d*x))
@test integrate(cot(c+d*x)^3*(a+b*sin(c+d*x)), x) == :(-1*a*d^-1*log(sin(c+d*x))+-1*b*d^-1*csc(c+d*x)+-1*b*d^-1*sin(c+d*x)+-1//2*a*d^-1*csc(c+d*x)^2)
@test integrate(cot(c+d*x)^5*(a+b*sin(c+d*x)), x) == :(a*d^-1*csc(c+d*x)^2+a*d^-1*log(sin(c+d*x))+b*d^-1*sin(c+d*x)+2*b*d^-1*csc(c+d*x)+-1//3*b*d^-1*csc(c+d*x)^3+-1//4*a*d^-1*csc(c+d*x)^4)
@test integrate(tan(c+d*x)^4*(a+b*sin(c+d*x)), x) == :(a*x+-1*a*d^-1*tan(c+d*x)+-1*b*d^-1*cos(c+d*x)+-2*b*d^-1*sec(c+d*x)+1//3*a*d^-1*tan(c+d*x)^3+1//3*b*d^-1*sec(c+d*x)^3)
@test integrate(tan(c+d*x)^2*(a+b*sin(c+d*x)), x) == :(-1*a*x+a*d^-1*tan(c+d*x)+b*d^-1*cos(c+d*x)+b*d^-1*sec(c+d*x))
@test integrate(cot(c+d*x)^2*(a+b*sin(c+d*x)), x) == :(-1*a*x+b*d^-1*cos(c+d*x)+-1*a*d^-1*cot(c+d*x)+-1*b*d^-1*arctanh(cos(c+d*x)))
@test integrate(cot(c+d*x)^4*(a+b*sin(c+d*x)), x) == :(a*x+a*d^-1*cot(c+d*x)+-3//2*b*d^-1*cos(c+d*x)+-1//3*a*d^-1*cot(c+d*x)^3+3//2*b*d^-1*arctanh(cos(c+d*x))+-1//2*b*d^-1*cot(c+d*x)^2*cos(c+d*x))
@test integrate(cot(c+d*x)^6*(a+b*sin(c+d*x)), x) == :(-1*a*x+-1*a*d^-1*cot(c+d*x)+-15//8*b*d^-1*arctanh(cos(c+d*x))+-1//5*a*d^-1*cot(c+d*x)^5+1//3*a*d^-1*cot(c+d*x)^3+15//8*b*d^-1*cos(c+d*x)+-1//4*b*d^-1*cot(c+d*x)^4*cos(c+d*x)+5//8*b*d^-1*cot(c+d*x)^2*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*tan(c+d*x)^3, x) == :((1/2)*b^2*d^-1*sin(c+d*x)^2+(1/2)*d^-1*(a+b*sin(c+d*x))^2*sec(c+d*x)^2+(1/2)*d^-1*(a+b)*(a+2b)*log(1+-1*sin(c+d*x))+(1/2)*d^-1*(a+-1b)*(a+-2b)*log(1+sin(c+d*x))+2*a*b*d^-1*sin(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*tan(c+d*x), x) == :(-1//2*b^2*d^-1*sin(c+d*x)^2+-1//2*d^-1*(a+b)^2*log(1+-1*sin(c+d*x))+-1//2*d^-1*(a+-1b)^2*log(1+sin(c+d*x))+-2*a*b*d^-1*sin(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*cot(c+d*x), x) == :(a^2*d^-1*log(sin(c+d*x))+(1/2)*b^2*d^-1*sin(c+d*x)^2+2*a*b*d^-1*sin(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*cot(c+d*x)^3, x) == :(-1*d^-1*(a^2+-1*b^2)*log(sin(c+d*x))+-1//2*a^2*d^-1*csc(c+d*x)^2+-1//2*b^2*d^-1*sin(c+d*x)^2+-2*a*b*d^-1*csc(c+d*x)+-2*a*b*d^-1*sin(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*cot(c+d*x)^5, x) == :(d^-1*(a^2+-2*b^2)*log(sin(c+d*x))+(1/2)*b^2*d^-1*sin(c+d*x)^2+(1/2)*d^-1*csc(c+d*x)^2*(-1*b^2+2*a^2)+-1//4*a^2*d^-1*csc(c+d*x)^4+2*a*b*d^-1*sin(c+d*x)+4*a*b*d^-1*csc(c+d*x)+-2//3*a*b*d^-1*csc(c+d*x)^3)
@test integrate((a+b*sin(c+d*x))^2*tan(c+d*x)^4, x) == :(x*a^2+5//2*x*b^2+-1*a^2*d^-1*tan(c+d*x)+-5//2*b^2*d^-1*tan(c+d*x)+1//3*a^2*d^-1*tan(c+d*x)^3+5//6*b^2*d^-1*tan(c+d*x)^3+-4*a*b*d^-1*sec(c+d*x)+-2*a*b*d^-1*cos(c+d*x)+-1//2*b^2*d^-1*sin(c+d*x)^2*tan(c+d*x)^3+2//3*a*b*d^-1*sec(c+d*x)^3)
@test integrate((a+b*sin(c+d*x))^2*tan(c+d*x)^2, x) == :(-1*x*a^2+-3//2*x*b^2+a^2*d^-1*tan(c+d*x)+3//2*b^2*d^-1*tan(c+d*x)+2*a*b*d^-1*cos(c+d*x)+2*a*b*d^-1*sec(c+d*x)+-1//2*b^2*d^-1*sin(c+d*x)^2*tan(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*cot(c+d*x)^2, x) == :((1/2)*x*b^2+-1*x*a^2+-1*a^2*d^-1*cot(c+d*x)+(1/2)*b^2*d^-1*cos(c+d*x)*sin(c+d*x)+-2*a*b*d^-1*arctanh(cos(c+d*x))+2*a*b*d^-1*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*cot(c+d*x)^4, x) == :(x*a^2+-3//2*x*b^2+a^2*d^-1*cot(c+d*x)+-3//2*b^2*d^-1*cot(c+d*x)+-1//3*a^2*d^-1*cot(c+d*x)^3+(1/2)*b^2*d^-1*cos(c+d*x)^2*cot(c+d*x)+-3*a*b*d^-1*cos(c+d*x)+3*a*b*d^-1*arctanh(cos(c+d*x))+-1*a*b*d^-1*cot(c+d*x)^2*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^2*cot(c+d*x)^6, x) == :(-1*x*a^2+5//2*x*b^2+-1*a^2*d^-1*cot(c+d*x)+-5//6*b^2*d^-1*cot(c+d*x)^3+-1//5*a^2*d^-1*cot(c+d*x)^5+1//3*a^2*d^-1*cot(c+d*x)^3+5//2*b^2*d^-1*cot(c+d*x)+(1/2)*b^2*d^-1*cos(c+d*x)^2*cot(c+d*x)^3+-15//4*a*b*d^-1*arctanh(cos(c+d*x))+15//4*a*b*d^-1*cos(c+d*x)+-1//2*a*b*d^-1*cot(c+d*x)^4*cos(c+d*x)+5//4*a*b*d^-1*cot(c+d*x)^2*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^3*tan(c+d*x)^3, x) == :((1/2)*d^-1*(a+b*sin(c+d*x))^3*sec(c+d*x)^2+1//3*b^3*d^-1*sin(c+d*x)^3+(1/2)*b*d^-1*(5*b^2+6*a^2)*sin(c+d*x)+1//4*d^-1*(a+b)^2*(2a+5b)*log(1+-1*sin(c+d*x))+1//4*d^-1*(a+-1b)^2*(-5b+2a)*log(1+sin(c+d*x))+3//2*a*b^2*d^-1*sin(c+d*x)^2)
@test integrate((a+b*sin(c+d*x))^3*tan(c+d*x), x) == :(-1//2*d^-1*(a+b)^3*log(1+-1*sin(c+d*x))+-1//2*d^-1*(a+-1b)^3*log(1+sin(c+d*x))+-1//3*b^3*d^-1*sin(c+d*x)^3+-1*b*d^-1*(b^2+3*a^2)*sin(c+d*x)+-3//2*a*b^2*d^-1*sin(c+d*x)^2)
@test integrate((a+b*sin(c+d*x))^3*cot(c+d*x), x) == :(a^3*d^-1*log(sin(c+d*x))+1//3*b^3*d^-1*sin(c+d*x)^3+3*b*a^2*d^-1*sin(c+d*x)+3//2*a*b^2*d^-1*sin(c+d*x)^2)
@test integrate((a+b*sin(c+d*x))^3*cot(c+d*x)^3, x) == :(-1//2*a^3*d^-1*csc(c+d*x)^2+-1//3*b^3*d^-1*sin(c+d*x)^3+-1*a*d^-1*(a^2+-3*b^2)*log(sin(c+d*x))+-1*b*d^-1*(-1*b^2+3*a^2)*sin(c+d*x)+-3*b*a^2*d^-1*csc(c+d*x)+-3//2*a*b^2*d^-1*sin(c+d*x)^2)
@test integrate((a+b*sin(c+d*x))^3*cot(c+d*x)^5, x) == :(-1//4*a^3*d^-1*csc(c+d*x)^4+1//3*b^3*d^-1*sin(c+d*x)^3+a*d^-1*(a^2+-6*b^2)*log(sin(c+d*x))+b*d^-1*(-1*b^2+6*a^2)*csc(c+d*x)+b*d^-1*(-2*b^2+3*a^2)*sin(c+d*x)+(1/2)*a*d^-1*csc(c+d*x)^2*(-3*b^2+2*a^2)+-1*b*a^2*d^-1*csc(c+d*x)^3+3//2*a*b^2*d^-1*sin(c+d*x)^2)
@test integrate((a+b*sin(c+d*x))^3*tan(c+d*x)^4, x) == :(x*a^3+-1*a^3*d^-1*tan(c+d*x)+-3*b^3*d^-1*cos(c+d*x)+-3*b^3*d^-1*sec(c+d*x)+1//3*a^3*d^-1*tan(c+d*x)^3+1//3*b^3*d^-1*cos(c+d*x)^3+1//3*b^3*d^-1*sec(c+d*x)^3+15//2*a*x*b^2+b*a^2*d^-1*sec(c+d*x)^3+-6*b*a^2*d^-1*sec(c+d*x)+-3*b*a^2*d^-1*cos(c+d*x)+-15//2*a*b^2*d^-1*tan(c+d*x)+5//2*a*b^2*d^-1*tan(c+d*x)^3+-3//2*a*b^2*d^-1*sin(c+d*x)^2*tan(c+d*x)^3)
@test integrate((a+b*sin(c+d*x))^3*tan(c+d*x)^2, x) == :(-1*x*a^3+a^3*d^-1*tan(c+d*x)+b^3*d^-1*sec(c+d*x)+2*b^3*d^-1*cos(c+d*x)+-9//2*a*x*b^2+-1//3*b^3*d^-1*cos(c+d*x)^3+3*b*a^2*d^-1*cos(c+d*x)+3*b*a^2*d^-1*sec(c+d*x)+9//2*a*b^2*d^-1*tan(c+d*x)+-3//2*a*b^2*d^-1*sin(c+d*x)^2*tan(c+d*x))
@test integrate((a+b*sin(c+d*x))^3*cot(c+d*x)^2, x) == :(-1*x*a^3+-1*a^3*d^-1*cot(c+d*x)+-1//3*b^3*d^-1*cos(c+d*x)^3+3//2*a*x*b^2+-3*b*a^2*d^-1*arctanh(cos(c+d*x))+3*b*a^2*d^-1*cos(c+d*x)+3//2*a*b^2*d^-1*cos(c+d*x)*sin(c+d*x))
@test integrate((a+b*sin(c+d*x))^3*cot(c+d*x)^4, x) == :(x*a^3+a^3*d^-1*cot(c+d*x)+b^3*d^-1*cos(c+d*x)+-1*b^3*d^-1*arctanh(cos(c+d*x))+-9//2*a*x*b^2+-1//3*a^3*d^-1*cot(c+d*x)^3+1//3*b^3*d^-1*cos(c+d*x)^3+-9//2*a*b^2*d^-1*cot(c+d*x)+-9//2*b*a^2*d^-1*cos(c+d*x)+9//2*b*a^2*d^-1*arctanh(cos(c+d*x))+-3//2*b*a^2*d^-1*cot(c+d*x)^2*cos(c+d*x)+3//2*a*b^2*d^-1*cos(c+d*x)^2*cot(c+d*x))
@test integrate((a+b*sin(c+d*x))^3*cot(c+d*x)^6, x) == :(-1*x*a^3+-1*a^3*d^-1*cot(c+d*x)+-5//2*b^3*d^-1*cos(c+d*x)+-5//6*b^3*d^-1*cos(c+d*x)^3+-1//5*a^3*d^-1*cot(c+d*x)^5+1//3*a^3*d^-1*cot(c+d*x)^3+5//2*b^3*d^-1*arctanh(cos(c+d*x))+15//2*a*x*b^2+-45//8*b*a^2*d^-1*arctanh(cos(c+d*x))+-5//2*a*b^2*d^-1*cot(c+d*x)^3+-1//2*b^3*d^-1*cos(c+d*x)^3*cot(c+d*x)^2+15//2*a*b^2*d^-1*cot(c+d*x)+45//8*b*a^2*d^-1*cos(c+d*x)+-3//4*b*a^2*d^-1*cot(c+d*x)^4*cos(c+d*x)+3//2*a*b^2*d^-1*cos(c+d*x)^2*cot(c+d*x)^3+15//8*b*a^2*d^-1*cot(c+d*x)^2*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^-1*tan(c+d*x)^5, x) == :(a^5*d^-1*(a^2+-1*b^2)^-3*log(a+b*sin(c+d*x))+d^-1*(-4*b^2+4*a^2)^-1*sec(c+d*x)^4*(a+-1*b*sin(c+d*x))+-1//8*d^-1*(a^2+-1*b^2)^-2*sec(c+d*x)^2*(4*a*(-1*b^2+2*a^2)+-1*b*(-5*b^2+9*a^2)*sin(c+d*x))+-1//16*d^-1*(a+b)^-3*(3*b^2+8*a^2+9*a*b)*log(1+-1*sin(c+d*x))+-1//16*d^-1*(a+-1b)^-3*(3*b^2+8*a^2+-9*a*b)*log(1+sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-1*tan(c+d*x)^3, x) == :(d^-1*(-2*b^2+2*a^2)^-1*sec(c+d*x)^2*(a+-1*b*sin(c+d*x))+-1*a^3*d^-1*(a^2+-1*b^2)^-2*log(a+b*sin(c+d*x))+1//4*d^-1*(a+b)^-2*(b+2a)*log(1+-1*sin(c+d*x))+1//4*d^-1*(a+-1b)^-2*(-1b+2a)*log(1+sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-1*tan(c+d*x), x) == :(-1*d^-1*(-2b+2a)^-1*log(1+sin(c+d*x))+-1*d^-1*(2a+2b)^-1*log(1+-1*sin(c+d*x))+a*d^-1*(a^2+-1*b^2)^-1*log(a+b*sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-1*cot(c+d*x), x) == :(a^-1*d^-1*log(sin(c+d*x))+-1*a^-1*d^-1*log(a+b*sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-1*cot(c+d*x)^3, x) == :(-1//2*a^-1*d^-1*csc(c+d*x)^2+b*a^-2*d^-1*csc(c+d*x)+a^-3*d^-1*(a^2+-1*b^2)*log(a+b*sin(c+d*x))+-1*a^-3*d^-1*(a^2+-1*b^2)*log(sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-1*cot(c+d*x)^5, x) == :(-1//4*a^-1*d^-1*csc(c+d*x)^4+a^-5*d^-1*(a^2+-1*b^2)^2*log(sin(c+d*x))+(1/2)*a^-3*d^-1*csc(c+d*x)^2*(-1*b^2+2*a^2)+-1*a^-5*d^-1*(a^2+-1*b^2)^2*log(a+b*sin(c+d*x))+1//3*b*a^-2*d^-1*csc(c+d*x)^3+-1*b*a^-4*d^-1*(-1*b^2+2*a^2)*csc(c+d*x))
@test integrate((a+b*sin(c+d*x))^-1*tan(c+d*x)^4, x) == :(a*d^-1*(-3*b^2+3*a^2)^-1*tan(c+d*x)^3+b*d^-1*(a^2+-1*b^2)^-1*sec(c+d*x)+-1*b*d^-1*(-3*b^2+3*a^2)^-1*sec(c+d*x)^3+-1*a^3*d^-1*(a^2+-1*b^2)^-2*tan(c+d*x)+2*a^4*d^-1*(a^2+-1*b^2)^-5//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+b*a^2*d^-1*(a^2+-1*b^2)^-2*sec(c+d*x))
@test integrate((a+b*sin(c+d*x))^-1*tan(c+d*x)^2, x) == :(a*d^-1*(a^2+-1*b^2)^-1*tan(c+d*x)+-1*b*d^-1*(a^2+-1*b^2)^-1*sec(c+d*x)+-2*a^2*d^-1*(a^2+-1*b^2)^-3//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x))))
@test integrate((a+b*sin(c+d*x))^-1*cot(c+d*x)^2, x) == :(-1*a^-1*d^-1*cot(c+d*x)+b*a^-2*d^-1*arctanh(cos(c+d*x))+-2*a^-2*d^-1*(a^2+-1*b^2)^(1/2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x))))
@test integrate((a+b*sin(c+d*x))^-1*cot(c+d*x)^4, x) == :(2*a^-4*d^-1*(a^2+-1*b^2)^3//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//3*a^-1*d^-1*csc(c+d*x)^2*cot(c+d*x)+1//3*a^-3*d^-1*(-3*b^2+4*a^2)*cot(c+d*x)+(1/2)*b*a^-2*d^-1*cot(c+d*x)*csc(c+d*x)+-1//2*b*a^-4*d^-1*(-2*b^2+3*a^2)*arctanh(cos(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-1*cot(c+d*x)^6, x) == :(-1*b^-1*d^-1*cot(c+d*x)*csc(c+d*x)+-2*a^-6*d^-1*(a^2+-1*b^2)^5//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//5*a^-1*d^-1*csc(c+d*x)^4*cot(c+d*x)+-1//15*a^-5*d^-1*(15*b^4+23*a^4+-35*a^2*b^2)*cot(c+d*x)+(1/2)*a*b^-2*d^-1*csc(c+d*x)^2*cot(c+d*x)+1//4*b*a^-2*d^-1*csc(c+d*x)^3*cot(c+d*x)+1//8*b*a^-6*d^-1*(8*b^4+15*a^4+-20*a^2*b^2)*arctanh(cos(c+d*x))+-1//30*a^-3*b^-2*d^-1*csc(c+d*x)^2*(10*b^4+15*a^4+-22*a^2*b^2)*cot(c+d*x)+1//8*a^-4*b^-1*d^-1*(4*b^4+8*a^4+-9*a^2*b^2)*cot(c+d*x)*csc(c+d*x))
@test integrate((a+b*sin(c+d*x))^-2*tan(c+d*x)^5, x) == :(-1*a^5*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-3+-1//4*d^-1*(a^2+-1*b^2)^-3*sec(c+d*x)^2*(-2*b^4+4*a^4+6*a^2*b^2+-1*a*b*(-1*b^2+9*a^2)*sin(c+d*x))+1//4*d^-1*(a^2+-1*b^2)^-2*sec(c+d*x)^4*(a^2+b^2+-2*a*b*sin(c+d*x))+a^4*d^-1*(a^2+-1*b^2)^-4*(a^2+5*b^2)*log(a+b*sin(c+d*x))+-1//8*a*d^-1*(a+b)^-4*(b+4a)*log(1+-1*sin(c+d*x))+-1//8*a*d^-1*(a+-1b)^-4*(-1b+4a)*log(1+sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-2*tan(c+d*x)^3, x) == :(a^3*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-2+(1/2)*a*d^-1*(a+b)^-3*log(1+-1*sin(c+d*x))+(1/2)*a*d^-1*(a+-1b)^-3*log(1+sin(c+d*x))+(1/2)*d^-1*(a^2+-1*b^2)^-2*sec(c+d*x)^2*(a^2+b^2+-2*a*b*sin(c+d*x))+-1*a^2*d^-1*(a^2+-1*b^2)^-3*(a^2+3*b^2)*log(a+b*sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-2*tan(c+d*x), x) == :(-1//2*d^-1*(a+b)^-2*log(1+-1*sin(c+d*x))+-1//2*d^-1*(a+-1b)^-2*log(1+sin(c+d*x))+d^-1*(a^2+-1*b^2)^-2*(a^2+b^2)*log(a+b*sin(c+d*x))+-1*a*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-1)
@test integrate((a+b*sin(c+d*x))^-2*cot(c+d*x), x) == :(a^-1*d^-1*(a+b*sin(c+d*x))^-1+a^-2*d^-1*log(sin(c+d*x))+-1*a^-2*d^-1*log(a+b*sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-2*cot(c+d*x)^3, x) == :(-1//2*a^-2*d^-1*csc(c+d*x)^2+a^-4*d^-1*(a^2+-3*b^2)*log(a+b*sin(c+d*x))+-1*a^-4*d^-1*(a^2+-3*b^2)*log(sin(c+d*x))+-1*a^-3*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)+2*b*a^-3*d^-1*csc(c+d*x))
@test integrate((a+b*sin(c+d*x))^-2*cot(c+d*x)^5, x) == :(-1//4*a^-2*d^-1*csc(c+d*x)^4+a^-6*d^-1*(a^4+5*b^4+-6*a^2*b^2)*log(sin(c+d*x))+a^-5*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^2+(1/2)*a^-4*d^-1*csc(c+d*x)^2*(-3*b^2+2*a^2)+-1*a^-6*d^-1*(a^4+5*b^4+-6*a^2*b^2)*log(a+b*sin(c+d*x))+2//3*b*a^-3*d^-1*csc(c+d*x)^3+-4*b*a^-5*d^-1*(a^2+-1*b^2)*csc(c+d*x))
@test integrate((a+b*sin(c+d*x))^-2*tan(c+d*x)^4, x) == :(2*a^5*d^-1*(a^2+-1*b^2)^-7//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//12*d^-1*(1+sin(c+d*x))^-1*(a+-1b)^-2*cos(c+d*x)+-1//12*d^-1*(1+sin(c+d*x))^-2*(a+-1b)^-2*cos(c+d*x)+1//12*d^-1*(1+-1*sin(c+d*x))^-1*(a+b)^-2*cos(c+d*x)+1//12*d^-1*(1+-1*sin(c+d*x))^-2*(a+b)^-2*cos(c+d*x)+8*a^3*b^2*d^-1*(a^2+-1*b^2)^-7//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//4*d^-1*(1+-1*sin(c+d*x))^-1*(a+b)^-3*(b+3a)*cos(c+d*x)+1//4*d^-1*(1+sin(c+d*x))^-1*(a+-1b)^-3*(-1b+3a)*cos(c+d*x)+b*a^4*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-3*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^-2*tan(c+d*x)^2, x) == :((1/2)*d^-1*(1+-1*sin(c+d*x))^-1*(a+b)^-2*cos(c+d*x)+-2*a^3*d^-1*(a^2+-1*b^2)^-5//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//2*d^-1*(1+sin(c+d*x))^-1*(a+-1b)^-2*cos(c+d*x)+-4*a*b^2*d^-1*(a^2+-1*b^2)^-5//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1*b*a^2*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-2*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^-2*cot(c+d*x)^2, x) == :(-2*a^-2*d^-1*cot(c+d*x)+a^-1*d^-1*(a+b*sin(c+d*x))^-1*cot(c+d*x)+2*b*a^-3*d^-1*arctanh(cos(c+d*x))+-1*a^-3*d^-1*(a^2+-1*b^2)^-1//2*(-4*b^2+2*a^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x))))
@test integrate((a+b*sin(c+d*x))^-2*cot(c+d*x)^4, x) == :(1//3*a^-4*d^-1*(-12*b^2+7*a^2)*cot(c+d*x)+a^-5*d^-1*(a^2+-1*b^2)^-1//2*(2*a^4+8*b^4+-10*a^2*b^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1*b*a^-5*d^-1*(-4*b^2+3*a^2)*arctanh(cos(c+d*x))+-1//3*a^-1*d^-1*(a+b*sin(c+d*x))^-1*csc(c+d*x)^2*cot(c+d*x)+-1*a^-3*b^-1*d^-1*(a^2+-2*b^2)*cot(c+d*x)*csc(c+d*x)+1//3*a^-2*b^-1*d^-1*(a+b*sin(c+d*x))^-1*(-4*b^2+3*a^2)*cot(c+d*x)*csc(c+d*x))
@test integrate((a+b*sin(c+d*x))^-2*cot(c+d*x)^6, x) == :(-1//15*a^-6*d^-1*(38*a^4+90*b^4+-135*a^2*b^2)*cot(c+d*x)+-1*a^-7*d^-1*(a^2+-1*b^2)^3//2*(-12*b^2+2*a^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//2*b^-1*d^-1*(a+b*sin(c+d*x))^-1*cot(c+d*x)*csc(c+d*x)+-1//5*a^-1*d^-1*(a+b*sin(c+d*x))^-1*csc(c+d*x)^4*cot(c+d*x)+1//4*b*a^-7*d^-1*(15*a^4+24*b^4+-40*a^2*b^2)*arctanh(cos(c+d*x))+-1//30*a^-4*b^-2*d^-1*csc(c+d*x)^2*(15*a^4+60*b^4+-82*a^2*b^2)*cot(c+d*x)+1//4*a^-5*b^-1*d^-1*(4*a^4+12*b^4+-17*a^2*b^2)*cot(c+d*x)*csc(c+d*x)+1//6*a*b^-2*d^-1*(a+b*sin(c+d*x))^-1*csc(c+d*x)^2*cot(c+d*x)+3//10*b*a^-2*d^-1*(a+b*sin(c+d*x))^-1*csc(c+d*x)^3*cot(c+d*x)+1//6*a^-3*b^-2*d^-1*(a+b*sin(c+d*x))^-1*csc(c+d*x)^2*(2*a^4+9*b^4+-12*a^2*b^2)*cot(c+d*x))
@test integrate((a+b*sin(c+d*x))^-3*tan(c+d*x)^5, x) == :(-1//2*a^5*d^-1*(a+b*sin(c+d*x))^-2*(a^2+-1*b^2)^-3+-1//8*d^-1*(a^2+-1*b^2)^-4*sec(c+d*x)^2*(8*a^3*(a^2+5*b^2)+-1*b*(-1*b^4+27*a^4+22*a^2*b^2)*sin(c+d*x))+-1//16*d^-1*(a+b)^-5*(-1*b^2+8*a^2+-5*a*b)*log(1+-1*sin(c+d*x))+-1//16*d^-1*(a+-1b)^-5*(-1*b^2+8*a^2+5*a*b)*log(1+sin(c+d*x))+1//4*d^-1*(a^2+-1*b^2)^-3*sec(c+d*x)^4*(a*(a^2+3*b^2)+-1*b*(b^2+3*a^2)*sin(c+d*x))+a^3*d^-1*(a^2+-1*b^2)^-5*(a^4+10*b^4+13*a^2*b^2)*log(a+b*sin(c+d*x))+-1*a^4*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-4*(a^2+5*b^2))
@test integrate((a+b*sin(c+d*x))^-3*tan(c+d*x)^3, x) == :((1/2)*a^3*d^-1*(a+b*sin(c+d*x))^-2*(a^2+-1*b^2)^-2+(1/2)*d^-1*(a^2+-1*b^2)^-3*sec(c+d*x)^2*(a*(a^2+3*b^2)+-1*b*(b^2+3*a^2)*sin(c+d*x))+1//4*d^-1*(a+b)^-4*(-1b+2a)*log(1+-1*sin(c+d*x))+1//4*d^-1*(a+-1b)^-4*(b+2a)*log(1+sin(c+d*x))+a^2*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-3*(a^2+3*b^2)+-1*a*d^-1*(a^2+-1*b^2)^-4*(a^4+3*b^4+8*a^2*b^2)*log(a+b*sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-3*tan(c+d*x), x) == :(-1//2*d^-1*(a+b)^-3*log(1+-1*sin(c+d*x))+-1//2*d^-1*(a+-1b)^-3*log(1+sin(c+d*x))+-1*a*d^-1*(a+b*sin(c+d*x))^-2*(-2*b^2+2*a^2)^-1+-1*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-2*(a^2+b^2)+a*d^-1*(a^2+-1*b^2)^-3*(a^2+3*b^2)*log(a+b*sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-3*cot(c+d*x), x) == :(a^-3*d^-1*log(sin(c+d*x))+a^-2*d^-1*(a+b*sin(c+d*x))^-1+(1/2)*a^-1*d^-1*(a+b*sin(c+d*x))^-2+-1*a^-3*d^-1*log(a+b*sin(c+d*x)))
@test integrate((a+b*sin(c+d*x))^-3*cot(c+d*x)^3, x) == :(-1//2*a^-3*d^-1*csc(c+d*x)^2+a^-5*d^-1*(a^2+-6*b^2)*log(a+b*sin(c+d*x))+-1*a^-5*d^-1*(a^2+-6*b^2)*log(sin(c+d*x))+-1*a^-4*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-3*b^2)+3*b*a^-4*d^-1*csc(c+d*x)+-1//2*a^-3*d^-1*(a+b*sin(c+d*x))^-2*(a^2+-1*b^2))
@test integrate((a+b*sin(c+d*x))^-3*cot(c+d*x)^5, x) == :(-1//4*a^-3*d^-1*csc(c+d*x)^4+b*a^-4*d^-1*csc(c+d*x)^3+a^-7*d^-1*(a^4+15*b^4+-12*a^2*b^2)*log(sin(c+d*x))+a^-6*d^-1*(a+b*sin(c+d*x))^-1*(a^4+5*b^4+-6*a^2*b^2)+a^-5*d^-1*csc(c+d*x)^2*(a^2+-3*b^2)+(1/2)*a^-5*d^-1*(a+b*sin(c+d*x))^-2*(a^2+-1*b^2)^2+-1*a^-7*d^-1*(a^4+15*b^4+-12*a^2*b^2)*log(a+b*sin(c+d*x))+-2*b*a^-6*d^-1*(-5*b^2+3*a^2)*csc(c+d*x))
@test integrate((a+b*sin(c+d*x))^-3*tan(c+d*x)^4, x) == :(-1//12*d^-1*(1+sin(c+d*x))^-1*(a+-1b)^-3*cos(c+d*x)+-1//12*d^-1*(1+sin(c+d*x))^-2*(a+-1b)^-3*cos(c+d*x)+1//12*d^-1*(1+-1*sin(c+d*x))^-1*(a+b)^-3*cos(c+d*x)+1//12*d^-1*(1+-1*sin(c+d*x))^-2*(a+b)^-3*cos(c+d*x)+a^4*d^-1*(a^2+-1*b^2)^-9//2*(b^2+2*a^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+8*a^4*b^2*d^-1*(a^2+-1*b^2)^-9//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-3//4*a*d^-1*(1+-1*sin(c+d*x))^-1*(a+b)^-4*cos(c+d*x)+3//4*a*d^-1*(1+sin(c+d*x))^-1*(a+-1b)^-4*cos(c+d*x)+(1/2)*b*a^4*d^-1*(a+b*sin(c+d*x))^-2*(a^2+-1*b^2)^-3*cos(c+d*x)+4*a^3*b^3*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-4*cos(c+d*x)+12*a^2*b^2*d^-1*(a^2+-1*b^2)^-9//2*(a^2+b^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+3//2*b*a^5*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-4*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^-3*tan(c+d*x)^2, x) == :((1/2)*d^-1*(1+-1*sin(c+d*x))^-1*(a+b)^-3*cos(c+d*x)+-1//2*d^-1*(1+sin(c+d*x))^-1*(a+-1b)^-3*cos(c+d*x)+-1*a^2*d^-1*(a^2+-1*b^2)^-7//2*(b^2+2*a^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-4*a^2*b^2*d^-1*(a^2+-1*b^2)^-7//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-2*b^2*d^-1*(a^2+-1*b^2)^-7//2*(b^2+3*a^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-2*a*b^3*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-3*cos(c+d*x)+-3//2*b*a^3*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-3*cos(c+d*x)+-1//2*b*a^2*d^-1*(a+b*sin(c+d*x))^-2*(a^2+-1*b^2)^-2*cos(c+d*x))
@test integrate((a+b*sin(c+d*x))^-3*cot(c+d*x)^2, x) == :((1/2)*a^-1*d^-1*(a+b*sin(c+d*x))^-2*cot(c+d*x)+3*b*a^-4*d^-1*arctanh(cos(c+d*x))+-1*a^-4*d^-1*(a^2+-1*b^2)^-3//2*(2*a^4+6*b^4+-9*a^2*b^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//2*a^-3*d^-1*(a^2+-1*b^2)^-1*(-6*b^2+5*a^2)*cot(c+d*x)+(1/2)*a^-2*d^-1*(a+b*sin(c+d*x))^-1*(a^2+-1*b^2)^-1*(-3*b^2+2*a^2)*cot(c+d*x))
@test integrate((a+b*sin(c+d*x))^-3*cot(c+d*x)^4, x) == :(1//6*a^-5*d^-1*(-60*b^2+17*a^2)*cot(c+d*x)+a^-6*d^-1*(a^2+-1*b^2)^-1//2*(2*a^4+20*b^4+-19*a^2*b^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//2*b*a^-6*d^-1*(-20*b^2+9*a^2)*arctanh(cos(c+d*x))+-1//3*a^-1*d^-1*(a+b*sin(c+d*x))^-2*csc(c+d*x)^2*cot(c+d*x)+-1*a^-4*b^-1*d^-1*(a^2+-5*b^2)*cot(c+d*x)*csc(c+d*x)+1//6*a^-3*b^-1*d^-1*(a+b*sin(c+d*x))^-1*(-20*b^2+3*a^2)*cot(c+d*x)*csc(c+d*x)+1//6*a^-2*b^-1*d^-1*(a+b*sin(c+d*x))^-2*(-5*b^2+3*a^2)*cot(c+d*x)*csc(c+d*x))
@test integrate((a+b*sin(c+d*x))^-3*cot(c+d*x)^6, x) == :(-1//30*a^-7*d^-1*(91*a^4+630*b^4+-645*a^2*b^2)*cot(c+d*x)+-1*a^-8*d^-1*(a^2+-1*b^2)^(1/2)*(2*a^4+42*b^4+-29*a^2*b^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*c+(1/2)*d*x)))+-1//3*b^-1*d^-1*(a+b*sin(c+d*x))^-2*cot(c+d*x)*csc(c+d*x)+-1//5*a^-1*d^-1*(a+b*sin(c+d*x))^-2*csc(c+d*x)^4*cot(c+d*x)+1//8*b*a^-8*d^-1*(45*a^4+168*b^4+-200*a^2*b^2)*arctanh(cos(c+d*x))+-1//30*a^-5*b^-2*d^-1*csc(c+d*x)^2*(15*a^4+210*b^4+-187*a^2*b^2)*cot(c+d*x)+1//8*a^-6*b^-1*d^-1*(8*a^4+84*b^4+-79*a^2*b^2)*cot(c+d*x)*csc(c+d*x)+1//12*a*b^-2*d^-1*(a+b*sin(c+d*x))^-2*csc(c+d*x)^2*cot(c+d*x)+7//20*b*a^-2*d^-1*(a+b*sin(c+d*x))^-2*csc(c+d*x)^3*cot(c+d*x)+1//12*a^-4*b^-2*d^-1*(a+b*sin(c+d*x))^-1*csc(c+d*x)^2*(4*a^4+63*b^4+-54*a^2*b^2)*cot(c+d*x)+1//60*a^-3*b^-2*d^-1*(a+b*sin(c+d*x))^-2*csc(c+d*x)^2*(5*a^4+63*b^4+-60*a^2*b^2)*cot(c+d*x))

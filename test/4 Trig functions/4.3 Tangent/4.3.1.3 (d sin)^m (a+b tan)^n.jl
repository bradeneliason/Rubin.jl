using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((im+tan(x))^-1*sin(x)^4, x) == :(-5//32*(im+tan(x))^-2+-1//32*(im+-1*tan(x))^-2+-1*im*(-8*tan(x)+8im)^-1+-3*im*(16im+16*tan(x))^-1+-1//16*im*x+1//24*im*(im+tan(x))^-3)
@test integrate((im+tan(x))^-1*sin(x)^3, x) == :(1//5*sin(x)^5+-1//5*im*cos(x)^5+1//3*im*cos(x)^3)
@test integrate((im+tan(x))^-1*sin(x)^2, x) == :(-1//8*(im+tan(x))^-2+-1*im*(-8*tan(x)+8im)^-1+-1*im*(4im+4*tan(x))^-1+-1//8*im*x)
@test integrate((im+tan(x))^-1*sin(x), x) == :(1//3*sin(x)^3+1//3*im*cos(x)^3)
@test integrate((im+tan(x))^-1*csc(x), x) == :(im*arctanh(cos(x))+-1*im*cos(x)+sin(x))
@test integrate((im+tan(x))^-1*csc(x)^2, x) == :(im*x+im*cot(x)+log(cos(x))+log(tan(x)))
@test integrate((im+tan(x))^-1*csc(x)^3, x) == :(-1*csc(x)+-1//2*im*arctanh(cos(x))+(1/2)*im*cot(x)*csc(x))
@test integrate((im+tan(x))^-1*csc(x)^4, x) == :(-1//2*cot(x)^2+1//3*im*cot(x)^3)
@test integrate((im+tan(x))^-1*csc(x)^5, x) == :(-1//3*csc(x)^3+-1//8*im*arctanh(cos(x))+-1//8*im*cot(x)*csc(x)+1//4*im*csc(x)^3*cot(x))
@test integrate((im+tan(x))^-1*csc(x)^6, x) == :(-1//2*cot(x)^2+-1//4*cot(x)^4+1//3*im*cot(x)^3+1//5*im*cot(x)^5)
@test integrate(sin(c+d*x)^5*(a+b*tan(c+d*x)), x) == :(b*d^-1*arctanh(sin(c+d*x))+-1*a*d^-1*cos(c+d*x)+-1*b*d^-1*sin(c+d*x)+-1//3*b*d^-1*sin(c+d*x)^3+-1//5*a*d^-1*cos(c+d*x)^5+-1//5*b*d^-1*sin(c+d*x)^5+2//3*a*d^-1*cos(c+d*x)^3)
@test integrate(sin(c+d*x)^4*(a+b*tan(c+d*x)), x) == :(3//8*a*x+-1*b*d^-1*log(cos(c+d*x))+-1//4*d^-1*sin(c+d*x)^3*(a+b*tan(c+d*x))*cos(c+d*x)+-1//8*d^-1*(3a+4*b*tan(c+d*x))*cos(c+d*x)*sin(c+d*x))
@test integrate(sin(c+d*x)^3*(a+b*tan(c+d*x)), x) == :(b*d^-1*arctanh(sin(c+d*x))+-1*a*d^-1*cos(c+d*x)+-1*b*d^-1*sin(c+d*x)+-1//3*b*d^-1*sin(c+d*x)^3+1//3*a*d^-1*cos(c+d*x)^3)
@test integrate(sin(c+d*x)^2*(a+b*tan(c+d*x)), x) == :((1/2)*a*x+-1*b*d^-1*log(cos(c+d*x))+-1//2*d^-1*(a+b*tan(c+d*x))*cos(c+d*x)*sin(c+d*x))
@test integrate((a+b*tan(c+d*x))*sin(c+d*x), x) == :(b*d^-1*arctanh(sin(c+d*x))+-1*a*d^-1*cos(c+d*x)+-1*b*d^-1*sin(c+d*x))
@test integrate((a+b*tan(c+d*x))*csc(c+d*x), x) == :(b*d^-1*arctanh(sin(c+d*x))+-1*a*d^-1*arctanh(cos(c+d*x)))
@test integrate(csc(c+d*x)^2*(a+b*tan(c+d*x)), x) == :(b*d^-1*log(tan(c+d*x))+-1*a*d^-1*cot(c+d*x))
@test integrate(csc(c+d*x)^3*(a+b*tan(c+d*x)), x) == :(b*d^-1*arctanh(sin(c+d*x))+-1*b*d^-1*csc(c+d*x)+-1//2*a*d^-1*arctanh(cos(c+d*x))+-1//2*a*d^-1*cot(c+d*x)*csc(c+d*x))
@test integrate(csc(c+d*x)^4*(a+b*tan(c+d*x)), x) == :(b*d^-1*log(tan(c+d*x))+-1*a*d^-1*cot(c+d*x)+-1//2*b*d^-1*cot(c+d*x)^2+-1//3*a*d^-1*cot(c+d*x)^3)
@test integrate(csc(c+d*x)^5*(a+b*tan(c+d*x)), x) == :(b*d^-1*arctanh(sin(c+d*x))+-1*b*d^-1*csc(c+d*x)+-3//8*a*d^-1*arctanh(cos(c+d*x))+-1//3*b*d^-1*csc(c+d*x)^3+-3//8*a*d^-1*cot(c+d*x)*csc(c+d*x)+-1//4*a*d^-1*csc(c+d*x)^3*cot(c+d*x))
@test integrate(csc(c+d*x)^6*(a+b*tan(c+d*x)), x) == :(b*d^-1*log(tan(c+d*x))+-1*a*d^-1*cot(c+d*x)+-1*b*d^-1*cot(c+d*x)^2+-2//3*a*d^-1*cot(c+d*x)^3+-1//4*b*d^-1*cot(c+d*x)^4+-1//5*a*d^-1*cot(c+d*x)^5)
@test integrate((a+b*tan(c+d*x))^2*sin(c+d*x)^4, x) == :(x*(-15//8*b^2+3//8*a^2)+b^2*d^-1*tan(c+d*x)+-2*a*b*d^-1*log(cos(c+d*x))+1//4*d^-1*(a+b*tan(c+d*x))^2*cos(c+d*x)^3*sin(c+d*x)+1//8*d^-1*cos(c+d*x)^2*(a+b*tan(c+d*x))*(7b+-5*a*tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^2*sin(c+d*x)^3, x) == :(b^2*d^-1*sec(c+d*x)+-1*a^2*d^-1*cos(c+d*x)+2*b^2*d^-1*cos(c+d*x)+-1//3*b^2*d^-1*cos(c+d*x)^3+1//3*a^2*d^-1*cos(c+d*x)^3+-2*a*b*d^-1*sin(c+d*x)+2*a*b*d^-1*arctanh(sin(c+d*x))+-2//3*a*b*d^-1*sin(c+d*x)^3)
@test integrate((a+b*tan(c+d*x))^2*sin(c+d*x)^2, x) == :(x*((1/2)*a^2+-3//2*b^2)+3//2*b^2*d^-1*tan(c+d*x)+-2*a*b*d^-1*log(cos(c+d*x))+-1//2*d^-1*(a+b*tan(c+d*x))^2*cos(c+d*x)*sin(c+d*x))
@test integrate((a+b*tan(c+d*x))^2*sin(c+d*x), x) == :(b^2*d^-1*cos(c+d*x)+b^2*d^-1*sec(c+d*x)+-1*a^2*d^-1*cos(c+d*x)+-2*a*b*d^-1*sin(c+d*x)+2*a*b*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^2*csc(c+d*x), x) == :(b^2*d^-1*sec(c+d*x)+-1*a^2*d^-1*arctanh(cos(c+d*x))+2*a*b*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^2*csc(c+d*x)^2, x) == :(b^2*d^-1*tan(c+d*x)+-1*a^2*d^-1*cot(c+d*x)+2*a*b*d^-1*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^2*csc(c+d*x)^3, x) == :(b^2*d^-1*sec(c+d*x)+-1*b^2*d^-1*arctanh(cos(c+d*x))+-1//2*a^2*d^-1*arctanh(cos(c+d*x))+-2*a*b*d^-1*csc(c+d*x)+2*a*b*d^-1*arctanh(sin(c+d*x))+-1//2*a^2*d^-1*cot(c+d*x)*csc(c+d*x))
@test integrate((a+b*tan(c+d*x))^2*csc(c+d*x)^4, x) == :(b^2*d^-1*tan(c+d*x)+-1*d^-1*(a^2+b^2)*cot(c+d*x)+-1//3*a^2*d^-1*cot(c+d*x)^3+-1*a*b*d^-1*cot(c+d*x)^2+2*a*b*d^-1*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^2*csc(c+d*x)^5, x) == :(-3//2*b^2*d^-1*arctanh(cos(c+d*x))+-3//8*a^2*d^-1*arctanh(cos(c+d*x))+3//2*b^2*d^-1*sec(c+d*x)+-2*a*b*d^-1*csc(c+d*x)+2*a*b*d^-1*arctanh(sin(c+d*x))+-3//8*a^2*d^-1*cot(c+d*x)*csc(c+d*x)+-2//3*a*b*d^-1*csc(c+d*x)^3+-1//2*b^2*d^-1*csc(c+d*x)^2*sec(c+d*x)+-1//4*a^2*d^-1*csc(c+d*x)^3*cot(c+d*x))
@test integrate((a+b*tan(c+d*x))^2*csc(c+d*x)^6, x) == :(b^2*d^-1*tan(c+d*x)+-1*d^-1*(a^2+2*b^2)*cot(c+d*x)+-1//3*d^-1*cot(c+d*x)^3*(b^2+2*a^2)+-1//5*a^2*d^-1*cot(c+d*x)^5+-2*a*b*d^-1*cot(c+d*x)^2+2*a*b*d^-1*log(tan(c+d*x))+-1//2*a*b*d^-1*cot(c+d*x)^4)
@test integrate((a+b*tan(c+d*x))^3*sin(c+d*x)^3, x) == :(-1*a^3*d^-1*cos(c+d*x)+-5//2*b^3*d^-1*arctanh(sin(c+d*x))+1//3*a^3*d^-1*cos(c+d*x)^3+5//2*b^3*d^-1*sin(c+d*x)+5//6*b^3*d^-1*sin(c+d*x)^3+(1/2)*b^3*d^-1*sin(c+d*x)^3*tan(c+d*x)^2+-1*a*b^2*d^-1*cos(c+d*x)^3+-1*b*a^2*d^-1*sin(c+d*x)^3+-3*b*a^2*d^-1*sin(c+d*x)+3*a*b^2*d^-1*sec(c+d*x)+3*b*a^2*d^-1*arctanh(sin(c+d*x))+6*a*b^2*d^-1*cos(c+d*x))
@test integrate((a+b*tan(c+d*x))^3*sin(c+d*x)^2, x) == :(b^3*d^-1*tan(c+d*x)^2+(1/2)*a*x*(a^2+-9*b^2)+-1*b*d^-1*(-2*b^2+3*a^2)*log(cos(c+d*x))+-1//2*d^-1*(a+b*tan(c+d*x))^3*cos(c+d*x)*sin(c+d*x)+9//2*a*b^2*d^-1*tan(c+d*x))
@test integrate((a+b*tan(c+d*x))^3*sin(c+d*x), x) == :(-1*a^3*d^-1*cos(c+d*x)+-3//2*b^3*d^-1*arctanh(sin(c+d*x))+3//2*b^3*d^-1*sin(c+d*x)+(1/2)*b^3*d^-1*tan(c+d*x)^2*sin(c+d*x)+-3*b*a^2*d^-1*sin(c+d*x)+3*a*b^2*d^-1*cos(c+d*x)+3*a*b^2*d^-1*sec(c+d*x)+3*b*a^2*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^3*csc(c+d*x), x) == :(-1*a^3*d^-1*arctanh(cos(c+d*x))+-1//2*b^3*d^-1*arctanh(sin(c+d*x))+(1/2)*b^3*d^-1*sec(c+d*x)*tan(c+d*x)+3*a*b^2*d^-1*sec(c+d*x)+3*b*a^2*d^-1*arctanh(sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^3*csc(c+d*x)^2, x) == :((1/2)*b^3*d^-1*tan(c+d*x)^2+-1*a^3*d^-1*cot(c+d*x)+3*a*b^2*d^-1*tan(c+d*x)+3*b*a^2*d^-1*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^3*csc(c+d*x)^3, x) == :((1/2)*b^3*d^-1*arctanh(sin(c+d*x))+-1//2*a^3*d^-1*arctanh(cos(c+d*x))+(1/2)*b^3*d^-1*sec(c+d*x)*tan(c+d*x)+-3*a*b^2*d^-1*arctanh(cos(c+d*x))+-3*b*a^2*d^-1*csc(c+d*x)+3*a*b^2*d^-1*sec(c+d*x)+3*b*a^2*d^-1*arctanh(sin(c+d*x))+-1//2*a^3*d^-1*cot(c+d*x)*csc(c+d*x))
@test integrate((a+b*tan(c+d*x))^3*csc(c+d*x)^4, x) == :((1/2)*b^3*d^-1*tan(c+d*x)^2+-1//3*a^3*d^-1*cot(c+d*x)^3+b*d^-1*(b^2+3*a^2)*log(tan(c+d*x))+-1*a*d^-1*(a^2+3*b^2)*cot(c+d*x)+3*a*b^2*d^-1*tan(c+d*x)+-3//2*b*a^2*d^-1*cot(c+d*x)^2)
@test integrate((a+b*tan(c+d*x))^3*csc(c+d*x)^5, x) == :(-3//2*b^3*d^-1*csc(c+d*x)+-3//8*a^3*d^-1*arctanh(cos(c+d*x))+3//2*b^3*d^-1*arctanh(sin(c+d*x))+(1/2)*b^3*d^-1*sec(c+d*x)^2*csc(c+d*x)+-1*b*a^2*d^-1*csc(c+d*x)^3+-3*b*a^2*d^-1*csc(c+d*x)+3*b*a^2*d^-1*arctanh(sin(c+d*x))+-9//2*a*b^2*d^-1*arctanh(cos(c+d*x))+-3//8*a^3*d^-1*cot(c+d*x)*csc(c+d*x)+-1//4*a^3*d^-1*csc(c+d*x)^3*cot(c+d*x)+9//2*a*b^2*d^-1*sec(c+d*x)+-3//2*a*b^2*d^-1*csc(c+d*x)^2*sec(c+d*x))
@test integrate((a+b*tan(c+d*x))^3*csc(c+d*x)^6, x) == :((1/2)*b^3*d^-1*tan(c+d*x)^2+-1//5*a^3*d^-1*cot(c+d*x)^5+b*d^-1*(2*b^2+3*a^2)*log(tan(c+d*x))+-1*a*d^-1*(a^2+6*b^2)*cot(c+d*x)+3*a*b^2*d^-1*tan(c+d*x)+-3//4*b*a^2*d^-1*cot(c+d*x)^4+-1//2*b*d^-1*cot(c+d*x)^2*(b^2+6*a^2)+-1//3*a*d^-1*cot(c+d*x)^3*(2*a^2+3*b^2))
@test integrate((a+b*tan(c+d*x))^4*sin(c+d*x)^3, x) == :(-1*a^4*d^-1*cos(c+d*x)+-3*b^4*d^-1*cos(c+d*x)+-3*b^4*d^-1*sec(c+d*x)+1//3*a^4*d^-1*cos(c+d*x)^3+1//3*b^4*d^-1*cos(c+d*x)^3+1//3*b^4*d^-1*sec(c+d*x)^3+-10*a*b^3*d^-1*arctanh(sin(c+d*x))+-4*b*a^3*d^-1*sin(c+d*x)+-2*a^2*b^2*d^-1*cos(c+d*x)^3+4*b*a^3*d^-1*arctanh(sin(c+d*x))+6*a^2*b^2*d^-1*sec(c+d*x)+10*a*b^3*d^-1*sin(c+d*x)+12*a^2*b^2*d^-1*cos(c+d*x)+-4//3*b*a^3*d^-1*sin(c+d*x)^3+10//3*a*b^3*d^-1*sin(c+d*x)^3+2*a*b^3*d^-1*sin(c+d*x)^3*tan(c+d*x)^2)
@test integrate((a+b*tan(c+d*x))^4*sin(c+d*x)^2, x) == :(x*((1/2)*a^4+5//2*b^4+-9*a^2*b^2)+5//6*b^4*d^-1*tan(c+d*x)^3+(1/2)*b^2*d^-1*(-5*b^2+18*a^2)*tan(c+d*x)+4*a*b^3*d^-1*tan(c+d*x)^2+-1//2*d^-1*(a+b*tan(c+d*x))^4*cos(c+d*x)*sin(c+d*x)+-4*a*b*d^-1*(a^2+-2*b^2)*log(cos(c+d*x)))
@test integrate((a+b*tan(c+d*x))^4*sin(c+d*x), x) == :(-1*a^4*d^-1*cos(c+d*x)+-1*b^4*d^-1*cos(c+d*x)+-2*b^4*d^-1*sec(c+d*x)+1//3*b^4*d^-1*sec(c+d*x)^3+-6*a*b^3*d^-1*arctanh(sin(c+d*x))+-4*b*a^3*d^-1*sin(c+d*x)+4*b*a^3*d^-1*arctanh(sin(c+d*x))+6*a*b^3*d^-1*sin(c+d*x)+6*a^2*b^2*d^-1*cos(c+d*x)+6*a^2*b^2*d^-1*sec(c+d*x)+2*a*b^3*d^-1*tan(c+d*x)^2*sin(c+d*x))
@test integrate((a+b*tan(c+d*x))^4*csc(c+d*x), x) == :(-1*a^4*d^-1*arctanh(cos(c+d*x))+-1*b^4*d^-1*sec(c+d*x)+1//3*b^4*d^-1*sec(c+d*x)^3+-2*a*b^3*d^-1*arctanh(sin(c+d*x))+4*b*a^3*d^-1*arctanh(sin(c+d*x))+6*a^2*b^2*d^-1*sec(c+d*x)+2*a*b^3*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a+b*tan(c+d*x))^4*csc(c+d*x)^2, x) == :(-1*a^4*d^-1*cot(c+d*x)+1//3*b^4*d^-1*tan(c+d*x)^3+2*a*b^3*d^-1*tan(c+d*x)^2+4*b*a^3*d^-1*log(tan(c+d*x))+6*a^2*b^2*d^-1*tan(c+d*x))
@test integrate((a+b*tan(c+d*x))^4*csc(c+d*x)^3, x) == :(-1//2*a^4*d^-1*arctanh(cos(c+d*x))+1//3*b^4*d^-1*sec(c+d*x)^3+-6*a^2*b^2*d^-1*arctanh(cos(c+d*x))+-4*b*a^3*d^-1*csc(c+d*x)+2*a*b^3*d^-1*arctanh(sin(c+d*x))+4*b*a^3*d^-1*arctanh(sin(c+d*x))+6*a^2*b^2*d^-1*sec(c+d*x)+-1//2*a^4*d^-1*cot(c+d*x)*csc(c+d*x)+2*a*b^3*d^-1*sec(c+d*x)*tan(c+d*x))
@test integrate((a+b*tan(c+d*x))^4*csc(c+d*x)^4, x) == :(-1//3*a^4*d^-1*cot(c+d*x)^3+1//3*b^4*d^-1*tan(c+d*x)^3+b^2*d^-1*(b^2+6*a^2)*tan(c+d*x)+-1*a^2*d^-1*(a^2+6*b^2)*cot(c+d*x)+-2*b*a^3*d^-1*cot(c+d*x)^2+2*a*b^3*d^-1*tan(c+d*x)^2+4*a*b*d^-1*(a^2+b^2)*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^4*csc(c+d*x)^5, x) == :(b^4*d^-1*sec(c+d*x)+-1*b^4*d^-1*arctanh(cos(c+d*x))+-3//8*a^4*d^-1*arctanh(cos(c+d*x))+1//3*b^4*d^-1*sec(c+d*x)^3+-9*a^2*b^2*d^-1*arctanh(cos(c+d*x))+-6*a*b^3*d^-1*csc(c+d*x)+-4*b*a^3*d^-1*csc(c+d*x)+4*b*a^3*d^-1*arctanh(sin(c+d*x))+6*a*b^3*d^-1*arctanh(sin(c+d*x))+9*a^2*b^2*d^-1*sec(c+d*x)+-4//3*b*a^3*d^-1*csc(c+d*x)^3+-3//8*a^4*d^-1*cot(c+d*x)*csc(c+d*x)+-1//4*a^4*d^-1*csc(c+d*x)^3*cot(c+d*x)+-3*a^2*b^2*d^-1*csc(c+d*x)^2*sec(c+d*x)+2*a*b^3*d^-1*sec(c+d*x)^2*csc(c+d*x))
@test integrate((a+b*tan(c+d*x))^4*csc(c+d*x)^6, x) == :(-1*d^-1*(a^4+b^4+12*a^2*b^2)*cot(c+d*x)+-1//5*a^4*d^-1*cot(c+d*x)^5+1//3*b^4*d^-1*tan(c+d*x)^3+-1*b*a^3*d^-1*cot(c+d*x)^4+2*a*b^3*d^-1*tan(c+d*x)^2+2*b^2*d^-1*(b^2+3*a^2)*tan(c+d*x)+-2//3*a^2*d^-1*cot(c+d*x)^3*(a^2+3*b^2)+-2*a*b*d^-1*cot(c+d*x)^2*(b^2+2*a^2)+4*a*b*d^-1*(a^2+2*b^2)*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^4*csc(c+d*x)^7, x) == :(-5//2*b^4*d^-1*arctanh(cos(c+d*x))+-5//16*a^4*d^-1*arctanh(cos(c+d*x))+5//2*b^4*d^-1*sec(c+d*x)+5//6*b^4*d^-1*sec(c+d*x)^3+-10*a*b^3*d^-1*csc(c+d*x)+-4*b*a^3*d^-1*csc(c+d*x)+4*b*a^3*d^-1*arctanh(sin(c+d*x))+10*a*b^3*d^-1*arctanh(sin(c+d*x))+-45//4*a^2*b^2*d^-1*arctanh(cos(c+d*x))+-10//3*a*b^3*d^-1*csc(c+d*x)^3+-5//16*a^4*d^-1*cot(c+d*x)*csc(c+d*x)+-5//24*a^4*d^-1*csc(c+d*x)^3*cot(c+d*x)+-4//3*b*a^3*d^-1*csc(c+d*x)^3+-4//5*b*a^3*d^-1*csc(c+d*x)^5+-1//2*b^4*d^-1*csc(c+d*x)^2*sec(c+d*x)^3+-1//6*a^4*d^-1*csc(c+d*x)^5*cot(c+d*x)+45//4*a^2*b^2*d^-1*sec(c+d*x)+2*a*b^3*d^-1*csc(c+d*x)^3*sec(c+d*x)^2+-15//4*a^2*b^2*d^-1*csc(c+d*x)^2*sec(c+d*x)+-3//2*a^2*b^2*d^-1*csc(c+d*x)^4*sec(c+d*x))
@test integrate((a+b*tan(c+d*x))^-1*sin(c+d*x)^5, x) == :(b*d^-1*(5*a^2+5*b^2)^-1*sin(c+d*x)^5+-1*a*d^-1*(a^2+b^2)^-1*cos(c+d*x)+-1*a*d^-1*(5*a^2+5*b^2)^-1*cos(c+d*x)^5+2*a*d^-1*(3*a^2+3*b^2)^-1*cos(c+d*x)^3+a*b^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)+b*a^4*d^-1*(a^2+b^2)^-3*sin(c+d*x)+b*a^5*d^-1*(a^2+b^2)^-7//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+a^3*b^2*d^-1*(a^2+b^2)^-3*cos(c+d*x)+-1//3*a*b^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)^3+1//3*b*a^2*d^-1*(a^2+b^2)^-2*sin(c+d*x)^3)
@test integrate((a+b*tan(c+d*x))^-1*sin(c+d*x)^4, x) == :(d^-1*(4*a^2+4*b^2)^-1*cos(c+d*x)^4*(b+a*tan(c+d*x))+-1//8*d^-1*(a^2+b^2)^-2*cos(c+d*x)^2*(4*b*(b^2+2*a^2)+a*(b^2+5*a^2)*tan(c+d*x))+1//8*a*x*(a^2+b^2)^-3*(-1*b^4+3*a^4+-6*a^2*b^2)+b*a^4*d^-1*(a^2+b^2)^-3*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-1*sin(c+d*x)^3, x) == :(a*d^-1*(3*a^2+3*b^2)^-1*cos(c+d*x)^3+b*d^-1*(3*a^2+3*b^2)^-1*sin(c+d*x)^3+-1*a*d^-1*(a^2+b^2)^-1*cos(c+d*x)+a*b^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)+b*a^2*d^-1*(a^2+b^2)^-2*sin(c+d*x)+b*a^3*d^-1*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a+b*tan(c+d*x))^-1*sin(c+d*x)^2, x) == :((1/2)*a*x*(a^2+b^2)^-2*(a^2+-1*b^2)+-1*d^-1*(2*a^2+2*b^2)^-1*cos(c+d*x)^2*(b+a*tan(c+d*x))+b*a^2*d^-1*(a^2+b^2)^-2*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-1*sin(c+d*x), x) == :(b*d^-1*(a^2+b^2)^-1*sin(c+d*x)+-1*a*d^-1*(a^2+b^2)^-1*cos(c+d*x)+a*b*d^-1*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a+b*tan(c+d*x))^-1*csc(c+d*x), x) == :(-1*a^-1*d^-1*arctanh(cos(c+d*x))+b*a^-1*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a+b*tan(c+d*x))^-1*csc(c+d*x)^2, x) == :(-1*a^-1*d^-1*cot(c+d*x)+b*a^-2*d^-1*log(a+b*tan(c+d*x))+-1*b*a^-2*d^-1*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-1*csc(c+d*x)^3, x) == :(-1//2*a^-1*d^-1*arctanh(cos(c+d*x))+b*a^-2*d^-1*csc(c+d*x)+-1*a^-3*b^2*d^-1*arctanh(cos(c+d*x))+-1//2*a^-1*d^-1*cot(c+d*x)*csc(c+d*x)+b*a^-3*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a+b*tan(c+d*x))^-1*csc(c+d*x)^4, x) == :(-1//3*a^-1*d^-1*cot(c+d*x)^3+(1/2)*b*a^-2*d^-1*cot(c+d*x)^2+-1*a^-3*d^-1*(a^2+b^2)*cot(c+d*x)+b*a^-4*d^-1*(a^2+b^2)*log(a+b*tan(c+d*x))+-1*b*a^-4*d^-1*(a^2+b^2)*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-1*csc(c+d*x)^6, x) == :(-1//5*a^-1*d^-1*cot(c+d*x)^5+-1*a^-5*d^-1*(a^2+b^2)^2*cot(c+d*x)+-1//3*a^-3*d^-1*cot(c+d*x)^3*(b^2+2*a^2)+1//4*b*a^-2*d^-1*cot(c+d*x)^4+b*a^-6*d^-1*(a^2+b^2)^2*log(a+b*tan(c+d*x))+(1/2)*b*a^-4*d^-1*cot(c+d*x)^2*(b^2+2*a^2)+-1*b*a^-6*d^-1*(a^2+b^2)^2*log(tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*sin(c+d*x)^6, x) == :(1//16*x*(a^2+b^2)^-5*(b^8+5*a^8+-80*a^6*b^2+8*a^2*b^6+50*a^4*b^4)+-1//6*d^-1*(a^2+b^2)^-2*cos(c+d*x)^6*((a^2+-1*b^2)*tan(c+d*x)+2*a*b)+-1//16*d^-1*(a^2+b^2)^-4*cos(c+d*x)^2*((-1*b^6+11*a^6+-43*a^4*b^2+-7*a^2*b^4)*tan(c+d*x)+48*b*a^5)+1//24*d^-1*(a^2+b^2)^-3*cos(c+d*x)^4*((-7*b^4+13*a^4+-18*a^2*b^2)*tan(c+d*x)+12*a*b*(b^2+3*a^2))+-1*b*a^6*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-4+2*b*a^5*d^-1*(a^2+b^2)^-5*(a^2+-3*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*sin(c+d*x)^4, x) == :(1//8*x*(a^2+b^2)^-4*(b^6+3*a^6+-33*a^4*b^2+13*a^2*b^4)+-1//8*d^-1*(a^2+b^2)^-3*cos(c+d*x)^2*((-1*b^4+5*a^4+-12*a^2*b^2)*tan(c+d*x)+16*b*a^3)+1//4*d^-1*(a^2+b^2)^-2*cos(c+d*x)^4*((a^2+-1*b^2)*tan(c+d*x)+2*a*b)+-1*b*a^4*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-3+2*b*a^3*d^-1*(a^2+b^2)^-4*(a^2+-2*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*sin(c+d*x)^2, x) == :((1/2)*x*(a^2+b^2)^-3*(a^4+b^4+-6*a^2*b^2)+-1//2*d^-1*(a^2+b^2)^-2*cos(c+d*x)^2*((a^2+-1*b^2)*tan(c+d*x)+2*a*b)+-1*b*a^2*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-2+2*a*b*d^-1*(a^2+b^2)^-3*(a^2+-1*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*csc(c+d*x)^2, x) == :(-1*a^-2*d^-1*cot(c+d*x)+-1*b*a^-2*d^-1*(a+b*tan(c+d*x))^-1+-2*b*a^-3*d^-1*log(tan(c+d*x))+2*b*a^-3*d^-1*log(a+b*tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*csc(c+d*x)^4, x) == :(-1//3*a^-2*d^-1*cot(c+d*x)^3+b*a^-3*d^-1*cot(c+d*x)^2+-1*a^-4*d^-1*(a^2+3*b^2)*cot(c+d*x)+-1*b*a^-4*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)+-2*b*a^-5*d^-1*(a^2+2*b^2)*log(tan(c+d*x))+2*b*a^-5*d^-1*(a^2+2*b^2)*log(a+b*tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*csc(c+d*x)^6, x) == :(-1//5*a^-2*d^-1*cot(c+d*x)^5+(1/2)*b*a^-3*d^-1*cot(c+d*x)^4+-1//3*a^-4*d^-1*cot(c+d*x)^3*(2*a^2+3*b^2)+-1*b*a^-6*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^2+-1*a^-6*d^-1*(a^2+b^2)*(a^2+5*b^2)*cot(c+d*x)+2*b*a^-5*d^-1*cot(c+d*x)^2*(a^2+b^2)+-2*b*a^-7*d^-1*(a^2+b^2)*(a^2+3*b^2)*log(tan(c+d*x))+2*b*a^-7*d^-1*(a^2+b^2)*(a^2+3*b^2)*log(a+b*tan(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*sin(c+d*x)^5, x) == :(-3//64*d^-1*(a+b*tan(c+d*x))^-2*(a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^2*((a^2+b^2)^-3*(8*a^4+8*b^4+-48*a^2*b^2)*cos(c+d*x)+-1//3*(a^2+b^2)^-2*(-4*b^2+4*a^2)*cos(3c+3*d*x)+a*(a^2+b^2)^-3*(a*cos(c+d*x)+b*sin(c+d*x))^-1*(a^4+5*b^4+-10*a^2*b^2)+10*b*(a^2+b^2)^-7//2*(b^4+5*a^4+-10*a^2*b^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x)))+8//3*a*b*(a^2+b^2)^-2*sin(3c+3*d*x)+-32*a*b*(a^2+b^2)^-3*(a^2+-1*b^2)*sin(c+d*x))+1//64*d^-1*(a+b*tan(c+d*x))^-2*(a*cos(c+d*x)+b*sin(c+d*x))^2*sec(c+d*x)^2*(-1*(a^2+b^2)^-4*(-12*b^6+12*a^6+-180*a^4*b^2+180*a^2*b^4)*cos(c+d*x)+-1//5*(a^2+b^2)^-2*(-4*b^2+4*a^2)*cos(5c+5*d*x)+1//3*(a^2+b^2)^-3*(8*a^4+8*b^4+-48*a^2*b^2)*cos(3c+3*d*x)+-1*a*(a^2+b^2)^-4*(a*cos(c+d*x)+b*sin(c+d*x))^-1*(a^6+-7*b^6+-21*a^4*b^2+35*a^2*b^4)+14*b*(a^2+b^2)^-9//2*(b^6+-7*a^6+-21*a^2*b^4+35*a^4*b^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x)))+8//5*a*b*(a^2+b^2)^-2*sin(5c+5*d*x)+24*a*b*(a^2+b^2)^-4*(3*a^4+3*b^4+-10*a^2*b^2)*sin(c+d*x)+-32//3*a*b*(a^2+b^2)^-3*(a^2+-1*b^2)*sin(3c+3*d*x))+1//64*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-3*sec(c+d*x)^2*(a*cos(c+d*x)+b*sin(c+d*x))*(-1*(a^2+b^2)*(3*a*(a^2+-3*b^2)+-2*b*(a^2+b^2)*sin(2c+2*d*x)+2*a*(a^2+b^2)*cos(2c+2*d*x))+6*b*(a^2+b^2)^(1/2)*(b^2+-3*a^2)*(a*cos(c+d*x)+b*sin(c+d*x))*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x))))+5//64*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-2*sec(c+d*x)^2*(a*(a^2+b^2)+2*b*(a^2+b^2)^(1/2)*(a*cos(c+d*x)+b*sin(c+d*x))*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x))))*(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-2*sin(c+d*x)^3, x) == :(-1*a^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)+-1//3*b^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)^3+1//3*a^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)^3+a^3*b^2*d^-1*(a^2+b^2)^-3*(a*cos(c+d*x)+b*sin(c+d*x))^-1+-3*a^2*b^3*d^-1*(a^2+b^2)^-7//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-2*a*b^3*d^-1*(a^2+b^2)^-3*sin(c+d*x)+2*b*a^3*d^-1*(a^2+b^2)^-3*sin(c+d*x)+2*b*a^4*d^-1*(a^2+b^2)^-7//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+4*a^2*b^2*d^-1*(a^2+b^2)^-3*cos(c+d*x)+2//3*a*b*d^-1*(a^2+b^2)^-2*sin(c+d*x)^3)
@test integrate((a+b*tan(c+d*x))^-2*sin(c+d*x), x) == :(b^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)+-1*a^2*d^-1*(a^2+b^2)^-2*cos(c+d*x)+-1*b^3*d^-1*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+a*b^2*d^-1*(a^2+b^2)^-2*(a*cos(c+d*x)+b*sin(c+d*x))^-1+2*a*b*d^-1*(a^2+b^2)^-2*sin(c+d*x)+2*b*a^2*d^-1*(a^2+b^2)^-5//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a+b*tan(c+d*x))^-2*csc(c+d*x), x) == :(-1*a^-2*d^-1*arctanh(cos(c+d*x))+b*d^-1*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+b*a^-2*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+a^-1*b^2*d^-1*(a^2+b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1)
@test integrate((a+b*tan(c+d*x))^-2*csc(c+d*x)^3, x) == :(-1//2*a^-2*d^-1*arctanh(cos(c+d*x))+a^-3*b^2*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1+-3*a^-4*b^2*d^-1*arctanh(cos(c+d*x))+2*b*a^-3*d^-1*csc(c+d*x)+-1//2*a^-2*d^-1*cot(c+d*x)*csc(c+d*x)+-1*b*a^-2*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+3*b*a^-4*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x))))
@test integrate((a+b*tan(c+d*x))^-3*sin(c+d*x)^6, x) == :(-1//6*d^-1*(a^2+b^2)^-3*cos(c+d*x)^6*(b*(-1*b^2+3*a^2)+a*(a^2+-3*b^2)*tan(c+d*x))+1//16*a*x*(a^2+b^2)^-6*(-3*b^8+5*a^8+-180*a^6*b^2+-68*a^2*b^6+390*a^4*b^4)+1//24*d^-1*(a^2+b^2)^-4*cos(c+d*x)^4*(6*b*(-1*b^4+9*a^4+-4*a^2*b^2)+a*(-3*b^4+13*a^4+-62*a^2*b^2)*tan(c+d*x))+-1//2*b*a^6*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-4+-1//16*a*d^-1*(a^2+b^2)^-5*cos(c+d*x)^2*((3*b^6+11*a^6+-119*a^4*b^2+65*a^2*b^4)*tan(c+d*x)+24*b*a^3*(-5*b^2+3*a^2))+b*a^4*d^-1*(a^2+b^2)^-6*(3*a^4+15*b^4+-22*a^2*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x))+-2*b*a^5*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-5*(a^2+-3*b^2))
@test integrate((a+b*tan(c+d*x))^-3*sin(c+d*x)^4, x) == :(1//4*d^-1*(a^2+b^2)^-3*cos(c+d*x)^4*(b*(-1*b^2+3*a^2)+a*(a^2+-3*b^2)*tan(c+d*x))+3//8*a*x*(a^2+b^2)^-5*(a^6+-3*b^6+-25*a^4*b^2+35*a^2*b^4)+-1//2*b*a^4*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-3+-1//8*a*d^-1*(a^2+b^2)^-4*cos(c+d*x)^2*((5*a^4+9*b^4+-34*a^2*b^2)*tan(c+d*x)+24*a*b*(a^2+-1*b^2))+-2*b*a^3*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-4*(a^2+-2*b^2)+3*b*a^2*d^-1*(a^2+b^2)^-5*(a^4+2*b^4+-5*a^2*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-3*sin(c+d*x)^2, x) == :((1/2)*a*x*(a^2+b^2)^-4*(a^4+9*b^4+-14*a^2*b^2)+-1//2*d^-1*(a^2+b^2)^-3*cos(c+d*x)^2*(b*(-1*b^2+3*a^2)+a*(a^2+-3*b^2)*tan(c+d*x))+b*d^-1*(a^2+b^2)^-4*(b^4+3*a^4+-8*a^2*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x))+-1//2*b*a^2*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-2+-2*a*b*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-3*(a^2+-1*b^2))
@test integrate((a+b*tan(c+d*x))^-3*csc(c+d*x)^2, x) == :(-1*a^-3*d^-1*cot(c+d*x)+-3*b*a^-4*d^-1*log(tan(c+d*x))+-2*b*a^-3*d^-1*(a+b*tan(c+d*x))^-1+3*b*a^-4*d^-1*log(a+b*tan(c+d*x))+-1//2*b*a^-2*d^-1*(a+b*tan(c+d*x))^-2)
@test integrate((a+b*tan(c+d*x))^-3*csc(c+d*x)^4, x) == :(-1//3*a^-3*d^-1*cot(c+d*x)^3+-1*a^-5*d^-1*(a^2+6*b^2)*cot(c+d*x)+3//2*b*a^-4*d^-1*cot(c+d*x)^2+b*a^-6*d^-1*(3*a^2+10*b^2)*log(a+b*tan(c+d*x))+-1*b*a^-6*d^-1*(3*a^2+10*b^2)*log(tan(c+d*x))+-2*b*a^-5*d^-1*(a+b*tan(c+d*x))^-1*(a^2+2*b^2)+-1//2*b*a^-4*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2))
@test integrate((a+b*tan(c+d*x))^-3*csc(c+d*x)^6, x) == :(-1//5*a^-3*d^-1*cot(c+d*x)^5+-1*a^-7*d^-1*(a^4+15*b^4+12*a^2*b^2)*cot(c+d*x)+-1//3*a^-5*d^-1*cot(c+d*x)^3*(2*a^2+6*b^2)+3//4*b*a^-4*d^-1*cot(c+d*x)^4+b*a^-8*d^-1*(3*a^4+21*b^4+20*a^2*b^2)*log(a+b*tan(c+d*x))+b*a^-6*d^-1*cot(c+d*x)^2*(3*a^2+5*b^2)+-1*b*a^-8*d^-1*(3*a^4+21*b^4+20*a^2*b^2)*log(tan(c+d*x))+-1//2*b*a^-6*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^2+-2*b*a^-7*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)*(a^2+3*b^2))
@test integrate((a+b*tan(c+d*x))^-3*sin(c+d*x)^5, x) == :(1//64*d^-1*(a+b*tan(c+d*x))^-3*(a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^3*((a^2+b^2)^-3*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(-2*b*((a^2+b^2)^2*sin(3c+3*d*x)+-5*b^2*(b^2+-5*a^2)*sin(c+d*x))+2*a*(a^2+b^2)^2*cos(3c+3*d*x)+10*a^3*(a^2+-5*b^2)*cos(c+d*x))+60*a*b*(a^2+b^2)^-7//2*(a^2+-1*b^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x))))+1//64*d^-1*(a+b*tan(c+d*x))^-3*(a*cos(c+d*x)+b*sin(c+d*x))^3*sec(c+d*x)^3*(-1*(a^2+b^2)^-4*(a*cos(c+d*x)+b*sin(c+d*x))^-1*(-3*b^6+6*a^6+-87*a^4*b^2+80*a^2*b^4)+-24*a*(a^2+b^2)^-4*(a^4+5*b^4+-10*a^2*b^2)*cos(c+d*x)+24*b*(a^2+b^2)^-4*(b^4+5*a^4+-10*a^2*b^2)*sin(c+d*x)+8//3*a*(a^2+b^2)^-3*(a^2+-3*b^2)*cos(3c+3*d*x)+8//3*b*(a^2+b^2)^-3*(b^2+-3*a^2)*sin(3c+3*d*x)+-1*b*(a^2+b^2)^-3*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(-3*a^4+-3*b^4+10*a^2*b^2)*sin(c+d*x)+-70*a*b*(a^2+b^2)^-9//2*(3*a^4+3*b^4+-10*a^2*b^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x))))+-1//320*d^-1*(a+b*tan(c+d*x))^-3*(a^2+b^2)^-6*sec(c+d*x)^3*(a*cos(c+d*x)+b*sin(c+d*x))*((a^2+b^2)*(a^9*cos(7c+7*d*x)+-1*b^9*sin(7c+7*d*x)+-21*b^9*sin(3c+3*d*x)+-3*a^9*cos(5c+5*d*x)+-3*b^9*sin(5c+5*d*x)+105*b^9*sin(c+d*x)+a*b^8*cos(7c+7*d*x)+-1*b*a^8*sin(7c+7*d*x)+-2730*a^2*b^7*sin(c+d*x)+-1470*a^6*b^3*sin(c+d*x)+-105*b*a^8*sin(c+d*x)+-105*b*a^8*sin(3c+3*d*x)+-6*a^4*b^5*sin(7c+7*d*x)+-4*a^2*b^7*sin(7c+7*d*x)+-4*a^6*b^3*sin(7c+7*d*x)+4*a^3*b^6*cos(7c+7*d*x)+4*a^7*b^2*cos(7c+7*d*x)+6*a^5*b^4*cos(7c+7*d*x)+9*a*b^8*cos(5c+5*d*x)+9*b*a^8*sin(5c+5*d*x)+18*a^4*b^5*sin(5c+5*d*x)+18*a^5*b^4*cos(5c+5*d*x)+24*a^3*b^6*cos(5c+5*d*x)+24*a^6*b^3*sin(5c+5*d*x)+105*a*(a^8+-1*b^8+-26*a^6*b^2+-14*a^2*b^6+56*a^4*b^4)*cos(c+d*x)+168*a^2*b^7*sin(3c+3*d*x)+294*a^4*b^5*sin(3c+3*d*x)+5880*a^4*b^5*sin(c+d*x)+21*a*(a^2+b^2)^2*(a^4+5*b^4+-10*a^2*b^2)*cos(3c+3*d*x))+1260*a*b*(a^2+b^2)^(1/2)*(a*cos(c+d*x)+b*sin(c+d*x))^2*(a^6+-1*b^6+-7*a^4*b^2+7*a^2*b^4)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x))))+3//64*d^-1*(a+b*tan(c+d*x))^-3*(a^2+b^2)^-3*sec(c+d*x)^3*(a*cos(c+d*x)+b*sin(c+d*x))*((a^2+b^2)*(a*(-1*b^2+2*a^2)*cos(c+d*x)+b*(a^2+-2*b^2)*sin(c+d*x))+6*a*b*(a^2+b^2)^(1/2)*(a*cos(c+d*x)+b*sin(c+d*x))^2*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x)))))
@test integrate((a+b*tan(c+d*x))^-3*sin(c+d*x)^3, x) == :(b^3*d^-1*(a^2+b^2)^-3*sin(c+d*x)+-1*a^3*d^-1*(a^2+b^2)^-3*cos(c+d*x)+-1//3*b^3*d^-1*(a^2+b^2)^-3*sin(c+d*x)^3+1//3*a^3*d^-1*(a^2+b^2)^-3*cos(c+d*x)^3+b*a^2*d^-1*(a^2+b^2)^-3*sin(c+d*x)^3+-1*a*b^2*d^-1*(a^2+b^2)^-3*cos(c+d*x)^3+-9*a^2*b^3*d^-1*(a^2+b^2)^-4*sin(c+d*x)+-3*a*b^4*d^-1*(a^2+b^2)^-4*cos(c+d*x)+-3*a^2*b^4*d^-1*(a^2+b^2)^-4*(a*cos(c+d*x)+b*sin(c+d*x))^-1+3*a*b^5*d^-1*(a^2+b^2)^-9//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+3*b*a^4*d^-1*(a^2+b^2)^-4*sin(c+d*x)+3*b*a^5*d^-1*(a^2+b^2)^-9//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+3*a^4*b^2*d^-1*(a^2+b^2)^-4*(a*cos(c+d*x)+b*sin(c+d*x))^-1+9*a^3*b^2*d^-1*(a^2+b^2)^-4*cos(c+d*x)+-23//2*a^3*b^3*d^-1*(a^2+b^2)^-9//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+(1/2)*a^3*b^3*d^-1*(a^2+b^2)^-4*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-3*sin(c+d*x), x) == :(-1//4*d^-1*(a+b*tan(c+d*x))^-3*(a^2+b^2)^-7//2*sec(c+d*x)^3*(a*cos(c+d*x)+b*sin(c+d*x))*((a^2+b^2)^(1/2)*(a*(a^2+b^2)^2*cos(3c+3*d*x)+a*(b^4+3*a^4+-26*a^2*b^2)*cos(c+d*x)+-2*b*(a^4+-3*b^4+(a^2+b^2)^2*cos(2c+2*d*x)+13*a^2*b^2)*sin(c+d*x))+12*a*b*(a*cos(c+d*x)+b*sin(c+d*x))^2*(-3*b^2+2*a^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x)))))
@test integrate((a+b*tan(c+d*x))^-3*csc(c+d*x), x) == :((1/2)*a^-3*d^-1*(a+b*tan(c+d*x))^-3*sec(c+d*x)^2*(a*cos(c+d*x)+b*sin(c+d*x))*(-2*(a*cos(c+d*x)+b*sin(c+d*x))^2*log(cos((1/2)*c+(1/2)*d*x))*sec(c+d*x)+2*(a*cos(c+d*x)+b*sin(c+d*x))^2*log(sin((1/2)*c+(1/2)*d*x))*sec(c+d*x)+-1*a*b^3*(a^2+b^2)^-1*tan(c+d*x)+-2*b*(a^2+b^2)^-5//2*(a*cos(c+d*x)+b*sin(c+d*x))^2*(2*b^4+6*a^4+5*a^2*b^2)*arctanh((a^2+b^2)^-1//2*(-1b+a*tan((1/2)*c+(1/2)*d*x)))*sec(c+d*x)+3*a*b^2*(a^2+b^2)^-2*(b^2+2*a^2)*(a*cos(c+d*x)+b*sin(c+d*x))*sec(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-3*csc(c+d*x)^3, x) == :(-1//2*a^-3*d^-1*arctanh(cos(c+d*x))+-6*a^-5*b^2*d^-1*arctanh(cos(c+d*x))+3*b*a^-4*d^-1*csc(c+d*x)+3*a^-4*b^2*d^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-1+-1//2*a^-3*d^-1*cot(c+d*x)*csc(c+d*x)+(1/2)*a^-3*b^3*d^-1*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+-3*b*a^-3*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+6*b*a^-5*d^-1*(a^2+b^2)^(1/2)*arctanh((a^2+b^2)^-1//2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))+(1/2)*a^-3*b^3*d^-1*(a^2+b^2)^-1*(a*cos(c+d*x)+b*sin(c+d*x))^-2*(b*cos(c+d*x)+-1*a*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-4*sin(c+d*x)^4, x) == :(1//8*x*(a^2+b^2)^-6*(3*a^8+3*b^8+-132*a^2*b^6+-132*a^6*b^2+370*a^4*b^4)+-1//8*d^-1*(a^2+b^2)^-5*cos(c+d*x)^2*((-3*b^6+5*a^6+-65*a^4*b^2+55*a^2*b^4)*tan(c+d*x)+16*a*b*(b^4+2*a^4+-5*a^2*b^2))+1//4*d^-1*(a^2+b^2)^-4*cos(c+d*x)^4*((a^4+b^4+-6*a^2*b^2)*tan(c+d*x)+4*a*b*(a^2+-1*b^2))+-1//3*b*a^4*d^-1*(a+b*tan(c+d*x))^-3*(a^2+b^2)^-3+-1*b*a^3*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-4*(a^2+-2*b^2)+-3*b*a^2*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-5*(a^4+2*b^4+-5*a^2*b^2)+4*a*b*d^-1*(a^2+b^2)^-6*(a^2+-1*b^2)*(a^4+b^4+-8*a^2*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-4*sin(c+d*x)^2, x) == :((1/2)*x*(a^2+b^2)^-5*(a^6+-3*b^6+-25*a^4*b^2+35*a^2*b^4)+-1//2*d^-1*(a^2+b^2)^-4*cos(c+d*x)^2*((a^4+b^4+-6*a^2*b^2)*tan(c+d*x)+4*a*b*(a^2+-1*b^2))+-1*b*d^-1*(a+b*tan(c+d*x))^-1*(a^2+b^2)^-4*(b^4+3*a^4+-8*a^2*b^2)+-1//3*b*a^2*d^-1*(a+b*tan(c+d*x))^-3*(a^2+b^2)^-2+-1*a*b*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)^-3*(a^2+-1*b^2)+4*a*b*d^-1*(a^2+b^2)^-5*(a^4+2*b^4+-5*a^2*b^2)*log(a*cos(c+d*x)+b*sin(c+d*x)))
@test integrate((a+b*tan(c+d*x))^-4*csc(c+d*x)^2, x) == :(-1*a^-4*d^-1*cot(c+d*x)+-1*b*a^-3*d^-1*(a+b*tan(c+d*x))^-2+-4*b*a^-5*d^-1*log(tan(c+d*x))+-3*b*a^-4*d^-1*(a+b*tan(c+d*x))^-1+4*b*a^-5*d^-1*log(a+b*tan(c+d*x))+-1//3*b*a^-2*d^-1*(a+b*tan(c+d*x))^-3)
@test integrate((a+b*tan(c+d*x))^-4*csc(c+d*x)^4, x) == :(-1//3*a^-4*d^-1*cot(c+d*x)^3+-1*a^-6*d^-1*(a^2+10*b^2)*cot(c+d*x)+2*b*a^-5*d^-1*cot(c+d*x)^2+-1*b*a^-6*d^-1*(a+b*tan(c+d*x))^-1*(3*a^2+10*b^2)+-1*b*a^-5*d^-1*(a+b*tan(c+d*x))^-2*(a^2+2*b^2)+-4*b*a^-7*d^-1*(a^2+5*b^2)*log(tan(c+d*x))+4*b*a^-7*d^-1*(a^2+5*b^2)*log(a+b*tan(c+d*x))+-1//3*b*a^-4*d^-1*(a+b*tan(c+d*x))^-3*(a^2+b^2))
@test integrate((a+b*tan(c+d*x))^-4*csc(c+d*x)^6, x) == :(-1//5*a^-4*d^-1*cot(c+d*x)^5+b*a^-5*d^-1*cot(c+d*x)^4+-1*a^-8*d^-1*(a^4+35*b^4+20*a^2*b^2)*cot(c+d*x)+-1//3*a^-6*d^-1*cot(c+d*x)^3*(2*a^2+10*b^2)+-1*b*a^-8*d^-1*(a+b*tan(c+d*x))^-1*(3*a^4+21*b^4+20*a^2*b^2)+-4*b*a^-9*d^-1*(a^4+14*b^4+10*a^2*b^2)*log(tan(c+d*x))+2*b*a^-7*d^-1*cot(c+d*x)^2*(2*a^2+5*b^2)+4*b*a^-9*d^-1*(a^4+14*b^4+10*a^2*b^2)*log(a+b*tan(c+d*x))+-1//3*b*a^-6*d^-1*(a+b*tan(c+d*x))^-3*(a^2+b^2)^2+-1*b*a^-7*d^-1*(a+b*tan(c+d*x))^-2*(a^2+b^2)*(a^2+3*b^2))
@test integrate((1+tan(x))^-1*csc(x), x) == :(-1*arctanh(cos(x))+(1/2)*2^(1/2)*arctanh((1/2)*2^(1/2)*(-1*sin(x)+cos(x))))

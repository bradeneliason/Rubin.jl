using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(x^3*tan(a+b*x), x) == :(1//4*im*x^4+-1*b^-1*x^3*log(1+exp(2*im*(a+b*x)))+-3//2*x*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+-3//4*im*b^-4*Polylogarithms.polylog(4,-1*exp(2*im*(a+b*x)))+3//2*im*b^-2*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
@test integrate(x^2*tan(a+b*x), x) == :(-1//2*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+1//3*im*x^3+-1*b^-1*x^2*log(1+exp(2*im*(a+b*x)))+im*x*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
@test integrate(x*tan(a+b*x), x) == :((1/2)*im*x^2+(1/2)*im*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x)))+-1*x*b^-1*log(1+exp(2*im*(a+b*x))))
@test integrate(x^3*tan(a+b*x)^2, x) == :(-1//4*x^4+3//2*b^-4*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+b^-1*x^3*tan(a+b*x)+-1*im*b^-1*x^3+3*b^-2*x^2*log(1+exp(2*im*(a+b*x)))+-3*im*x*b^-3*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
@test integrate(x^2*tan(a+b*x)^2, x) == :(-1//3*x^3+b^-1*x^2*tan(a+b*x)+-1*im*b^-1*x^2+-1*im*b^-3*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x)))+2*x*b^-2*log(1+exp(2*im*(a+b*x))))
@test integrate(x*tan(a+b*x)^2, x) == :(-1//2*x^2+b^-2*log(cos(a+b*x))+x*b^-1*tan(a+b*x))
@test integrate(x^3*tan(a+b*x)^3, x) == :((1/2)*b^-1*x^3+-1//4*im*x^4+b^-1*x^3*log(1+exp(2*im*(a+b*x)))+(1/2)*b^-1*x^3*tan(a+b*x)^2+-3*x*b^-3*log(1+exp(2*im*(a+b*x)))+-3//2*b^-2*x^2*tan(a+b*x)+3//2*im*b^-4*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x)))+3//2*im*b^-2*x^2+3//2*x*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+3//4*im*b^-4*Polylogarithms.polylog(4,-1*exp(2*im*(a+b*x)))+-3//2*im*b^-2*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
@test integrate(x^2*tan(a+b*x)^3, x) == :((1/2)*b^-1*x^2+(1/2)*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+-1*b^-3*log(cos(a+b*x))+-1//3*im*x^3+b^-1*x^2*log(1+exp(2*im*(a+b*x)))+(1/2)*b^-1*x^2*tan(a+b*x)^2+-1*x*b^-2*tan(a+b*x)+-1*im*x*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
@test integrate(x*tan(a+b*x)^3, x) == :((1/2)*x*b^-1+-1//2*im*x^2+-1//2*b^-2*tan(a+b*x)+x*b^-1*log(1+exp(2*im*(a+b*x)))+(1/2)*x*b^-1*tan(a+b*x)^2+-1//2*im*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
@test integrate(x^2*tan(a+b*x)^(1/2)+x^2*tan(a+b*x)^-3//2+-4*x*b^-1*tan(a+b*x)^-1//2, x) == :(-2*b^-1*x^2*tan(a+b*x)^-1//2)
@test integrate(b^-1*tan(a+b*x^2)^(1/2)+x^2*tan(a+b*x^2)^-1//2+x^2*tan(a+b*x^2)^3//2, x) == :(x*b^-1*tan(a+b*x^2)^(1/2))
@test integrate((a+im*a*tan(e+f*x))^-1*(c+d*x)^3, x) == :(-3//8*d^3*f^-4*(a+im*a*tan(e+f*x))^-1+1//8*a^-1*d^-1*(c+d*x)^4+(1/2)*im*f^-1*(a+im*a*tan(e+f*x))^-1*(c+d*x)^3+-3//8*d*a^-1*f^-2*(c+d*x)^2+-1//4*im*a^-1*f^-1*(c+d*x)^3+3//4*d*f^-2*(a+im*a*tan(e+f*x))^-1*(c+d*x)^2+-3//4*im*d^2*f^-3*(a+im*a*tan(e+f*x))^-1*(c+d*x)+3//8*im*x*a^-1*d^3*f^-3)
@test integrate((a+im*a*tan(e+f*x))^-1*(c+d*x)^2, x) == :(1//6*a^-1*d^-1*(c+d*x)^3+(1/2)*im*f^-1*(a+im*a*tan(e+f*x))^-1*(c+d*x)^2+(1/2)*d*f^-2*(a+im*a*tan(e+f*x))^-1*(c+d*x)+-1//4*im*a^-1*f^-1*(c+d*x)^2+-1//4*im*d^2*f^-3*(a+im*a*tan(e+f*x))^-1+-1//4*x*a^-1*d^2*f^-2)
@test integrate((a+im*a*tan(e+f*x))^-1*(c+d*x), x) == :(1//4*d*f^-2*(a+im*a*tan(e+f*x))^-1+1//4*a^-1*d^-1*(c+d*x)^2+(1/2)*im*f^-1*(a+im*a*tan(e+f*x))^-1*(c+d*x)+-1//4*im*d*x*a^-1*f^-1)
@test integrate((a+im*a*tan(e+f*x))^-1*(c+d*x)^-1, x) == :((1/2)*a^-1*d^-1*log(c+d*x)+(1/2)*a^-1*d^-1*cos(-2*e+2*c*f*d^-1)*cosintegral(2*f*x+2*c*f*d^-1)+(1/2)*a^-1*d^-1*sin(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+(1/2)*im*a^-1*d^-1*cosintegral(2*f*x+2*c*f*d^-1)*sin(-2*e+2*c*f*d^-1)+-1//2*im*a^-1*d^-1*cos(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1))
@test integrate((a+im*a*tan(e+f*x))^-1*(c+d*x)^-2, x) == :(-1*d^-1*(a+im*a*tan(e+f*x))^-1*(c+d*x)^-1+f*a^-1*d^-2*cosintegral(2*f*x+2*c*f*d^-1)*sin(-2*e+2*c*f*d^-1)+-1*f*a^-1*d^-2*cos(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+-1*im*f*a^-1*d^-2*cos(-2*e+2*c*f*d^-1)*cosintegral(2*f*x+2*c*f*d^-1)+-1*im*f*a^-1*d^-2*sin(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1))
@test integrate((a+im*a*tan(e+f*x))^-1*(c+d*x)^-3, x) == :(-1//2*d^-1*(a+im*a*tan(e+f*x))^-1*(c+d*x)^-2+im*f*d^-2*(a+im*a*tan(e+f*x))^-1*(c+d*x)^-1+-1*a^-1*d^-3*f^2*cos(-2*e+2*c*f*d^-1)*cosintegral(2*f*x+2*c*f*d^-1)+-1*a^-1*d^-3*f^2*sin(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+-1//2*im*f*a^-1*d^-2*(c+d*x)^-1+im*a^-1*d^-3*f^2*cos(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+-1*im*a^-1*d^-3*f^2*cosintegral(2*f*x+2*c*f*d^-1)*sin(-2*e+2*c*f*d^-1))
@test integrate((a+im*a*tan(e+f*x))^-2*(c+d*x)^3, x) == :(1//16*a^-2*d^-1*(c+d*x)^4+-3//16*a^-2*d^3*f^-4*exp(-2*im*e+-2*im*f*x)+-3//512*a^-2*d^3*f^-4*exp(-4*im*e+-4*im*f*x)+1//4*im*a^-2*f^-1*(c+d*x)^3*exp(-2*im*e+-2*im*f*x)+1//16*im*a^-2*f^-1*(c+d*x)^3*exp(-4*im*e+-4*im*f*x)+3//8*d*a^-2*f^-2*(c+d*x)^2*exp(-2*im*e+-2*im*f*x)+3//64*d*a^-2*f^-2*(c+d*x)^2*exp(-4*im*e+-4*im*f*x)+-3//8*im*a^-2*d^2*f^-3*(c+d*x)*exp(-2*im*e+-2*im*f*x)+-3//128*im*a^-2*d^2*f^-3*(c+d*x)*exp(-4*im*e+-4*im*f*x))
@test integrate((a+im*a*tan(e+f*x))^-2*(c+d*x)^2, x) == :(1//12*a^-2*d^-1*(c+d*x)^3+-1//8*im*a^-2*d^2*f^-3*exp(-2*im*e+-2*im*f*x)+-1//128*im*a^-2*d^2*f^-3*exp(-4*im*e+-4*im*f*x)+1//4*im*a^-2*f^-1*(c+d*x)^2*exp(-2*im*e+-2*im*f*x)+1//4*d*a^-2*f^-2*(c+d*x)*exp(-2*im*e+-2*im*f*x)+1//16*im*a^-2*f^-1*(c+d*x)^2*exp(-4*im*e+-4*im*f*x)+1//32*d*a^-2*f^-2*(c+d*x)*exp(-4*im*e+-4*im*f*x))
@test integrate((a+im*a*tan(e+f*x))^-2*(c+d*x), x) == :(-1//8*d*a^-2*x^2+1//4*x*a^-2*(c+d*x)+1//16*d*f^-2*(a+im*a*tan(e+f*x))^-2+3//16*d*f^-2*(a^2+im*a^2*tan(e+f*x))^-1+1//4*im*f^-1*(a+im*a*tan(e+f*x))^-2*(c+d*x)+1//4*im*f^-1*(a^2+im*a^2*tan(e+f*x))^-1*(c+d*x)+-3//16*im*d*x*a^-2*f^-1)
@test integrate((a+im*a*tan(e+f*x))^-2*(c+d*x)^-1, x) == :(1//4*a^-2*d^-1*log(c+d*x)+(1/2)*a^-2*d^-1*cos(-2*e+2*c*f*d^-1)*cosintegral(2*f*x+2*c*f*d^-1)+(1/2)*a^-2*d^-1*sin(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+1//4*a^-2*d^-1*cos(-4*e+4*c*f*d^-1)*cosintegral(4*f*x+4*c*f*d^-1)+1//4*a^-2*d^-1*sin(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+(1/2)*im*a^-2*d^-1*cosintegral(2*f*x+2*c*f*d^-1)*sin(-2*e+2*c*f*d^-1)+-1//2*im*a^-2*d^-1*cos(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+-1//4*im*a^-2*d^-1*cos(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+1//4*im*a^-2*d^-1*cosintegral(4*f*x+4*c*f*d^-1)*sin(-4*e+4*c*f*d^-1))
@test integrate((a+im*a*tan(e+f*x))^-2*(c+d*x)^-2, x) == :(-1//4*a^-2*d^-1*(c+d*x)^-1+-1//2*a^-2*d^-1*(c+d*x)^-1*cos(2*e+2*f*x)+-1//4*a^-2*d^-1*(c+d*x)^-1*cos(2*e+2*f*x)^2+1//4*a^-2*d^-1*(c+d*x)^-1*sin(2*e+2*f*x)^2+f*a^-2*d^-2*cosintegral(2*f*x+2*c*f*d^-1)*sin(-2*e+2*c*f*d^-1)+f*a^-2*d^-2*cosintegral(4*f*x+4*c*f*d^-1)*sin(-4*e+4*c*f*d^-1)+(1/2)*im*a^-2*d^-1*(c+d*x)^-1*sin(2*e+2*f*x)+-1*f*a^-2*d^-2*cos(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+-1*f*a^-2*d^-2*cos(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+1//4*im*a^-2*d^-1*(c+d*x)^-1*sin(4*e+4*f*x)+-1*im*f*a^-2*d^-2*cos(-4*e+4*c*f*d^-1)*cosintegral(4*f*x+4*c*f*d^-1)+-1*im*f*a^-2*d^-2*cos(-2*e+2*c*f*d^-1)*cosintegral(2*f*x+2*c*f*d^-1)+-1*im*f*a^-2*d^-2*sin(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+-1*im*f*a^-2*d^-2*sin(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1))
@test integrate((a+im*a*tan(e+f*x))^-3*(c+d*x)^3, x) == :(1//32*a^-3*d^-1*(c+d*x)^4+-9//64*a^-3*d^3*f^-4*exp(-2*im*e+-2*im*f*x)+-9//1024*a^-3*d^3*f^-4*exp(-4*im*e+-4*im*f*x)+-1//1728*a^-3*d^3*f^-4*exp(-6*im*e+-6*im*f*x)+1//48*im*a^-3*f^-1*(c+d*x)^3*exp(-6*im*e+-6*im*f*x)+1//96*d*a^-3*f^-2*(c+d*x)^2*exp(-6*im*e+-6*im*f*x)+3//16*im*a^-3*f^-1*(c+d*x)^3*exp(-2*im*e+-2*im*f*x)+3//32*im*a^-3*f^-1*(c+d*x)^3*exp(-4*im*e+-4*im*f*x)+9//32*d*a^-3*f^-2*(c+d*x)^2*exp(-2*im*e+-2*im*f*x)+9//128*d*a^-3*f^-2*(c+d*x)^2*exp(-4*im*e+-4*im*f*x)+-9//32*im*a^-3*d^2*f^-3*(c+d*x)*exp(-2*im*e+-2*im*f*x)+-9//256*im*a^-3*d^2*f^-3*(c+d*x)*exp(-4*im*e+-4*im*f*x)+-1//288*im*a^-3*d^2*f^-3*(c+d*x)*exp(-6*im*e+-6*im*f*x))
@test integrate((a+im*a*tan(e+f*x))^-3*(c+d*x)^2, x) == :(1//24*a^-3*d^-1*(c+d*x)^3+-3//32*im*a^-3*d^2*f^-3*exp(-2*im*e+-2*im*f*x)+-3//256*im*a^-3*d^2*f^-3*exp(-4*im*e+-4*im*f*x)+-1//864*im*a^-3*d^2*f^-3*exp(-6*im*e+-6*im*f*x)+1//48*im*a^-3*f^-1*(c+d*x)^2*exp(-6*im*e+-6*im*f*x)+1//144*d*a^-3*f^-2*(c+d*x)*exp(-6*im*e+-6*im*f*x)+3//16*im*a^-3*f^-1*(c+d*x)^2*exp(-2*im*e+-2*im*f*x)+3//16*d*a^-3*f^-2*(c+d*x)*exp(-2*im*e+-2*im*f*x)+3//32*im*a^-3*f^-1*(c+d*x)^2*exp(-4*im*e+-4*im*f*x)+3//64*d*a^-3*f^-2*(c+d*x)*exp(-4*im*e+-4*im*f*x))
@test integrate((a+im*a*tan(e+f*x))^-3*(c+d*x), x) == :(-1//16*d*a^-3*x^2+1//8*x*a^-3*(c+d*x)+1//36*d*f^-2*(a+im*a*tan(e+f*x))^-3+11//96*d*f^-2*(a^3+im*a^3*tan(e+f*x))^-1+1//6*im*f^-1*(a+im*a*tan(e+f*x))^-3*(c+d*x)+1//8*im*f^-1*(a^3+im*a^3*tan(e+f*x))^-1*(c+d*x)+5//96*d*a^-1*f^-2*(a+im*a*tan(e+f*x))^-2+-11//96*im*d*x*a^-3*f^-1+1//8*im*a^-1*f^-1*(a+im*a*tan(e+f*x))^-2*(c+d*x))
@test integrate((a+im*a*tan(e+f*x))^-3*(c+d*x)^-1, x) == :(1//8*a^-3*d^-1*log(c+d*x)+1//8*a^-3*d^-1*cos(-6*e+6*c*f*d^-1)*cosintegral(6*f*x+6*c*f*d^-1)+1//8*a^-3*d^-1*sin(-6*e+6*c*f*d^-1)*sinintegral(6*f*x+6*c*f*d^-1)+3//8*a^-3*d^-1*cos(-4*e+4*c*f*d^-1)*cosintegral(4*f*x+4*c*f*d^-1)+3//8*a^-3*d^-1*cos(-2*e+2*c*f*d^-1)*cosintegral(2*f*x+2*c*f*d^-1)+3//8*a^-3*d^-1*sin(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+3//8*a^-3*d^-1*sin(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+-3//8*im*a^-3*d^-1*cos(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+-3//8*im*a^-3*d^-1*cos(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+-1//8*im*a^-3*d^-1*cos(-6*e+6*c*f*d^-1)*sinintegral(6*f*x+6*c*f*d^-1)+1//8*im*a^-3*d^-1*cosintegral(6*f*x+6*c*f*d^-1)*sin(-6*e+6*c*f*d^-1)+3//8*im*a^-3*d^-1*cosintegral(2*f*x+2*c*f*d^-1)*sin(-2*e+2*c*f*d^-1)+3//8*im*a^-3*d^-1*cosintegral(4*f*x+4*c*f*d^-1)*sin(-4*e+4*c*f*d^-1))
@test integrate((a+im*a*tan(e+f*x))^-3*(c+d*x)^-2, x) == :(-1//8*a^-3*d^-1*(c+d*x)^-1+-9//32*a^-3*d^-1*(c+d*x)^-1*cos(2*e+2*f*x)+-3//8*a^-3*d^-1*(c+d*x)^-1*cos(2*e+2*f*x)^2+-3//32*a^-3*d^-1*(c+d*x)^-1*cos(6*e+6*f*x)+-1//8*a^-3*d^-1*(c+d*x)^-1*cos(2*e+2*f*x)^3+3//8*a^-3*d^-1*(c+d*x)^-1*sin(2*e+2*f*x)^2+-3//2*f*a^-3*d^-2*cos(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+-3//4*f*a^-3*d^-2*cos(-6*e+6*c*f*d^-1)*sinintegral(6*f*x+6*c*f*d^-1)+-3//4*f*a^-3*d^-2*cos(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1)+-1//8*im*a^-3*d^-1*(c+d*x)^-1*sin(2*e+2*f*x)^3+3//2*f*a^-3*d^-2*cosintegral(4*f*x+4*c*f*d^-1)*sin(-4*e+4*c*f*d^-1)+3//4*f*a^-3*d^-2*cosintegral(2*f*x+2*c*f*d^-1)*sin(-2*e+2*c*f*d^-1)+3//4*f*a^-3*d^-2*cosintegral(6*f*x+6*c*f*d^-1)*sin(-6*e+6*c*f*d^-1)+3//8*im*a^-3*d^-1*(c+d*x)^-1*sin(4*e+4*f*x)+3//32*im*a^-3*d^-1*(c+d*x)^-1*sin(6*e+6*f*x)+15//32*im*a^-3*d^-1*(c+d*x)^-1*sin(2*e+2*f*x)+-3//2*im*f*a^-3*d^-2*cos(-4*e+4*c*f*d^-1)*cosintegral(4*f*x+4*c*f*d^-1)+-3//2*im*f*a^-3*d^-2*sin(-4*e+4*c*f*d^-1)*sinintegral(4*f*x+4*c*f*d^-1)+-3//4*im*f*a^-3*d^-2*cos(-6*e+6*c*f*d^-1)*cosintegral(6*f*x+6*c*f*d^-1)+-3//4*im*f*a^-3*d^-2*cos(-2*e+2*c*f*d^-1)*cosintegral(2*f*x+2*c*f*d^-1)+-3//4*im*f*a^-3*d^-2*sin(-6*e+6*c*f*d^-1)*sinintegral(6*f*x+6*c*f*d^-1)+-3//4*im*f*a^-3*d^-2*sin(-2*e+2*c*f*d^-1)*sinintegral(2*f*x+2*c*f*d^-1))
@test integrate((a+im*a*tan(e+f*x))^-1*(c+d*x)^m, x) == :((1/2)*a^-1*d^-1*(1+m)^-1*(c+d*x)^(1+m)+im*2^(-2+-1m)*a^-1*f^-1*(im*f*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,2*im*f*d^-1*(c+d*x))*exp(-2*im*(e+-1*c*f*d^-1)))
@test integrate((a+im*a*tan(e+f*x))^-2*(c+d*x)^m, x) == :(1//4*a^-2*d^-1*(1+m)^-1*(c+d*x)^(1+m)+im*2^(-2+-1m)*a^-2*f^-1*(im*f*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,2*im*f*d^-1*(c+d*x))*exp(-2*im*(e+-1*c*f*d^-1))+im*4^(-2+-1m)*a^-2*f^-1*(im*f*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,4*im*f*d^-1*(c+d*x))*exp(-4*im*(e+-1*c*f*d^-1)))
@test integrate((a+im*a*tan(e+f*x))^-3*(c+d*x)^m, x) == :(1//8*a^-3*d^-1*(1+m)^-1*(c+d*x)^(1+m)+3*im*2^(-5+-2m)*a^-3*f^-1*(im*f*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,4*im*f*d^-1*(c+d*x))*exp(-4*im*(e+-1*c*f*d^-1))+3*im*2^(-4+-1m)*a^-3*f^-1*(im*f*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,2*im*f*d^-1*(c+d*x))*exp(-2*im*(e+-1*c*f*d^-1))+im*2^(-4+-1m)*3^(-1+-1m)*a^-3*f^-1*(im*f*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,6*im*f*d^-1*(c+d*x))*exp(-6*im*(e+-1*c*f*d^-1)))
@test integrate((c+d*x)^3*(a+b*tan(e+f*x)), x) == :(1//4*a*d^-1*(c+d*x)^4+-1*b*f^-1*(c+d*x)^3*log(1+exp(2*im*(e+f*x)))+1//4*im*b*d^-1*(c+d*x)^4+-3//2*b*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+-3//4*im*b*d^3*f^-4*Polylogarithms.polylog(4,-1*exp(2*im*(e+f*x)))+3//2*im*b*d*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((c+d*x)^2*(a+b*tan(e+f*x)), x) == :(1//3*a*d^-1*(c+d*x)^3+-1*b*f^-1*(c+d*x)^2*log(1+exp(2*im*(e+f*x)))+-1//2*b*d^2*f^-3*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+1//3*im*b*d^-1*(c+d*x)^3+im*b*d*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))*(c+d*x), x) == :((1/2)*a*d^-1*(c+d*x)^2+(1/2)*im*b*d^-1*(c+d*x)^2+-1*b*f^-1*(c+d*x)*log(1+exp(2*im*(e+f*x)))+(1/2)*im*b*d*f^-2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^2*(c+d*x)^3, x) == :(-1//4*b^2*d^-1*(c+d*x)^4+1//4*a^2*d^-1*(c+d*x)^4+b^2*f^-1*(c+d*x)^3*tan(e+f*x)+-1*im*b^2*f^-1*(c+d*x)^3+3//2*b^2*d^3*f^-4*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+(1/2)*im*a*b*d^-1*(c+d*x)^4+-2*a*b*f^-1*(c+d*x)^3*log(1+exp(2*im*(e+f*x)))+3*d*b^2*f^-2*(c+d*x)^2*log(1+exp(2*im*(e+f*x)))+-3*im*b^2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+-3*a*b*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+-3//2*im*a*b*d^3*f^-4*Polylogarithms.polylog(4,-1*exp(2*im*(e+f*x)))+3*im*a*b*d*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^2*(c+d*x)^2, x) == :(-1//3*b^2*d^-1*(c+d*x)^3+1//3*a^2*d^-1*(c+d*x)^3+b^2*f^-1*(c+d*x)^2*tan(e+f*x)+-1*im*b^2*f^-1*(c+d*x)^2+-1*im*b^2*d^2*f^-3*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+-1*a*b*d^2*f^-3*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+-2*a*b*f^-1*(c+d*x)^2*log(1+exp(2*im*(e+f*x)))+2*d*b^2*f^-2*(c+d*x)*log(1+exp(2*im*(e+f*x)))+2//3*im*a*b*d^-1*(c+d*x)^3+2*im*a*b*d*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^2*(c+d*x), x) == :((1/2)*a^2*d^-1*(c+d*x)^2+-1*c*x*b^2+-1//2*d*b^2*x^2+d*b^2*f^-2*log(cos(e+f*x))+b^2*f^-1*(c+d*x)*tan(e+f*x)+im*a*b*d^-1*(c+d*x)^2+-2*a*b*f^-1*(c+d*x)*log(1+exp(2*im*(e+f*x)))+im*a*b*d*f^-2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^3*(c+d*x)^3, x) == :((1/2)*b^3*f^-1*(c+d*x)^3+1//4*a^3*d^-1*(c+d*x)^4+b^3*f^-1*(c+d*x)^3*log(1+exp(2*im*(e+f*x)))+(1/2)*b^3*f^-1*(c+d*x)^3*tan(e+f*x)^2+-3//4*a*b^2*d^-1*(c+d*x)^4+-1//4*im*b^3*d^-1*(c+d*x)^4+-3*im*a*b^2*f^-1*(c+d*x)^3+-3*b*a^2*f^-1*(c+d*x)^3*log(1+exp(2*im*(e+f*x)))+-3*b^3*d^2*f^-3*(c+d*x)*log(1+exp(2*im*(e+f*x)))+3*a*b^2*f^-1*(c+d*x)^3*tan(e+f*x)+-3//2*d*b^3*f^-2*(c+d*x)^2*tan(e+f*x)+3//2*im*d*b^3*f^-2*(c+d*x)^2+3//2*im*b^3*d^3*f^-4*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+3//2*b^3*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+3//4*im*b*a^2*d^-1*(c+d*x)^4+3//4*im*b^3*d^3*f^-4*Polylogarithms.polylog(4,-1*exp(2*im*(e+f*x)))+9//2*a*b^2*d^3*f^-4*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+9*a*d*b^2*f^-2*(c+d*x)^2*log(1+exp(2*im*(e+f*x)))+-9//2*b*a^2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+-9//4*im*b*a^2*d^3*f^-4*Polylogarithms.polylog(4,-1*exp(2*im*(e+f*x)))+-3//2*im*d*b^3*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+-9*im*a*b^2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+9//2*im*b*d*a^2*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^3*(c+d*x)^2, x) == :(1//3*a^3*d^-1*(c+d*x)^3+b^3*f^-1*(c+d*x)^2*log(1+exp(2*im*(e+f*x)))+(1/2)*b^3*d^2*f^-1*x^2+(1/2)*b^3*d^2*f^-3*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+(1/2)*b^3*f^-1*(c+d*x)^2*tan(e+f*x)^2+-1*a*b^2*d^-1*(c+d*x)^3+-1*b^3*d^2*f^-3*log(cos(e+f*x))+-1//3*im*b^3*d^-1*(c+d*x)^3+im*b*a^2*d^-1*(c+d*x)^3+c*d*x*b^3*f^-1+-1*d*b^3*f^-2*(c+d*x)*tan(e+f*x)+-3*im*a*b^2*f^-1*(c+d*x)^2+-3*b*a^2*f^-1*(c+d*x)^2*log(1+exp(2*im*(e+f*x)))+3*a*b^2*f^-1*(c+d*x)^2*tan(e+f*x)+-3//2*b*a^2*d^2*f^-3*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+-1*im*d*b^3*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+-3*im*a*b^2*d^2*f^-3*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+6*a*d*b^2*f^-2*(c+d*x)*log(1+exp(2*im*(e+f*x)))+3*im*b*d*a^2*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^3*(c+d*x), x) == :((1/2)*a^3*d^-1*(c+d*x)^2+b^3*f^-1*(c+d*x)*log(1+exp(2*im*(e+f*x)))+(1/2)*d*x*b^3*f^-1+(1/2)*b^3*f^-1*tan(e+f*x)^2*(c+d*x)+-3*a*c*x*b^2+-3//2*a*d*b^2*x^2+-1//2*im*b^3*d^-1*(c+d*x)^2+-1//2*d*b^3*f^-2*tan(e+f*x)+-3*b*a^2*f^-1*(c+d*x)*log(1+exp(2*im*(e+f*x)))+3*a*d*b^2*f^-2*log(cos(e+f*x))+3*a*b^2*f^-1*(c+d*x)*tan(e+f*x)+-1//2*im*d*b^3*f^-2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+3//2*im*b*a^2*d^-1*(c+d*x)^2+3//2*im*b*d*a^2*f^-2*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^-1*(c+d*x)^3, x) == :(d^-1*(c+d*x)^4*(4a+4*im*b)^-1+b*f^-1*(c+d*x)^3*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x)))+3*im*b*d^3*f^-4*(4*a^2+4*b^2)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x)))+3*b*d^2*f^-3*(2*a^2+2*b^2)^-1*(c+d*x)*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x)))+-3*im*b*d*f^-2*(c+d*x)^2*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^-1*(c+d*x)^2, x) == :(d^-1*(c+d*x)^3*(3a+3*im*b)^-1+b*d^2*f^-3*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x)))+b*f^-1*(c+d*x)^2*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x)))+-1*im*b*d*f^-2*(a^2+b^2)^-1*(c+d*x)*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^-1*(c+d*x), x) == :(d^-1*(c+d*x)^2*(2a+2*im*b)^-1+b*f^-1*(a^2+b^2)^-1*(c+d*x)*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x)))+-1*im*b*d*f^-2*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x))))
@test integrate((a+b*tan(e+f*x))^-2*(c+d*x)^3, x) == :(1//4*d^-1*(a+-1*im*b)^-2*(c+d*x)^4+-1*b^2*d^-1*(c+d*x)^4*(a^2+b^2)^-2+b*d^-1*(a+-1*im*b)^-2*(c+d*x)^4*(-1b+im*a)^-1+-2*im*b^2*f^-1*(c+d*x)^3*(a^2+b^2)^-2+3//2*b^2*d^3*f^-4*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+3//2*b^2*d^3*f^-4*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-3*b*d^3*f^-4*(a+-1*im*b)^-2*(-2b+2*im*a)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-3*d*b^2*f^-2*(c+d*x)^2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-2*im*b^2*f^-1*(c+d*x)^3*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+2*b*f^-1*(a+im*b)^-1*(a+-1*im*b)^-2*(c+d*x)^3*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+2*b^2*f^-1*(a+im*b)^-1*(b+im*a)^-2*(c+d*x)^3*(-1b+im*a+(b+im*a)*exp(2*im*e+2*im*f*x))^-1+3*d*b^2*f^-2*(c+d*x)^2*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-3*im*b^2*d^2*f^-3*(a^2+b^2)^-2*(c+d*x)*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-3*im*b^2*d^2*f^-3*(a^2+b^2)^-2*(c+d*x)*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+3*b*d*f^-2*(a+-1*im*b)^-2*(c+d*x)^2*(-1b+im*a)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+3*b*d^2*f^-3*(a+im*b)^-1*(a+-1*im*b)^-2*(c+d*x)*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x)))
@test integrate((a+b*tan(e+f*x))^-2*(c+d*x)^2, x) == :(1//3*d^-1*(a+-1*im*b)^-2*(c+d*x)^3+-4//3*b^2*d^-1*(c+d*x)^3*(a^2+b^2)^-2+-2*im*b^2*f^-1*(c+d*x)^2*(a^2+b^2)^-2+4*b*d^-1*(a+-1*im*b)^-2*(c+d*x)^3*(-3b+3*im*a)^-1+b*d^2*f^-3*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-1*im*b^2*d^2*f^-3*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-1*im*b^2*d^2*f^-3*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-2*im*b^2*f^-1*(c+d*x)^2*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+-2*d*b^2*f^-2*(a^2+b^2)^-2*(c+d*x)*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+2*b*f^-1*(a+im*b)^-1*(a+-1*im*b)^-2*(c+d*x)^2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+2*d*b^2*f^-2*(a^2+b^2)^-2*(c+d*x)*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x))+2*b^2*f^-1*(a+im*b)^-1*(b+im*a)^-2*(c+d*x)^2*(-1b+im*a+(b+im*a)*exp(2*im*e+2*im*f*x))^-1+2*b*d*f^-2*(a+-1*im*b)^-2*(-1b+im*a)^-1*(c+d*x)*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*e+2*im*f*x)))
@test integrate((a+b*tan(e+f*x))^-2*(c+d*x), x) == :(-1*d^-1*(c+d*x)^2*(2*a^2+2*b^2)^-1+b*f^-2*(a^2+b^2)^-2*(b*d+2*a*c*f+2*a*d*f*x)*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x)))+-1*b*f^-1*(a+b*tan(e+f*x))^-1*(a^2+b^2)^-1*(c+d*x)+1//4*a^-1*d^-1*f^-2*(a+im*b)^-1*(a^2+b^2)^-1*(b*d+2*a*c*f+2*a*d*f*x)^2+-1*im*a*b*d*f^-2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(e+f*x))))

using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(x^3*(a+b*tan(c+d*x^2)), x) == :(1//4*a*x^4+1//4*im*b*x^4+-1//2*b*d^-1*x^2*log(1+exp(2*im*(c+d*x^2)))+1//4*im*b*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^2))))
@test integrate(x*(a+b*tan(c+d*x^2)), x) == :((1/2)*a*x^2+-1//2*b*d^-1*log(cos(c+d*x^2)))
@test integrate(x^3*(a+b*tan(c+d*x^2))^2, x) == :(-1//4*b^2*x^4+1//4*a^2*x^4+(1/2)*b^2*d^-2*log(cos(c+d*x^2))+(1/2)*im*a*b*x^4+(1/2)*b^2*d^-1*x^2*tan(c+d*x^2)+(1/2)*im*a*b*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^2)))+-1*a*b*d^-1*x^2*log(1+exp(2*im*(c+d*x^2))))
@test integrate(x*(a+b*tan(c+d*x^2))^2, x) == :((1/2)*x^2*(a^2+-1*b^2)+(1/2)*b^2*d^-1*tan(c+d*x^2)+-1*a*b*d^-1*log(cos(c+d*x^2)))
@test integrate(x^3*(a+b*tan(c+d*x^2))^-1, x) == :(x^4*(4a+4*im*b)^-1+b*d^-1*x^2*(2*a^2+2*b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2)))+-1*im*b*d^-2*(4*a^2+4*b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2))))
@test integrate(x*(a+b*tan(c+d*x^2))^-1, x) == :(a*x^2*(2*a^2+2*b^2)^-1+b*d^-1*(2*a^2+2*b^2)^-1*log(a*cos(c+d*x^2)+b*sin(c+d*x^2)))
@test integrate(x^3*(a+b*tan(c+d*x^2))^-2, x) == :(-1*x^4*(4*a^2+4*b^2)^-1+(1/2)*b*d^-2*(a^2+b^2)^-2*(b+2*a*d*x^2)*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2)))+-1*b*d^-1*x^2*(a+b*tan(c+d*x^2))^-1*(2*a^2+2*b^2)^-1+1//8*a^-1*d^-2*(a+im*b)^-1*(b+2*a*d*x^2)^2*(a^2+b^2)^-1+-1//2*im*a*b*d^-2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2))))
@test integrate(x*(a+b*tan(c+d*x^2))^-2, x) == :((1/2)*x^2*(a^2+b^2)^-2*(a^2+-1*b^2)+-1*b*d^-1*(a+b*tan(c+d*x^2))^-1*(2*a^2+2*b^2)^-1+a*b*d^-1*(a^2+b^2)^-2*log(a*cos(c+d*x^2)+b*sin(c+d*x^2)))
@test integrate(x^3*(a+b*tan(c+d*x^(1/2))), x) == :(1//4*a*x^4+1//4*im*b*x^4+-21*b*d^-3*x^5//2*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+-2*b*d^-1*x^7//2*log(1+exp(2*im*(c+d*x^(1/2))))+105*b*d^-5*x^3//2*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^(1/2))))+-315//2*b*d^-7*x^(1/2)*Polylogarithms.polylog(7,-1*exp(2*im*(c+d*x^(1/2))))+-315//4*im*b*d^-8*Polylogarithms.polylog(8,-1*exp(2*im*(c+d*x^(1/2))))+7*im*b*d^-2*x^3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2))))+-105//2*im*b*d^-4*x^2*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+315//2*im*b*x*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x^2*(a+b*tan(c+d*x^(1/2))), x) == :(1//3*a*x^3+1//3*im*b*x^3+-10*b*d^-3*x^3//2*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+-2*b*d^-1*x^5//2*log(1+exp(2*im*(c+d*x^(1/2))))+15*b*d^-5*x^(1/2)*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^(1/2))))+15//2*im*b*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^(1/2))))+-15*im*b*x*d^-4*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+5*im*b*d^-2*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x*(a+b*tan(c+d*x^(1/2))), x) == :((1/2)*a*x^2+(1/2)*im*b*x^2+-3*b*d^-3*x^(1/2)*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+-2*b*d^-1*x^3//2*log(1+exp(2*im*(c+d*x^(1/2))))+-3//2*im*b*d^-4*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+3*im*b*x*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2)))))
@test integrate(a+b*tan(c+d*x^(1/2)), x) == :(a*x+im*b*x+im*b*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2))))+-2*b*d^-1*x^(1/2)*log(1+exp(2*im*(c+d*x^(1/2)))))
@test integrate(x^2*(a+b*tan(c+d*x^(1/2)))^2, x) == :(-1//3*b^2*x^3+1//3*a^2*x^3+-15*b^2*d^-6*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^(1/2))))+-2*im*b^2*d^-1*x^5//2+2*b^2*d^-1*x^5//2*tan(c+d*x^(1/2))+10*b^2*d^-2*x^2*log(1+exp(2*im*(c+d*x^(1/2))))+30*x*b^2*d^-4*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+2//3*im*a*b*x^3+-20*im*b^2*d^-3*x^3//2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2))))+-20*a*b*d^-3*x^3//2*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+-4*a*b*d^-1*x^5//2*log(1+exp(2*im*(c+d*x^(1/2))))+15*im*a*b*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^(1/2))))+30*im*b^2*d^-5*x^(1/2)*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+30*a*b*d^-5*x^(1/2)*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^(1/2))))+-30*im*a*b*x*d^-4*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+10*im*a*b*d^-2*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x*(a+b*tan(c+d*x^(1/2)))^2, x) == :((1/2)*a^2*x^2+-1//2*b^2*x^2+3*b^2*d^-4*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+im*a*b*x^2+-2*im*b^2*d^-1*x^3//2+2*b^2*d^-1*x^3//2*tan(c+d*x^(1/2))+6*x*b^2*d^-2*log(1+exp(2*im*(c+d*x^(1/2))))+-6*im*b^2*d^-3*x^(1/2)*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2))))+-6*a*b*d^-3*x^(1/2)*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+-4*a*b*d^-1*x^3//2*log(1+exp(2*im*(c+d*x^(1/2))))+-3*im*a*b*d^-4*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+6*im*a*b*x*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2)))))
@test integrate((a+b*tan(c+d*x^(1/2)))^2, x) == :(x*a^2+-1*x*b^2+2*b^2*d^-2*log(cos(c+d*x^(1/2)))+2*im*a*b*x+2*b^2*d^-1*x^(1/2)*tan(c+d*x^(1/2))+-4*a*b*d^-1*x^(1/2)*log(1+exp(2*im*(c+d*x^(1/2))))+2*im*a*b*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x^3*(a+b*tan(c+d*x^(1/2)))^-1, x) == :(x^4*(4a+4*im*b)^-1+-105*b*d^-5*x^3//2*(a^2+b^2)^-1*Polylogarithms.polylog(5,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+2*b*d^-1*x^7//2*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+21*b*d^-3*x^5//2*(a^2+b^2)^-1*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+315*im*b*d^-8*(4*a^2+4*b^2)^-1*Polylogarithms.polylog(8,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+315*b*d^-7*x^(1/2)*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(7,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+-315*im*b*x*d^-6*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(6,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+-7*im*b*d^-2*x^3*(a^2+b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+105*im*b*d^-4*x^2*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x^2*(a+b*tan(c+d*x^(1/2)))^-1, x) == :(x^3*(3a+3*im*b)^-1+-15*im*b*d^-6*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(6,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+-15*b*d^-5*x^(1/2)*(a^2+b^2)^-1*Polylogarithms.polylog(5,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+2*b*d^-1*x^5//2*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+10*b*d^-3*x^3//2*(a^2+b^2)^-1*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+-5*im*b*d^-2*x^2*(a^2+b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+15*im*b*x*d^-4*(a^2+b^2)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x*(a+b*tan(c+d*x^(1/2)))^-1, x) == :(x^2*(2a+2*im*b)^-1+2*b*d^-1*x^3//2*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+3*im*b*d^-4*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+3*b*d^-3*x^(1/2)*(a^2+b^2)^-1*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+-3*im*b*x*d^-2*(a^2+b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2)))))
@test integrate((a+b*tan(c+d*x^(1/2)))^-1, x) == :(x*(a+im*b)^-1+-1*im*b*d^-2*(a^2+b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+2*b*d^-1*x^(1/2)*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x^2*(a+b*tan(c+d*x^(1/2)))^-2, x) == :(1//3*x^3*(a+-1*im*b)^-2+-4//3*b^2*x^3*(a^2+b^2)^-2+-15*b^2*d^-6*(a^2+b^2)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-15*b^2*d^-6*(a^2+b^2)^-2*Polylogarithms.polylog(6,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+4*b*x^3*(a+-1*im*b)^-2*(-3b+3*im*a)^-1+-10*b^2*d^-2*x^2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-4*im*b^2*d^-1*x^5//2*(a^2+b^2)^-2+10*b^2*d^-2*x^2*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+15*b*d^-6*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(6,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+30*x*b^2*d^-4*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+30*x*b^2*d^-4*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-30*b*x*d^-4*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-30*b*d^-5*x^(1/2)*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-20*im*b^2*d^-3*x^3//2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-20*im*b^2*d^-3*x^3//2*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-4*im*b^2*d^-1*x^5//2*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+4*b*d^-1*x^5//2*(a+im*b)^-1*(a+-1*im*b)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+4*b^2*d^-1*x^5//2*(a+im*b)^-1*(b+im*a)^-2*(-1b+im*a+(b+im*a)*exp(2*im*(c+d*x^(1/2))))^-1+10*b*d^-2*x^2*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+20*b*d^-3*x^3//2*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+30*im*b^2*d^-5*x^(1/2)*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+30*im*b^2*d^-5*x^(1/2)*(a^2+b^2)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x*(a+b*tan(c+d*x^(1/2)))^-2, x) == :((1/2)*x^2*(a+-1*im*b)^-2+-2*b^2*x^2*(a^2+b^2)^-2+2*b*x^2*(a+-1*im*b)^-2*(-1b+im*a)^-1+3*b^2*d^-4*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+3*b^2*d^-4*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-6*x*b^2*d^-2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-4*im*b^2*d^-1*x^3//2*(a^2+b^2)^-2+-3*b*d^-4*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+6*x*b^2*d^-2*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-6*im*b^2*d^-3*x^(1/2)*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-6*im*b^2*d^-3*x^(1/2)*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+-4*im*b^2*d^-1*x^3//2*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+4*b*d^-1*x^3//2*(a+im*b)^-1*(a+-1*im*b)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+4*b^2*d^-1*x^3//2*(a+im*b)^-1*(b+im*a)^-2*(-1b+im*a+(b+im*a)*exp(2*im*(c+d*x^(1/2))))^-1+6*b*x*d^-2*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2))))+6*b*d^-3*x^(1/2)*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^(1/2)))))
@test integrate((a+b*tan(c+d*x^(1/2)))^-2, x) == :(-1*x*(a^2+b^2)^-1+(1/2)*a^-1*d^-2*(a+im*b)^-1*(b+2*a*d*x^(1/2))^2*(a^2+b^2)^-1+-2*b*d^-1*x^(1/2)*(a+b*tan(c+d*x^(1/2)))^-1*(a^2+b^2)^-1+2*b*d^-2*(a^2+b^2)^-2*(b+2*a*d*x^(1/2))*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2))))+-2*im*a*b*d^-2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^(1/2)))))
@test integrate(x^2*(a+b*tan(c+d*x^1//3)), x) == :(1//3*a*x^3+1//3*im*b*x^3+945//2*b*d^-9*Polylogarithms.polylog(9,-1*exp(2*im*(c+d*x^1//3)))+-945*b*d^-7*x^2//3*Polylogarithms.polylog(7,-1*exp(2*im*(c+d*x^1//3)))+-42*b*d^-3*x^2*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+-3*b*d^-1*x^8//3*log(1+exp(2*im*(c+d*x^1//3)))+315*b*d^-5*x^4//3*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^1//3)))+-945*im*b*d^-8*x^1//3*Polylogarithms.polylog(8,-1*exp(2*im*(c+d*x^1//3)))+-126*im*b*d^-4*x^5//3*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^1//3)))+12*im*b*d^-2*x^7//3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3)))+630*im*b*x*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^1//3))))
@test integrate(x*(a+b*tan(c+d*x^1//3)), x) == :((1/2)*a*x^2+(1/2)*im*b*x^2+-15*b*x*d^-3*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+-3*b*d^-1*x^5//3*log(1+exp(2*im*(c+d*x^1//3)))+45//2*b*d^-5*x^1//3*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^1//3)))+45//4*im*b*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^1//3)))+-45//2*im*b*d^-4*x^2//3*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^1//3)))+15//2*im*b*d^-2*x^4//3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3))))
@test integrate(a+b*tan(c+d*x^1//3), x) == :(a*x+im*b*x+-3//2*b*d^-3*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+-3*b*d^-1*x^2//3*log(1+exp(2*im*(c+d*x^1//3)))+3*im*b*d^-2*x^1//3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3))))
@test integrate(x^2*(a+b*tan(c+d*x^1//3))^2, x) == :(-1//3*b^2*x^3+1//3*a^2*x^3+-1260*x*b^2*d^-6*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^1//3)))+-3*im*b^2*d^-1*x^8//3+3*b^2*d^-1*x^8//3*tan(c+d*x^1//3)+24*b^2*d^-2*x^7//3*log(1+exp(2*im*(c+d*x^1//3)))+252*b^2*d^-4*x^5//3*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+945*im*b^2*d^-9*Polylogarithms.polylog(8,-1*exp(2*im*(c+d*x^1//3)))+945*a*b*d^-9*Polylogarithms.polylog(9,-1*exp(2*im*(c+d*x^1//3)))+1890*b^2*d^-8*x^1//3*Polylogarithms.polylog(7,-1*exp(2*im*(c+d*x^1//3)))+2//3*im*a*b*x^3+-1890*im*b^2*d^-7*x^2//3*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^1//3)))+-1890*a*b*d^-7*x^2//3*Polylogarithms.polylog(7,-1*exp(2*im*(c+d*x^1//3)))+-84*im*b^2*d^-3*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3)))+-84*a*b*d^-3*x^2*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+-6*a*b*d^-1*x^8//3*log(1+exp(2*im*(c+d*x^1//3)))+630*im*b^2*d^-5*x^4//3*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^1//3)))+630*a*b*d^-5*x^4//3*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^1//3)))+-1890*im*a*b*d^-8*x^1//3*Polylogarithms.polylog(8,-1*exp(2*im*(c+d*x^1//3)))+-252*im*a*b*d^-4*x^5//3*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^1//3)))+24*im*a*b*d^-2*x^7//3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3)))+1260*im*a*b*x*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^1//3))))
@test integrate(x*(a+b*tan(c+d*x^1//3))^2, x) == :((1/2)*a^2*x^2+-1//2*b^2*x^2+-45//2*b^2*d^-6*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^1//3)))+im*a*b*x^2+-3*im*b^2*d^-1*x^5//3+3*b^2*d^-1*x^5//3*tan(c+d*x^1//3)+15*b^2*d^-2*x^4//3*log(1+exp(2*im*(c+d*x^1//3)))+45*b^2*d^-4*x^2//3*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+-30*im*x*b^2*d^-3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3)))+-30*a*b*x*d^-3*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+-6*a*b*d^-1*x^5//3*log(1+exp(2*im*(c+d*x^1//3)))+45*im*b^2*d^-5*x^1//3*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^1//3)))+45*a*b*d^-5*x^1//3*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^1//3)))+45//2*im*a*b*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^1//3)))+-45*im*a*b*d^-4*x^2//3*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^1//3)))+15*im*a*b*d^-2*x^4//3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3))))
@test integrate((a+b*tan(c+d*x^1//3))^2, x) == :(x*a^2+-1*x*b^2+-3*im*b^2*d^-1*x^2//3+-3*im*b^2*d^-3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3)))+-3*a*b*d^-3*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^1//3)))+2*im*a*b*x+3*b^2*d^-1*x^2//3*tan(c+d*x^1//3)+6*b^2*d^-2*x^1//3*log(1+exp(2*im*(c+d*x^1//3)))+-6*a*b*d^-1*x^2//3*log(1+exp(2*im*(c+d*x^1//3)))+6*im*a*b*d^-2*x^1//3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^1//3))))
@test integrate(x^2*(a+b*tan(c+d*x^1//3))^-1, x) == :(x^3*(3a+3*im*b)^-1+-945*b*d^-9*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(9,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+-315*b*d^-5*x^4//3*(a^2+b^2)^-1*Polylogarithms.polylog(5,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+3*b*d^-1*x^8//3*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+42*b*d^-3*x^2*(a^2+b^2)^-1*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+945*b*d^-7*x^2//3*(a^2+b^2)^-1*Polylogarithms.polylog(7,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+-630*im*b*x*d^-6*(a^2+b^2)^-1*Polylogarithms.polylog(6,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+-12*im*b*d^-2*x^7//3*(a^2+b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+126*im*b*d^-4*x^5//3*(a^2+b^2)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+945*im*b*d^-8*x^1//3*(a^2+b^2)^-1*Polylogarithms.polylog(8,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3))))
@test integrate(x*(a+b*tan(c+d*x^1//3))^-1, x) == :(x^2*(2a+2*im*b)^-1+-45*im*b*d^-6*(4*a^2+4*b^2)^-1*Polylogarithms.polylog(6,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+-45*b*d^-5*x^1//3*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(5,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+3*b*d^-1*x^5//3*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+15*b*x*d^-3*(a^2+b^2)^-1*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+-15*im*b*d^-2*x^4//3*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+45*im*b*d^-4*x^2//3*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3))))
@test integrate((a+b*tan(c+d*x^1//3))^-1, x) == :(x*(a+im*b)^-1+3*b*d^-3*(2*a^2+2*b^2)^-1*Polylogarithms.polylog(3,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+3*b*d^-1*x^2//3*(a^2+b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3)))+-3*im*b*d^-2*x^1//3*(a^2+b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^1//3))))
@test integrate(x^2*(a+b*tan(c+d*x^1//3))^-2, x) == :(1//3*x^3*(a+-1*im*b)^-2+-4//3*b^2*x^3*(a^2+b^2)^-2+4*b*x^3*(a+-1*im*b)^-2*(-3b+3*im*a)^-1+-1260*x*b^2*d^-6*(a^2+b^2)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-1260*x*b^2*d^-6*(a^2+b^2)^-2*Polylogarithms.polylog(6,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-945*b*d^-9*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(9,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-24*b^2*d^-2*x^7//3*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-6*im*b^2*d^-1*x^8//3*(a^2+b^2)^-2+24*b^2*d^-2*x^7//3*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+252*b^2*d^-4*x^5//3*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+252*b^2*d^-4*x^5//3*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+945*im*b^2*d^-9*(a^2+b^2)^-2*Polylogarithms.polylog(8,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+945*im*b^2*d^-9*(a^2+b^2)^-2*Polylogarithms.polylog(9,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+1890*b^2*d^-8*x^1//3*(a^2+b^2)^-2*Polylogarithms.polylog(7,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+1890*b^2*d^-8*x^1//3*(a^2+b^2)^-2*Polylogarithms.polylog(8,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-1890*im*b^2*d^-7*x^2//3*(a^2+b^2)^-2*Polylogarithms.polylog(6,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-1890*im*b^2*d^-7*x^2//3*(a^2+b^2)^-2*Polylogarithms.polylog(7,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-1890*b*d^-8*x^1//3*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(8,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-630*b*d^-5*x^4//3*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-252*b*d^-4*x^5//3*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-84*im*b^2*d^-3*x^2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-84*im*b^2*d^-3*x^2*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-6*im*b^2*d^-1*x^8//3*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b*d^-1*x^8//3*(a+im*b)^-1*(a+-1*im*b)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b^2*d^-1*x^8//3*(a+im*b)^-1*(b+im*a)^-2*(-1b+im*a+(b+im*a)*exp(2*im*(c+d*x^1//3)))^-1+24*b*d^-2*x^7//3*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+84*b*d^-3*x^2*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+630*im*b^2*d^-5*x^4//3*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+630*im*b^2*d^-5*x^4//3*(a^2+b^2)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+1260*b*x*d^-6*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(6,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+1890*b*d^-7*x^2//3*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(7,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3))))
@test integrate(x*(a+b*tan(c+d*x^1//3))^-2, x) == :((1/2)*x^2*(a+-1*im*b)^-2+-2*b^2*x^2*(a^2+b^2)^-2+2*b*x^2*(a+-1*im*b)^-2*(-1b+im*a)^-1+-45//2*b^2*d^-6*(a^2+b^2)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-45//2*b^2*d^-6*(a^2+b^2)^-2*Polylogarithms.polylog(6,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-15*b^2*d^-2*x^4//3*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-6*im*b^2*d^-1*x^5//3*(a^2+b^2)^-2+15*b^2*d^-2*x^4//3*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+45*b*d^-6*(a+-1*im*b)^-2*(-2b+2*im*a)^-1*Polylogarithms.polylog(6,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+45*b^2*d^-4*x^2//3*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+45*b^2*d^-4*x^2//3*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-45*b*d^-5*x^1//3*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-45*b*d^-4*x^2//3*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-30*im*x*b^2*d^-3*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-30*im*x*b^2*d^-3*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-6*im*b^2*d^-1*x^5//3*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b*d^-1*x^5//3*(a+im*b)^-1*(a+-1*im*b)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b^2*d^-1*x^5//3*(a+im*b)^-1*(b+im*a)^-2*(-1b+im*a+(b+im*a)*exp(2*im*(c+d*x^1//3)))^-1+15*b*d^-2*x^4//3*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+30*b*x*d^-3*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+45*im*b^2*d^-5*x^1//3*(a^2+b^2)^-2*Polylogarithms.polylog(4,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+45*im*b^2*d^-5*x^1//3*(a^2+b^2)^-2*Polylogarithms.polylog(5,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3))))
@test integrate((a+b*tan(c+d*x^1//3))^-2, x) == :(x*(a+-1*im*b)^-2+-4*x*b^2*(a^2+b^2)^-2+4*b*x*(a+-1*im*b)^-2*(-1b+im*a)^-1+-6*im*b^2*d^-1*x^2//3*(a^2+b^2)^-2+-6*b^2*d^-2*x^1//3*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-3*im*b^2*d^-3*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-3*im*b^2*d^-3*(a^2+b^2)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+3*b*d^-3*(a+im*b)^-1*(a+-1*im*b)^-2*Polylogarithms.polylog(3,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b^2*d^-2*x^1//3*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+-6*im*b^2*d^-1*x^2//3*(a^2+b^2)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b*d^-1*x^2//3*(a+im*b)^-1*(a+-1*im*b)^-2*log(1+(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b*d^-2*x^1//3*(a+-1*im*b)^-2*(-1b+im*a)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-1*(a+-1*im*b)*exp(2*im*(c+d*x^1//3)))+6*b^2*d^-1*x^2//3*(a+im*b)^-1*(b+im*a)^-2*(-1b+im*a+(b+im*a)*exp(2*im*(c+d*x^1//3)))^-1)

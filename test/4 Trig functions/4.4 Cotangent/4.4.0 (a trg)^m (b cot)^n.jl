using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(cot(a+b*x), x) == :(b^-1*log(sin(a+b*x)))
@test integrate(cot(a+b*x)^2, x) == :(-1x+-1*b^-1*cot(a+b*x))
@test integrate(cot(a+b*x)^3, x) == :(-1*b^-1*log(sin(a+b*x))+-1//2*b^-1*cot(a+b*x)^2)
@test integrate(cot(a+b*x)^4, x) == :(x+b^-1*cot(a+b*x)+-1//3*b^-1*cot(a+b*x)^3)
@test integrate(cot(a+b*x)^5, x) == :(b^-1*log(sin(a+b*x))+(1/2)*b^-1*cot(a+b*x)^2+-1//4*b^-1*cot(a+b*x)^4)
@test integrate(cot(a+b*x)^6, x) == :(-1x+-1*b^-1*cot(a+b*x)+-1//5*b^-1*cot(a+b*x)^5+1//3*b^-1*cot(a+b*x)^3)
@test integrate(cot(a+b*x)^7, x) == :(-1*b^-1*log(sin(a+b*x))+-1//2*b^-1*cot(a+b*x)^2+-1//6*b^-1*cot(a+b*x)^6+1//4*b^-1*cot(a+b*x)^4)
@test integrate(cot(a+b*x)^8, x) == :(x+b^-1*cot(a+b*x)+-1//3*b^-1*cot(a+b*x)^3+-1//7*b^-1*cot(a+b*x)^7+1//5*b^-1*cot(a+b*x)^5)
@test integrate((c*cot(a+b*x))^7//2, x) == :(2*b^-1*c^3*(c*cot(a+b*x))^(1/2)+-2//5*c*b^-1*(c*cot(a+b*x))^5//2+(1/2)*2^(1/2)*b^-1*c^7//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^7//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^7//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x))+1//4*2^(1/2)*b^-1*c^7//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2)))
@test integrate((c*cot(a+b*x))^5//2, x) == :(-2//3*c*b^-1*(c*cot(a+b*x))^3//2+(1/2)*2^(1/2)*b^-1*c^5//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^5//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^5//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x))+1//4*2^(1/2)*b^-1*c^5//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2)))
@test integrate((c*cot(a+b*x))^3//2, x) == :(-2*c*b^-1*(c*cot(a+b*x))^(1/2)+(1/2)*2^(1/2)*b^-1*c^3//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^3//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^3//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2))+1//4*2^(1/2)*b^-1*c^3//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x)))
@test integrate((c*cot(a+b*x))^(1/2), x) == :((1/2)*2^(1/2)*b^-1*c^(1/2)*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^(1/2)*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^(1/2)*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2))+1//4*2^(1/2)*b^-1*c^(1/2)*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x)))
@test integrate((c*cot(a+b*x))^-1//2, x) == :((1/2)*2^(1/2)*b^-1*c^-1//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^-1//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^-1//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x))+1//4*2^(1/2)*b^-1*c^-1//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2)))
@test integrate((c*cot(a+b*x))^-3//2, x) == :(2*b^-1*c^-1*(c*cot(a+b*x))^-1//2+(1/2)*2^(1/2)*b^-1*c^-3//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^-3//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^-3//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x))+1//4*2^(1/2)*b^-1*c^-3//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2)))
@test integrate((c*cot(a+b*x))^-5//2, x) == :(2//3*b^-1*c^-1*(c*cot(a+b*x))^-3//2+(1/2)*2^(1/2)*b^-1*c^-5//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^-5//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^-5//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2))+1//4*2^(1/2)*b^-1*c^-5//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x)))
@test integrate((c*cot(a+b*x))^-7//2, x) == :(-2*b^-1*c^-3*(c*cot(a+b*x))^-1//2+2//5*b^-1*c^-1*(c*cot(a+b*x))^-5//2+(1/2)*2^(1/2)*b^-1*c^-7//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^-7//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^-7//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2))+1//4*2^(1/2)*b^-1*c^-7//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x)))
@test integrate((c*cot(a+b*x))^4//3, x) == :(b^-1*c^4//3*arctan(c^-1//3*(c*cot(a+b*x))^1//3)+(1/2)*b^-1*c^4//3*arctan(3^(1/2)+2*c^-1//3*(c*cot(a+b*x))^1//3)+-3*c*b^-1*(c*cot(a+b*x))^1//3+-1//2*b^-1*c^4//3*arctan(3^(1/2)+-2*c^-1//3*(c*cot(a+b*x))^1//3)+-1//4*3^(1/2)*b^-1*c^4//3*log(c^2//3+(c*cot(a+b*x))^2//3+-1*3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3)+1//4*3^(1/2)*b^-1*c^4//3*log(c^2//3+(c*cot(a+b*x))^2//3+3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3))
@test integrate((c*cot(a+b*x))^2//3, x) == :((1/2)*b^-1*c^2//3*arctan(3^(1/2)+-2*c^-1//3*(c*cot(a+b*x))^1//3)+-1*b^-1*c^2//3*arctan(c^-1//3*(c*cot(a+b*x))^1//3)+-1//2*b^-1*c^2//3*arctan(3^(1/2)+2*c^-1//3*(c*cot(a+b*x))^1//3)+-1//4*3^(1/2)*b^-1*c^2//3*log(c^2//3+(c*cot(a+b*x))^2//3+-1*3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3)+1//4*3^(1/2)*b^-1*c^2//3*log(c^2//3+(c*cot(a+b*x))^2//3+3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3))
@test integrate((c*cot(a+b*x))^1//3, x) == :((1/2)*b^-1*c^1//3*log(c^2//3+(c*cot(a+b*x))^2//3)+-1//4*b^-1*c^1//3*log(c^4//3+(c*cot(a+b*x))^4//3+-1*c^2//3*(c*cot(a+b*x))^2//3)+(1/2)*3^(1/2)*b^-1*c^1//3*arctan(1//3*3^(1/2)*c^-2//3*(c^2//3+-2*(c*cot(a+b*x))^2//3)))
@test integrate((c*cot(a+b*x))^-1//3, x) == :(-1//2*b^-1*c^-1//3*log(c^2//3+(c*cot(a+b*x))^2//3)+1//4*b^-1*c^-1//3*log(c^4//3+(c*cot(a+b*x))^4//3+-1*c^2//3*(c*cot(a+b*x))^2//3)+(1/2)*3^(1/2)*b^-1*c^-1//3*arctan(1//3*3^(1/2)*c^-2//3*(c^2//3+-2*(c*cot(a+b*x))^2//3)))
@test integrate((c*cot(a+b*x))^-2//3, x) == :((1/2)*b^-1*c^-2//3*arctan(3^(1/2)+-2*c^-1//3*(c*cot(a+b*x))^1//3)+-1*b^-1*c^-2//3*arctan(c^-1//3*(c*cot(a+b*x))^1//3)+-1//2*b^-1*c^-2//3*arctan(3^(1/2)+2*c^-1//3*(c*cot(a+b*x))^1//3)+-1//4*3^(1/2)*b^-1*c^-2//3*log(c^2//3+(c*cot(a+b*x))^2//3+3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3)+1//4*3^(1/2)*b^-1*c^-2//3*log(c^2//3+(c*cot(a+b*x))^2//3+-1*3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3))
@test integrate((c*cot(a+b*x))^-4//3, x) == :(b^-1*c^-4//3*arctan(c^-1//3*(c*cot(a+b*x))^1//3)+(1/2)*b^-1*c^-4//3*arctan(3^(1/2)+2*c^-1//3*(c*cot(a+b*x))^1//3)+3*b^-1*c^-1*(c*cot(a+b*x))^-1//3+-1//2*b^-1*c^-4//3*arctan(3^(1/2)+-2*c^-1//3*(c*cot(a+b*x))^1//3)+-1//4*3^(1/2)*b^-1*c^-4//3*log(c^2//3+(c*cot(a+b*x))^2//3+3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3)+1//4*3^(1/2)*b^-1*c^-4//3*log(c^2//3+(c*cot(a+b*x))^2//3+-1*3^(1/2)*c^1//3*(c*cot(a+b*x))^1//3))
@test integrate((a*cot(x)^2)^3//2, x) == :(-1//2*a*(a*cot(x)^2)^(1/2)*cot(x)+-1*a*(a*cot(x)^2)^(1/2)*log(sin(x))*tan(x))
@test integrate((a*cot(x)^2)^(1/2), x) == :((a*cot(x)^2)^(1/2)*log(sin(x))*tan(x))
@test integrate((a*cot(x)^2)^-1//2, x) == :(-1*(a*cot(x)^2)^-1//2*cot(x)*log(cos(x)))
@test integrate((a*cot(x)^2)^-3//2, x) == :((1/2)*a^-1*(a*cot(x)^2)^-1//2*tan(x)+a^-1*(a*cot(x)^2)^-1//2*cot(x)*log(cos(x)))
@test integrate((a*cot(x)^3)^3//2, x) == :(2//3*a*(a*cot(x)^3)^(1/2)+-2//7*a*(a*cot(x)^3)^(1/2)*cot(x)^2+(1/2)*a*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*arctan(1+-1*2^(1/2)*cot(x)^(1/2))+-1//2*a*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*arctan(1+2^(1/2)*cot(x)^(1/2))+-1//4*a*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*log(1+-1*2^(1/2)*cot(x)^(1/2)+cot(x))+1//4*a*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*log(1+2^(1/2)*cot(x)^(1/2)+cot(x)))
@test integrate((a*cot(x)^3)^(1/2), x) == :(-2*(a*cot(x)^3)^(1/2)*tan(x)+(1/2)*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*arctan(1+2^(1/2)*cot(x)^(1/2))+-1//2*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*arctan(1+-1*2^(1/2)*cot(x)^(1/2))+-1//4*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*log(1+-1*2^(1/2)*cot(x)^(1/2)+cot(x))+1//4*2^(1/2)*(a*cot(x)^3)^(1/2)*cot(x)^-3//2*log(1+2^(1/2)*cot(x)^(1/2)+cot(x)))
@test integrate((a*cot(x)^3)^-1//2, x) == :(2*(a*cot(x)^3)^-1//2*cot(x)+(1/2)*2^(1/2)*(a*cot(x)^3)^-1//2*cot(x)^3//2*arctan(1+2^(1/2)*cot(x)^(1/2))+-1//2*2^(1/2)*(a*cot(x)^3)^-1//2*cot(x)^3//2*arctan(1+-1*2^(1/2)*cot(x)^(1/2))+-1//4*2^(1/2)*(a*cot(x)^3)^-1//2*cot(x)^3//2*log(1+2^(1/2)*cot(x)^(1/2)+cot(x))+1//4*2^(1/2)*(a*cot(x)^3)^-1//2*cot(x)^3//2*log(1+-1*2^(1/2)*cot(x)^(1/2)+cot(x)))
@test integrate((a*cot(x)^3)^-3//2, x) == :(-2//3*a^-1*(a*cot(x)^3)^-1//2+2//7*a^-1*(a*cot(x)^3)^-1//2*tan(x)^2+(1/2)*2^(1/2)*a^-1*(a*cot(x)^3)^-1//2*cot(x)^3//2*arctan(1+-1*2^(1/2)*cot(x)^(1/2))+-1//2*2^(1/2)*a^-1*(a*cot(x)^3)^-1//2*cot(x)^3//2*arctan(1+2^(1/2)*cot(x)^(1/2))+-1//4*2^(1/2)*a^-1*(a*cot(x)^3)^-1//2*cot(x)^3//2*log(1+2^(1/2)*cot(x)^(1/2)+cot(x))+1//4*2^(1/2)*a^-1*(a*cot(x)^3)^-1//2*cot(x)^3//2*log(1+-1*2^(1/2)*cot(x)^(1/2)+cot(x)))
@test integrate((a*cot(x)^4)^3//2, x) == :(-1*a*(a*cot(x)^4)^(1/2)*tan(x)+-1//5*a*(a*cot(x)^4)^(1/2)*cot(x)^3+1//3*a*(a*cot(x)^4)^(1/2)*cot(x)+-1*a*x*(a*cot(x)^4)^(1/2)*tan(x)^2)
@test integrate((a*cot(x)^4)^(1/2), x) == :(-1*(a*cot(x)^4)^(1/2)*tan(x)+-1*x*(a*cot(x)^4)^(1/2)*tan(x)^2)
@test integrate((a*cot(x)^4)^-1//2, x) == :((a*cot(x)^4)^-1//2*cot(x)+-1*x*(a*cot(x)^4)^-1//2*cot(x)^2)
@test integrate((a*cot(x)^4)^-3//2, x) == :(a^-1*(a*cot(x)^4)^-1//2*cot(x)+-1//3*a^-1*(a*cot(x)^4)^-1//2*tan(x)+1//5*a^-1*(a*cot(x)^4)^-1//2*tan(x)^3+-1*x*a^-1*(a*cot(x)^4)^-1//2*cot(x)^2)
@test integrate((d*cot(e+f*x))^n*csc(e+f*x)^6, x) == :(-1*d^-1*f^-1*(d*cot(e+f*x))^(1+n)*(1+n)^-1+-1*d^-5*f^-1*(d*cot(e+f*x))^(5+n)*(5+n)^-1+-2*d^-3*f^-1*(d*cot(e+f*x))^(3+n)*(3+n)^-1)
@test integrate((d*cot(e+f*x))^n*csc(e+f*x)^4, x) == :(-1*d^-1*f^-1*(d*cot(e+f*x))^(1+n)*(1+n)^-1+-1*d^-3*f^-1*(d*cot(e+f*x))^(3+n)*(3+n)^-1)
@test integrate((d*cot(e+f*x))^n*csc(e+f*x)^2, x) == :(-1*d^-1*f^-1*(d*cot(e+f*x))^(1+n)*(1+n)^-1)

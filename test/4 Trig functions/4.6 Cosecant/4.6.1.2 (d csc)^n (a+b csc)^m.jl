using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((a+a*csc(x))^-1*csc(x)^5, x) == :(-4*a^-1*cot(x)+-4//3*a^-1*cot(x)^3+3//2*a^-1*arctanh(cos(x))+(a+a*csc(x))^-1*csc(x)^3*cot(x)+3//2*a^-1*cot(x)*csc(x))
@test integrate((a+a*csc(x))^-1*csc(x)^4, x) == :(2*a^-1*cot(x)+-3//2*a^-1*arctanh(cos(x))+(a+a*csc(x))^-1*csc(x)^2*cot(x)+-3//2*a^-1*cot(x)*csc(x))
@test integrate((a+a*csc(x))^-1*csc(x)^3, x) == :(a^-1*arctanh(cos(x))+-1*a^-1*cot(x)+-1*(a+a*csc(x))^-1*cot(x))
@test integrate((a+a*csc(x))^-1*csc(x)^2, x) == :((a+a*csc(x))^-1*cot(x)+-1*a^-1*arctanh(cos(x)))
@test integrate((a+a*csc(x))^-1*csc(x), x) == :(-1*(a+a*csc(x))^-1*cot(x))
@test integrate((a+a*csc(c+d*x))^-1, x) == :(x*a^-1+d^-1*(a+a*csc(c+d*x))^-1*cot(c+d*x))
@test integrate((a+a*csc(x))^-1*sin(x), x) == :((a+a*csc(x))^-1*cos(x)+-1*x*a^-1+-2*a^-1*cos(x))
@test integrate((a+a*csc(x))^-1*sin(x)^2, x) == :(2*a^-1*cos(x)+3//2*x*a^-1+(a+a*csc(x))^-1*cos(x)*sin(x)+-3//2*a^-1*cos(x)*sin(x))
@test integrate((a+a*csc(x))^-1*sin(x)^3, x) == :(-4*a^-1*cos(x)+-3//2*x*a^-1+4//3*a^-1*cos(x)^3+(a+a*csc(x))^-1*sin(x)^2*cos(x)+3//2*a^-1*cos(x)*sin(x))
@test integrate((a+a*csc(x))^-1*sin(x)^4, x) == :(4*a^-1*cos(x)+-4//3*a^-1*cos(x)^3+15//8*x*a^-1+(a+a*csc(x))^-1*sin(x)^3*cos(x)+-15//8*a^-1*cos(x)*sin(x)+-5//4*a^-1*sin(x)^3*cos(x))
@test integrate((a+a*csc(c+d*x))^-2, x) == :(x*a^-2+1//3*d^-1*(a+a*csc(c+d*x))^-2*cot(c+d*x)+4//3*a^-2*d^-1*(1+csc(c+d*x))^-1*cot(c+d*x))
@test integrate((a+a*csc(c+d*x))^-3, x) == :(x*a^-3+1//5*d^-1*(a+a*csc(c+d*x))^-3*cot(c+d*x)+22//15*d^-1*(a^3+a^3*csc(c+d*x))^-1*cot(c+d*x)+7//15*a^-1*d^-1*(a+a*csc(c+d*x))^-2*cot(c+d*x))
@test integrate((a+a*csc(x))^5//2, x) == :(-2*a^5//2*arctan(a^(1/2)*(a+a*csc(x))^-1//2*cot(x))+-14//3*a^3*(a+a*csc(x))^-1//2*cot(x)+-2//3*a^2*(a+a*csc(x))^(1/2)*cot(x))
@test integrate((a+a*csc(x))^3//2, x) == :(-2*a^3//2*arctan(a^(1/2)*(a+a*csc(x))^-1//2*cot(x))+-2*a^2*(a+a*csc(x))^-1//2*cot(x))
@test integrate((a+a*csc(x))^(1/2), x) == :(-2*a^(1/2)*arctan(a^(1/2)*(a+a*csc(x))^-1//2*cot(x)))
@test integrate((a+a*csc(x))^-1//2, x) == :(-2*a^-1//2*arctan(a^(1/2)*(a+a*csc(x))^-1//2*cot(x))+2^(1/2)*a^-1//2*arctan((1/2)*2^(1/2)*a^(1/2)*(a+a*csc(x))^-1//2*cot(x)))
@test integrate((a+a*csc(x))^-3//2, x) == :((1/2)*(a+a*csc(x))^-3//2*cot(x)+-2*a^-3//2*arctan(a^(1/2)*(a+a*csc(x))^-1//2*cot(x))+5//4*2^(1/2)*a^-3//2*arctan((1/2)*2^(1/2)*a^(1/2)*(a+a*csc(x))^-1//2*cot(x)))
@test integrate((a+a*csc(x))^-5//2, x) == :(-2*a^-5//2*arctan(a^(1/2)*(a+a*csc(x))^-1//2*cot(x))+1//4*(a+a*csc(x))^-5//2*cot(x)+11//16*a^-1*(a+a*csc(x))^-3//2*cot(x)+43//32*2^(1/2)*a^-5//2*arctan((1/2)*2^(1/2)*a^(1/2)*(a+a*csc(x))^-1//2*cot(x)))
@test integrate((a+a*csc(e+f*x))^(1/2)*csc(e+f*x)^(1/2), x) == :(-2*a^(1/2)*f^-1*arcsinh(a^(1/2)*(a+a*csc(e+f*x))^-1//2*cot(e+f*x)))
@test integrate((-1*csc(e+f*x))^(1/2)*(a+-1*a*csc(e+f*x))^(1/2), x) == :(-2*a^(1/2)*f^-1*arcsinh(a^(1/2)*(a+-1*a*csc(e+f*x))^-1//2*cot(e+f*x)))
@test integrate((a+a*csc(c+d*x))^(1/2)*csc(c+d*x)^4//3, x) == :(-6//5*a*d^-1*(a+a*csc(c+d*x))^-1//2*csc(c+d*x)^4//3*cos(c+d*x)+-4//5*3^3//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(2+3^(1/2))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.F(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x))
@test integrate((a+a*csc(c+d*x))^(1/2)*csc(c+d*x)^1//3, x) == :(-2*3^3//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(2+3^(1/2))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.F(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x))
@test integrate((a+a*csc(c+d*x))^(1/2)*csc(c+d*x)^-2//3, x) == :(-3//2*a*d^-1*(a+a*csc(c+d*x))^-1//2*csc(c+d*x)^1//3*cos(c+d*x)+-1//2*3^3//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(2+3^(1/2))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.F(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x))
@test integrate((a+a*csc(c+d*x))^(1/2)*csc(c+d*x)^5//3, x) == :(-6//7*a*d^-1*(a+a*csc(c+d*x))^-1//2*csc(c+d*x)^5//3*cos(c+d*x)+24//7*a*d^-1*(a+a*csc(c+d*x))^-1//2*(1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*cot(c+d*x)+-12//7*3^1//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(2+-1*3^(1/2))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.E(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x)+8//7*2^(1/2)*3^3//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.F(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x))
@test integrate((a+a*csc(c+d*x))^(1/2)*csc(c+d*x)^2//3, x) == :(6*a*d^-1*(a+a*csc(c+d*x))^-1//2*(1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*cot(c+d*x)+-3*3^1//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(2+-1*3^(1/2))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.E(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x)+2*2^(1/2)*3^3//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.F(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x))
@test integrate((a+a*csc(c+d*x))^(1/2)*csc(c+d*x)^-1//3, x) == :(-3*a*d^-1*(a+a*csc(c+d*x))^-1//2*(1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*cot(c+d*x)+-3*a*d^-1*(a+a*csc(c+d*x))^-1//2*csc(c+d*x)^2//3*cos(c+d*x)+-1*2^(1/2)*3^3//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.F(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x)+3//2*3^1//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(2+-1*3^(1/2))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.E(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x))
@test integrate((a+a*csc(c+d*x))^(1/2)*csc(c+d*x)^-4//3, x) == :(-15//8*a*d^-1*(a+a*csc(c+d*x))^-1//2*(1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*cot(c+d*x)+-15//8*a*d^-1*(a+a*csc(c+d*x))^-1//2*csc(c+d*x)^2//3*cos(c+d*x)+-3//4*a*d^-1*(a+a*csc(c+d*x))^-1//2*csc(c+d*x)^-1//3*cos(c+d*x)+-5//8*2^(1/2)*3^3//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.F(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x)+15//16*3^1//4*a^2*d^-1*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+-1*csc(c+d*x)^1//3))^-1//2*((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-2*(1+csc(c+d*x)^1//3+csc(c+d*x)^2//3))^(1/2)*(2+-1*3^(1/2))^(1/2)*(a+a*csc(c+d*x))^-1//2*(a+-1*a*csc(c+d*x))^-1*(1+-1*csc(c+d*x)^1//3)*Elliptic.E(arcsin((1+3^(1/2)+-1*csc(c+d*x)^1//3)^-1*(1+-1*3^(1/2)+-1*csc(c+d*x)^1//3)),-7+-4*3^(1/2))*cot(c+d*x))
@test integrate((a+b*csc(c+d*x))^4, x) == :(x*a^4+-1//3*b^2*d^-1*(a+b*csc(c+d*x))^2*cot(c+d*x)+-1//3*b^2*d^-1*(2*b^2+17*a^2)*cot(c+d*x)+-2*a*b*d^-1*(b^2+2*a^2)*arctanh(cos(c+d*x))+-4//3*a*b^3*d^-1*cot(c+d*x)*csc(c+d*x))
@test integrate((a+b*csc(c+d*x))^3, x) == :(x*a^3+-5//2*a*b^2*d^-1*cot(c+d*x)+-1//2*b*d^-1*(b^2+6*a^2)*arctanh(cos(c+d*x))+-1//2*b^2*d^-1*(a+b*csc(c+d*x))*cot(c+d*x))
@test integrate((a+b*csc(c+d*x))^2, x) == :(x*a^2+-1*b^2*d^-1*cot(c+d*x)+-2*a*b*d^-1*arctanh(cos(c+d*x)))
@test integrate((a+b*csc(x))^-1*csc(x)^5, x) == :(-1//3*b^-1*csc(x)^2*cot(x)+-1//3*b^-3*(2*b^2+3*a^2)*cot(x)+(1/2)*a*b^-4*(b^2+2*a^2)*arctanh(cos(x))+(1/2)*a*b^-2*cot(x)*csc(x)+-2*a^4*b^-4*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
@test integrate((a+b*csc(x))^-1*csc(x)^4, x) == :(a*b^-2*cot(x)+-1//2*b^-1*cot(x)*csc(x)+-1//2*b^-3*(b^2+2*a^2)*arctanh(cos(x))+2*a^3*b^-3*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
@test integrate((a+b*csc(x))^-1*csc(x)^3, x) == :(-1*b^-1*cot(x)+a*b^-2*arctanh(cos(x))+-2*a^2*b^-2*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
@test integrate((a+b*csc(x))^-1*csc(x)^2, x) == :(-1*b^-1*arctanh(cos(x))+2*a*b^-1*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
@test integrate((a+b*csc(x))^-1*csc(x), x) == :(-2*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
@test integrate((a+b*csc(c+d*x))^-1, x) == :(x*a^-1+2*b*a^-1*d^-1*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*c+(1/2)*d*x))))
@test integrate((a+b*csc(x))^-1*sin(x), x) == :(-1*a^-1*cos(x)+-1*b*x*a^-2+-2*a^-2*b^2*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
@test integrate((a+b*csc(x))^-1*sin(x)^2, x) == :(b*a^-2*cos(x)+(1/2)*x*a^-3*(a^2+2*b^2)+-1//2*a^-1*cos(x)*sin(x)+2*a^-3*b^3*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
@test integrate((a+b*csc(x))^-1*sin(x)^3, x) == :(-1//3*a^-1*sin(x)^2*cos(x)+-1//3*a^-3*(2*a^2+3*b^2)*cos(x)+(1/2)*b*a^-2*cos(x)*sin(x)+-2*a^-4*b^4*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x)))+-1//2*b*x*a^-4*(a^2+2*b^2))
@test integrate((a+b*csc(x))^-1*sin(x)^4, x) == :(-1//4*a^-1*sin(x)^3*cos(x)+1//8*x*a^-5*(3*a^4+8*b^4+4*a^2*b^2)+2*a^-5*b^5*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x)))+-1//8*a^-3*(3*a^2+4*b^2)*cos(x)*sin(x)+1//3*b*a^-4*(2*a^2+3*b^2)*cos(x)+1//3*b*a^-2*sin(x)^2*cos(x))
@test integrate((a+b*csc(c+d*x))^-2, x) == :(x*a^-2+-1*a^-1*b^2*d^-1*(a+b*csc(c+d*x))^-1*(a^2+-1*b^2)^-1*cot(c+d*x)+2*b*a^-2*d^-1*(a^2+-1*b^2)^-3//2*(-1*b^2+2*a^2)*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*c+(1/2)*d*x))))
@test integrate((a+b*csc(c+d*x))^-3, x) == :(x*a^-3+b*a^-3*d^-1*(a^2+-1*b^2)^-5//2*(2*b^4+6*a^4+-5*a^2*b^2)*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*c+(1/2)*d*x)))+-1//2*a^-1*b^2*d^-1*(a+b*csc(c+d*x))^-2*(a^2+-1*b^2)^-1*cot(c+d*x)+-1//2*a^-2*b^2*d^-1*(a+b*csc(c+d*x))^-1*(a^2+-1*b^2)^-2*(-2*b^2+5*a^2)*cot(c+d*x))
@test integrate((a+b*csc(c+d*x))^-4, x) == :(x*a^-4+b*a^-4*d^-1*(a^2+-1*b^2)^-7//2*(-2*b^6+8*a^6+-8*a^4*b^2+7*a^2*b^4)*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*c+(1/2)*d*x)))+-1//3*a^-1*b^2*d^-1*(a+b*csc(c+d*x))^-3*(a^2+-1*b^2)^-1*cot(c+d*x)+-1//6*a^-3*b^2*d^-1*(a+b*csc(c+d*x))^-1*(a^2+-1*b^2)^-3*(6*b^4+26*a^4+-17*a^2*b^2)*cot(c+d*x)+-1//6*a^-2*b^2*d^-1*(a+b*csc(c+d*x))^-2*(a^2+-1*b^2)^-2*(-3*b^2+8*a^2)*cot(c+d*x))
@test integrate((3+5*csc(c+d*x))^-1, x) == :(-1//12*x+-5//6*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x)))
@test integrate((5+3*csc(c+d*x))^-1, x) == :(1//5*x+-3//20*d^-1*log(3*sin((1/2)*c+(1/2)*d*x)+cos((1/2)*c+(1/2)*d*x))+3//20*d^-1*log(3*cos((1/2)*c+(1/2)*d*x)+sin((1/2)*c+(1/2)*d*x)))

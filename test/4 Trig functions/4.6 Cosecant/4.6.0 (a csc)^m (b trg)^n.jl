using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(csc(a+b*x), x) == :(-1*b^-1*arctanh(cos(a+b*x)))
@test integrate(csc(a+b*x)^2, x) == :(-1*b^-1*cot(a+b*x))
@test integrate(csc(a+b*x)^3, x) == :(-1//2*b^-1*arctanh(cos(a+b*x))+-1//2*b^-1*cot(a+b*x)*csc(a+b*x))
@test integrate(csc(a+b*x)^4, x) == :(-1*b^-1*cot(a+b*x)+-1//3*b^-1*cot(a+b*x)^3)
@test integrate(csc(a+b*x)^5, x) == :(-3//8*b^-1*arctanh(cos(a+b*x))+-3//8*b^-1*cot(a+b*x)*csc(a+b*x)+-1//4*b^-1*csc(a+b*x)^3*cot(a+b*x))
@test integrate(csc(a+b*x)^6, x) == :(-1*b^-1*cot(a+b*x)+-2//3*b^-1*cot(a+b*x)^3+-1//5*b^-1*cot(a+b*x)^5)
@test integrate(csc(a+b*x)^7, x) == :(-5//16*b^-1*arctanh(cos(a+b*x))+-5//16*b^-1*cot(a+b*x)*csc(a+b*x)+-5//24*b^-1*csc(a+b*x)^3*cot(a+b*x)+-1//6*b^-1*csc(a+b*x)^5*cot(a+b*x))
@test integrate(csc(a+b*x)^8, x) == :(-1*b^-1*cot(a+b*x)^3+-1*b^-1*cot(a+b*x)+-3//5*b^-1*cot(a+b*x)^5+-1//7*b^-1*cot(a+b*x)^7)
@test integrate(csc(a+b*x)^7//2, x) == :(-6//5*b^-1*csc(a+b*x)^(1/2)*cos(a+b*x)+-2//5*b^-1*csc(a+b*x)^5//2*cos(a+b*x)+-6//5*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate(csc(a+b*x)^5//2, x) == :(-2//3*b^-1*csc(a+b*x)^3//2*cos(a+b*x)+2//3*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate(csc(a+b*x)^3//2, x) == :(-2*b^-1*csc(a+b*x)^(1/2)*cos(a+b*x)+-2*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate(csc(a+b*x)^(1/2), x) == :(2*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate(csc(a+b*x)^-1//2, x) == :(2*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate(csc(a+b*x)^-3//2, x) == :(-2//3*b^-1*csc(a+b*x)^-1//2*cos(a+b*x)+2//3*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate(csc(a+b*x)^-5//2, x) == :(-2//5*b^-1*csc(a+b*x)^-3//2*cos(a+b*x)+6//5*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate(csc(a+b*x)^-7//2, x) == :(-10//21*b^-1*csc(a+b*x)^-1//2*cos(a+b*x)+-2//7*b^-1*csc(a+b*x)^-5//2*cos(a+b*x)+10//21*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^7//2, x) == :(-6//5*b^-1*c^3*(c*csc(a+b*x))^(1/2)*cos(a+b*x)+-2//5*c*b^-1*(c*csc(a+b*x))^5//2*cos(a+b*x)+-6//5*b^-1*c^4*(c*csc(a+b*x))^-1//2*sin(a+b*x)^-1//2*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^5//2, x) == :(-2//3*c*b^-1*(c*csc(a+b*x))^3//2*cos(a+b*x)+2//3*b^-1*c^2*(c*csc(a+b*x))^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^3//2, x) == :(-2*c*b^-1*(c*csc(a+b*x))^(1/2)*cos(a+b*x)+-2*b^-1*c^2*(c*csc(a+b*x))^-1//2*sin(a+b*x)^-1//2*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^(1/2), x) == :(2*b^-1*(c*csc(a+b*x))^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^-1//2, x) == :(2*b^-1*(c*csc(a+b*x))^-1//2*sin(a+b*x)^-1//2*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^-3//2, x) == :(-2//3*b^-1*c^-1*(c*csc(a+b*x))^-1//2*cos(a+b*x)+2//3*b^-1*c^-2*(c*csc(a+b*x))^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^-5//2, x) == :(-2//5*b^-1*c^-1*(c*csc(a+b*x))^-3//2*cos(a+b*x)+6//5*b^-1*c^-2*(c*csc(a+b*x))^-1//2*sin(a+b*x)^-1//2*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((c*csc(a+b*x))^-7//2, x) == :(-10//21*b^-1*c^-3*(c*csc(a+b*x))^-1//2*cos(a+b*x)+-2//7*b^-1*c^-1*(c*csc(a+b*x))^-5//2*cos(a+b*x)+10//21*b^-1*c^-4*(c*csc(a+b*x))^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
@test integrate((csc(x)^2)^7//2, x) == :(-5//16*arcsinh(cot(x))+-5//16*(csc(x)^2)^(1/2)*cot(x)+-5//24*(csc(x)^2)^3//2*cot(x)+-1//6*(csc(x)^2)^5//2*cot(x))
@test integrate((csc(x)^2)^5//2, x) == :(-3//8*arcsinh(cot(x))+-3//8*(csc(x)^2)^(1/2)*cot(x)+-1//4*(csc(x)^2)^3//2*cot(x))
@test integrate((csc(x)^2)^3//2, x) == :(-1//2*arcsinh(cot(x))+-1//2*(csc(x)^2)^(1/2)*cot(x))
@test integrate((csc(x)^2)^(1/2), x) == :(-1*arcsinh(cot(x)))
@test integrate((csc(x)^2)^-1//2, x) == :(-1*(csc(x)^2)^-1//2*cot(x))
@test integrate((csc(x)^2)^-3//2, x) == :(-2//3*(csc(x)^2)^-1//2*cot(x)+-1//3*(csc(x)^2)^-3//2*cot(x))
@test integrate((csc(x)^2)^-5//2, x) == :(-8//15*(csc(x)^2)^-1//2*cot(x)+-4//15*(csc(x)^2)^-3//2*cot(x)+-1//5*(csc(x)^2)^-5//2*cot(x))
@test integrate((csc(x)^2)^-7//2, x) == :(-16//35*(csc(x)^2)^-1//2*cot(x)+-8//35*(csc(x)^2)^-3//2*cot(x)+-6//35*(csc(x)^2)^-5//2*cot(x)+-1//7*(csc(x)^2)^-7//2*cot(x))
@test integrate((a*csc(x)^2)^7//2, x) == :(-5//16*a^7//2*arctanh(a^(1/2)*(a*csc(x)^2)^-1//2*cot(x))+-5//16*a^3*(a*csc(x)^2)^(1/2)*cot(x)+-5//24*a^2*(a*csc(x)^2)^3//2*cot(x)+-1//6*a*(a*csc(x)^2)^5//2*cot(x))
@test integrate((a*csc(x)^2)^5//2, x) == :(-3//8*a^5//2*arctanh(a^(1/2)*(a*csc(x)^2)^-1//2*cot(x))+-3//8*a^2*(a*csc(x)^2)^(1/2)*cot(x)+-1//4*a*(a*csc(x)^2)^3//2*cot(x))
@test integrate((a*csc(x)^2)^3//2, x) == :(-1//2*a^3//2*arctanh(a^(1/2)*(a*csc(x)^2)^-1//2*cot(x))+-1//2*a*(a*csc(x)^2)^(1/2)*cot(x))
@test integrate((a*csc(x)^2)^(1/2), x) == :(-1*a^(1/2)*arctanh(a^(1/2)*(a*csc(x)^2)^-1//2*cot(x)))
@test integrate((a*csc(x)^2)^-1//2, x) == :(-1*(a*csc(x)^2)^-1//2*cot(x))
@test integrate((a*csc(x)^2)^-3//2, x) == :(-1//3*(a*csc(x)^2)^-3//2*cot(x)+-2//3*a^-1*(a*csc(x)^2)^-1//2*cot(x))
@test integrate((a*csc(x)^2)^-5//2, x) == :(-1//5*(a*csc(x)^2)^-5//2*cot(x)+-8//15*a^-2*(a*csc(x)^2)^-1//2*cot(x)+-4//15*a^-1*(a*csc(x)^2)^-3//2*cot(x))
@test integrate((a*csc(x)^2)^-7//2, x) == :(-1//7*(a*csc(x)^2)^-7//2*cot(x)+-16//35*a^-3*(a*csc(x)^2)^-1//2*cot(x)+-8//35*a^-2*(a*csc(x)^2)^-3//2*cot(x)+-6//35*a^-1*(a*csc(x)^2)^-5//2*cot(x))
@test integrate((a*csc(x)^3)^5//2, x) == :(-154//585*a^2*(a*csc(x)^3)^(1/2)*cot(x)+-154//195*a^2*(a*csc(x)^3)^(1/2)*cos(x)*sin(x)+-22//117*a^2*(a*csc(x)^3)^(1/2)*csc(x)^2*cot(x)+-2//13*a^2*(a*csc(x)^3)^(1/2)*csc(x)^4*cot(x)+154//195*a^2*(a*csc(x)^3)^(1/2)*sin(x)^3//2*Elliptic.E(-1//2*x+1//4*pi,2))
@test integrate((a*csc(x)^3)^3//2, x) == :(-10//21*a*(a*csc(x)^3)^(1/2)*cos(x)+-10//21*a*(a*csc(x)^3)^(1/2)*sin(x)^3//2*Elliptic.F(-1//2*x+1//4*pi,2)+-2//7*a*(a*csc(x)^3)^(1/2)*cot(x)*csc(x))
@test integrate((a*csc(x)^3)^(1/2), x) == :(-2*(a*csc(x)^3)^(1/2)*cos(x)*sin(x)+2*(a*csc(x)^3)^(1/2)*sin(x)^3//2*Elliptic.E(-1//2*x+1//4*pi,2))
@test integrate((a*csc(x)^3)^-1//2, x) == :(-2//3*(a*csc(x)^3)^-1//2*cot(x)+-2//3*(a*csc(x)^3)^-1//2*sin(x)^-3//2*Elliptic.F(-1//2*x+1//4*pi,2))
@test integrate((a*csc(x)^3)^-3//2, x) == :(-14//45*a^-1*(a*csc(x)^3)^-1//2*cos(x)+-14//15*a^-1*(a*csc(x)^3)^-1//2*sin(x)^-3//2*Elliptic.E(-1//2*x+1//4*pi,2)+-2//9*a^-1*(a*csc(x)^3)^-1//2*sin(x)^2*cos(x))
@test integrate((a*csc(x)^3)^-5//2, x) == :(-26//77*a^-2*(a*csc(x)^3)^-1//2*cot(x)+-78//385*a^-2*(a*csc(x)^3)^-1//2*cos(x)*sin(x)+-26//77*a^-2*(a*csc(x)^3)^-1//2*sin(x)^-3//2*Elliptic.F(-1//2*x+1//4*pi,2)+-26//165*a^-2*(a*csc(x)^3)^-1//2*sin(x)^3*cos(x)+-2//15*a^-2*(a*csc(x)^3)^-1//2*sin(x)^5*cos(x))
@test integrate((a*csc(x)^4)^7//2, x) == :(-1*a^3*(a*csc(x)^4)^(1/2)*cos(x)*sin(x)+-3*a^3*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^3+-2*a^3*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)+-20//7*a^3*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^5+-6//11*a^3*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^9+-5//3*a^3*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^7+-1//13*a^3*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^11)
@test integrate((a*csc(x)^4)^5//2, x) == :(-1*a^2*(a*csc(x)^4)^(1/2)*cos(x)*sin(x)+-6//5*a^2*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^3+-4//3*a^2*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)+-4//7*a^2*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^5+-1//9*a^2*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^7)
@test integrate((a*csc(x)^4)^3//2, x) == :(-1*a*(a*csc(x)^4)^(1/2)*cos(x)*sin(x)+-2//3*a*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)+-1//5*a*(a*csc(x)^4)^(1/2)*cos(x)^2*cot(x)^3)
@test integrate((a*csc(x)^4)^(1/2), x) == :(-1*(a*csc(x)^4)^(1/2)*cos(x)*sin(x))
@test integrate((a*csc(x)^4)^-1//2, x) == :(-1//2*(a*csc(x)^4)^-1//2*cot(x)+(1/2)*x*(a*csc(x)^4)^-1//2*csc(x)^2)
@test integrate((a*csc(x)^4)^-3//2, x) == :(-5//16*a^-1*(a*csc(x)^4)^-1//2*cot(x)+-5//24*a^-1*(a*csc(x)^4)^-1//2*cos(x)*sin(x)+-1//6*a^-1*(a*csc(x)^4)^-1//2*sin(x)^3*cos(x)+5//16*x*a^-1*(a*csc(x)^4)^-1//2*csc(x)^2)
@test integrate((a*csc(x)^4)^-5//2, x) == :(-63//256*a^-2*(a*csc(x)^4)^-1//2*cot(x)+-21//128*a^-2*(a*csc(x)^4)^-1//2*cos(x)*sin(x)+-21//160*a^-2*(a*csc(x)^4)^-1//2*sin(x)^3*cos(x)+-9//80*a^-2*(a*csc(x)^4)^-1//2*sin(x)^5*cos(x)+-1//10*a^-2*(a*csc(x)^4)^-1//2*sin(x)^7*cos(x)+63//256*x*a^-2*(a*csc(x)^4)^-1//2*csc(x)^2)

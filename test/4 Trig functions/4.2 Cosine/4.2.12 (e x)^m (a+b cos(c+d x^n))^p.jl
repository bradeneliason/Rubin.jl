using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(x^3*cos(a+b*x^2), x) == :((1/2)*b^-2*cos(a+b*x^2)+(1/2)*b^-1*x^2*sin(a+b*x^2))
@test integrate(x^2*cos(a+b*x^2), x) == :((1/2)*x*b^-1*sin(a+b*x^2)+-1//4*2^(1/2)*pi^(1/2)*b^-3//2*cos(a)*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))+-1//4*2^(1/2)*pi^(1/2)*b^-3//2*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a))
@test integrate(x*cos(a+b*x^2), x) == :((1/2)*b^-1*sin(a+b*x^2))
@test integrate(cos(a+b*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*b^-1//2*cos(a)*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))+-1//2*2^(1/2)*pi^(1/2)*b^-1//2*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a))
@test integrate(x^-1*cos(a+b*x^2), x) == :((1/2)*cos(a)*cosintegral(b*x^2)+-1//2*sin(a)*sinintegral(b*x^2))
@test integrate(x^-2*cos(a+b*x^2), x) == :(-1*x^-1*cos(a+b*x^2)+-1*2^(1/2)*pi^(1/2)*b^(1/2)*cos(a)*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))+-1*2^(1/2)*pi^(1/2)*b^(1/2)*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a))
@test integrate(x^-3*cos(a+b*x^2), x) == :(-1//2*x^-2*cos(a+b*x^2)+-1//2*b*cos(a)*sinintegral(b*x^2)+-1//2*b*cosintegral(b*x^2)*sin(a))
@test integrate(x^3*cos(a+b*x^2)^2, x) == :(1//8*x^4+1//8*b^-2*cos(a+b*x^2)^2+1//4*b^-1*x^2*cos(a+b*x^2)*sin(a+b*x^2))
@test integrate(x^2*cos(a+b*x^2)^2, x) == :(1//6*x^3+1//8*x*b^-1*sin(2a+2*b*x^2)+-1//16*pi^(1/2)*b^-3//2*cos(2a)*fresnels(2*x*pi^-1//2*b^(1/2))+-1//16*pi^(1/2)*b^-3//2*fresnelc(2*x*pi^-1//2*b^(1/2))*sin(2a))
@test integrate(x*cos(a+b*x^2)^2, x) == :(1//4*x^2+1//4*b^-1*cos(a+b*x^2)*sin(a+b*x^2))
@test integrate(cos(a+b*x^2)^2, x) == :((1/2)*x+-1//4*pi^(1/2)*b^-1//2*fresnels(2*x*pi^-1//2*b^(1/2))*sin(2a)+1//4*pi^(1/2)*b^-1//2*cos(2a)*fresnelc(2*x*pi^-1//2*b^(1/2)))
@test integrate(x^-1*cos(a+b*x^2)^2, x) == :((1/2)*log(x)+-1//4*sin(2a)*sinintegral(2*b*x^2)+1//4*cos(2a)*cosintegral(2*b*x^2))
@test integrate(x^-2*cos(a+b*x^2)^2, x) == :(-1*x^-1*cos(a+b*x^2)^2+-1*pi^(1/2)*b^(1/2)*cos(2a)*fresnels(2*x*pi^-1//2*b^(1/2))+-1*pi^(1/2)*b^(1/2)*fresnelc(2*x*pi^-1//2*b^(1/2))*sin(2a))
@test integrate(x^-3*cos(a+b*x^2)^2, x) == :(-1//4*x^-2+-1//4*x^-2*cos(2a+2*b*x^2)+-1//2*b*cos(2a)*sinintegral(2*b*x^2)+-1//2*b*cosintegral(2*b*x^2)*sin(2a))
@test integrate(x^3*cos(a+b*x^2)^3, x) == :(1//3*b^-2*cos(a+b*x^2)+1//18*b^-2*cos(a+b*x^2)^3+1//3*b^-1*x^2*sin(a+b*x^2)+1//6*b^-1*x^2*cos(a+b*x^2)^2*sin(a+b*x^2))
@test integrate(x^2*cos(a+b*x^2)^3, x) == :(1//24*x*b^-1*sin(3a+3*b*x^2)+3//8*x*b^-1*sin(a+b*x^2)+-3//16*2^(1/2)*pi^(1/2)*b^-3//2*cos(a)*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))+-3//16*2^(1/2)*pi^(1/2)*b^-3//2*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a)+-1//144*6^(1/2)*pi^(1/2)*b^-3//2*cos(3a)*fresnels(x*6^(1/2)*pi^-1//2*b^(1/2))+-1//144*6^(1/2)*pi^(1/2)*b^-3//2*fresnelc(x*6^(1/2)*pi^-1//2*b^(1/2))*sin(3a))
@test integrate(x*cos(a+b*x^2)^3, x) == :((1/2)*b^-1*sin(a+b*x^2)+-1//6*b^-1*sin(a+b*x^2)^3)
@test integrate(cos(a+b*x^2)^3, x) == :(-3//8*2^(1/2)*pi^(1/2)*b^-1//2*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a)+-1//24*6^(1/2)*pi^(1/2)*b^-1//2*fresnels(x*6^(1/2)*pi^-1//2*b^(1/2))*sin(3a)+1//24*6^(1/2)*pi^(1/2)*b^-1//2*cos(3a)*fresnelc(x*6^(1/2)*pi^-1//2*b^(1/2))+3//8*2^(1/2)*pi^(1/2)*b^-1//2*cos(a)*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2)))
@test integrate(x^-1*cos(a+b*x^2)^3, x) == :(-3//8*sin(a)*sinintegral(b*x^2)+-1//8*sin(3a)*sinintegral(3*b*x^2)+1//8*cos(3a)*cosintegral(3*b*x^2)+3//8*cos(a)*cosintegral(b*x^2))
@test integrate(x^-2*cos(a+b*x^2)^3, x) == :(-1*x^-1*cos(a+b*x^2)^3+-3//4*2^(1/2)*pi^(1/2)*b^(1/2)*cos(a)*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))+-3//4*2^(1/2)*pi^(1/2)*b^(1/2)*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a)+-1//4*6^(1/2)*pi^(1/2)*b^(1/2)*cos(3a)*fresnels(x*6^(1/2)*pi^-1//2*b^(1/2))+-1//4*6^(1/2)*pi^(1/2)*b^(1/2)*fresnelc(x*6^(1/2)*pi^-1//2*b^(1/2))*sin(3a))
@test integrate(x^-3*cos(a+b*x^2)^3, x) == :(-3//8*x^-2*cos(a+b*x^2)+-1//8*x^-2*cos(3a+3*b*x^2)+-3//8*b*cos(a)*sinintegral(b*x^2)+-3//8*b*cos(3a)*sinintegral(3*b*x^2)+-3//8*b*cosintegral(b*x^2)*sin(a)+-3//8*b*cosintegral(3*b*x^2)*sin(3a))
@test integrate(x*cos(a+b*x^2)^7, x) == :((1/2)*b^-1*sin(a+b*x^2)+-1//2*b^-1*sin(a+b*x^2)^3+-1//14*b^-1*sin(a+b*x^2)^7+3//10*b^-1*sin(a+b*x^2)^5)
@test integrate(x^5//2*cos(a+b*x^2), x) == :((1/2)*b^-1*x^3//2*sin(a+b*x^2)+-3//16*im*b^-1*x^3//2*(-1*im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,-1*im*b*x^2)*exp(im*a)+3//16*im*b^-1*x^3//2*(im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,im*b*x^2)*exp(-1*im*a))
@test integrate(x^3//2*cos(a+b*x^2), x) == :((1/2)*b^-1*x^(1/2)*sin(a+b*x^2)+-1//16*im*b^-1*x^(1/2)*(-1*im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,-1*im*b*x^2)*exp(im*a)+1//16*im*b^-1*x^(1/2)*(im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,im*b*x^2)*exp(-1*im*a))
@test integrate(x^(1/2)*cos(a+b*x^2), x) == :(-1//4*x^3//2*(im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,im*b*x^2)*exp(-1*im*a)+-1//4*x^3//2*(-1*im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,-1*im*b*x^2)*exp(im*a))
@test integrate(x^-1//2*cos(a+b*x^2), x) == :(-1//4*x^(1/2)*(im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,im*b*x^2)*exp(-1*im*a)+-1//4*x^(1/2)*(-1*im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,-1*im*b*x^2)*exp(im*a))
@test integrate(x^-3//2*cos(a+b*x^2), x) == :(-2*x^-1//2*cos(a+b*x^2)+im*b*x^3//2*(im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,im*b*x^2)*exp(-1*im*a)+-1*im*b*x^3//2*(-1*im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,-1*im*b*x^2)*exp(im*a))
@test integrate(x^-5//2*cos(a+b*x^2), x) == :(-2//3*x^-3//2*cos(a+b*x^2)+-1//3*im*b*x^(1/2)*(-1*im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,-1*im*b*x^2)*exp(im*a)+1//3*im*b*x^(1/2)*(im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,im*b*x^2)*exp(-1*im*a))
@test integrate(x^5//2*cos(a+b*x^2)^2, x) == :(1//7*x^7//2+1//8*b^-1*x^3//2*sin(2a+2*b*x^2)+-3//128*im*2^1//4*b^-1*x^3//2*(-1*im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,-2*im*b*x^2)*exp(2*im*a)+3//128*im*2^1//4*b^-1*x^3//2*(im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,2*im*b*x^2)*exp(-2*im*a))
@test integrate(x^3//2*cos(a+b*x^2)^2, x) == :(1//5*x^5//2+1//8*b^-1*x^(1/2)*sin(2a+2*b*x^2)+-1//128*im*2^3//4*b^-1*x^(1/2)*(-1*im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,-2*im*b*x^2)*exp(2*im*a)+1//128*im*2^3//4*b^-1*x^(1/2)*(im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,2*im*b*x^2)*exp(-2*im*a))
@test integrate(x^(1/2)*cos(a+b*x^2)^2, x) == :(1//3*x^3//2+-1//16*2^1//4*x^3//2*(im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,2*im*b*x^2)*exp(-2*im*a)+-1//16*2^1//4*x^3//2*(-1*im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,-2*im*b*x^2)*exp(2*im*a))
@test integrate(x^-1//2*cos(a+b*x^2)^2, x) == :(x^(1/2)+-1//16*2^3//4*x^(1/2)*(im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,2*im*b*x^2)*exp(-2*im*a)+-1//16*2^3//4*x^(1/2)*(-1*im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,-2*im*b*x^2)*exp(2*im*a))
@test integrate(x^-3//2*cos(a+b*x^2)^2, x) == :(-1*x^-1//2+-1*x^-1//2*cos(2a+2*b*x^2)+(1/2)*im*b*2^1//4*x^3//2*(im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,2*im*b*x^2)*exp(-2*im*a)+-1//2*im*b*2^1//4*x^3//2*(-1*im*b*x^2)^-3//4*SpecialFunctions.gamma(3//4,-2*im*b*x^2)*exp(2*im*a))
@test integrate(x^-5//2*cos(a+b*x^2)^2, x) == :(-2//3*x^-3//2*cos(a+b*x^2)^2+-1//6*im*b*2^3//4*x^(1/2)*(-1*im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,-2*im*b*x^2)*exp(2*im*a)+1//6*im*b*2^3//4*x^(1/2)*(im*b*x^2)^-1//4*SpecialFunctions.gamma(1//4,2*im*b*x^2)*exp(-2*im*a))
@test integrate(cos(a+b*x^-1), x) == :(x*cos(a+b*x^-1)+b*cos(a)*sinintegral(b*x^-1)+b*cosintegral(b*x^-1)*sin(a))
@test integrate(x^-1*cos(a+b*x^-1), x) == :(sin(a)*sinintegral(b*x^-1)+-1*cos(a)*cosintegral(b*x^-1))
@test integrate(x^-2*cos(a+b*x^-1), x) == :(-1*b^-1*sin(a+b*x^-1))
@test integrate(x^-3*cos(a+b*x^-1), x) == :(-1*b^-2*cos(a+b*x^-1)+-1*b^-1*x^-1*sin(a+b*x^-1))
@test integrate(x^-4*cos(a+b*x^-1), x) == :(2*b^-3*sin(a+b*x^-1)+-1*b^-1*x^-2*sin(a+b*x^-1)+-2*b^-2*x^-1*cos(a+b*x^-1))
@test integrate(cos(a+b*x^-2), x) == :(x*cos(a+b*x^-2)+2^(1/2)*pi^(1/2)*b^(1/2)*cos(a)*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^-1)+2^(1/2)*pi^(1/2)*b^(1/2)*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^-1)*sin(a))
@test integrate(x^-1*cos(a+b*x^-2), x) == :((1/2)*sin(a)*sinintegral(b*x^-2)+-1//2*cos(a)*cosintegral(b*x^-2))
@test integrate(x^-2*cos(a+b*x^-2), x) == :((1/2)*2^(1/2)*pi^(1/2)*b^-1//2*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^-1)*sin(a)+-1//2*2^(1/2)*pi^(1/2)*b^-1//2*cos(a)*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^-1))
@test integrate(x^-3*cos(a+b*x^-2), x) == :(-1//2*b^-1*sin(a+b*x^-2))
@test integrate(x^-4*cos(a+b*x^-2), x) == :(-1//2*b^-1*x^-1*sin(a+b*x^-2)+1//4*2^(1/2)*pi^(1/2)*b^-3//2*cos(a)*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^-1)+1//4*2^(1/2)*pi^(1/2)*b^-3//2*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^-1)*sin(a))
@test integrate(x^-1//2*cos(x^(1/2))^2, x) == :(x^(1/2)+cos(x^(1/2))*sin(x^(1/2)))
@test integrate(x^-1//2*cos(x^(1/2)), x) == :(2*sin(x^(1/2)))
@test integrate(cos(x^(1/2)), x) == :(2*cos(x^(1/2))+2*x^(1/2)*sin(x^(1/2)))
@test integrate(cos(x^(1/2))^2, x) == :((1/2)*x+(1/2)*cos(x^(1/2))^2+x^(1/2)*cos(x^(1/2))*sin(x^(1/2)))
@test integrate(x^3//2*cos(a+b*x^1//3), x) == :(3*b^-1*x^13//6*sin(a+b*x^1//3)+-405405//64*b^-7*x^1//6*sin(a+b*x^1//3)+-3861//8*b^-4*x^7//6*cos(a+b*x^1//3)+-429//4*b^-3*x^3//2*sin(a+b*x^1//3)+39//2*b^-2*x^11//6*cos(a+b*x^1//3)+27027//16*b^-5*x^5//6*sin(a+b*x^1//3)+135135//32*b^-6*x^(1/2)*cos(a+b*x^1//3)+405405//128*2^(1/2)*pi^(1/2)*b^-15//2*cos(a)*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)+405405//128*2^(1/2)*pi^(1/2)*b^-15//2*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)*sin(a))
@test integrate(x^(1/2)*cos(a+b*x^1//3), x) == :(3*b^-1*x^7//6*sin(a+b*x^1//3)+-315//8*b^-4*x^1//6*cos(a+b*x^1//3)+-105//4*b^-3*x^(1/2)*sin(a+b*x^1//3)+21//2*b^-2*x^5//6*cos(a+b*x^1//3)+-315//16*2^(1/2)*pi^(1/2)*b^-9//2*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)*sin(a)+315//16*2^(1/2)*pi^(1/2)*b^-9//2*cos(a)*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6))
@test integrate(x^-1//2*cos(a+b*x^1//3), x) == :(3*b^-1*x^1//6*sin(a+b*x^1//3)+-3//2*2^(1/2)*pi^(1/2)*b^-3//2*cos(a)*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)+-3//2*2^(1/2)*pi^(1/2)*b^-3//2*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)*sin(a))
@test integrate(x^-3//2*cos(a+b*x^1//3), x) == :(-2*x^-1//2*cos(a+b*x^1//3)+4*b*x^-1//6*sin(a+b*x^1//3)+-4*2^(1/2)*pi^(1/2)*b^3//2*cos(a)*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)+4*2^(1/2)*pi^(1/2)*b^3//2*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)*sin(a))
@test integrate(x^-5//2*cos(a+b*x^1//3), x) == :(-2//3*x^-3//2*cos(a+b*x^1//3)+-32//315*b^4*x^-1//6*cos(a+b*x^1//3)+-16//315*b^3*x^-1//2*sin(a+b*x^1//3)+4//21*b*x^-7//6*sin(a+b*x^1//3)+8//105*b^2*x^-5//6*cos(a+b*x^1//3)+-32//315*2^(1/2)*pi^(1/2)*b^9//2*cos(a)*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)+-32//315*2^(1/2)*pi^(1/2)*b^9//2*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)*sin(a))
@test integrate(x^-7//2*cos(a+b*x^1//3), x) == :(-2//5*x^-5//2*cos(a+b*x^1//3)+-256//675675*b^7*x^-1//6*sin(a+b*x^1//3)+-32//45045*b^4*x^-7//6*cos(a+b*x^1//3)+-16//6435*b^3*x^-3//2*sin(a+b*x^1//3)+4//65*b*x^-13//6*sin(a+b*x^1//3)+8//715*b^2*x^-11//6*cos(a+b*x^1//3)+64//225225*b^5*x^-5//6*sin(a+b*x^1//3)+128//675675*b^6*x^-1//2*cos(a+b*x^1//3)+-256//675675*2^(1/2)*pi^(1/2)*b^15//2*fresnels(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6)*sin(a)+256//675675*2^(1/2)*pi^(1/2)*b^15//2*cos(a)*fresnelc(2^(1/2)*pi^-1//2*b^(1/2)*x^1//6))
@test integrate(x^3//2*cos(a+b*x^1//3)^2, x) == :(1//5*x^5//2+-135135//4096*b^-6*x^(1/2)+-39//16*b^-2*x^11//6+3861//256*b^-4*x^7//6+-405405//16384*b^-7*x^1//6*sin(2a+2*b*x^1//3)+-3861//128*b^-4*x^7//6*cos(a+b*x^1//3)^2+39//8*b^-2*x^11//6*cos(a+b*x^1//3)^2+135135//2048*b^-6*x^(1/2)*cos(a+b*x^1//3)^2+-429//32*b^-3*x^3//2*cos(a+b*x^1//3)*sin(a+b*x^1//3)+3//2*b^-1*x^13//6*cos(a+b*x^1//3)*sin(a+b*x^1//3)+27027//512*b^-5*x^5//6*cos(a+b*x^1//3)*sin(a+b*x^1//3)+405405//32768*pi^(1/2)*b^-15//2*cos(2a)*fresnels(2*pi^-1//2*b^(1/2)*x^1//6)+405405//32768*pi^(1/2)*b^-15//2*fresnelc(2*pi^-1//2*b^(1/2)*x^1//6)*sin(2a))
@test integrate(x^(1/2)*cos(a+b*x^1//3)^2, x) == :(1//3*x^3//2+-21//16*b^-2*x^5//6+315//256*b^-4*x^1//6+-315//128*b^-4*x^1//6*cos(a+b*x^1//3)^2+21//8*b^-2*x^5//6*cos(a+b*x^1//3)^2+-315//512*pi^(1/2)*b^-9//2*fresnels(2*pi^-1//2*b^(1/2)*x^1//6)*sin(2a)+-105//32*b^-3*x^(1/2)*cos(a+b*x^1//3)*sin(a+b*x^1//3)+3//2*b^-1*x^7//6*cos(a+b*x^1//3)*sin(a+b*x^1//3)+315//512*pi^(1/2)*b^-9//2*cos(2a)*fresnelc(2*pi^-1//2*b^(1/2)*x^1//6))
@test integrate(x^-1//2*cos(a+b*x^1//3)^2, x) == :(x^(1/2)+3//4*b^-1*x^1//6*sin(2a+2*b*x^1//3)+-3//8*pi^(1/2)*b^-3//2*cos(2a)*fresnels(2*pi^-1//2*b^(1/2)*x^1//6)+-3//8*pi^(1/2)*b^-3//2*fresnelc(2*pi^-1//2*b^(1/2)*x^1//6)*sin(2a))
@test integrate(x^-3//2*cos(a+b*x^1//3)^2, x) == :(-2*x^-1//2*cos(a+b*x^1//3)^2+-8*pi^(1/2)*b^3//2*cos(2a)*fresnelc(2*pi^-1//2*b^(1/2)*x^1//6)+8*b*x^-1//6*cos(a+b*x^1//3)*sin(a+b*x^1//3)+8*pi^(1/2)*b^3//2*fresnels(2*pi^-1//2*b^(1/2)*x^1//6)*sin(2a))
@test integrate(x^-5//2*cos(a+b*x^1//3)^2, x) == :(-16//105*b^2*x^-5//6+-2//3*x^-3//2*cos(a+b*x^1//3)^2+256//315*b^4*x^-1//6+-512//315*b^4*x^-1//6*cos(a+b*x^1//3)^2+32//105*b^2*x^-5//6*cos(a+b*x^1//3)^2+-512//315*pi^(1/2)*b^9//2*cos(2a)*fresnels(2*pi^-1//2*b^(1/2)*x^1//6)+-512//315*pi^(1/2)*b^9//2*fresnelc(2*pi^-1//2*b^(1/2)*x^1//6)*sin(2a)+-128//315*b^3*x^-1//2*cos(a+b*x^1//3)*sin(a+b*x^1//3)+8//21*b*x^-7//6*cos(a+b*x^1//3)*sin(a+b*x^1//3))
@test integrate(x^-7//2*cos(a+b*x^1//3)^2, x) == :(-4096//675675*b^6*x^-1//2+-16//715*b^2*x^-11//6+-2//5*x^-5//2*cos(a+b*x^1//3)^2+256//45045*b^4*x^-7//6+-512//45045*b^4*x^-7//6*cos(a+b*x^1//3)^2+32//715*b^2*x^-11//6*cos(a+b*x^1//3)^2+8192//675675*b^6*x^-1//2*cos(a+b*x^1//3)^2+-32768//675675*pi^(1/2)*b^15//2*fresnels(2*pi^-1//2*b^(1/2)*x^1//6)*sin(2a)+-32768//675675*b^7*x^-1//6*cos(a+b*x^1//3)*sin(a+b*x^1//3)+-128//6435*b^3*x^-3//2*cos(a+b*x^1//3)*sin(a+b*x^1//3)+8//65*b*x^-13//6*cos(a+b*x^1//3)*sin(a+b*x^1//3)+2048//225225*b^5*x^-5//6*cos(a+b*x^1//3)*sin(a+b*x^1//3)+32768//675675*pi^(1/2)*b^15//2*cos(2a)*fresnelc(2*pi^-1//2*b^(1/2)*x^1//6))
@test integrate(cos(x^1//3)^3, x) == :(-14//3*sin(x^1//3)+2//9*sin(x^1//3)^3+2*x^2//3*sin(x^1//3)+4*x^1//3*cos(x^1//3)+2//3*x^1//3*cos(x^1//3)^3+x^2//3*cos(x^1//3)^2*sin(x^1//3))
@test integrate(x^-5//6*cos(x^1//6), x) == :(6*sin(x^1//6))
@test integrate(x^-1*cos(a+b*x^n), x) == :(n^-1*cos(a)*cosintegral(b*x^n)+-1*n^-1*sin(a)*sinintegral(b*x^n))
@test integrate(x^-1*cos(a+b*x^n)^2, x) == :((1/2)*log(x)+(1/2)*n^-1*cos(2a)*cosintegral(2*b*x^n)+-1//2*n^-1*sin(2a)*sinintegral(2*b*x^n))
@test integrate(x^-1*cos(a+b*x^n)^3, x) == :(-3//4*n^-1*sin(a)*sinintegral(b*x^n)+-1//4*n^-1*sin(3a)*sinintegral(3*b*x^n)+1//4*n^-1*cos(3a)*cosintegral(3*b*x^n)+3//4*n^-1*cos(a)*cosintegral(b*x^n))
@test integrate(x^-1*cos(a+b*x^n)^4, x) == :(3//8*log(x)+(1/2)*n^-1*cos(2a)*cosintegral(2*b*x^n)+-1//2*n^-1*sin(2a)*sinintegral(2*b*x^n)+-1//8*n^-1*sin(4a)*sinintegral(4*b*x^n)+1//8*n^-1*cos(4a)*cosintegral(4*b*x^n))
@test integrate(cos(a+b*x^n), x) == :(-1//2*x*n^-1*(im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,im*b*x^n)*exp(-1*im*a)+-1//2*x*n^-1*(-1*im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,-1*im*b*x^n)*exp(im*a))
@test integrate(cos(a+b*x^n)^2, x) == :((1/2)*x+-1*x*2^(-2+-1*n^-1)*n^-1*(im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,2*im*b*x^n)*exp(-2*im*a)+-1*x*2^(-2+-1*n^-1)*n^-1*(-1*im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,-2*im*b*x^n)*exp(2*im*a))
@test integrate(cos(a+b*x^n)^3, x) == :(-3//8*x*n^-1*(im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,im*b*x^n)*exp(-1*im*a)+-3//8*x*n^-1*(-1*im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,-1*im*b*x^n)*exp(im*a)+-1//8*x*3^(-1*n^-1)*n^-1*(im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,3*im*b*x^n)*exp(-3*im*a)+-1//8*x*3^(-1*n^-1)*n^-1*(-1*im*b*x^n)^(-1*n^-1)*SpecialFunctions.gamma(n^-1,-3*im*b*x^n)*exp(3*im*a))
@test integrate(x^m*cos(a+b*x^n), x) == :(-1//2*n^-1*x^(1+m)*(im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),im*b*x^n)*exp(-1*im*a)+-1//2*n^-1*x^(1+m)*(-1*im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),-1*im*b*x^n)*exp(im*a))
@test integrate(x^m*cos(a+b*x^n)^2, x) == :(x^(1+m)*(2+2m)^-1+-1*2^(-1*n^-1*(1+m+2n))*n^-1*x^(1+m)*(im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),2*im*b*x^n)*exp(-2*im*a)+-1*2^(-1*n^-1*(1+m+2n))*n^-1*x^(1+m)*(-1*im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),-2*im*b*x^n)*exp(2*im*a))
@test integrate(x^m*cos(a+b*x^n)^3, x) == :(-3//8*n^-1*x^(1+m)*(im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),im*b*x^n)*exp(-1*im*a)+-3//8*n^-1*x^(1+m)*(-1*im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),-1*im*b*x^n)*exp(im*a)+-1//8*3^(-1*n^-1*(1+m))*n^-1*x^(1+m)*(im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),3*im*b*x^n)*exp(-3*im*a)+-1//8*3^(-1*n^-1*(1+m))*n^-1*x^(1+m)*(-1*im*b*x^n)^(-1*n^-1*(1+m))*SpecialFunctions.gamma(n^-1*(1+m),-3*im*b*x^n)*exp(3*im*a))
@test integrate(x^(-1+-1n)*cos(a+b*x^n), x) == :(-1*n^-1*x^(-1n)*cos(a+b*x^n)+-1*b*n^-1*cos(a)*sinintegral(b*x^n)+-1*b*n^-1*cosintegral(b*x^n)*sin(a))
@test integrate(x^(-1+-1n)*cos(a+b*x^n)^2, x) == :(-1//2*n^-1*x^(-1n)+-1//2*n^-1*x^(-1n)*cos(2a+2*b*x^n)+-1*b*n^-1*cos(2a)*sinintegral(2*b*x^n)+-1*b*n^-1*cosintegral(2*b*x^n)*sin(2a))
@test integrate(x^(-1+-1n)*cos(a+b*x^n)^3, x) == :(-3//4*n^-1*x^(-1n)*cos(a+b*x^n)+-1//4*n^-1*x^(-1n)*cos(3a+3*b*x^n)+-3//4*b*n^-1*cos(a)*sinintegral(b*x^n)+-3//4*b*n^-1*cos(3a)*sinintegral(3*b*x^n)+-3//4*b*n^-1*cosintegral(b*x^n)*sin(a)+-3//4*b*n^-1*cosintegral(3*b*x^n)*sin(3a))
@test integrate(x^(-1+-2n)*cos(a+b*x^n), x) == :(-1//2*n^-1*x^(-2n)*cos(a+b*x^n)+(1/2)*b*n^-1*x^(-1n)*sin(a+b*x^n)+(1/2)*b^2*n^-1*sin(a)*sinintegral(b*x^n)+-1//2*b^2*n^-1*cos(a)*cosintegral(b*x^n))
@test integrate(x^(-1+-2n)*cos(a+b*x^n)^2, x) == :(-1//4*n^-1*x^(-2n)+-1//4*n^-1*x^(-2n)*cos(2a+2*b*x^n)+b^2*n^-1*sin(2a)*sinintegral(2*b*x^n)+(1/2)*b*n^-1*x^(-1n)*sin(2a+2*b*x^n)+-1*b^2*n^-1*cos(2a)*cosintegral(2*b*x^n))
@test integrate(x^(-1+-2n)*cos(a+b*x^n)^3, x) == :(-3//8*n^-1*x^(-2n)*cos(a+b*x^n)+-1//8*n^-1*x^(-2n)*cos(3a+3*b*x^n)+-9//8*b^2*n^-1*cos(3a)*cosintegral(3*b*x^n)+-3//8*b^2*n^-1*cos(a)*cosintegral(b*x^n)+3//8*b*n^-1*x^(-1n)*sin(a+b*x^n)+3//8*b*n^-1*x^(-1n)*sin(3a+3*b*x^n)+3//8*b^2*n^-1*sin(a)*sinintegral(b*x^n)+9//8*b^2*n^-1*sin(3a)*sinintegral(3*b*x^n))
@test integrate(x^2*cos((a+b*x)^2), x) == :((1/2)*b^-3*(a+b*x)*sin((a+b*x)^2)+-1*a*b^-3*sin((a+b*x)^2)+-1//4*2^(1/2)*pi^(1/2)*b^-3*fresnels(2^(1/2)*pi^-1//2*(a+b*x))+(1/2)*2^(1/2)*pi^(1/2)*a^2*b^-3*fresnelc(2^(1/2)*pi^-1//2*(a+b*x)))
@test integrate(x*cos((a+b*x)^2), x) == :((1/2)*b^-2*sin((a+b*x)^2)+-1//2*a*2^(1/2)*pi^(1/2)*b^-2*fresnelc(2^(1/2)*pi^-1//2*(a+b*x)))
@test integrate(cos((a+b*x)^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*b^-1*fresnelc(2^(1/2)*pi^-1//2*(a+b*x)))
@test integrate(x^2*cos(a+b*(c+d*x)^(1/2)), x) == :(240*b^-6*d^-3*cos(a+b*(c+d*x)^(1/2))+-1*b^-4*d^-3*(120c+120*d*x)*cos(a+b*(c+d*x)^(1/2))+-40*b^-3*d^-3*(c+d*x)^3//2*sin(a+b*(c+d*x)^(1/2))+2*b^-1*d^-3*(c+d*x)^5//2*sin(a+b*(c+d*x)^(1/2))+2*b^-2*c^2*d^-3*cos(a+b*(c+d*x)^(1/2))+10*b^-2*d^-3*(c+d*x)^2*cos(a+b*(c+d*x)^(1/2))+24*c*b^-4*d^-3*cos(a+b*(c+d*x)^(1/2))+240*b^-5*d^-3*(c+d*x)^(1/2)*sin(a+b*(c+d*x)^(1/2))+-12*c*b^-2*d^-3*(c+d*x)*cos(a+b*(c+d*x)^(1/2))+-4*c*b^-1*d^-3*(c+d*x)^3//2*sin(a+b*(c+d*x)^(1/2))+2*b^-1*c^2*d^-3*(c+d*x)^(1/2)*sin(a+b*(c+d*x)^(1/2))+24*c*b^-3*d^-3*(c+d*x)^(1/2)*sin(a+b*(c+d*x)^(1/2)))
@test integrate(x*cos(a+b*(c+d*x)^(1/2)), x) == :(-12*b^-4*d^-2*cos(a+b*(c+d*x)^(1/2))+b^-2*d^-2*(6c+6*d*x)*cos(a+b*(c+d*x)^(1/2))+-12*b^-3*d^-2*(c+d*x)^(1/2)*sin(a+b*(c+d*x)^(1/2))+-2*c*b^-2*d^-2*cos(a+b*(c+d*x)^(1/2))+2*b^-1*d^-2*(c+d*x)^3//2*sin(a+b*(c+d*x)^(1/2))+-2*c*b^-1*d^-2*(c+d*x)^(1/2)*sin(a+b*(c+d*x)^(1/2)))
@test integrate(cos(a+b*(c+d*x)^(1/2)), x) == :(2*b^-2*d^-1*cos(a+b*(c+d*x)^(1/2))+2*b^-1*d^-1*(c+d*x)^(1/2)*sin(a+b*(c+d*x)^(1/2)))
@test integrate(x^-1*cos(a+b*(c+d*x)^(1/2)), x) == :(cos(a+b*c^(1/2))*cosintegral(b*c^(1/2)+-1*b*(c+d*x)^(1/2))+cos(a+-1*b*c^(1/2))*cosintegral(b*(c^(1/2)+(c+d*x)^(1/2)))+sin(a+b*c^(1/2))*sinintegral(b*c^(1/2)+-1*b*(c+d*x)^(1/2))+-1*sin(a+-1*b*c^(1/2))*sinintegral(b*(c^(1/2)+(c+d*x)^(1/2))))
@test integrate(x^-2*cos(a+b*(c+d*x)^(1/2)), x) == :(-1*x^-1*cos(a+b*(c+d*x)^(1/2))+(1/2)*b*d*c^-1//2*cos(a+b*c^(1/2))*sinintegral(b*c^(1/2)+-1*b*(c+d*x)^(1/2))+(1/2)*b*d*c^-1//2*cos(a+-1*b*c^(1/2))*sinintegral(b*(c^(1/2)+(c+d*x)^(1/2)))+(1/2)*b*d*c^-1//2*cosintegral(b*(c^(1/2)+(c+d*x)^(1/2)))*sin(a+-1*b*c^(1/2))+-1//2*b*d*c^-1//2*cosintegral(b*c^(1/2)+-1*b*(c+d*x)^(1/2))*sin(a+b*c^(1/2)))
@test integrate(x^2*cos(a+b*(c+d*x)^1//3), x) == :(120960*b^-9*d^-3*sin(a+b*(c+d*x)^1//3)+b^-6*d^-3*(20160c+20160*d*x)*cos(a+b*(c+d*x)^1//3)+-120960*b^-8*d^-3*(c+d*x)^1//3*cos(a+b*(c+d*x)^1//3)+-60480*b^-7*d^-3*(c+d*x)^2//3*sin(a+b*(c+d*x)^1//3)+-1008*b^-4*d^-3*(c+d*x)^5//3*cos(a+b*(c+d*x)^1//3)+-720*c*b^-6*d^-3*cos(a+b*(c+d*x)^1//3)+-168*b^-3*d^-3*(c+d*x)^2*sin(a+b*(c+d*x)^1//3)+-6*b^-3*c^2*d^-3*sin(a+b*(c+d*x)^1//3)+3*b^-1*d^-3*(c+d*x)^8//3*sin(a+b*(c+d*x)^1//3)+24*b^-2*d^-3*(c+d*x)^7//3*cos(a+b*(c+d*x)^1//3)+5040*b^-5*d^-3*(c+d*x)^4//3*sin(a+b*(c+d*x)^1//3)+-720*c*b^-5*d^-3*(c+d*x)^1//3*sin(a+b*(c+d*x)^1//3)+-30*c*b^-2*d^-3*(c+d*x)^4//3*cos(a+b*(c+d*x)^1//3)+-6*c*b^-1*d^-3*(c+d*x)^5//3*sin(a+b*(c+d*x)^1//3)+3*b^-1*c^2*d^-3*(c+d*x)^2//3*sin(a+b*(c+d*x)^1//3)+6*b^-2*c^2*d^-3*(c+d*x)^1//3*cos(a+b*(c+d*x)^1//3)+120*c*b^-3*d^-3*(c+d*x)*sin(a+b*(c+d*x)^1//3)+360*c*b^-4*d^-3*(c+d*x)^2//3*cos(a+b*(c+d*x)^1//3))
@test integrate(x*cos(a+b*(c+d*x)^1//3), x) == :(360*b^-6*d^-2*cos(a+b*(c+d*x)^1//3)+-1*b^-3*d^-2*(60c+60*d*x)*sin(a+b*(c+d*x)^1//3)+-180*b^-4*d^-2*(c+d*x)^2//3*cos(a+b*(c+d*x)^1//3)+3*b^-1*d^-2*(c+d*x)^5//3*sin(a+b*(c+d*x)^1//3)+6*c*b^-3*d^-2*sin(a+b*(c+d*x)^1//3)+15*b^-2*d^-2*(c+d*x)^4//3*cos(a+b*(c+d*x)^1//3)+360*b^-5*d^-2*(c+d*x)^1//3*sin(a+b*(c+d*x)^1//3)+-6*c*b^-2*d^-2*(c+d*x)^1//3*cos(a+b*(c+d*x)^1//3)+-3*c*b^-1*d^-2*(c+d*x)^2//3*sin(a+b*(c+d*x)^1//3))
@test integrate(cos(a+b*(c+d*x)^1//3), x) == :(-6*b^-3*d^-1*sin(a+b*(c+d*x)^1//3)+3*b^-1*d^-1*(c+d*x)^2//3*sin(a+b*(c+d*x)^1//3)+6*b^-2*d^-1*(c+d*x)^1//3*cos(a+b*(c+d*x)^1//3))
@test integrate(x^-1*cos(a+b*(c+d*x)^1//3), x) == :(cos(a+b*c^1//3)*cosintegral(b*c^1//3+-1*b*(c+d*x)^1//3)+cos(a+b*(-1)^2//3*c^1//3)*cosintegral(-1*b*(c+d*x)^1//3+b*(-1)^2//3*c^1//3)+cos(a+-1*b*(-1)^1//3*c^1//3)*cosintegral(b*(c+d*x)^1//3+b*(-1)^1//3*c^1//3)+sin(a+b*c^1//3)*sinintegral(b*c^1//3+-1*b*(c+d*x)^1//3)+sin(a+b*(-1)^2//3*c^1//3)*sinintegral(-1*b*(c+d*x)^1//3+b*(-1)^2//3*c^1//3)+-1*sin(a+-1*b*(-1)^1//3*c^1//3)*sinintegral(b*(c+d*x)^1//3+b*(-1)^1//3*c^1//3))
@test integrate(x^-2*cos(a+b*(c+d*x)^1//3), x) == :(-1*x^-1*cos(a+b*(c+d*x)^1//3)+-1//3*b*d*c^-2//3*cosintegral(b*c^1//3+-1*b*(c+d*x)^1//3)*sin(a+b*c^1//3)+1//3*b*d*c^-2//3*cos(a+b*c^1//3)*sinintegral(b*c^1//3+-1*b*(c+d*x)^1//3)+-1//3*b*d*(-1)^2//3*c^-2//3*cosintegral(-1*b*(c+d*x)^1//3+b*(-1)^2//3*c^1//3)*sin(a+b*(-1)^2//3*c^1//3)+1//3*b*d*(-1)^1//3*c^-2//3*cos(a+-1*b*(-1)^1//3*c^1//3)*sinintegral(b*(c+d*x)^1//3+b*(-1)^1//3*c^1//3)+1//3*b*d*(-1)^1//3*c^-2//3*cosintegral(b*(c+d*x)^1//3+b*(-1)^1//3*c^1//3)*sin(a+-1*b*(-1)^1//3*c^1//3)+1//3*b*d*(-1)^2//3*c^-2//3*cos(a+b*(-1)^2//3*c^1//3)*sinintegral(-1*b*(c+d*x)^1//3+b*(-1)^2//3*c^1//3))

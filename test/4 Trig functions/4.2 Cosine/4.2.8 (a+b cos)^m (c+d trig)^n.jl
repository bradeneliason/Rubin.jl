using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((a+b*cos(x))^-1*(A+B*sin(x)), x) == :(-1*B*b^-1*log(a+b*cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
@test integrate((1+cos(x))^-1*(A+B*sin(x)), x) == :(-1*B*log(1+cos(x))+A*(1+cos(x))^-1*sin(x))
@test integrate((1+-1*cos(x))^-1*(A+B*sin(x)), x) == :(B*log(1+-1*cos(x))+-1*A*(1+-1*cos(x))^-1*sin(x))
@test integrate((a+b*cos(x))^-1*(b+c+sin(x)), x) == :(-1*b^-1*log(a+b*cos(x))+(a+b)^-1//2*(a+-1b)^-1//2*(2b+2c)*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
@test integrate((a+-1*b*cos(x))^-1*(b+c+sin(x)), x) == :(b^-1*log(a+-1*b*cos(x))+(a+b)^-1//2*(a+-1b)^-1//2*(2b+2c)*arctan((a+b)^(1/2)*(a+-1b)^-1//2*tan((1/2)*x)))
@test integrate((a+b*cos(x))^-1*(A+B*tan(x)), x) == :(B*a^-1*log(a+b*cos(x))+-1*B*a^-1*log(cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
@test integrate((a+b*cos(x))^-1*(A+B*cot(x)), x) == :(B*(-2b+2a)^-1*log(1+cos(x))+B*(2a+2b)^-1*log(1+-1*cos(x))+-1*B*a*(a^2+-1*b^2)^-1*log(a+b*cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
@test integrate((a+b*cos(x))^-1*(A+B*csc(x)), x) == :(B*(2a+2b)^-1*log(1+-1*cos(x))+-1*B*(-2b+2a)^-1*log(1+cos(x))+B*b*(a^2+-1*b^2)^-1*log(a+b*cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^4, x) == :(a^-1*d^4*f^-1*tan(e+f*x)+1//3*a^-1*d^4*f^-1*tan(e+f*x)^3+a^-3*d^2*f^-1*(b^2*d^2+6*a^2*c^2+-4*a*b*c*d)*tan(e+f*x)+(1/2)*a^-2*d^3*f^-1*(-1*b*d+4*a*c)*arctanh(sin(e+f*x))+d*a^-4*f^-1*(-1*b*d+2*a*c)*(b^2*d^2+2*a^2*c^2+-2*a*b*c*d)*arctanh(sin(e+f*x))+(1/2)*a^-2*d^3*f^-1*(-1*b*d+4*a*c)*sec(e+f*x)*tan(e+f*x)+2*a^-4*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^4*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^3, x) == :((1/2)*a^-1*d^3*f^-1*arctanh(sin(e+f*x))+d*a^-3*f^-1*(b^2*d^2+3*a^2*c^2+-3*a*b*c*d)*arctanh(sin(e+f*x))+a^-2*d^2*f^-1*(-1*b*d+3*a*c)*tan(e+f*x)+(1/2)*a^-1*d^3*f^-1*sec(e+f*x)*tan(e+f*x)+2*a^-3*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^3*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^2, x) == :(a^-1*d^2*f^-1*tan(e+f*x)+d*a^-2*f^-1*(-1*b*d+2*a*c)*arctanh(sin(e+f*x))+2*a^-2*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x)), x) == :(d*a^-1*f^-1*arctanh(sin(e+f*x))+a^-1*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(-2*b*d+2*a*c)*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^-1, x) == :(-2*d*f^-1*(c+d)^-1//2*(c+-1d)^-1//2*(a*c+-1*b*d)^-1*arctanh((c+d)^-1//2*(c+-1d)^(1/2)*tan((1/2)*e+(1/2)*f*x))+2*a*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^-1*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^-2, x) == :(d^2*f^-1*(d+c*cos(e+f*x))^-1*(c^2+-1*d^2)^-1*(a*c+-1*b*d)^-1*sin(e+f*x)+2*a^2*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^-2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x))+-2*d*f^-1*(c+d)^-3//2*(c+-1d)^-3//2*(a*c+-1*b*d)^-2*(-1*a*d^2+2*a*c^2+-1*b*c*d)*arctanh((c+d)^-1//2*(c+-1d)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^-3, x) == :(2*a^3*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^-3*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x))+-1//2*c^-1*d^3*f^-1*(d+c*cos(e+f*x))^-2*(c^2+-1*d^2)^-1*(a*c+-1*b*d)^-1*sin(e+f*x)+3//2*c^-1*d^4*f^-1*(d+c*cos(e+f*x))^-1*(c^2+-1*d^2)^-2*(a*c+-1*b*d)^-1*sin(e+f*x)+c^-1*d^2*f^-1*(d+c*cos(e+f*x))^-1*(c^2+-1*d^2)^-1*(a*c+-1*b*d)^-2*(-2*b*d+3*a*c)*sin(e+f*x)+-1*c^-2*d^3*f^-1*(c+d)^-5//2*(c+-1d)^-5//2*(a*c+-1*b*d)^-1*(c^2+2*d^2)*arctanh((c+d)^-1//2*(c+-1d)^(1/2)*tan((1/2)*e+(1/2)*f*x))+-2*d*c^-2*f^-1*(c+d)^-1//2*(c+-1d)^-1//2*(a*c+-1*b*d)^-3*(b^2*d^2+3*a^2*c^2+-3*a*b*c*d)*arctanh((c+d)^-1//2*(c+-1d)^(1/2)*tan((1/2)*e+(1/2)*f*x))+-2*c^-2*d^3*f^-1*(c+d)^-3//2*(c+-1d)^-3//2*(a*c+-1*b*d)^-2*(-2*b*d+3*a*c)*arctanh((c+d)^-1//2*(c+-1d)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
@test integrate((a+b*cos(d+e*x))^-1*(A+B*cos(d+e*x)+C*sin(d+e*x)), x) == :(B*x*b^-1+-1*C*b^-1*e^-1*log(a+b*cos(d+e*x))+b^-1*e^-1*(a+b)^-1//2*(a+-1b)^-1//2*(-2*B*a+2*A*b)*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*d+(1/2)*e*x)))
@test integrate((a+b*cos(d+e*x))^-2*(A+B*cos(d+e*x)+C*sin(d+e*x)), x) == :(C*b^-1*e^-1*(a+b*cos(d+e*x))^-1+e^-1*(a+b)^-3//2*(a+-1b)^-3//2*(-2*B*b+2*A*a)*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*d+(1/2)*e*x))+-1*e^-1*(a+b*cos(d+e*x))^-1*(a^2+-1*b^2)^-1*(A*b+-1*B*a)*sin(d+e*x))
@test integrate((a+b*cos(d+e*x))^-3*(A+B*cos(d+e*x)+C*sin(d+e*x)), x) == :((1/2)*C*b^-1*e^-1*(a+b*cos(d+e*x))^-2+e^-1*(a+b)^-5//2*(a+-1b)^-5//2*(A*b^2+2*A*a^2+-3*B*a*b)*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*d+(1/2)*e*x))+-1*e^-1*(a+b*cos(d+e*x))^-2*(-2*b^2+2*a^2)^-1*(A*b+-1*B*a)*sin(d+e*x)+-1//2*e^-1*(a+b*cos(d+e*x))^-1*(a^2+-1*b^2)^-2*(-1*B*a^2+-2*B*b^2+3*A*a*b)*sin(d+e*x))
@test integrate((a+b*cos(d+e*x))^-4*(A+B*cos(d+e*x)+C*sin(d+e*x)), x) == :(1//3*C*b^-1*e^-1*(a+b*cos(d+e*x))^-3+e^-1*(a+b)^-7//2*(a+-1b)^-7//2*(-1*B*b^3+2*A*a^3+-4*B*b*a^2+3*A*a*b^2)*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*d+(1/2)*e*x))+-1*e^-1*(a+b*cos(d+e*x))^-3*(-3*b^2+3*a^2)^-1*(A*b+-1*B*a)*sin(d+e*x)+-1//6*e^-1*(a+b*cos(d+e*x))^-1*(a^2+-1*b^2)^-3*(-2*B*a^3+4*A*b^3+-13*B*a*b^2+11*A*b*a^2)*sin(d+e*x)+-1//6*e^-1*(a+b*cos(d+e*x))^-2*(a^2+-1*b^2)^-2*(-3*B*b^2+-2*B*a^2+5*A*a*b)*sin(d+e*x))

using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^6, x) == :(3//8*x*a^-1+-3//8*a^-1*cos(x)*sin(x)+-1//4*a^-1*sin(x)^3*cos(x))
@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^5, x) == :(-1*a^-1*cos(x)+1//3*a^-1*cos(x)^3)
@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^4, x) == :((1/2)*x*a^-1+-1//2*a^-1*cos(x)*sin(x))
@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^3, x) == :(-1*a^-1*cos(x))
@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^2, x) == :(x*a^-1)
@test integrate((a+-1*a*cos(x)^2)^-1*sin(x), x) == :(-1*a^-1*arctanh(cos(x)))
@test integrate((a+-1*a*cos(x)^2)^-1*csc(x), x) == :(-1//2*a^-1*arctanh(cos(x))+-1//2*a^-1*cot(x)*csc(x))
@test integrate((a+-1*a*cos(x)^2)^-1*csc(x)^2, x) == :(-1*a^-1*cot(x)+-1//3*a^-1*cot(x)^3)
@test integrate((a+-1*a*cos(x)^2)^-1*csc(x)^3, x) == :(-3//8*a^-1*arctanh(cos(x))+-3//8*a^-1*cot(x)*csc(x)+-1//4*a^-1*csc(x)^3*cot(x))
@test integrate((a+b*cos(x)^2)^-1*sin(x)^7, x) == :(1//5*b^-1*cos(x)^5+b^-3*(a^2+3*b^2+3*a*b)*cos(x)+-1//3*b^-2*cos(x)^3*(a+3b)+-1*a^-1//2*b^-7//2*(a+b)^3*arctan(a^-1//2*b^(1/2)*cos(x)))
@test integrate((a+b*cos(x)^2)^-1*sin(x)^5, x) == :(-1//3*b^-1*cos(x)^3+b^-2*(a+2b)*cos(x)+-1*a^-1//2*b^-5//2*(a+b)^2*arctan(a^-1//2*b^(1/2)*cos(x)))
@test integrate((a+b*cos(x)^2)^-1*sin(x)^3, x) == :(b^-1*cos(x)+-1*a^-1//2*b^-3//2*(a+b)*arctan(a^-1//2*b^(1/2)*cos(x)))
@test integrate((a+b*cos(x)^2)^-1*sin(x), x) == :(-1*a^-1//2*b^-1//2*arctan(a^-1//2*b^(1/2)*cos(x)))
@test integrate((a+b*cos(x)^2)^-1*csc(x), x) == :(-1*(a+b)^-1*arctanh(cos(x))+-1*a^-1//2*b^(1/2)*(a+b)^-1*arctan(a^-1//2*b^(1/2)*cos(x)))
@test integrate((a+b*cos(x)^2)^-1*csc(x)^3, x) == :(-1*(2a+2b)^-1*cot(x)*csc(x)+-1//2*(a+b)^-2*(a+3b)*arctanh(cos(x))+-1*a^-1//2*b^3//2*(a+b)^-2*arctan(a^-1//2*b^(1/2)*cos(x)))
@test integrate((a+b*cos(x)^2)^-1*csc(x)^5, x) == :(-1*(4a+4b)^-1*csc(x)^3*cot(x)+-1//8*(a+b)^-3*(3*a^2+15*b^2+10*a*b)*arctanh(cos(x))+-1*a^-1//2*b^5//2*(a+b)^-3*arctan(a^-1//2*b^(1/2)*cos(x))+-1//8*(a+b)^-2*(3a+7b)*cot(x)*csc(x))
@test integrate((a+b*cos(x)^2)^-1*sin(x)^6, x) == :(-1//8*x*b^-3*(8*a^2+15*b^2+20*a*b)+1//4*b^-1*sin(x)^3*cos(x)+-1*a^-1//2*b^-3*(a+b)^5//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x))+1//8*b^-2*(4a+7b)*cos(x)*sin(x))
@test integrate((a+b*cos(x)^2)^-1*sin(x)^4, x) == :((1/2)*b^-1*cos(x)*sin(x)+-1//2*x*b^-2*(2a+3b)+-1*a^-1//2*b^-2*(a+b)^3//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*sin(x)^2, x) == :(-1*x*b^-1+-1*a^-1//2*b^-1*(a+b)^(1/2)*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1, x) == :(-1*a^-1//2*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*csc(x)^2, x) == :(-1*(a+b)^-1*cot(x)+-1*b*a^-1//2*(a+b)^-3//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*csc(x)^4, x) == :(-1*(3a+3b)^-1*cot(x)^3+-1*(a+b)^-2*(a+2b)*cot(x)+-1*a^-1//2*b^2*(a+b)^-5//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*csc(x)^6, x) == :(-1*(5a+5b)^-1*cot(x)^5+-1*(a+b)^-3*(a^2+3*b^2+3*a*b)*cot(x)+-1//3*(a+b)^-2*cot(x)^3*(2a+3b)+-1*a^-1//2*b^3*(a+b)^-7//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((4+-3*cos(x)^3)^-1*sin(x), x) == :(-1//72*6^2//3*log(2*2^1//3+3^2//3*cos(x)^2+2^2//3*3^1//3*cos(x))+1//36*6^2//3*log(2^2//3+-1*3^1//3*cos(x))+-1//12*2^2//3*3^1//6*arctan(1//3*3^(1/2)*(1+6^1//3*cos(x))))
@test integrate((1+-1*cos(x)^2)^-1, x) == :(-1*cot(x))
@test integrate((1+-1*cos(x)^2)^-2, x) == :(-1*cot(x)+-1//3*cot(x)^3)
@test integrate((1+-1*cos(x)^2)^-3, x) == :(-1*cot(x)+-2//3*cot(x)^3+-1//5*cot(x)^5)
@test integrate((a+b*cos(x)^2)^-1*cos(x)^7, x) == :(1//5*b^-1*sin(x)^5+b^-3*(a^2+b^2+-1*a*b)*sin(x)+1//3*b^-2*sin(x)^3*(a+-2b)+-1*a^3*b^-7//2*(a+b)^-1//2*arctanh(b^(1/2)*(a+b)^-1//2*sin(x)))
@test integrate((a+b*cos(x)^2)^-1*cos(x)^5, x) == :(-1//3*b^-1*sin(x)^3+-1*b^-2*(a+-1b)*sin(x)+a^2*b^-5//2*(a+b)^-1//2*arctanh(b^(1/2)*(a+b)^-1//2*sin(x)))
@test integrate((a+b*cos(x)^2)^-1*cos(x)^3, x) == :(b^-1*sin(x)+-1*a*b^-3//2*(a+b)^-1//2*arctanh(b^(1/2)*(a+b)^-1//2*sin(x)))
@test integrate((a+b*cos(x)^2)^-1*cos(x), x) == :(b^-1//2*(a+b)^-1//2*arctanh(b^(1/2)*(a+b)^-1//2*sin(x)))
@test integrate((a+b*cos(x)^2)^-1*sec(x), x) == :(a^-1*arctanh(sin(x))+-1*a^-1*b^(1/2)*(a+b)^-1//2*arctanh(b^(1/2)*(a+b)^-1//2*sin(x)))
@test integrate((a+b*cos(x)^2)^-1*sec(x)^3, x) == :((1/2)*a^-1*sec(x)*tan(x)+(1/2)*a^-2*(a+-2b)*arctanh(sin(x))+a^-2*b^3//2*(a+b)^-1//2*arctanh(b^(1/2)*(a+b)^-1//2*sin(x)))
@test integrate((a+b*cos(x)^2)^-1*sec(x)^5, x) == :(1//4*a^-1*sec(x)^3*tan(x)+1//8*a^-3*(3*a^2+8*b^2+-4*a*b)*arctanh(sin(x))+-1*a^-3*b^5//2*(a+b)^-1//2*arctanh(b^(1/2)*(a+b)^-1//2*sin(x))+1//8*a^-2*(-4b+3a)*sec(x)*tan(x))
@test integrate((a+b*cos(x)^2)^-1*cos(x)^6, x) == :(1//4*b^-1*cos(x)^3*sin(x)+1//8*x*b^-3*(3*b^2+8*a^2+-4*a*b)+a^5//2*b^-3*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x))+-1//8*b^-2*(-3b+4a)*cos(x)*sin(x))
@test integrate((a+b*cos(x)^2)^-1*cos(x)^4, x) == :((1/2)*b^-1*cos(x)*sin(x)+-1//2*x*b^-2*(-1b+2a)+-1*a^3//2*b^-2*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*cos(x)^2, x) == :(x*b^-1+a^(1/2)*b^-1*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1, x) == :(-1*a^-1//2*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*sec(x)^2, x) == :(a^-1*tan(x)+b*a^-3//2*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*sec(x)^4, x) == :(1//3*a^-1*tan(x)^3+a^-2*(a+-1b)*tan(x)+-1*a^-5//2*b^2*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-1*sec(x)^6, x) == :(1//5*a^-1*tan(x)^5+a^-3*(a^2+b^2+-1*a*b)*tan(x)+1//3*a^-2*tan(x)^3*(-1b+2a)+a^-7//2*b^3*(a+b)^-1//2*arctan(a^-1//2*(a+b)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^2)^-2, x) == :(-1//2*a^-3//2*(a+b)^-3//2*(b+2a)*arctan(a^-1//2*(a+b)^(1/2)*cot(x))+-1//2*b*a^-1*(a+b)^-1*(a+b*cos(x)^2)^-1*cos(x)*sin(x))
@test integrate((a+b*cos(x)^2)^-3, x) == :(-1//8*a^-5//2*(a+b)^-5//2*(3*b^2+8*a^2+8*a*b)*arctan(a^-1//2*(a+b)^(1/2)*cot(x))+-1//4*b*a^-1*(a+b)^-1*(a+b*cos(x)^2)^-2*cos(x)*sin(x)+-3//8*b*a^-2*(a+b)^-2*(a+b*cos(x)^2)^-1*(b+2a)*cos(x)*sin(x))
@test integrate((1+cos(x)^2)^-1, x) == :((1/2)*x*2^(1/2)+-1//2*2^(1/2)*arctan((1+2^(1/2)+cos(x)^2)^-1*cos(x)*sin(x)))
@test integrate((1+cos(x)^2)^-2, x) == :(-3//8*2^(1/2)*arctan((1+2^(1/2)+cos(x)^2)^-1*cos(x)*sin(x))+3//8*x*2^(1/2)+-1*(4+4*cos(x)^2)^-1*cos(x)*sin(x))
@test integrate((1+cos(x)^2)^-3, x) == :(-19//64*2^(1/2)*arctan((1+2^(1/2)+cos(x)^2)^-1*cos(x)*sin(x))+19//64*x*2^(1/2)+-9*(32+32*cos(x)^2)^-1*cos(x)*sin(x)+-1//8*(1+cos(x)^2)^-2*cos(x)*sin(x))
@test integrate((1+-1*cos(x)^2)^(1/2), x) == :(-1*(sin(x)^2)^(1/2)*cot(x))
@test integrate((-1+cos(x)^2)^(1/2), x) == :(-1*(-1*sin(x)^2)^(1/2)*cot(x))
@test integrate((1+-1*cos(x)^2)^3//2, x) == :(-2//3*(sin(x)^2)^(1/2)*cot(x)+-1//3*(sin(x)^2)^3//2*cot(x))
@test integrate((-1+cos(x)^2)^3//2, x) == :(-1//3*(-1*sin(x)^2)^3//2*cot(x)+2//3*(-1*sin(x)^2)^(1/2)*cot(x))
@test integrate((1+-1*cos(x)^2)^-1//2, x) == :(-1*(sin(x)^2)^-1//2*arctanh(cos(x))*sin(x))
@test integrate((-1+cos(x)^2)^-1//2, x) == :(-1*(-1*sin(x)^2)^-1//2*arctanh(cos(x))*sin(x))
@test integrate((1+-1*cos(x)^2)^-3//2, x) == :(-1//2*(sin(x)^2)^-1//2*cot(x)+-1//2*(sin(x)^2)^-1//2*arctanh(cos(x))*sin(x))
@test integrate((-1+cos(x)^2)^-3//2, x) == :((1/2)*(-1*sin(x)^2)^-1//2*cot(x)+(1/2)*(-1*sin(x)^2)^-1//2*arctanh(cos(x))*sin(x))
@test integrate((1+cos(x)^2)^(1/2), x) == :(Elliptic.E(x+(1/2)*pi,-1))
@test integrate((-1+-1*cos(x)^2)^(1/2), x) == :((1+cos(x)^2)^-1//2*(-1+-1*cos(x)^2)^(1/2)*Elliptic.E(x+(1/2)*pi,-1))
@test integrate((a+b*cos(x)^2)^(1/2), x) == :((1+b*a^-1*cos(x)^2)^-1//2*(a+b*cos(x)^2)^(1/2)*Elliptic.E(x+(1/2)*pi,-1*b*a^-1))
@test integrate((1+cos(x)^2)^3//2, x) == :(2*Elliptic.E(x+(1/2)*pi,-1)+-2//3*Elliptic.F(x+(1/2)*pi,-1)+1//3*(1+cos(x)^2)^(1/2)*cos(x)*sin(x))
@test integrate((-1+-1*cos(x)^2)^3//2, x) == :(-2*(1+cos(x)^2)^-1//2*(-1+-1*cos(x)^2)^(1/2)*Elliptic.E(x+(1/2)*pi,-1)+-2//3*(1+cos(x)^2)^(1/2)*(-1+-1*cos(x)^2)^-1//2*Elliptic.F(x+(1/2)*pi,-1)+-1//3*(-1+-1*cos(x)^2)^(1/2)*cos(x)*sin(x))
@test integrate((a+b*cos(x)^2)^3//2, x) == :(1//3*b*(a+b*cos(x)^2)^(1/2)*cos(x)*sin(x)+1//3*(1+b*a^-1*cos(x)^2)^-1//2*(a+b*cos(x)^2)^(1/2)*(2b+4a)*Elliptic.E(x+(1/2)*pi,-1*b*a^-1)+-1//3*a*(1+b*a^-1*cos(x)^2)^(1/2)*(a+b*cos(x)^2)^-1//2*(a+b)*Elliptic.F(x+(1/2)*pi,-1*b*a^-1))
@test integrate((1+cos(x)^2)^-1//2, x) == :(Elliptic.F(x+(1/2)*pi,-1))
@test integrate((-1+-1*cos(x)^2)^-1//2, x) == :((1+cos(x)^2)^(1/2)*(-1+-1*cos(x)^2)^-1//2*Elliptic.F(x+(1/2)*pi,-1))
@test integrate((a+b*cos(x)^2)^-1//2, x) == :((1+b*a^-1*cos(x)^2)^(1/2)*(a+b*cos(x)^2)^-1//2*Elliptic.F(x+(1/2)*pi,-1*b*a^-1))
@test integrate((1+cos(x)^2)^-3//2, x) == :((1/2)*Elliptic.E(x+(1/2)*pi,-1)+-1//2*(1+cos(x)^2)^-1//2*cos(x)*sin(x))
@test integrate((-1+-1*cos(x)^2)^-3//2, x) == :((1/2)*(1+cos(x)^2)^-1//2*(-1+-1*cos(x)^2)^(1/2)*Elliptic.E(x+(1/2)*pi,-1)+(1/2)*(-1+-1*cos(x)^2)^-1//2*cos(x)*sin(x))
@test integrate((a+b*cos(x)^2)^-3//2, x) == :(a^-1*(1+b*a^-1*cos(x)^2)^-1//2*(a+b)^-1*(a+b*cos(x)^2)^(1/2)*Elliptic.E(x+(1/2)*pi,-1*b*a^-1)+-1*b*a^-1*(a+b)^-1*(a+b*cos(x)^2)^-1//2*cos(x)*sin(x))
@test integrate((1+cos(x)^2)^-1//2*cos(x), x) == :(arcsin((1/2)*2^(1/2)*sin(x)))
@test integrate((3+cos(5+3x)^2)^-1//2*cos(5+3x), x) == :(1//3*arcsin((1/2)*sin(5+3x)))
@test integrate((4+-1*cos(x)^2)^-1//2*cos(x), x) == :(arcsinh(1//3*3^(1/2)*sin(x)))
@test integrate((a+b*cos(x)^4)^-1, x) == :(-1//4*2^(1/2)*a^-3//4*(a+b)^-1//4*(a+b+a^(1/2)*(a+b)^(1/2))^-1//2*(a^(1/2)+(a+b)^(1/2))*arctan(a^-1//4*(a+b+a^(1/2)*(a+b)^(1/2))^-1//2*(a^1//4*(a+b+-1*a^(1/2)*(a+b)^(1/2))^(1/2)+2^(1/2)*(a+b)^3//4*cot(x)))+-1//8*2^(1/2)*a^-3//4*(a+b)^-1//4*(a+b+-1*a^(1/2)*(a+b)^(1/2))^-1//2*(a^(1/2)+-1*(a+b)^(1/2))*log(a^(1/2)*(a+b)^1//4+(a+b)^3//4*cot(x)^2+-1*2^(1/2)*a^1//4*(a+b+-1*a^(1/2)*(a+b)^(1/2))^(1/2)*cot(x))+1//4*2^(1/2)*a^-3//4*(a+b)^-1//4*(a+b+a^(1/2)*(a+b)^(1/2))^-1//2*(a^(1/2)+(a+b)^(1/2))*arctan(a^-1//4*(a+b+a^(1/2)*(a+b)^(1/2))^-1//2*(a^1//4*(a+b+-1*a^(1/2)*(a+b)^(1/2))^(1/2)+-1*2^(1/2)*(a+b)^3//4*cot(x)))+1//8*2^(1/2)*a^-3//4*(a+b)^-1//4*(a+b+-1*a^(1/2)*(a+b)^(1/2))^-1//2*(a^(1/2)+-1*(a+b)^(1/2))*log(a^(1/2)*(a+b)^1//4+(a+b)^3//4*cot(x)^2+2^(1/2)*a^1//4*(a+b+-1*a^(1/2)*(a+b)^(1/2))^(1/2)*cot(x)))
@test integrate((a+-1*b*cos(x)^4)^-1, x) == :(-1//2*a^-3//4*(a^(1/2)+b^(1/2))^-1//2*arctan(a^-1//4*(a^(1/2)+b^(1/2))^(1/2)*cot(x))+-1//2*a^-3//4*(a^(1/2)+-1*b^(1/2))^-1//2*arctan(a^-1//4*(a^(1/2)+-1*b^(1/2))^(1/2)*cot(x)))
@test integrate((1+cos(x)^4)^-1, x) == :((1/2)*x*(-1+2^(1/2))^-1//2+-1//8*(-1+2^(1/2))^(1/2)*log(1+2^(1/2)*cot(x)^2+(-2+2*2^(1/2))^(1/2)*cot(x))+1//4*(-1+2^(1/2))^-1//2*arctan((2+(1+2^(1/2))^(1/2)+sin(x)^2*(-2+2^(1/2))+-2*(-1+2^(1/2))^(1/2)*cos(x)*sin(x))^-1*((-1+2^(1/2))^(1/2)*(-1+2*sin(x)^2)+(-2+2^(1/2))*cos(x)*sin(x)))+1//4*(-1+2^(1/2))^-1//2*arctan((2+(1+2^(1/2))^(1/2)+sin(x)^2*(-2+2^(1/2))+2*(-1+2^(1/2))^(1/2)*cos(x)*sin(x))^-1*((-1+2^(1/2))^(1/2)*(1+-2*sin(x)^2)+(-2+2^(1/2))*cos(x)*sin(x)))+1//8*(-1+2^(1/2))^(1/2)*log(2^(1/2)+2*cot(x)^2+-2*(-1+2^(1/2))^(1/2)*cot(x)))
@test integrate((1+-1*cos(x)^4)^-1, x) == :(-1//2*cot(x)+-1//4*2^(1/2)*arctan((1+2^(1/2)+cos(x)^2)^-1*cos(x)*sin(x))+1//4*x*2^(1/2))
@test integrate((a+b*cos(x)^5)^-1, x) == :(2//5*a^-4//5*(a^1//5+b^1//5)^-1//2*(a^1//5+-1*b^1//5)^-1//2*arctan((a^1//5+b^1//5)^-1//2*(a^1//5+-1*b^1//5)^(1/2)*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^1//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^1//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^1//5*b^1//5)^(1/2)*(a^1//5+-1*(-1)^1//5*b^1//5)^-1//2*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^2//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^2//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^2//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^2//5*b^1//5)^(1/2)*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^3//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^3//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^3//5*b^1//5)^(1/2)*(a^1//5+-1*(-1)^3//5*b^1//5)^-1//2*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^4//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^4//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^4//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^4//5*b^1//5)^(1/2)*tan((1/2)*x)))
@test integrate((a+b*cos(x)^6)^-1, x) == :(-1//3*a^-5//6*(a^1//3+b^1//3)^-1//2*arctan(a^-1//6*(a^1//3+b^1//3)^(1/2)*cot(x))+-1//3*a^-5//6*(a^1//3+(-1)^2//3*b^1//3)^-1//2*arctan(a^-1//6*(a^1//3+(-1)^2//3*b^1//3)^(1/2)*cot(x))+-1//3*a^-5//6*(a^1//3+-1*(-1)^1//3*b^1//3)^-1//2*arctan(a^-1//6*(a^1//3+-1*(-1)^1//3*b^1//3)^(1/2)*cot(x)))
@test integrate((a+b*cos(x)^8)^-1, x) == :(1//4*(-1a)^-7//8*(b^1//4+(-1a)^1//4)^-1//2*arctan((-1a)^-1//8*(b^1//4+(-1a)^1//4)^(1/2)*cot(x))+1//4*(-1a)^-7//8*((-1a)^1//4+-1*b^1//4)^-1//2*arctan((-1a)^-1//8*((-1a)^1//4+-1*b^1//4)^(1/2)*cot(x))+1//4*(-1a)^-7//8*((-1a)^1//4+im*b^1//4)^-1//2*arctan((-1a)^-1//8*((-1a)^1//4+im*b^1//4)^(1/2)*cot(x))+1//4*(-1a)^-7//8*((-1a)^1//4+-1*im*b^1//4)^-1//2*arctan((-1a)^-1//8*((-1a)^1//4+-1*im*b^1//4)^(1/2)*cot(x)))
@test integrate((a+-1*b*cos(x)^5)^-1, x) == :(2//5*a^-4//5*(a^1//5+b^1//5)^-1//2*(a^1//5+-1*b^1//5)^-1//2*arctan((a^1//5+b^1//5)^(1/2)*(a^1//5+-1*b^1//5)^-1//2*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^1//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^1//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^1//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^1//5*b^1//5)^(1/2)*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^2//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^2//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^2//5*b^1//5)^(1/2)*(a^1//5+-1*(-1)^2//5*b^1//5)^-1//2*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^3//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^3//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^3//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^3//5*b^1//5)^(1/2)*tan((1/2)*x))+2//5*a^-4//5*(a^1//5+(-1)^4//5*b^1//5)^-1//2*(a^1//5+-1*(-1)^4//5*b^1//5)^-1//2*arctan((a^1//5+(-1)^4//5*b^1//5)^(1/2)*(a^1//5+-1*(-1)^4//5*b^1//5)^-1//2*tan((1/2)*x)))
@test integrate((a+-1*b*cos(x)^6)^-1, x) == :(-1//3*a^-5//6*(a^1//3+-1*b^1//3)^-1//2*arctan(a^-1//6*(a^1//3+-1*b^1//3)^(1/2)*cot(x))+-1//3*a^-5//6*(a^1//3+(-1)^1//3*b^1//3)^-1//2*arctan(a^-1//6*(a^1//3+(-1)^1//3*b^1//3)^(1/2)*cot(x))+-1//3*a^-5//6*(a^1//3+-1*(-1)^2//3*b^1//3)^-1//2*arctan(a^-1//6*(a^1//3+-1*(-1)^2//3*b^1//3)^(1/2)*cot(x)))
@test integrate((a+-1*b*cos(x)^8)^-1, x) == :(-1//4*a^-7//8*(a^1//4+b^1//4)^-1//2*arctan(a^-1//8*(a^1//4+b^1//4)^(1/2)*cot(x))+-1//4*a^-7//8*(a^1//4+-1*b^1//4)^-1//2*arctan(a^-1//8*(a^1//4+-1*b^1//4)^(1/2)*cot(x))+-1//4*a^-7//8*(a^1//4+im*b^1//4)^-1//2*arctan(a^-1//8*(a^1//4+im*b^1//4)^(1/2)*cot(x))+-1//4*a^-7//8*(a^1//4+-1*im*b^1//4)^-1//2*arctan(a^-1//8*(a^1//4+-1*im*b^1//4)^(1/2)*cot(x)))
@test integrate((1+cos(x)^5)^-1, x) == :((5+5*cos(x))^-1*sin(x)+-2//5*(-1+(-1)^2//5)^-1//2*arctanh((-1*(1+(-1)^1//5)^-1*(1+-1*(-1)^1//5))^-1//2*tan((1/2)*x))+2//5*(1+(-1)^3//5)^-1//2*arctan(((1+(-1)^4//5)^-1*(1+-1*(-1)^4//5))^(1/2)*tan((1/2)*x))+2//5*(1+-1*(-1)^4//5)^-1//2*arctan(((1+(-1)^2//5)^-1*(1+-1*(-1)^2//5))^(1/2)*tan((1/2)*x))+-2*(-1*(1+-1*(-1)^3//5)^-1*(1+(-1)^3//5))^(1/2)*(5+5*(-1)^3//5)^-1*arctanh((-1*(1+-1*(-1)^3//5)^-1*(1+(-1)^3//5))^(1/2)*tan((1/2)*x)))
@test integrate((1+cos(x)^8)^-1, x) == :(-1//4*(1+(-1)^1//4)^-1//2*arctan((1+(-1)^1//4)^(1/2)*cot(x))+-1//4*(1+(-1)^3//4)^-1//2*arctan((1+(-1)^3//4)^(1/2)*cot(x))+-1//4*(1+-1*(-1)^1//4)^-1//2*arctan((1+-1*(-1)^1//4)^(1/2)*cot(x))+-1//4*(1+-1*(-1)^3//4)^-1//2*arctan((1+-1*(-1)^3//4)^(1/2)*cot(x)))
@test integrate((1+-1*cos(x)^5)^-1, x) == :(-1*(5+-5*cos(x))^-1*sin(x)+-2//5*(-1+(-1)^4//5)^-1//2*arctanh((-1*(1+(-1)^2//5)^-1*(1+-1*(-1)^2//5))^-1//2*tan((1/2)*x))+2//5*(1+(-1)^1//5)^-1//2*arctan(((1+(-1)^3//5)^-1*(1+-1*(-1)^3//5))^(1/2)*tan((1/2)*x))+2//5*(1+-1*(-1)^2//5)^-1//2*arctan(((1+(-1)^1//5)^-1*(1+-1*(-1)^1//5))^(1/2)*tan((1/2)*x))+2//5*(-1+-1*(-1)^3//5)^-1//2*arctanh((-1*(1+-1*(-1)^4//5)^-1*(1+(-1)^4//5))^(1/2)*tan((1/2)*x)))
@test integrate((1+-1*cos(x)^6)^-1, x) == :(-1//3*cot(x)+-1//3*(1+(-1)^1//3)^-1//2*arctan((1+(-1)^1//3)^(1/2)*cot(x))+-1//3*(1+-1*(-1)^2//3)^-1//2*arctan((1+-1*(-1)^2//3)^(1/2)*cot(x)))
@test integrate((1+-1*cos(x)^8)^-1, x) == :(-1//4*cot(x)+-1//4*(1+im)^-1//2*arctan((1+im)^(1/2)*cot(x))+-1//4*(1+-1im)^-1//2*arctan((1+-1im)^(1/2)*cot(x))+-1//8*2^(1/2)*arctan((1+2^(1/2)+cos(x)^2)^-1*cos(x)*sin(x))+1//8*x*2^(1/2))
@test integrate((1+cos(x)^2)^-1*tan(x), x) == :((1/2)*log(1+cos(x)^2)+-1*log(cos(x)))
@test integrate((a+b*cos(x)^2)^(1/2)*tan(x), x) == :(-1*(a+b*cos(x)^2)^(1/2)+a^(1/2)*arctanh(a^-1//2*(a+b*cos(x)^2)^(1/2)))
@test integrate((1+-1*cos(x)^2)^(1/2)*tan(x), x) == :(-1*(sin(x)^2)^(1/2)+arctanh((sin(x)^2)^(1/2)))
@test integrate((a+b*cos(x)^2)^-1//2*tan(x), x) == :(a^-1//2*arctanh(a^-1//2*(a+b*cos(x)^2)^(1/2)))
@test integrate((1+cos(x)^2)^-1//2*tan(x), x) == :(arctanh((1+cos(x)^2)^(1/2)))
@test integrate((1+-1*cos(x)^2)^-1//2*tan(x), x) == :(arctanh((sin(x)^2)^(1/2)))
@test integrate((a+b*cos(x)^3)^-1*tan(x)^3, x) == :(a^-1*log(cos(x))+(1/2)*a^-1*sec(x)^2+-1//3*a^-1*log(a+b*cos(x)^3)+-1//6*a^-5//3*b^2//3*log(a^2//3+b^2//3*cos(x)^2+-1*a^1//3*b^1//3*cos(x))+1//3*a^-5//3*b^2//3*log(a^1//3+b^1//3*cos(x))+-1//3*3^(1/2)*a^-5//3*b^2//3*arctan(1//3*3^(1/2)*a^-1//3*(a^1//3+-2*b^1//3*cos(x))))
@test integrate((a+b*cos(x)^3)^(1/2)*tan(x), x) == :(-2//3*(a+b*cos(x)^3)^(1/2)+2//3*a^(1/2)*arctanh(a^-1//2*(a+b*cos(x)^3)^(1/2)))
@test integrate((a+b*cos(x)^3)^-1//2*tan(x), x) == :(2//3*a^-1//2*arctanh(a^-1//2*(a+b*cos(x)^3)^(1/2)))
@test integrate((a+b*cos(x)^4)^(1/2)*tan(x), x) == :(-1//2*(a+b*cos(x)^4)^(1/2)+(1/2)*a^(1/2)*arctanh(a^-1//2*(a+b*cos(x)^4)^(1/2)))
@test integrate((a+b*cos(x)^4)^-1//2*tan(x), x) == :((1/2)*a^-1//2*arctanh(a^-1//2*(a+b*cos(x)^4)^(1/2)))
@test integrate((a+b*cos(x)^n)^(1/2)*tan(x), x) == :(-2*n^-1*(a+b*cos(x)^n)^(1/2)+2*a^(1/2)*n^-1*arctanh(a^-1//2*(a+b*cos(x)^n)^(1/2)))
@test integrate((a+b*cos(x)^n)^-1//2*tan(x), x) == :(2*a^-1//2*n^-1*arctanh(a^-1//2*(a+b*cos(x)^n)^(1/2)))

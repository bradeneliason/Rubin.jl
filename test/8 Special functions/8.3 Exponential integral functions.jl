using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(x^2*SpecialFunctions.expint(1,b*x), x) == :(-1//3*x^3*SpecialFunctions.expint(-2,b*x)+1//3*x^3*SpecialFunctions.expint(1,b*x))
@test integrate(x*SpecialFunctions.expint(1,b*x), x) == :((1/2)*x^2*SpecialFunctions.expint(1,b*x)+-1//2*x^2*SpecialFunctions.expint(-1,b*x))
@test integrate(SpecialFunctions.expint(1,b*x), x) == :(-1*b^-1*SpecialFunctions.expint(2,b*x))
@test integrate(x^-2*SpecialFunctions.expint(1,b*x), x) == :(x^-1*SpecialFunctions.expint(2,b*x)+-1*x^-1*SpecialFunctions.expint(1,b*x))
@test integrate(x^-3*SpecialFunctions.expint(1,b*x), x) == :((1/2)*x^-2*SpecialFunctions.expint(3,b*x)+-1//2*x^-2*SpecialFunctions.expint(1,b*x))
@test integrate(x^-4*SpecialFunctions.expint(1,b*x), x) == :(-1//3*x^-3*SpecialFunctions.expint(1,b*x)+1//3*x^-3*SpecialFunctions.expint(4,b*x))
@test integrate(x^2*SpecialFunctions.expint(2,b*x), x) == :(-1//4*x^3*SpecialFunctions.expint(-2,b*x)+1//4*x^3*SpecialFunctions.expint(2,b*x))
@test integrate(x*SpecialFunctions.expint(2,b*x), x) == :(-1//3*x^2*SpecialFunctions.expint(-1,b*x)+1//3*x^2*SpecialFunctions.expint(2,b*x))
@test integrate(SpecialFunctions.expint(2,b*x), x) == :(-1*b^-1*SpecialFunctions.expint(3,b*x))
@test integrate(x^-1*SpecialFunctions.expint(2,b*x), x) == :(-1*SpecialFunctions.expint(1,b*x)+SpecialFunctions.expint(2,b*x))
@test integrate(x^-3*SpecialFunctions.expint(2,b*x), x) == :(x^-2*SpecialFunctions.expint(3,b*x)+-1*x^-2*SpecialFunctions.expint(2,b*x))
@test integrate(x^-4*SpecialFunctions.expint(2,b*x), x) == :((1/2)*x^-3*SpecialFunctions.expint(4,b*x)+-1//2*x^-3*SpecialFunctions.expint(2,b*x))
@test integrate(x^-5*SpecialFunctions.expint(2,b*x), x) == :(-1//3*x^-4*SpecialFunctions.expint(2,b*x)+1//3*x^-4*SpecialFunctions.expint(5,b*x))
@test integrate(x^2*SpecialFunctions.expint(3,b*x), x) == :(-1//5*x^3*SpecialFunctions.expint(-2,b*x)+1//5*x^3*SpecialFunctions.expint(3,b*x))
@test integrate(x*SpecialFunctions.expint(3,b*x), x) == :(-1//4*x^2*SpecialFunctions.expint(-1,b*x)+1//4*x^2*SpecialFunctions.expint(3,b*x))
@test integrate(SpecialFunctions.expint(3,b*x), x) == :(-1*b^-1*SpecialFunctions.expint(4,b*x))
@test integrate(x^-1*SpecialFunctions.expint(3,b*x), x) == :((1/2)*SpecialFunctions.expint(3,b*x)+-1//2*SpecialFunctions.expint(1,b*x))
@test integrate(x^-2*SpecialFunctions.expint(3,b*x), x) == :(x^-1*SpecialFunctions.expint(3,b*x)+-1*x^-1*SpecialFunctions.expint(2,b*x))
@test integrate(x^-4*SpecialFunctions.expint(3,b*x), x) == :(x^-3*SpecialFunctions.expint(4,b*x)+-1*x^-3*SpecialFunctions.expint(3,b*x))
@test integrate(x^-5*SpecialFunctions.expint(3,b*x), x) == :((1/2)*x^-4*SpecialFunctions.expint(5,b*x)+-1//2*x^-4*SpecialFunctions.expint(3,b*x))
@test integrate(x^-6*SpecialFunctions.expint(3,b*x), x) == :(-1//3*x^-5*SpecialFunctions.expint(3,b*x)+1//3*x^-5*SpecialFunctions.expint(6,b*x))
@test integrate(x^3*SpecialFunctions.expint(-1,b*x), x) == :((1/2)*x^4*SpecialFunctions.expint(-1,b*x)+-1//2*x^4*SpecialFunctions.expint(-3,b*x))
@test integrate(x^2*SpecialFunctions.expint(-1,b*x), x) == :(x^3*SpecialFunctions.expint(-1,b*x)+-1*x^3*SpecialFunctions.expint(-2,b*x))
@test integrate(x*SpecialFunctions.expint(-1,b*x), x) == :(b^-2*expintegralei(-1*b*x)+-1*b^-2*exp(-1*b*x))
@test integrate(SpecialFunctions.expint(-1,b*x), x) == :(-1*b^-2*x^-1*exp(-1*b*x))
@test integrate(x^-1*SpecialFunctions.expint(-1,b*x), x) == :((1/2)*SpecialFunctions.expint(1,b*x)+-1//2*SpecialFunctions.expint(-1,b*x))
@test integrate(x^-2*SpecialFunctions.expint(-1,b*x), x) == :(-1//3*x^-1*SpecialFunctions.expint(-1,b*x)+1//3*x^-1*SpecialFunctions.expint(2,b*x))
@test integrate(x^-3*SpecialFunctions.expint(-1,b*x), x) == :(-1//4*x^-2*SpecialFunctions.expint(-1,b*x)+1//4*x^-2*SpecialFunctions.expint(3,b*x))
@test integrate(x^4*SpecialFunctions.expint(-2,b*x), x) == :((1/2)*x^5*SpecialFunctions.expint(-2,b*x)+-1//2*x^5*SpecialFunctions.expint(-4,b*x))
@test integrate(x^3*SpecialFunctions.expint(-2,b*x), x) == :(x^4*SpecialFunctions.expint(-2,b*x)+-1*x^4*SpecialFunctions.expint(-3,b*x))
@test integrate(x^2*SpecialFunctions.expint(-2,b*x), x) == :(-2*b^-3*exp(-1*b*x)+2*b^-3*expintegralei(-1*b*x)+-1*b^-1*x^2*SpecialFunctions.expint(-1,b*x))
@test integrate(x*SpecialFunctions.expint(-2,b*x), x) == :(x^2*SpecialFunctions.expint(-1,b*x)+-1*x^2*SpecialFunctions.expint(-2,b*x))
@test integrate(SpecialFunctions.expint(-1,b*x), x) == :(-1*b^-2*x^-1*exp(-1*b*x))
@test integrate(x^-1*SpecialFunctions.expint(-2,b*x), x) == :(-1//3*SpecialFunctions.expint(-2,b*x)+1//3*SpecialFunctions.expint(1,b*x))
@test integrate(x^-2*SpecialFunctions.expint(-2,b*x), x) == :(-1//4*x^-1*SpecialFunctions.expint(-2,b*x)+1//4*x^-1*SpecialFunctions.expint(2,b*x))
@test integrate(x^-3*SpecialFunctions.expint(-2,b*x), x) == :(-1//5*x^-2*SpecialFunctions.expint(-2,b*x)+1//5*x^-2*SpecialFunctions.expint(3,b*x))
@test integrate(x^5*SpecialFunctions.expint(-3,b*x), x) == :((1/2)*x^6*SpecialFunctions.expint(-3,b*x)+-1//2*x^6*SpecialFunctions.expint(-5,b*x))
@test integrate(x^4*SpecialFunctions.expint(-3,b*x), x) == :(x^5*SpecialFunctions.expint(-3,b*x)+-1*x^5*SpecialFunctions.expint(-4,b*x))
@test integrate(x^3*SpecialFunctions.expint(-3,b*x), x) == :(-6*b^-4*exp(-1*b*x)+6*b^-4*expintegralei(-1*b*x)+-1*b^-1*x^3*SpecialFunctions.expint(-2,b*x)+-3*b^-2*x^2*SpecialFunctions.expint(-1,b*x))
@test integrate(x^2*SpecialFunctions.expint(-3,b*x), x) == :(x^3*SpecialFunctions.expint(-2,b*x)+-1*x^3*SpecialFunctions.expint(-3,b*x))
@test integrate(x*SpecialFunctions.expint(-3,b*x), x) == :((1/2)*x^2*SpecialFunctions.expint(-1,b*x)+-1//2*x^2*SpecialFunctions.expint(-3,b*x))
@test integrate(SpecialFunctions.expint(-1,b*x), x) == :(-1*b^-2*x^-1*exp(-1*b*x))
@test integrate(x^-1*SpecialFunctions.expint(-3,b*x), x) == :(-1//4*SpecialFunctions.expint(-3,b*x)+1//4*SpecialFunctions.expint(1,b*x))
@test integrate(x^-2*SpecialFunctions.expint(-3,b*x), x) == :(-1//5*x^-1*SpecialFunctions.expint(-3,b*x)+1//5*x^-1*SpecialFunctions.expint(2,b*x))
@test integrate(x^-3*SpecialFunctions.expint(-3,b*x), x) == :(-1//6*x^-2*SpecialFunctions.expint(-3,b*x)+1//6*x^-2*SpecialFunctions.expint(3,b*x))
@test integrate(x^3*SpecialFunctions.expint(-3,b*x), x) == :(-6*b^-4*exp(-1*b*x)+6*b^-4*expintegralei(-1*b*x)+-1*b^-1*x^3*SpecialFunctions.expint(-2,b*x)+-3*b^-2*x^2*SpecialFunctions.expint(-1,b*x))
@test integrate(x^2*SpecialFunctions.expint(-2,b*x), x) == :(-2*b^-3*exp(-1*b*x)+2*b^-3*expintegralei(-1*b*x)+-1*b^-1*x^2*SpecialFunctions.expint(-1,b*x))
@test integrate(x*SpecialFunctions.expint(-1,b*x), x) == :(b^-2*expintegralei(-1*b*x)+-1*b^-2*exp(-1*b*x))
@test integrate(SpecialFunctions.expint(0,b*x), x) == :(b^-1*expintegralei(-1*b*x))
@test integrate(x^m*SpecialFunctions.expint(n,x), x) == :(x^(1+m)*(m+n)^-1*SpecialFunctions.expint(n,x)+-1*x^(1+m)*(m+n)^-1*SpecialFunctions.expint(-1m,x))
@test integrate(x^m*SpecialFunctions.expint(n,b*x), x) == :(x^(1+m)*(m+n)^-1*SpecialFunctions.expint(n,b*x)+-1*x^(1+m)*(m+n)^-1*SpecialFunctions.expint(-1m,b*x))
@test integrate((d*x)^m*SpecialFunctions.expint(n,x), x) == :(d^-1*(d*x)^(1+m)*(m+n)^-1*SpecialFunctions.expint(n,x)+-1*d^-1*(d*x)^(1+m)*(m+n)^-1*SpecialFunctions.expint(-1m,x))
@test integrate((d*x)^m*SpecialFunctions.expint(n,b*x), x) == :(d^-1*(d*x)^(1+m)*(m+n)^-1*SpecialFunctions.expint(n,b*x)+-1*d^-1*(d*x)^(1+m)*(m+n)^-1*SpecialFunctions.expint(-1m,b*x))
@test integrate(x^2*SpecialFunctions.expint(n,b*x), x) == :(x^3*(2+n)^-1*SpecialFunctions.expint(n,b*x)+-1*x^3*(2+n)^-1*SpecialFunctions.expint(-2,b*x))
@test integrate(x*SpecialFunctions.expint(n,b*x), x) == :(x^2*(1+n)^-1*SpecialFunctions.expint(n,b*x)+-1*x^2*(1+n)^-1*SpecialFunctions.expint(-1,b*x))
@test integrate(SpecialFunctions.expint(n,b*x), x) == :(-1*b^-1*SpecialFunctions.expint(1+n,b*x))
@test integrate(x^-1*SpecialFunctions.expint(n,b*x), x) == :((1+-1n)^-1*SpecialFunctions.expint(1,b*x)+-1*(1+-1n)^-1*SpecialFunctions.expint(n,b*x))
@test integrate(x^-2*SpecialFunctions.expint(n,b*x), x) == :(x^-1*(2+-1n)^-1*SpecialFunctions.expint(2,b*x)+-1*x^-1*(2+-1n)^-1*SpecialFunctions.expint(n,b*x))
@test integrate(x^-3*SpecialFunctions.expint(n,b*x), x) == :(x^-2*(3+-1n)^-1*SpecialFunctions.expint(3,b*x)+-1*x^-2*(3+-1n)^-1*SpecialFunctions.expint(n,b*x))
@test integrate((c+d*x)^3*SpecialFunctions.expint(1,a+b*x), x) == :(-1*b^-1*(c+d*x)^3*SpecialFunctions.expint(2,a+b*x)+-6*b^-4*d^3*SpecialFunctions.expint(5,a+b*x)+-6*b^-3*d^2*(c+d*x)*SpecialFunctions.expint(4,a+b*x)+-3*d*b^-2*(c+d*x)^2*SpecialFunctions.expint(3,a+b*x))
@test integrate((c+d*x)^2*SpecialFunctions.expint(1,a+b*x), x) == :(-1*b^-1*(c+d*x)^2*SpecialFunctions.expint(2,a+b*x)+-2*b^-3*d^2*SpecialFunctions.expint(4,a+b*x)+-2*d*b^-2*(c+d*x)*SpecialFunctions.expint(3,a+b*x))
@test integrate((c+d*x)*SpecialFunctions.expint(1,a+b*x), x) == :(-1*d*b^-2*SpecialFunctions.expint(3,a+b*x)+-1*b^-1*(c+d*x)*SpecialFunctions.expint(2,a+b*x))
@test integrate(SpecialFunctions.expint(1,a+b*x), x) == :(-1*b^-1*SpecialFunctions.expint(2,a+b*x))
@test integrate((c+d*x)^-2*SpecialFunctions.expint(1,a+b*x), x) == :(-1*d^-1*(c+d*x)^-1*SpecialFunctions.expint(1,a+b*x)+-1*b*d^-1*(b*c+-1*a*d)^-1*expintegralei(-1a+-1*b*x)+b*d^-1*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^-3*SpecialFunctions.expint(1,a+b*x), x) == :(-1//2*d^-1*(c+d*x)^-2*SpecialFunctions.expint(1,a+b*x)+-1//2*b^2*d^-1*(b*c+-1*a*d)^-2*expintegralei(-1a+-1*b*x)+(1/2)*b^2*d^-1*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1//2*b*d^-1*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1//2*b^2*d^-2*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^-4*SpecialFunctions.expint(1,a+b*x), x) == :(-1//3*d^-1*(c+d*x)^-3*SpecialFunctions.expint(1,a+b*x)+-1//3*b^3*d^-1*(b*c+-1*a*d)^-3*expintegralei(-1a+-1*b*x)+-1//3*b^2*d^-1*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+-1//3*b^3*d^-2*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1//6*b*d^-1*(c+d*x)^-2*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+1//3*b^3*d^-1*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+1//6*b^2*d^-2*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+1//6*b^3*d^-3*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^3*SpecialFunctions.expint(2,a+b*x), x) == :(-1*b^-1*(c+d*x)^3*SpecialFunctions.expint(3,a+b*x)+-6*b^-4*d^3*SpecialFunctions.expint(6,a+b*x)+-6*b^-3*d^2*(c+d*x)*SpecialFunctions.expint(5,a+b*x)+-3*d*b^-2*(c+d*x)^2*SpecialFunctions.expint(4,a+b*x))
@test integrate((c+d*x)^2*SpecialFunctions.expint(2,a+b*x), x) == :(-1*b^-1*(c+d*x)^2*SpecialFunctions.expint(3,a+b*x)+-2*b^-3*d^2*SpecialFunctions.expint(5,a+b*x)+-2*d*b^-2*(c+d*x)*SpecialFunctions.expint(4,a+b*x))
@test integrate((c+d*x)*SpecialFunctions.expint(2,a+b*x), x) == :(-1*d*b^-2*SpecialFunctions.expint(4,a+b*x)+-1*b^-1*(c+d*x)*SpecialFunctions.expint(3,a+b*x))
@test integrate(SpecialFunctions.expint(2,a+b*x), x) == :(-1*b^-1*SpecialFunctions.expint(3,a+b*x))
@test integrate((c+d*x)^-3*SpecialFunctions.expint(2,a+b*x), x) == :(-1//2*d^-1*(c+d*x)^-2*SpecialFunctions.expint(2,a+b*x)+(1/2)*b*d^-2*(c+d*x)^-1*SpecialFunctions.expint(1,a+b*x)+(1/2)*b^2*d^-2*(b*c+-1*a*d)^-1*expintegralei(-1a+-1*b*x)+-1//2*b^2*d^-2*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^-4*SpecialFunctions.expint(2,a+b*x), x) == :(-1//3*d^-1*(c+d*x)^-3*SpecialFunctions.expint(2,a+b*x)+1//6*b*d^-2*(c+d*x)^-2*SpecialFunctions.expint(1,a+b*x)+1//6*b^3*d^-2*(b*c+-1*a*d)^-2*expintegralei(-1a+-1*b*x)+-1//6*b^3*d^-2*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+1//6*b^2*d^-2*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+1//6*b^3*d^-3*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^3*SpecialFunctions.expint(3,a+b*x), x) == :(-1*b^-1*(c+d*x)^3*SpecialFunctions.expint(4,a+b*x)+-6*b^-4*d^3*SpecialFunctions.expint(7,a+b*x)+-6*b^-3*d^2*(c+d*x)*SpecialFunctions.expint(6,a+b*x)+-3*d*b^-2*(c+d*x)^2*SpecialFunctions.expint(5,a+b*x))
@test integrate((c+d*x)^2*SpecialFunctions.expint(3,a+b*x), x) == :(-1*b^-1*(c+d*x)^2*SpecialFunctions.expint(4,a+b*x)+-2*b^-3*d^2*SpecialFunctions.expint(6,a+b*x)+-2*d*b^-2*(c+d*x)*SpecialFunctions.expint(5,a+b*x))
@test integrate((c+d*x)*SpecialFunctions.expint(3,a+b*x), x) == :(-1*d*b^-2*SpecialFunctions.expint(5,a+b*x)+-1*b^-1*(c+d*x)*SpecialFunctions.expint(4,a+b*x))
@test integrate(SpecialFunctions.expint(3,a+b*x), x) == :(-1*b^-1*SpecialFunctions.expint(4,a+b*x))
@test integrate((c+d*x)^-4*SpecialFunctions.expint(3,a+b*x), x) == :(-1//3*d^-1*(c+d*x)^-3*SpecialFunctions.expint(3,a+b*x)+-1//6*b^2*d^-3*(c+d*x)^-1*SpecialFunctions.expint(1,a+b*x)+-1//6*b^3*d^-3*(b*c+-1*a*d)^-1*expintegralei(-1a+-1*b*x)+1//6*b*d^-2*(c+d*x)^-2*SpecialFunctions.expint(2,a+b*x)+1//6*b^3*d^-3*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^4*SpecialFunctions.expint(-1,a+b*x), x) == :(-8*b^-5*d^4*exp(-1a+-1*b*x)+-1*b^-1*(a+b*x)^-1*(c+d*x)^4*exp(-1a+-1*b*x)+-8*b^-4*d^3*(c+d*x)*exp(-1a+-1*b*x)+-4*b^-5*d^2*(b*c+-1*a*d)^2*exp(-1a+-1*b*x)+-4*b^-5*d^3*(b*c+-1*a*d)*exp(-1a+-1*b*x)+-4*b^-3*d^2*(c+d*x)^2*exp(-1a+-1*b*x)+4*d*b^-5*(b*c+-1*a*d)^3*expintegralei(-1a+-1*b*x)+-4*b^-4*d^2*(c+d*x)*(b*c+-1*a*d)*exp(-1a+-1*b*x))
@test integrate((c+d*x)^3*SpecialFunctions.expint(-1,a+b*x), x) == :(-3*b^-4*d^3*exp(-1a+-1*b*x)+-1*b^-1*(a+b*x)^-1*(c+d*x)^3*exp(-1a+-1*b*x)+-3*b^-4*d^2*(b*c+-1*a*d)*exp(-1a+-1*b*x)+-3*b^-3*d^2*(c+d*x)*exp(-1a+-1*b*x)+3*d*b^-4*(b*c+-1*a*d)^2*expintegralei(-1a+-1*b*x))
@test integrate((c+d*x)^2*SpecialFunctions.expint(-1,a+b*x), x) == :(-2*b^-3*d^2*exp(-1a+-1*b*x)+-1*b^-1*(a+b*x)^-1*(c+d*x)^2*exp(-1a+-1*b*x)+2*d*b^-3*(b*c+-1*a*d)*expintegralei(-1a+-1*b*x))
@test integrate((c+d*x)*SpecialFunctions.expint(-1,a+b*x), x) == :(d*b^-2*expintegralei(-1a+-1*b*x)+-1*b^-1*(a+b*x)^-1*(c+d*x)*exp(-1a+-1*b*x))
@test integrate(SpecialFunctions.expint(-1,a+b*x), x) == :(-1*b^-1*(a+b*x)^-1*exp(-1a+-1*b*x))
@test integrate((c+d*x)^-1*SpecialFunctions.expint(-1,a+b*x), x) == :(-1*d*(b*c+-1*a*d)^-2*expintegralei(-1a+-1*b*x)+-1*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+d*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1*b^-1*(a+b*x)^-1*(c+d*x)^-1*exp(-1a+-1*b*x)+-1*d*b^-1*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x))
@test integrate((c+d*x)^-2*SpecialFunctions.expint(-1,a+b*x), x) == :((c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1*b^-1*(a+b*x)^-1*(c+d*x)^-2*exp(-1a+-1*b*x)+-2*b*d*(b*c+-1*a*d)^-3*expintegralei(-1a+-1*b*x)+-2*b*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-2*d*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+b*d^-1*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1*d*b^-1*(c+d*x)^-2*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+2*b*d*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^-3*SpecialFunctions.expint(-1,a+b*x), x) == :((c+d*x)^-2*(-2*a*d+2*b*c)^-1*exp(-1a+-1*b*x)+-1*b^-1*(a+b*x)^-1*(c+d*x)^-3*exp(-1a+-1*b*x)+-3*d*b^2*(b*c+-1*a*d)^-4*expintegralei(-1a+-1*b*x)+-3*b^2*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-3//2*d*(c+d*x)^-2*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+3//2*b*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+-1*d*b^-1*(c+d*x)^-3*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-3*b*d*(c+d*x)^-1*(b*c+-1*a*d)^-3*exp(-1a+-1*b*x)+3*d*b^2*(b*c+-1*a*d)^-4*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1//2*b*d^-1*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1//2*b^2*d^-2*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+3//2*b^2*d^-1*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^4*SpecialFunctions.expint(-2,a+b*x), x) == :(-1*b^-1*(c+d*x)^4*SpecialFunctions.expint(-1,a+b*x)+-12*b^-5*d^4*exp(-1a+-1*b*x)+-12*b^-5*d^3*(b*c+-1*a*d)*exp(-1a+-1*b*x)+-12*b^-4*d^3*(c+d*x)*exp(-1a+-1*b*x)+12*b^-5*d^2*(b*c+-1*a*d)^2*expintegralei(-1a+-1*b*x)+-4*d*b^-2*(a+b*x)^-1*(c+d*x)^3*exp(-1a+-1*b*x))
@test integrate((c+d*x)^3*SpecialFunctions.expint(-2,a+b*x), x) == :(-1*b^-1*(c+d*x)^3*SpecialFunctions.expint(-1,a+b*x)+-6*b^-4*d^3*exp(-1a+-1*b*x)+6*b^-4*d^2*(b*c+-1*a*d)*expintegralei(-1a+-1*b*x)+-3*d*b^-2*(a+b*x)^-1*(c+d*x)^2*exp(-1a+-1*b*x))
@test integrate((c+d*x)^2*SpecialFunctions.expint(-2,a+b*x), x) == :(-1*b^-1*(c+d*x)^2*SpecialFunctions.expint(-1,a+b*x)+2*b^-3*d^2*expintegralei(-1a+-1*b*x)+-2*d*b^-2*(a+b*x)^-1*(c+d*x)*exp(-1a+-1*b*x))
@test integrate((c+d*x)*SpecialFunctions.expint(-2,a+b*x), x) == :(-1*b^-1*(c+d*x)*SpecialFunctions.expint(-1,a+b*x)+-1*d*b^-2*(a+b*x)^-1*exp(-1a+-1*b*x))
@test integrate(SpecialFunctions.expint(-2,a+b*x), x) == :(-1*b^-1*SpecialFunctions.expint(-1,a+b*x))
@test integrate((c+d*x)^-1*SpecialFunctions.expint(-2,a+b*x), x) == :(-1*b^-1*(c+d*x)^-1*SpecialFunctions.expint(-1,a+b*x)+-1*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+2*d^2*(b*c+-1*a*d)^-3*expintegralei(-1a+-1*b*x)+-2*d^2*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+2*d*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+d*b^-2*(a+b*x)^-1*(c+d*x)^-2*exp(-1a+-1*b*x)+b^-2*d^2*(c+d*x)^-2*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1*d*b^-1*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+2*b^-1*d^2*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x))
@test integrate((c+d*x)^-2*SpecialFunctions.expint(-2,a+b*x), x) == :((c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1*b^-1*(c+d*x)^-2*SpecialFunctions.expint(-1,a+b*x)+-3*b*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-3*d*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+6*b*d^2*(b*c+-1*a*d)^-4*expintegralei(-1a+-1*b*x)+6*d^2*(c+d*x)^-1*(b*c+-1*a*d)^-3*exp(-1a+-1*b*x)+b*d^-1*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1*d*b^-1*(c+d*x)^-2*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-6*b*d^2*(b*c+-1*a*d)^-4*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+2*d*b^-2*(a+b*x)^-1*(c+d*x)^-3*exp(-1a+-1*b*x)+2*b^-2*d^2*(c+d*x)^-3*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+3*b^-1*d^2*(c+d*x)^-2*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+6*b*d*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^-3*SpecialFunctions.expint(-2,a+b*x), x) == :((c+d*x)^-2*(-2*a*d+2*b*c)^-1*exp(-1a+-1*b*x)+-1*b^-1*(c+d*x)^-3*SpecialFunctions.expint(-1,a+b*x)+-6*b^2*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-2*d*(c+d*x)^-2*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+2*b*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+6*d^2*(c+d*x)^-2*(b*c+-1*a*d)^-3*exp(-1a+-1*b*x)+12*b^2*d^2*(b*c+-1*a*d)^-5*expintegralei(-1a+-1*b*x)+-1*d*b^-1*(c+d*x)^-3*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-12*b^2*d^2*(b*c+-1*a*d)^-5*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-6*b*d*(c+d*x)^-1*(b*c+-1*a*d)^-3*exp(-1a+-1*b*x)+2*b^2*d^-1*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+3*d*b^-2*(a+b*x)^-1*(c+d*x)^-4*exp(-1a+-1*b*x)+3*b^-2*d^2*(c+d*x)^-4*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+4*b^-1*d^2*(c+d*x)^-3*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+12*b*d^2*(c+d*x)^-1*(b*c+-1*a*d)^-4*exp(-1a+-1*b*x)+12*d*b^2*(b*c+-1*a*d)^-4*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1//2*b*d^-1*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1//2*b^2*d^-2*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^4*SpecialFunctions.expint(-3,a+b*x), x) == :(-1*b^-1*(c+d*x)^4*SpecialFunctions.expint(-2,a+b*x)+-24*b^-5*d^4*exp(-1a+-1*b*x)+-4*d*b^-2*(c+d*x)^3*SpecialFunctions.expint(-1,a+b*x)+24*b^-5*d^3*(b*c+-1*a*d)*expintegralei(-1a+-1*b*x)+-12*b^-3*d^2*(a+b*x)^-1*(c+d*x)^2*exp(-1a+-1*b*x))
@test integrate((c+d*x)^3*SpecialFunctions.expint(-3,a+b*x), x) == :(-1*b^-1*(c+d*x)^3*SpecialFunctions.expint(-2,a+b*x)+6*b^-4*d^3*expintegralei(-1a+-1*b*x)+-3*d*b^-2*(c+d*x)^2*SpecialFunctions.expint(-1,a+b*x)+-6*b^-3*d^2*(a+b*x)^-1*(c+d*x)*exp(-1a+-1*b*x))
@test integrate((c+d*x)^2*SpecialFunctions.expint(-3,a+b*x), x) == :(-1*b^-1*(c+d*x)^2*SpecialFunctions.expint(-2,a+b*x)+-2*d*b^-2*(c+d*x)*SpecialFunctions.expint(-1,a+b*x)+-2*b^-3*d^2*(a+b*x)^-1*exp(-1a+-1*b*x))
@test integrate((c+d*x)*SpecialFunctions.expint(-3,a+b*x), x) == :(-1*d*b^-2*SpecialFunctions.expint(-1,a+b*x)+-1*b^-1*(c+d*x)*SpecialFunctions.expint(-2,a+b*x))
@test integrate(SpecialFunctions.expint(-3,a+b*x), x) == :(-1*b^-1*SpecialFunctions.expint(-2,a+b*x))
@test integrate((c+d*x)^-1*SpecialFunctions.expint(-3,a+b*x), x) == :(-1*b^-1*(c+d*x)^-1*SpecialFunctions.expint(-2,a+b*x)+-1*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-6*d^3*(b*c+-1*a*d)^-4*expintegralei(-1a+-1*b*x)+d*b^-2*(c+d*x)^-2*SpecialFunctions.expint(-1,a+b*x)+-6*d^2*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+3*d*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+6*d^3*(b*c+-1*a*d)^-4*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+b^-2*d^2*(c+d*x)^-2*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1*d*b^-1*(c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-6*b^-1*d^3*(c+d*x)^-1*(b*c+-1*a*d)^-3*exp(-1a+-1*b*x)+-3*b^-2*d^3*(c+d*x)^-2*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+-2*b^-3*d^2*(a+b*x)^-1*(c+d*x)^-3*exp(-1a+-1*b*x)+-2*b^-3*d^3*(c+d*x)^-3*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+3*b^-1*d^2*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x))
@test integrate((c+d*x)^-2*SpecialFunctions.expint(-3,a+b*x), x) == :((c+d*x)^-1*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-1*b^-1*(c+d*x)^-2*SpecialFunctions.expint(-2,a+b*x)+-24*b*d^3*(b*c+-1*a*d)^-5*expintegralei(-1a+-1*b*x)+-24*d^3*(c+d*x)^-1*(b*c+-1*a*d)^-4*exp(-1a+-1*b*x)+-4*b*(b*c+-1*a*d)^-2*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-4*d*(c+d*x)^-1*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+2*d*b^-2*(c+d*x)^-3*SpecialFunctions.expint(-1,a+b*x)+12*d^2*(c+d*x)^-1*(b*c+-1*a*d)^-3*exp(-1a+-1*b*x)+b*d^-1*(b*c+-1*a*d)^-1*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-1*d*b^-1*(c+d*x)^-2*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+-24*b*d^2*(b*c+-1*a*d)^-4*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+-12*b^-1*d^3*(c+d*x)^-2*(b*c+-1*a*d)^-3*exp(-1a+-1*b*x)+-8*b^-2*d^3*(c+d*x)^-3*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+-6*b^-3*d^2*(a+b*x)^-1*(c+d*x)^-4*exp(-1a+-1*b*x)+-6*b^-3*d^3*(c+d*x)^-4*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+2*b^-2*d^2*(c+d*x)^-3*(b*c+-1*a*d)^-1*exp(-1a+-1*b*x)+4*b^-1*d^2*(c+d*x)^-2*(b*c+-1*a*d)^-2*exp(-1a+-1*b*x)+12*b*d*(b*c+-1*a*d)^-3*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x))+24*b*d^3*(b*c+-1*a*d)^-5*exp(-1a+b*c*d^-1)*expintegralei(-1*b*d^-1*(c+d*x)))
@test integrate((c+d*x)^3*SpecialFunctions.expint(n,a+b*x), x) == :(-1*b^-1*(c+d*x)^3*SpecialFunctions.expint(1+n,a+b*x)+-6*b^-4*d^3*SpecialFunctions.expint(4+n,a+b*x)+-6*b^-3*d^2*(c+d*x)*SpecialFunctions.expint(3+n,a+b*x)+-3*d*b^-2*(c+d*x)^2*SpecialFunctions.expint(2+n,a+b*x))
@test integrate((c+d*x)^2*SpecialFunctions.expint(n,a+b*x), x) == :(-1*b^-1*(c+d*x)^2*SpecialFunctions.expint(1+n,a+b*x)+-2*b^-3*d^2*SpecialFunctions.expint(3+n,a+b*x)+-2*d*b^-2*(c+d*x)*SpecialFunctions.expint(2+n,a+b*x))
@test integrate((c+d*x)*SpecialFunctions.expint(n,a+b*x), x) == :(-1*d*b^-2*SpecialFunctions.expint(2+n,a+b*x)+-1*b^-1*(c+d*x)*SpecialFunctions.expint(1+n,a+b*x))
@test integrate(SpecialFunctions.expint(n,a+b*x), x) == :(-1*b^-1*SpecialFunctions.expint(1+n,a+b*x))
@test integrate(x^3*expintegralei(b*x), x) == :(1//4*x^4*expintegralei(b*x)+3//2*b^-4*exp(b*x)+-3//2*x*b^-3*exp(b*x)+-1//4*b^-1*x^3*exp(b*x)+3//4*b^-2*x^2*exp(b*x))
@test integrate(x^2*expintegralei(b*x), x) == :(-2//3*b^-3*exp(b*x)+1//3*x^3*expintegralei(b*x)+-1//3*b^-1*x^2*exp(b*x)+2//3*x*b^-2*exp(b*x))
@test integrate(x*expintegralei(b*x), x) == :((1/2)*b^-2*exp(b*x)+(1/2)*x^2*expintegralei(b*x)+-1//2*x*b^-1*exp(b*x))
@test integrate(expintegralei(b*x), x) == :(x*expintegralei(b*x)+-1*b^-1*exp(b*x))
@test integrate(x^-2*expintegralei(b*x), x) == :(b*expintegralei(b*x)+-1*x^-1*exp(b*x)+-1*x^-1*expintegralei(b*x))
@test integrate(x^-3*expintegralei(b*x), x) == :(-1//2*x^-2*expintegralei(b*x)+-1//4*x^-2*exp(b*x)+1//4*b^2*expintegralei(b*x)+-1//4*b*x^-1*exp(b*x))
@test integrate(x^-4*expintegralei(b*x), x) == :(-1//3*x^-3*expintegralei(b*x)+-1//9*x^-3*exp(b*x)+1//18*b^3*expintegralei(b*x)+-1//18*b*x^-2*exp(b*x)+-1//18*b^2*x^-1*exp(b*x))
@test integrate(x^2*expintegralei(b*x)^2, x) == :(-5//6*b^-3*exp(2*b*x)+1//3*x^3*expintegralei(b*x)^2+4//3*b^-3*expintegralei(2*b*x)+-4//3*b^-3*exp(b*x)*expintegralei(b*x)+1//3*x*b^-2*exp(2*b*x)+-2//3*b^-1*x^2*exp(b*x)*expintegralei(b*x)+4//3*x*b^-2*exp(b*x)*expintegralei(b*x))
@test integrate(x*expintegralei(b*x)^2, x) == :((1/2)*b^-2*exp(2*b*x)+(1/2)*x^2*expintegralei(b*x)^2+-1*b^-2*expintegralei(2*b*x)+b^-2*exp(b*x)*expintegralei(b*x)+-1*x*b^-1*exp(b*x)*expintegralei(b*x))
@test integrate(expintegralei(b*x)^2, x) == :(x*expintegralei(b*x)^2+2*b^-1*expintegralei(2*b*x)+-2*b^-1*exp(b*x)*expintegralei(b*x))
@test integrate((d*x)^m*expintegralei(b*x), x) == :(d^-1*(d*x)^(1+m)*(1+m)^-1*expintegralei(b*x)+-1*b^-1*(d*x)^m*(-1*b*x)^(-1m)*(1+m)^-1*SpecialFunctions.gamma(1+m,-1*b*x))
@test integrate(x^3*expintegralei(a+b*x), x) == :(1//4*x^4*expintegralei(a+b*x)+3//2*b^-4*exp(a+b*x)+(1/2)*a*b^-4*exp(a+b*x)+-3//2*x*b^-3*exp(a+b*x)+-1//4*a^4*b^-4*expintegralei(a+b*x)+-1//4*b^-1*x^3*exp(a+b*x)+1//4*a^2*b^-4*exp(a+b*x)+1//4*a^3*b^-4*exp(a+b*x)+3//4*b^-2*x^2*exp(a+b*x)+-1//2*a*x*b^-3*exp(a+b*x)+-1//4*x*a^2*b^-3*exp(a+b*x)+1//4*a*b^-2*x^2*exp(a+b*x))
@test integrate(x^2*expintegralei(a+b*x), x) == :(-2//3*b^-3*exp(a+b*x)+1//3*x^3*expintegralei(a+b*x)+-1//3*a*b^-3*exp(a+b*x)+-1//3*a^2*b^-3*exp(a+b*x)+-1//3*b^-1*x^2*exp(a+b*x)+1//3*a^3*b^-3*expintegralei(a+b*x)+2//3*x*b^-2*exp(a+b*x)+1//3*a*x*b^-2*exp(a+b*x))
@test integrate(x*expintegralei(a+b*x), x) == :((1/2)*b^-2*exp(a+b*x)+(1/2)*x^2*expintegralei(a+b*x)+(1/2)*a*b^-2*exp(a+b*x)+-1//2*x*b^-1*exp(a+b*x)+-1//2*a^2*b^-2*expintegralei(a+b*x))
@test integrate(expintegralei(a+b*x), x) == :(-1*b^-1*exp(a+b*x)+b^-1*(a+b*x)*expintegralei(a+b*x))
@test integrate(x^-2*expintegralei(a+b*x), x) == :(-1*x^-1*expintegralei(a+b*x)+-1*b*a^-1*expintegralei(a+b*x)+b*a^-1*exp(a)*expintegralei(b*x))
@test integrate(x^-3*expintegralei(a+b*x), x) == :(-1//2*x^-2*expintegralei(a+b*x)+(1/2)*a^-2*b^2*expintegralei(a+b*x)+(1/2)*a^-1*b^2*exp(a)*expintegralei(b*x)+-1//2*b*a^-1*x^-1*exp(a+b*x)+-1//2*a^-2*b^2*exp(a)*expintegralei(b*x))
@test integrate(x^2*expintegralei(a+b*x)^2, x) == :(-5//6*b^-3*exp(2a+2*b*x)+1//3*x^3*expintegralei(a+b*x)^2+4//3*b^-3*expintegralei(2a+2*b*x)+2*a*b^-3*expintegralei(2a+2*b*x)+2*a^2*b^-3*expintegralei(2a+2*b*x)+-4//3*b^-3*exp(a+b*x)*expintegralei(a+b*x)+-2//3*a*b^-3*exp(2a+2*b*x)+1//3*x*b^-2*exp(2a+2*b*x)+-2//3*a*b^-3*exp(a+b*x)*expintegralei(a+b*x)+-2//3*a^2*b^-3*exp(a+b*x)*expintegralei(a+b*x)+-2//3*b^-1*x^2*exp(a+b*x)*expintegralei(a+b*x)+-1//3*x*a^2*b^-2*expintegralei(a+b*x)^2+1//3*a^2*b^-3*expintegralei(a+b*x)^2*(a+b*x)+4//3*x*b^-2*exp(a+b*x)*expintegralei(a+b*x)+2//3*a*x*b^-2*exp(a+b*x)*expintegralei(a+b*x))
@test integrate(x*expintegralei(a+b*x)^2, x) == :((1/2)*b^-2*exp(2a+2*b*x)+(1/2)*x^2*expintegralei(a+b*x)^2+-1*b^-2*expintegralei(2a+2*b*x)+b^-2*exp(a+b*x)*expintegralei(a+b*x)+-2*a*b^-2*expintegralei(2a+2*b*x)+a*b^-2*exp(a+b*x)*expintegralei(a+b*x)+(1/2)*a*x*b^-1*expintegralei(a+b*x)^2+-1*x*b^-1*exp(a+b*x)*expintegralei(a+b*x)+-1//2*a*b^-2*expintegralei(a+b*x)^2*(a+b*x))
@test integrate(expintegralei(a+b*x)^2, x) == :(2*b^-1*expintegralei(2a+2*b*x)+b^-1*expintegralei(a+b*x)^2*(a+b*x)+-2*b^-1*exp(a+b*x)*expintegralei(a+b*x))
@test integrate(x^2*expintegralei(d*(a+b*log(c*x^n))), x) == :(1//3*x^3*expintegralei(d*(a+b*log(c*x^n)))+-1//3*x^3*(c*x^n)^(-3*n^-1)*exp(-3*a*b^-1*n^-1)*expintegralei(b^-1*n^-1*(3+b*d*n)*(a+b*log(c*x^n))))
@test integrate(x*expintegralei(d*(a+b*log(c*x^n))), x) == :((1/2)*x^2*expintegralei(d*(a+b*log(c*x^n)))+-1//2*x^2*(c*x^n)^(-2*n^-1)*exp(-2*a*b^-1*n^-1)*expintegralei(b^-1*n^-1*(2+b*d*n)*(a+b*log(c*x^n))))
@test integrate(expintegralei(d*(a+b*log(c*x^n))), x) == :(x*expintegralei(d*(a+b*log(c*x^n)))+-1*x*(c*x^n)^(-1*n^-1)*exp(-1*a*b^-1*n^-1)*expintegralei(b^-1*n^-1*(1+b*d*n)*(a+b*log(c*x^n))))
@test integrate(x^-1*expintegralei(d*(a+b*log(c*x^n))), x) == :(b^-1*n^-1*(a+b*log(c*x^n))*expintegralei(d*(a+b*log(c*x^n)))+-1*b^-1*d^-1*n^-1*(c*x^n)^(b*d)*exp(a*d))
@test integrate(x^-2*expintegralei(d*(a+b*log(c*x^n))), x) == :(-1*x^-1*expintegralei(d*(a+b*log(c*x^n)))+x^-1*(c*x^n)^(n^-1)*exp(a*b^-1*n^-1)*expintegralei(-1*b^-1*n^-1*(1+-1*b*d*n)*(a+b*log(c*x^n))))
@test integrate(x^-3*expintegralei(d*(a+b*log(c*x^n))), x) == :(-1//2*x^-2*expintegralei(d*(a+b*log(c*x^n)))+(1/2)*x^-2*(c*x^n)^(2*n^-1)*exp(2*a*b^-1*n^-1)*expintegralei(-1*b^-1*n^-1*(2+-1*b*d*n)*(a+b*log(c*x^n))))
@test integrate((e*x)^m*expintegralei(d*(a+b*log(c*x^n))), x) == :(e^-1*(e*x)^(1+m)*(1+m)^-1*expintegralei(d*(a+b*log(c*x^n)))+-1*e^-1*(c*x^n)^(-1*n^-1*(1+m))*(e*x)^(1+m)*(1+m)^-1*exp(-1*a*b^-1*n^-1*(1+m))*expintegralei(b^-1*n^-1*(a+b*log(c*x^n))*(1+m+b*d*n)))
@test integrate(x^-3*exp(b*x)*expintegralei(b*x), x) == :(2*b^2*expintegralei(2*b*x)+-1//4*x^-2*exp(2*b*x)+1//4*b^2*expintegralei(b*x)^2+-1*b*x^-1*exp(2*b*x)+-1//2*x^-2*exp(b*x)*expintegralei(b*x)+-1//2*b*x^-1*exp(b*x)*expintegralei(b*x))
@test integrate(x^-2*exp(b*x)*expintegralei(b*x), x) == :((1/2)*b*expintegralei(b*x)^2+-1*x^-1*exp(2*b*x)+2*b*expintegralei(2*b*x)+-1*x^-1*exp(b*x)*expintegralei(b*x))
@test integrate(x^-1*exp(b*x)*expintegralei(b*x), x) == :((1/2)*expintegralei(b*x)^2)
@test integrate(exp(b*x)*expintegralei(b*x), x) == :(-1*b^-1*expintegralei(2*b*x)+b^-1*exp(b*x)*expintegralei(b*x))
@test integrate(x*exp(b*x)*expintegralei(b*x), x) == :(b^-2*expintegralei(2*b*x)+-1//2*b^-2*exp(2*b*x)+-1*b^-2*exp(b*x)*expintegralei(b*x)+x*b^-1*exp(b*x)*expintegralei(b*x))
@test integrate(x^2*exp(b*x)*expintegralei(b*x), x) == :(-2*b^-3*expintegralei(2*b*x)+5//4*b^-3*exp(2*b*x)+2*b^-3*exp(b*x)*expintegralei(b*x)+-1//2*x*b^-2*exp(2*b*x)+b^-1*x^2*exp(b*x)*expintegralei(b*x)+-2*x*b^-2*exp(b*x)*expintegralei(b*x))
@test integrate(x^3*exp(b*x)*expintegralei(b*x), x) == :(-4*b^-4*exp(2*b*x)+6*b^-4*expintegralei(2*b*x)+-6*b^-4*exp(b*x)*expintegralei(b*x)+2*x*b^-3*exp(2*b*x)+-1//2*b^-2*x^2*exp(2*b*x)+b^-1*x^3*exp(b*x)*expintegralei(b*x)+-3*b^-2*x^2*exp(b*x)*expintegralei(b*x)+6*x*b^-3*exp(b*x)*expintegralei(b*x))
@test integrate(x^3*exp(a+b*x)*expintegralei(c+d*x), x) == :(-6*b^-4*exp(a+b*x)*expintegralei(c+d*x)+-6*b^-3*(b+d)^-1*exp(a+c+x*(b+d))+-3*b^-2*(b+d)^-2*exp(a+c+x*(b+d))+-2*b^-1*(b+d)^-3*exp(a+c+x*(b+d))+6*b^-4*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x))+b^-1*x^3*exp(a+b*x)*expintegralei(c+d*x)+-1*b^-1*x^2*(b+d)^-1*exp(a+c+x*(b+d))+-3*b^-2*x^2*exp(a+b*x)*expintegralei(c+d*x)+2*x*b^-1*(b+d)^-2*exp(a+c+x*(b+d))+3*x*b^-2*(b+d)^-1*exp(a+c+x*(b+d))+6*x*b^-3*exp(a+b*x)*expintegralei(c+d*x)+b^-1*c^3*d^-3*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x))+-1*c*b^-1*d^-1*(b+d)^-2*exp(a+c+x*(b+d))+-1*b^-1*c^2*d^-2*(b+d)^-1*exp(a+c+x*(b+d))+-3*c*b^-2*d^-1*(b+d)^-1*exp(a+c+x*(b+d))+3*b^-2*c^2*d^-2*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x))+6*c*b^-3*d^-1*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x))+c*x*b^-1*d^-1*(b+d)^-1*exp(a+c+x*(b+d)))
@test integrate(x^2*exp(a+b*x)*expintegralei(c+d*x), x) == :(b^-1*(b+d)^-2*exp(a+c+x*(b+d))+-2*b^-3*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x))+2*b^-3*exp(a+b*x)*expintegralei(c+d*x)+2*b^-2*(b+d)^-1*exp(a+c+x*(b+d))+b^-1*x^2*exp(a+b*x)*expintegralei(c+d*x)+-1*x*b^-1*(b+d)^-1*exp(a+c+x*(b+d))+-2*x*b^-2*exp(a+b*x)*expintegralei(c+d*x)+c*b^-1*d^-1*(b+d)^-1*exp(a+c+x*(b+d))+-1*b^-1*c^2*d^-2*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x))+-2*c*b^-2*d^-1*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x)))
@test integrate(x*exp(a+b*x)*expintegralei(c+d*x), x) == :(b^-2*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x))+-1*b^-1*(b+d)^-1*exp(a+c+x*(b+d))+-1*b^-2*exp(a+b*x)*expintegralei(c+d*x)+x*b^-1*exp(a+b*x)*expintegralei(c+d*x)+c*b^-1*d^-1*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x)))
@test integrate(exp(a+b*x)*expintegralei(c+d*x), x) == :(b^-1*exp(a+b*x)*expintegralei(c+d*x)+-1*b^-1*exp(a+-1*b*c*d^-1)*expintegralei(d^-1*(b+d)*(c+d*x)))
@test integrate(x^2*logintegral(b*x), x) == :(-1//3*b^-3*expintegralei(4*log(b*x))+1//3*x^3*logintegral(b*x))
@test integrate(x*logintegral(b*x), x) == :((1/2)*x^2*logintegral(b*x)+-1//2*b^-2*expintegralei(3*log(b*x)))
@test integrate(logintegral(b*x), x) == :(x*logintegral(b*x)+-1*b^-1*expintegralei(2*log(b*x)))
@test integrate(x^-1*logintegral(b*x), x) == :(log(b*x)*logintegral(b*x)+-1*b*x)
@test integrate(x^-2*logintegral(b*x), x) == :(b*log(log(b*x))+-1*x^-1*logintegral(b*x))
@test integrate(x^-3*logintegral(b*x), x) == :((1/2)*b^2*expintegralei(-1*log(b*x))+-1//2*x^-2*logintegral(b*x))
@test integrate((d*x)^m*logintegral(b*x), x) == :(d^-1*(d*x)^(1+m)*(1+m)^-1*logintegral(b*x)+-1*b*d^-2*(b*x)^(-2+-1m)*(d*x)^(2+m)*(1+m)^-1*expintegralei((2+m)*log(b*x)))
@test integrate(x^2*logintegral(a+b*x), x) == :(-1//3*b^-3*expintegralei(4*log(a+b*x))+1//3*x^3*logintegral(a+b*x)+a*b^-3*expintegralei(3*log(a+b*x))+-1*a^2*b^-3*expintegralei(2*log(a+b*x))+1//3*a^3*b^-3*logintegral(a+b*x))
@test integrate(x*logintegral(a+b*x), x) == :((1/2)*x^2*logintegral(a+b*x)+-1//2*b^-2*expintegralei(3*log(a+b*x))+a*b^-2*expintegralei(2*log(a+b*x))+-1//2*a^2*b^-2*logintegral(a+b*x))
@test integrate(logintegral(a+b*x), x) == :(-1*b^-1*expintegralei(2*log(a+b*x))+b^-1*(a+b*x)*logintegral(a+b*x))

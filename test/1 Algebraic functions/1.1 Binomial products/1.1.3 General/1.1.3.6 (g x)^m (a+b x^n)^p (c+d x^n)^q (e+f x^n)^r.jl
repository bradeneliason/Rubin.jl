using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((e*x)^m*(a+b*x^n)^3*(A+B*x^n)*(c+d*x^n), x) == :(a*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(B*a*(a*d+3*b*c)+3*A*b*(a*d+b*c))+b*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*(b*c+3*a*d)+3*B*a*(a*d+b*c))+a^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*a*d+B*a*c+3*A*b*c)+b^2*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(A*b*d+B*b*c+3*B*a*d)+A*c*a^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^3*x^(1+5n)*(e*x)^m*(1+m+5n)^-1)
@test integrate((e*x)^m*(a+b*x^n)^2*(A+B*x^n)*(c+d*x^n), x) == :(x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*b*(b*c+2*a*d)+B*a*(a*d+2*b*c))+a*x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*a*d+B*a*c+2*A*b*c)+b*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*d+B*b*c+2*B*a*d)+A*c*a^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^2*x^(1+4n)*(e*x)^m*(1+m+4n)^-1)
@test integrate((e*x)^m*(A+B*x^n)*(a+b*x^n)*(c+d*x^n), x) == :(x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*a*d+A*b*c+B*a*c)+x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*b*d+B*a*d+B*b*c)+A*a*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d*x^(1+3n)*(e*x)^m*(1+m+3n)^-1)
@test integrate((e*x)^m*(A+B*x^n)*(c+d*x^n), x) == :(x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*d+B*c)+A*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*x^(1+2n)*(e*x)^m*(1+m+2n)^-1)
@test integrate((e*x)^m*(a+b*x^n)^3*(c+d*x^n)^2*(A+B*x^n), x) == :(x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*(a^2*d^2+3*b^2*c^2+6*a*b*c*d))+a*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(a^2*d^2+3*b^2*c^2+6*a*b*c*d)+B*a*c*(2*a*d+3*b*c))+b*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(c*b^2*(B*c+2*A*d)+3*B*a^2*d^2+3*a*b*d*(A*d+2*B*c))+A*a^3*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^2*x^(1+6n)*(e*x)^m*(1+m+6n)^-1+c*a^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(B*a*c+2*A*a*d+3*A*b*c)+d*b^2*x^(1+5n)*(e*x)^m*(1+m+5n)^-1*(A*b*d+2*B*b*c+3*B*a*d))
@test integrate((e*x)^m*(a+b*x^n)^2*(c+d*x^n)^2*(A+B*x^n), x) == :(x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(a^2*d^2+b^2*c^2+4*a*b*c*d)+2*B*a*c*(a*d+b*c))+x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(B*a^2*d^2+c*b^2*(B*c+2*A*d)+2*a*b*d*(A*d+2*B*c))+A*a^2*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^2*x^(1+5n)*(e*x)^m*(1+m+5n)^-1+a*c*x^(1+n)*(e*x)^m*(1+m+n)^-1*(2*A*(a*d+b*c)+B*a*c)+b*d*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(A*b*d+2*B*a*d+2*B*b*c))
@test integrate((e*x)^m*(c+d*x^n)^2*(A+B*x^n)*(a+b*x^n), x) == :(x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(a*d*(A*d+2*B*c)+b*c*(B*c+2*A*d))+c*x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*b*c+B*a*c+2*A*a*d)+d*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*d+B*a*d+2*B*b*c)+A*a*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d^2*x^(1+4n)*(e*x)^m*(1+m+4n)^-1)
@test integrate((e*x)^m*(c+d*x^n)^2*(A+B*x^n), x) == :(A*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d^2*x^(1+3n)*(e*x)^m*(1+m+3n)^-1+c*x^(1+n)*(e*x)^m*(1+m+n)^-1*(B*c+2*A*d)+d*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*d+2*B*c))
@test integrate((e*x)^m*(a+b*x^n)^3*(c+d*x^n)^3*(A+B*x^n), x) == :(x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*(a^3*d^3+b^3*c^3+9*a*d*b^2*c^2+9*b*c*a^2*d^2)+3*B*a*c*(a^2*d^2+b^2*c^2+3*a*b*c*d))+x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(B*a^3*d^3+b^3*c^2*(B*c+3*A*d)+3*b*a^2*d^2*(A*d+3*B*c)+9*a*c*d*b^2*(A*d+B*c))+A*a^3*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^3*x^(1+7n)*(e*x)^m*(1+m+7n)^-1+a^2*c^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(3*A*(a*d+b*c)+B*a*c)+b^2*d^2*x^(1+6n)*(e*x)^m*(1+m+6n)^-1*(A*b*d+3*B*a*d+3*B*b*c)+3*a*c*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(a^2*d^2+b^2*c^2+3*a*b*c*d)+B*a*c*(a*d+b*c))+3*b*d*x^(1+5n)*(e*x)^m*(1+m+5n)^-1*(B*a^2*d^2+c*b^2*(A*d+B*c)+a*b*d*(A*d+3*B*c)))
@test integrate((e*x)^m*(a+b*x^n)^2*(c+d*x^n)^3*(A+B*x^n), x) == :(x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(a^2*d^2*(A*d+3*B*c)+b^2*c^2*(B*c+3*A*d)+6*a*b*c*d*(A*d+B*c))+c*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*c*(2*b*c+3*a*d))+d*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(B*a^2*d^2+3*c*b^2*(A*d+B*c)+2*a*b*d*(A*d+3*B*c))+A*a^2*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^3*x^(1+6n)*(e*x)^m*(1+m+6n)^-1+a*c^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(B*a*c+2*A*b*c+3*A*a*d)+b*d^2*x^(1+5n)*(e*x)^m*(1+m+5n)^-1*(A*b*d+2*B*a*d+3*B*b*c))
@test integrate((e*x)^m*(c+d*x^n)^3*(A+B*x^n)*(a+b*x^n), x) == :(c*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(b*c*(B*c+3*A*d)+3*a*d*(A*d+B*c))+d*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(a*d*(A*d+3*B*c)+3*b*c*(A*d+B*c))+c^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*b*c+B*a*c+3*A*a*d)+d^2*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(A*b*d+B*a*d+3*B*b*c)+A*a*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d^3*x^(1+5n)*(e*x)^m*(1+m+5n)^-1)
@test integrate((e*x)^m*(c+d*x^n)^3*(A+B*x^n), x) == :(A*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d^3*x^(1+4n)*(e*x)^m*(1+m+4n)^-1+c^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(B*c+3*A*d)+d^2*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*d+3*B*c)+3*c*d*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*d+B*c))

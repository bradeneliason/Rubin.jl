using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((e*x)^m*(a+b*x^2)^3*(A+B*x^2)*(c+d*x^2), x) == :(a*e^-5*(e*x)^(5+m)*(5+m)^-1*(B*a*(a*d+3*b*c)+3*A*b*(a*d+b*c))+b*e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*(b*c+3*a*d)+3*B*a*(a*d+b*c))+a^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(A*a*d+B*a*c+3*A*b*c)+b^2*e^-9*(e*x)^(9+m)*(9+m)^-1*(A*b*d+B*b*c+3*B*a*d)+A*c*a^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^3*e^-11*(e*x)^(11+m)*(11+m)^-1)
@test integrate((e*x)^m*(a+b*x^2)^2*(A+B*x^2)*(c+d*x^2), x) == :(e^-5*(e*x)^(5+m)*(5+m)^-1*(A*b*(b*c+2*a*d)+B*a*(a*d+2*b*c))+a*e^-3*(e*x)^(3+m)*(3+m)^-1*(A*a*d+B*a*c+2*A*b*c)+b*e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*d+B*b*c+2*B*a*d)+A*c*a^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^2*e^-9*(e*x)^(9+m)*(9+m)^-1)
@test integrate((e*x)^m*(A+B*x^2)*(a+b*x^2)*(c+d*x^2), x) == :(e^-5*(e*x)^(5+m)*(5+m)^-1*(A*b*d+B*a*d+B*b*c)+e^-3*(e*x)^(3+m)*(3+m)^-1*(A*a*d+A*b*c+B*a*c)+A*a*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d*e^-7*(e*x)^(7+m)*(7+m)^-1)
@test integrate((e*x)^m*(A+B*x^2)*(c+d*x^2), x) == :(e^-3*(e*x)^(3+m)*(3+m)^-1*(A*d+B*c)+A*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*e^-5*(e*x)^(5+m)*(5+m)^-1)
@test integrate((e*x)^m*(a+b*x^2)^3*(c+d*x^2)^2*(A+B*x^2), x) == :(e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*(a^2*d^2+3*b^2*c^2+6*a*b*c*d))+a*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(a^2*d^2+3*b^2*c^2+6*a*b*c*d)+B*a*c*(2*a*d+3*b*c))+b*e^-9*(e*x)^(9+m)*(9+m)^-1*(c*b^2*(B*c+2*A*d)+3*B*a^2*d^2+3*a*b*d*(A*d+2*B*c))+A*a^3*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^2*e^-13*(e*x)^(13+m)*(13+m)^-1+c*a^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(B*a*c+2*A*a*d+3*A*b*c)+d*b^2*e^-11*(e*x)^(11+m)*(11+m)^-1*(A*b*d+2*B*b*c+3*B*a*d))
@test integrate((e*x)^m*(a+b*x^2)^2*(c+d*x^2)^2*(A+B*x^2), x) == :(e^-7*(e*x)^(7+m)*(7+m)^-1*(B*a^2*d^2+c*b^2*(B*c+2*A*d)+2*a*b*d*(A*d+2*B*c))+e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(a^2*d^2+b^2*c^2+4*a*b*c*d)+2*B*a*c*(a*d+b*c))+A*a^2*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^2*e^-11*(e*x)^(11+m)*(11+m)^-1+a*c*e^-3*(e*x)^(3+m)*(3+m)^-1*(2*A*(a*d+b*c)+B*a*c)+b*d*e^-9*(e*x)^(9+m)*(9+m)^-1*(A*b*d+2*B*a*d+2*B*b*c))
@test integrate((e*x)^m*(c+d*x^2)^2*(A+B*x^2)*(a+b*x^2), x) == :(e^-5*(e*x)^(5+m)*(5+m)^-1*(a*d*(A*d+2*B*c)+b*c*(B*c+2*A*d))+c*e^-3*(e*x)^(3+m)*(3+m)^-1*(A*b*c+B*a*c+2*A*a*d)+d*e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*d+B*a*d+2*B*b*c)+A*a*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d^2*e^-9*(e*x)^(9+m)*(9+m)^-1)
@test integrate((e*x)^m*(c+d*x^2)^2*(A+B*x^2), x) == :(A*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d^2*e^-7*(e*x)^(7+m)*(7+m)^-1+c*e^-3*(e*x)^(3+m)*(3+m)^-1*(B*c+2*A*d)+d*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*d+2*B*c))
@test integrate((e*x)^m*(a+b*x^2)^3*(c+d*x^2)^3*(A+B*x^2), x) == :(e^-9*(e*x)^(9+m)*(9+m)^-1*(B*a^3*d^3+b^3*c^2*(B*c+3*A*d)+3*b*a^2*d^2*(A*d+3*B*c)+9*a*c*d*b^2*(A*d+B*c))+e^-7*(e*x)^(7+m)*(7+m)^-1*(A*(a^3*d^3+b^3*c^3+9*a*d*b^2*c^2+9*b*c*a^2*d^2)+3*B*a*c*(a^2*d^2+b^2*c^2+3*a*b*c*d))+A*a^3*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^3*e^-15*(e*x)^(15+m)*(15+m)^-1+a^2*c^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(3*A*(a*d+b*c)+B*a*c)+b^2*d^2*e^-13*(e*x)^(13+m)*(13+m)^-1*(A*b*d+3*B*a*d+3*B*b*c)+3*a*c*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(a^2*d^2+b^2*c^2+3*a*b*c*d)+B*a*c*(a*d+b*c))+3*b*d*e^-11*(e*x)^(11+m)*(11+m)^-1*(B*a^2*d^2+c*b^2*(A*d+B*c)+a*b*d*(A*d+3*B*c)))
@test integrate((e*x)^m*(a+b*x^2)^2*(c+d*x^2)^3*(A+B*x^2), x) == :(e^-7*(e*x)^(7+m)*(7+m)^-1*(a^2*d^2*(A*d+3*B*c)+b^2*c^2*(B*c+3*A*d)+6*a*b*c*d*(A*d+B*c))+c*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*c*(2*b*c+3*a*d))+d*e^-9*(e*x)^(9+m)*(9+m)^-1*(B*a^2*d^2+3*c*b^2*(A*d+B*c)+2*a*b*d*(A*d+3*B*c))+A*a^2*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^3*e^-13*(e*x)^(13+m)*(13+m)^-1+a*c^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(B*a*c+2*A*b*c+3*A*a*d)+b*d^2*e^-11*(e*x)^(11+m)*(11+m)^-1*(A*b*d+2*B*a*d+3*B*b*c))
@test integrate((e*x)^m*(c+d*x^2)^3*(A+B*x^2)*(a+b*x^2), x) == :(c*e^-5*(e*x)^(5+m)*(5+m)^-1*(b*c*(B*c+3*A*d)+3*a*d*(A*d+B*c))+d*e^-7*(e*x)^(7+m)*(7+m)^-1*(a*d*(A*d+3*B*c)+3*b*c*(A*d+B*c))+c^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(A*b*c+B*a*c+3*A*a*d)+d^2*e^-9*(e*x)^(9+m)*(9+m)^-1*(A*b*d+B*a*d+3*B*b*c)+A*a*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d^3*e^-11*(e*x)^(11+m)*(11+m)^-1)
@test integrate((e*x)^m*(c+d*x^2)^3*(A+B*x^2), x) == :(A*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d^3*e^-9*(e*x)^(9+m)*(9+m)^-1+c^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(B*c+3*A*d)+d^2*e^-7*(e*x)^(7+m)*(7+m)^-1*(A*d+3*B*c)+3*c*d*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*d+B*c))
@test integrate(x^-1*(a+b*x^2)^(1/2)*(A+B*x^2)*(c+d*x^2), x) == :(A*c*(a+b*x^2)^(1/2)+-1//15*b^-2*(a+b*x^2)^3//2*(-5*b*(A*d+B*c)+2*B*a*d+-3*B*b*d*x^2)+-1*A*c*a^(1/2)*arctanh(a^-1//2*(a+b*x^2)^(1/2)))
@test integrate(x^-1*(c+d*x^2)^(1/2)*(A+B*x^2)*(a+b*x^2), x) == :(A*a*(c+d*x^2)^(1/2)+-1//15*d^-2*(c+d*x^2)^3//2*(-1*d*(5*A*b+5*B*a)+2*B*b*c+-3*B*b*d*x^2)+-1*A*a*c^(1/2)*arctanh(c^-1//2*(c+d*x^2)^(1/2)))

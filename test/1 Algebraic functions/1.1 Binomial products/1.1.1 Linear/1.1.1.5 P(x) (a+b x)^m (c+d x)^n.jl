using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((a+b*x)^3*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(1//7*d^-7*(c+d*x)^7//2*(2*b^3*(A*d^3+-20*D*c^3+-4*B*c*d^2+10*C*d*c^2)+2*D*a^3*d^3+-6*a*d*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+6*b*a^2*d^2*(C*d+-4*D*c))+-2*d^-7*(c+d*x)^(1/2)*(b*c+-1*a*d)^3*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+-2//3*d^-7*(c+d*x)^3//2*(b*c+-1*a*d)^2*(-1*b*(-6*D*c^3+3*A*d^3+-4*B*c*d^2+5*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+-1//5*d^-7*(c+d*x)^5//2*(-2*a*d+2*b*c)*(b^2*(-15*D*c^3+3*A*d^3+-6*B*c*d^2+10*C*d*c^2)+a^2*d^2*(C*d+-3*D*c)+-1*a*b*d*(-15*D*c^2+-3*B*d^2+8*C*c*d))+2//9*b*d^-7*(c+d*x)^9//2*(-1*b^2*(-1*B*d^2+-15*D*c^2+5*C*c*d)+3*D*a^2*d^2+3*a*b*d*(C*d+-5*D*c))+2//11*b^2*d^-7*(c+d*x)^11//2*(C*b*d+-6*D*b*c+3*D*a*d)+2//13*D*b^3*d^-7*(c+d*x)^13//2)
@test integrate((a+b*x)^2*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(1//5*d^-6*(c+d*x)^5//2*(2*b^2*(A*d^3+-10*D*c^3+-3*B*c*d^2+6*C*d*c^2)+2*a^2*d^2*(C*d+-3*D*c)+-4*a*b*d*(-1*B*d^2+-6*D*c^2+3*C*c*d))+1//7*d^-6*(c+d*x)^7//2*(-2*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+2*D*a^2*d^2+4*a*b*d*(C*d+-4*D*c))+2*d^-6*(c+d*x)^(1/2)*(b*c+-1*a*d)^2*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+1//3*d^-6*(c+d*x)^3//2*(-1*b*(-5*D*c^3+2*A*d^3+-3*B*c*d^2+4*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))*(-2*a*d+2*b*c)+2//9*b*d^-6*(c+d*x)^9//2*(C*b*d+-5*D*b*c+2*D*a*d)+2//11*D*b^2*d^-6*(c+d*x)^11//2)
@test integrate((c+d*x)^-1//2*(a+b*x)*(A+B*x+C*x^2+D*x^3), x) == :(-1//3*d^-5*(c+d*x)^3//2*(-2*b*(A*d^3+-4*D*c^3+-2*B*c*d^2+3*C*d*c^2)+2*a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+1//5*d^-5*(c+d*x)^5//2*(-2*b*(-1*B*d^2+-6*D*c^2+3*C*c*d)+2*a*d*(C*d+-3*D*c))+1//7*d^-5*(c+d*x)^7//2*(-8*D*b*c+2*C*b*d+2*D*a*d)+-1*d^-5*(c+d*x)^(1/2)*(-2*a*d+2*b*c)*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+2//9*D*b*d^-5*(c+d*x)^9//2)
@test integrate((c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(d^-4*(c+d*x)^(1/2)*(-2*D*c^3+2*A*d^3+-2*B*c*d^2+2*C*d*c^2)+-1//3*d^-4*(c+d*x)^3//2*(-6*D*c^2+-2*B*d^2+4*C*c*d)+1//5*d^-4*(c+d*x)^5//2*(-6*D*c+2*C*d)+2//7*D*d^-4*(c+d*x)^7//2)
@test integrate((a+b*x)^-1*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(b^-3*d^-3*(c+d*x)^(1/2)*(-2*b^2*(-1*B*d^2+-1*D*c^2+C*c*d)+2*D*a^2*d^2+-2*a*b*d*(C*d+-1*D*c))+-1*b^-7//2*(b*c+-1*a*d)^-1//2*(-2*a*(B*b^2+D*a^2+-1*C*a*b)+2*A*b^3)*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+1//3*b^-2*d^-3*(c+d*x)^3//2*(-4*D*b*c+-2*D*a*d+2*C*b*d)+2//5*D*b^-1*d^-3*(c+d*x)^5//2)
@test integrate((a+b*x)^-2*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(b^-3*d^-2*(c+d*x)^(1/2)*(-4*D*a*d+-2*D*b*c+2*C*b*d)+-1*b^-7//2*(b*c+-1*a*d)^-3//2*(b^3*(-1*A*d+2*B*c)+-1*a*b^2*(B*d+4*C*c)+-5*D*d*a^3+3*b*a^2*(C*d+2*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A+-1*a*b^-3*(B*b^2+D*a^2+-1*C*a*b))+2//3*D*b^-2*d^-2*(c+d*x)^3//2)
@test integrate((a+b*x)^-3*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(2*D*b^-3*d^-1*(c+d*x)^(1/2)+-1//4*b^-7//2*(b*c+-1*a*d)^-5//2*(b^3*(3*A*d^2+8*C*c^2+-4*B*c*d)+-1*a*b^2*(-1*B*d^2+24*D*c^2+8*C*c*d)+-15*D*a^3*d^2+3*b*d*a^2*(C*d+12*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//2*b^-3*(a+b*x)^-2*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//4*b^-3*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-2*(b^3*(-3*A*d+4*B*c)+b*a^2*(5*C*d+12*D*c)+-1*a*b^2*(B*d+8*C*c)+-9*D*d*a^3))
@test integrate((a+b*x)^-4*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(1//8*b^-7//2*(b*c+-1*a*d)^-7//2*(b^3*(-16*D*c^3+5*A*d^3+-6*B*c*d^2+8*C*d*c^2)+5*D*a^3*d^3+b*a^2*d^2*(C*d+-18*D*c)+-1*a*d*b^2*(-1*B*d^2+-24*D*c^2+4*C*c*d))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//3*b^-3*(a+b*x)^-3*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//8*b^-3*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-3*(b^3*(5*A*d^2+8*C*c^2+-6*B*c*d)+-1*a*b^2*(-1*B*d^2+24*D*c^2+4*C*c*d)+-11*D*a^3*d^2+b*d*a^2*(C*d+30*D*c))+-1//12*b^-3*(a+b*x)^-2*(c+d*x)^(1/2)*(b*c+-1*a*d)^-2*(b^3*(-5*A*d+6*B*c)+b*a^2*(7*C*d+18*D*c)+-1*a*b^2*(B*d+12*C*c)+-13*D*d*a^3))
@test integrate((a+b*x)^-5*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(-1//4*b^-3*(a+b*x)^-4*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//24*b^-3*(a+b*x)^-3*(c+d*x)^(1/2)*(b*c+-1*a*d)^-2*(b^3*(-7*A*d+8*B*c)+-1*a*b^2*(B*d+16*C*c)+-17*D*d*a^3+3*b*a^2*(3*C*d+8*D*c))+-1//64*d*b^-7//2*(b*c+-1*a*d)^-9//2*(b^3*(-64*D*c^3+35*A*d^3+-40*B*c*d^2+48*C*d*c^2)+5*D*a^3*d^3+-1*a*d*b^2*(-48*D*c^2+-5*B*d^2+16*C*c*d)+3*b*a^2*d^2*(C*d+-8*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//96*b^-3*(a+b*x)^-2*(c+d*x)^(1/2)*(b*c+-1*a*d)^-3*(b^3*(35*A*d^2+48*C*c^2+-40*B*c*d)+-1*a*b^2*(-5*B*d^2+144*D*c^2+16*C*c*d)+-59*D*a^3*d^2+3*b*d*a^2*(C*d+56*D*c))+1//64*b^-3*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-4*(b^3*(-64*D*c^3+35*A*d^3+-40*B*c*d^2+48*C*d*c^2)+5*D*a^3*d^3+-1*a*d*b^2*(-48*D*c^2+-5*B*d^2+16*C*c*d)+3*b*a^2*d^2*(C*d+-8*D*c)))
@test integrate((a+b*x)^3*(c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(1//5*d^-7*(c+d*x)^5//2*(2*b^3*(A*d^3+-20*D*c^3+-4*B*c*d^2+10*C*d*c^2)+2*D*a^3*d^3+-6*a*d*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+6*b*a^2*d^2*(C*d+-4*D*c))+-2*d^-7*(c+d*x)^(1/2)*(b*c+-1*a*d)^2*(-1*b*(-6*D*c^3+3*A*d^3+-4*B*c*d^2+5*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+2*d^-7*(c+d*x)^-1//2*(b*c+-1*a*d)^3*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+-1//3*d^-7*(c+d*x)^3//2*(-2*a*d+2*b*c)*(b^2*(-15*D*c^3+3*A*d^3+-6*B*c*d^2+10*C*d*c^2)+a^2*d^2*(C*d+-3*D*c)+-1*a*b*d*(-15*D*c^2+-3*B*d^2+8*C*c*d))+2//7*b*d^-7*(c+d*x)^7//2*(-1*b^2*(-1*B*d^2+-15*D*c^2+5*C*c*d)+3*D*a^2*d^2+3*a*b*d*(C*d+-5*D*c))+2//9*b^2*d^-7*(c+d*x)^9//2*(C*b*d+-6*D*b*c+3*D*a*d)+2//11*D*b^3*d^-7*(c+d*x)^11//2)
@test integrate((a+b*x)^2*(c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(1//3*d^-6*(c+d*x)^3//2*(2*b^2*(A*d^3+-10*D*c^3+-3*B*c*d^2+6*C*d*c^2)+2*a^2*d^2*(C*d+-3*D*c)+-4*a*b*d*(-1*B*d^2+-6*D*c^2+3*C*c*d))+1//5*d^-6*(c+d*x)^5//2*(-2*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+2*D*a^2*d^2+4*a*b*d*(C*d+-4*D*c))+d^-6*(c+d*x)^(1/2)*(-1*b*(-5*D*c^3+2*A*d^3+-3*B*c*d^2+4*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))*(-2*a*d+2*b*c)+-2*d^-6*(c+d*x)^-1//2*(b*c+-1*a*d)^2*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+2//7*b*d^-6*(c+d*x)^7//2*(C*b*d+-5*D*b*c+2*D*a*d)+2//9*D*b^2*d^-6*(c+d*x)^9//2)
@test integrate((c+d*x)^-3//2*(a+b*x)*(A+B*x+C*x^2+D*x^3), x) == :(-1*d^-5*(c+d*x)^(1/2)*(-2*b*(A*d^3+-4*D*c^3+-2*B*c*d^2+3*C*d*c^2)+2*a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+1//3*d^-5*(c+d*x)^3//2*(-2*b*(-1*B*d^2+-6*D*c^2+3*C*c*d)+2*a*d*(C*d+-3*D*c))+1//5*d^-5*(c+d*x)^5//2*(-8*D*b*c+2*C*b*d+2*D*a*d)+d^-5*(c+d*x)^-1//2*(-2*a*d+2*b*c)*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+2//7*D*b*d^-5*(c+d*x)^7//2)
@test integrate((c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(-1*d^-4*(c+d*x)^(1/2)*(-6*D*c^2+-2*B*d^2+4*C*c*d)+-1*d^-4*(c+d*x)^-1//2*(-2*D*c^3+2*A*d^3+-2*B*c*d^2+2*C*d*c^2)+1//3*d^-4*(c+d*x)^3//2*(-6*D*c+2*C*d)+2//5*D*d^-4*(c+d*x)^5//2)
@test integrate((a+b*x)^-1*(c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(b^-2*d^-3*(c+d*x)^(1/2)*(-2*D*a*d+-2*D*b*c+2*C*b*d)+d^-3*(c+d*x)^-1//2*(b*c+-1*a*d)^-1*(-2*D*c^3+2*A*d^3+-2*B*c*d^2+2*C*d*c^2)+-1*b^-5//2*(b*c+-1*a*d)^-3//2*(-2*a*(B*b^2+D*a^2+-1*C*a*b)+2*A*b^3)*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+2//3*D*b^-1*d^-3*(c+d*x)^3//2+-2*D*c*b^-1*d^-3*(c+d*x)^(1/2))
@test integrate((a+b*x)^-2*(c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(-1*b^-5//2*(b*c+-1*a*d)^-5//2*(b^3*(-3*A*d+2*B*c)+b*a^2*(C*d+6*D*c)+-1*a*b^2*(-1*B*d+4*C*c)+-3*D*d*a^3)*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1*(a+b*x)^-1*(c+d*x)^-1//2*(b*c+-1*a*d)^-1*(A+-1*a*b^-3*(B*b^2+D*a^2+-1*C*a*b))+2*D*b^-2*d^-2*(c+d*x)^(1/2)+b^-3*d^-2*(c+d*x)^-1//2*(b*c+-1*a*d)^-2*(-1*b^3*(-2*D*c^3+3*A*d^3+-2*B*c*d^2+2*C*d*c^2)+D*a^3*d^3+B*a*b^2*d^3+-1*C*b*a^2*d^3))
@test integrate((a+b*x)^-3*(c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(-1//4*b^-5//2*(b*c+-1*a*d)^-7//2*(b^3*(8*C*c^2+15*A*d^2+-12*B*c*d)+a*b^2*(-24*D*c^2+-3*B*d^2+8*C*c*d)+-3*D*a^3*d^2+-1*b*d*a^2*(C*d+-12*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//2*b^-3*d^-1*(c+d*x)^-1//2*(b*c+-1*a*d)^-3*(-1*b^3*(-4*D*c^3+5*A*d^3+-4*B*c*d^2+4*C*d*c^2)+D*a^3*d^3+B*a*b^2*d^3+-1*C*b*a^2*d^3)+-1//2*b^-3*(a+b*x)^-2*(c+d*x)^-1//2*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//4*b^-2*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-3*(b^3*(-5*A*d+4*B*c)+-1*a*b^2*(-1*B*d+8*C*c)+-7*D*d*a^3+3*b*a^2*(C*d+4*D*c)))
@test integrate((a+b*x)^-4*(c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(-1//8*b^-5//2*(b*c+-1*a*d)^-9//2*(-1*b^3*(-16*D*c^3+35*A*d^3+-30*B*c*d^2+24*C*d*c^2)+D*a^3*d^3+b*a^2*d^2*(C*d+-6*D*c)+-1*a*d*b^2*(-24*D*c^2+-5*B*d^2+12*C*c*d))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+1//3*b^-3*(c+d*x)^-1//2*(b*c+-1*a*d)^-4*(-1*b^3*(-6*D*c^3+7*A*d^3+-6*B*c*d^2+6*C*d*c^2)+D*a^3*d^3+B*a*b^2*d^3+-1*C*b*a^2*d^3)+-1//3*b^-3*(a+b*x)^-3*(c+d*x)^-1//2*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//12*b^-2*(a+b*x)^-2*(c+d*x)^(1/2)*(b*c+-1*a*d)^-3*(b^3*(-7*A*d+6*B*c)+b*a^2*(5*C*d+18*D*c)+-1*a*b^2*(-1*B*d+12*C*c)+-11*D*d*a^3)+-1//24*b^-2*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-4*(b^3*(24*C*c^2+49*A*d^2+-42*B*c*d)+a*b^2*(-72*D*c^2+-7*B*d^2+36*C*c*d)+5*D*a^3*d^2+-1*b*d*a^2*(-18*D*c+11*C*d)))
@test integrate((a+b*x)^3*(c+d*x)^-5//2*(A+B*x+C*x^2+D*x^3), x) == :(1//3*d^-7*(c+d*x)^3//2*(2*b^3*(A*d^3+-20*D*c^3+-4*B*c*d^2+10*C*d*c^2)+2*D*a^3*d^3+-6*a*d*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+6*b*a^2*d^2*(C*d+-4*D*c))+-1*d^-7*(c+d*x)^(1/2)*(-2*a*d+2*b*c)*(b^2*(-15*D*c^3+3*A*d^3+-6*B*c*d^2+10*C*d*c^2)+a^2*d^2*(C*d+-3*D*c)+-1*a*b*d*(-15*D*c^2+-3*B*d^2+8*C*c*d))+2*d^-7*(c+d*x)^-1//2*(b*c+-1*a*d)^2*(-1*b*(-6*D*c^3+3*A*d^3+-4*B*c*d^2+5*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+2//3*d^-7*(c+d*x)^-3//2*(b*c+-1*a*d)^3*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+2//5*b*d^-7*(c+d*x)^5//2*(-1*b^2*(-1*B*d^2+-15*D*c^2+5*C*c*d)+3*D*a^2*d^2+3*a*b*d*(C*d+-5*D*c))+2//7*b^2*d^-7*(c+d*x)^7//2*(C*b*d+-6*D*b*c+3*D*a*d)+2//9*D*b^3*d^-7*(c+d*x)^9//2)
@test integrate((a+b*x)^2*(c+d*x)^-5//2*(A+B*x+C*x^2+D*x^3), x) == :(d^-6*(c+d*x)^(1/2)*(2*b^2*(A*d^3+-10*D*c^3+-3*B*c*d^2+6*C*d*c^2)+2*a^2*d^2*(C*d+-3*D*c)+-4*a*b*d*(-1*B*d^2+-6*D*c^2+3*C*c*d))+1//3*d^-6*(c+d*x)^3//2*(-2*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+2*D*a^2*d^2+4*a*b*d*(C*d+-4*D*c))+-1*d^-6*(c+d*x)^-1//2*(-1*b*(-5*D*c^3+2*A*d^3+-3*B*c*d^2+4*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))*(-2*a*d+2*b*c)+-2//3*d^-6*(c+d*x)^-3//2*(b*c+-1*a*d)^2*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+2//5*b*d^-6*(c+d*x)^5//2*(C*b*d+-5*D*b*c+2*D*a*d)+2//7*D*b^2*d^-6*(c+d*x)^7//2)
@test integrate((c+d*x)^-5//2*(a+b*x)*(A+B*x+C*x^2+D*x^3), x) == :(d^-5*(c+d*x)^(1/2)*(-2*b*(-1*B*d^2+-6*D*c^2+3*C*c*d)+2*a*d*(C*d+-3*D*c))+d^-5*(c+d*x)^-1//2*(-2*b*(A*d^3+-4*D*c^3+-2*B*c*d^2+3*C*d*c^2)+2*a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+1//3*d^-5*(c+d*x)^3//2*(-8*D*b*c+2*C*b*d+2*D*a*d)+1//3*d^-5*(c+d*x)^-3//2*(-2*a*d+2*b*c)*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+2//5*D*b*d^-5*(c+d*x)^5//2)
@test integrate((c+d*x)^-5//2*(A+B*x+C*x^2+D*x^3), x) == :(d^-4*(c+d*x)^(1/2)*(-6*D*c+2*C*d)+d^-4*(c+d*x)^-1//2*(-6*D*c^2+-2*B*d^2+4*C*c*d)+-1//3*d^-4*(c+d*x)^-3//2*(-2*D*c^3+2*A*d^3+-2*B*c*d^2+2*C*d*c^2)+2//3*D*d^-4*(c+d*x)^3//2)
@test integrate((a+b*x)^-1*(c+d*x)^-5//2*(A+B*x+C*x^2+D*x^3), x) == :(d^-3*(c+d*x)^-1//2*(b*c+-1*a*d)^-2*(-2*b*(-1*A*d^3+-2*D*c^3+C*d*c^2)+2*a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+-1*b^-3//2*(b*c+-1*a*d)^-5//2*(-2*a*(B*b^2+D*a^2+-1*C*a*b)+2*A*b^3)*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+2*D*b^-1*d^-3*(c+d*x)^(1/2)+1//3*d^-3*(c+d*x)^-3//2*(b*c+-1*a*d)^-1*(-2*D*c^3+2*A*d^3+-2*B*c*d^2+2*C*d*c^2))
@test integrate((a+b*x)^-2*(c+d*x)^-5//2*(A+B*x+C*x^2+D*x^3), x) == :(-1*b^-3//2*(b*c+-1*a*d)^-7//2*(b^3*(-5*A*d+2*B*c)+-1*D*d*a^3+-1*a*b^2*(-3*B*d+4*C*c)+-1*b*a^2*(C*d+-6*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1*(a+b*x)^-1*(c+d*x)^-3//2*(b*c+-1*a*d)^-1*(A+-1*a*b^-3*(B*b^2+D*a^2+-1*C*a*b))+-1*b^-2*d^-2*(c+d*x)^-1//2*(b*c+-1*a*d)^-3*(-1*b^3*(-5*A*d^3+-2*D*c^3+2*B*c*d^2)+-1*D*a^3*d^3+C*b*a^2*d^3+a*d*b^2*(-6*D*c^2+-3*B*d^2+4*C*c*d))+1//3*b^-3*d^-2*(c+d*x)^-3//2*(b*c+-1*a*d)^-2*(-1*b^3*(-2*D*c^3+5*A*d^3+-2*B*c*d^2+2*C*d*c^2)+3*D*a^3*d^3+-3*C*b*a^2*d^3+3*B*a*b^2*d^3))
@test integrate((a+b*x)^-3*(c+d*x)^-5//2*(A+B*x+C*x^2+D*x^3), x) == :(b^-2*(c+d*x)^-1//2*(b*c+-1*a*d)^-4*(b^3*(2*C*c^2+7*A*d^2+-4*B*c*d)+a*b^2*(-6*D*c^2+-3*B*d^2+4*C*c*d)+-1*D*a^3*d^2+C*b*a^2*d^2)+-1//4*b^-3//2*(b*c+-1*a*d)^-9//2*(b^3*(8*C*c^2+35*A*d^2+-20*B*c*d)+D*a^3*d^2+3*a*b^2*(-8*D*c^2+-5*B*d^2+8*C*c*d)+3*b*d*a^2*(C*d+-4*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//2*b^-3*(a+b*x)^-2*(c+d*x)^-3//2*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//4*b^-1*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-4*(b^3*(-7*A*d+4*B*c)+b*a^2*(C*d+12*D*c)+-1*a*b^2*(-3*B*d+8*C*c)+-5*D*d*a^3)+-1//6*b^-3*d^-1*(c+d*x)^-3//2*(b*c+-1*a*d)^-3*(-1*b^3*(-4*D*c^3+7*A*d^3+-4*B*c*d^2+4*C*d*c^2)+3*D*a^3*d^3+-3*C*b*a^2*d^3+3*B*a*b^2*d^3))
@test integrate((a+b*x)^3*(c+d*x)^n*(A+B*x+C*x^2+D*x^3), x) == :(d^-7*(4+n)^-1*(c+d*x)^(4+n)*(b^3*(A*d^3+-20*D*c^3+-4*B*c*d^2+10*C*d*c^2)+D*a^3*d^3+-3*a*d*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+3*b*a^2*d^2*(C*d+-4*D*c))+D*b^3*d^-7*(7+n)^-1*(c+d*x)^(7+n)+b*d^-7*(5+n)^-1*(c+d*x)^(5+n)*(-1*b^2*(-1*B*d^2+-15*D*c^2+5*C*c*d)+3*D*a^2*d^2+3*a*b*d*(C*d+-5*D*c))+b^2*d^-7*(6+n)^-1*(c+d*x)^(6+n)*(C*b*d+-6*D*b*c+3*D*a*d)+-1*d^-7*(1+n)^-1*(c+d*x)^(1+n)*(b*c+-1*a*d)^3*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+-1*d^-7*(2+n)^-1*(c+d*x)^(2+n)*(b*c+-1*a*d)^2*(-1*b*(-6*D*c^3+3*A*d^3+-4*B*c*d^2+5*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+-1*d^-7*(3+n)^-1*(c+d*x)^(3+n)*(b*c+-1*a*d)*(b^2*(-15*D*c^3+3*A*d^3+-6*B*c*d^2+10*C*d*c^2)+a^2*d^2*(C*d+-3*D*c)+-1*a*b*d*(-15*D*c^2+-3*B*d^2+8*C*c*d)))
@test integrate((a+b*x)^2*(c+d*x)^n*(A+B*x+C*x^2+D*x^3), x) == :(d^-6*(3+n)^-1*(c+d*x)^(3+n)*(b^2*(A*d^3+-10*D*c^3+-3*B*c*d^2+6*C*d*c^2)+a^2*d^2*(C*d+-3*D*c)+-2*a*b*d*(-1*B*d^2+-6*D*c^2+3*C*c*d))+d^-6*(4+n)^-1*(c+d*x)^(4+n)*(-1*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+D*a^2*d^2+2*a*b*d*(C*d+-4*D*c))+D*b^2*d^-6*(6+n)^-1*(c+d*x)^(6+n)+b*d^-6*(5+n)^-1*(c+d*x)^(5+n)*(C*b*d+-5*D*b*c+2*D*a*d)+d^-6*(1+n)^-1*(c+d*x)^(1+n)*(b*c+-1*a*d)^2*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+d^-6*(2+n)^-1*(c+d*x)^(2+n)*(b*c+-1*a*d)*(-1*b*(-5*D*c^3+2*A*d^3+-3*B*c*d^2+4*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d)))
@test integrate((c+d*x)^n*(a+b*x)*(A+B*x+C*x^2+D*x^3), x) == :(d^-5*(3+n)^-1*(c+d*x)^(3+n)*(-1*b*(-1*B*d^2+-6*D*c^2+3*C*c*d)+a*d*(C*d+-3*D*c))+d^-5*(4+n)^-1*(c+d*x)^(4+n)*(C*b*d+D*a*d+-4*D*b*c)+-1*d^-5*(2+n)^-1*(c+d*x)^(2+n)*(-1*b*(A*d^3+-4*D*c^3+-2*B*c*d^2+3*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+D*b*d^-5*(5+n)^-1*(c+d*x)^(5+n)+-1*d^-5*(1+n)^-1*(c+d*x)^(1+n)*(b*c+-1*a*d)*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2))
@test integrate((c+d*x)^n*(A+B*x+C*x^2+D*x^3), x) == :(D*d^-4*(4+n)^-1*(c+d*x)^(4+n)+d^-4*(1+n)^-1*(c+d*x)^(1+n)*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+d^-4*(3+n)^-1*(c+d*x)^(3+n)*(C*d+-3*D*c)+-1*d^-4*(2+n)^-1*(c+d*x)^(2+n)*(-1*B*d^2+-3*D*c^2+2*C*c*d))

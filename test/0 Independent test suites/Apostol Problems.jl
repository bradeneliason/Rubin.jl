using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((1+2x)^(1/2), x) == :(1//3*(1+2x)^3//2)
@test integrate(x*(1+3x)^(1/2), x) == :(-2//27*(1+3x)^3//2+2//45*(1+3x)^5//2)
@test integrate(x^2*(1+x)^(1/2), x) == :(-4//5*(1+x)^5//2+2//3*(1+x)^3//2+2//7*(1+x)^7//2)
@test integrate(x*(2+-3x)^-1//2, x) == :(-4//9*(2+-3x)^(1/2)+2//27*(2+-3x)^3//2)
@test integrate((2+x^2+2x)^-3*(1+x), x) == :(-1//4*(2+x^2+2x)^-2)
@test integrate(sin(x)^3, x) == :(-1*cos(x)+1//3*cos(x)^3)
@test integrate(z*(-1+z)^1//3, z) == :(3//4*(-1+z)^4//3+3//7*(-1+z)^7//3)
@test integrate(sin(x)^-3*cos(x), x) == :(-1//2*csc(x)^2)
@test integrate((4+-1*sin(2x))^(1/2)*cos(2x), x) == :(-1//3*(4+-1*sin(2x))^3//2)
@test integrate((3+cos(x))^-2*sin(x), x) == :((3+cos(x))^-1)
@test integrate((cos(x)^3)^-1//2*sin(x), x) == :(2*(cos(x)^3)^-1//2*cos(x))
@test integrate((1+x)^-1//2*sin((1+x)^(1/2)), x) == :(-2*cos((1+x)^(1/2)))
@test integrate(x^(-1+n)*sin(x^n), x) == :(-1*n^-1*cos(x^n))
@test integrate(x^5*(1+-1*x^6)^-1//2, x) == :(-1//3*(1+-1*x^6)^(1/2))
@test integrate(t*(1+t)^1//4, t) == :(-4//5*(1+t)^5//4+4//9*(1+t)^9//4)
@test integrate((1+x^2)^-3//2, x) == :(x*(1+x^2)^-1//2)
@test integrate(x^2*(27+8*x^3)^2//3, x) == :(1//40*(27+8*x^3)^5//3)
@test integrate((-1*cos(x)+sin(x))^-1//3*(cos(x)+sin(x)), x) == :(3//2*(-1*cos(x)+sin(x))^2//3)
@test integrate(x*(1+x^2+(1+x^2)^3//2)^-1//2, x) == :(2*((1+x^2)*(1+(1+x^2)^(1/2)))^(1/2)*(1+x^2)^-1//2)
@test integrate(x*(1+x^2)^-1//2*(1+(1+x^2)^(1/2))^-1//2, x) == :(2*(1+(1+x^2)^(1/2))^(1/2))
@test integrate((1+-1x)^-1*(1+x^2+-2x)^1//5, x) == :(-5//2*(1+x^2+-2x)^1//5)
@test integrate(x*sin(x), x) == :(-1*x*cos(x)+sin(x))
@test integrate(x^2*sin(x), x) == :(2*cos(x)+-1*x^2*cos(x)+2*x*sin(x))
@test integrate(x^3*cos(x), x) == :(-6*cos(x)+x^3*sin(x)+-6*x*sin(x)+3*x^2*cos(x))
@test integrate(x^3*sin(x), x) == :(-6*sin(x)+-1*x^3*cos(x)+3*x^2*sin(x)+6*x*cos(x))
@test integrate(cos(x)*sin(x), x) == :((1/2)*sin(x)^2)
@test integrate(x*cos(x)*sin(x), x) == :(-1//4*x+(1/2)*x*sin(x)^2+1//4*cos(x)*sin(x))
@test integrate(sin(x)^2, x) == :((1/2)*x+-1//2*cos(x)*sin(x))
@test integrate(sin(x)^3, x) == :(-1*cos(x)+1//3*cos(x)^3)
@test integrate(sin(x)^4, x) == :(3//8*x+-3//8*cos(x)*sin(x)+-1//4*sin(x)^3*cos(x))
@test integrate(sin(x)^5, x) == :(-1*cos(x)+-1//5*cos(x)^5+2//3*cos(x)^3)
@test integrate(sin(x)^6, x) == :(5//16*x+-5//16*cos(x)*sin(x)+-5//24*sin(x)^3*cos(x)+-1//6*sin(x)^5*cos(x))
@test integrate(x*sin(x)^2, x) == :(1//4*x^2+1//4*sin(x)^2+-1//2*x*cos(x)*sin(x))
@test integrate(x*sin(x)^3, x) == :(1//9*sin(x)^3+2//3*sin(x)+-2//3*x*cos(x)+-1//3*x*sin(x)^2*cos(x))
@test integrate(x^2*sin(x)^2, x) == :(-1//4*x+1//6*x^3+(1/2)*x*sin(x)^2+1//4*cos(x)*sin(x)+-1//2*x^2*cos(x)*sin(x))
@test integrate(cos(x)^2, x) == :((1/2)*x+(1/2)*cos(x)*sin(x))
@test integrate(cos(x)^3, x) == :(-1//3*sin(x)^3+sin(x))
@test integrate(cos(x)^4, x) == :(3//8*x+1//4*cos(x)^3*sin(x)+3//8*cos(x)*sin(x))
@test integrate((a^2+-1*x^2)^5//2, x) == :(1//6*x*(a^2+-1*x^2)^5//2+5//16*a^6*arctan(x*(a^2+-1*x^2)^-1//2)+5//16*x*a^4*(a^2+-1*x^2)^(1/2)+5//24*x*a^2*(a^2+-1*x^2)^3//2)
@test integrate(x^5*(5+x^2)^-1//2, x) == :(25*(5+x^2)^(1/2)+-10//3*(5+x^2)^3//2+1//5*(5+x^2)^5//2)
@test integrate(t^3*(4+t^3)^-1//2, t) == :(2//5*t*(4+t^3)^(1/2)+-8//15*2^2//3*3^3//4*((t+2^2//3*(1+3^(1/2)))^-2*(t+2^2//3))^-1//2*((t+2^2//3*(1+3^(1/2)))^-2*(t^2+2*2^1//3+-1*t*2^2//3))^(1/2)*(2+3^(1/2))^(1/2)*(4+t^3)^-1//2*(t+2^2//3)*Elliptic.F(arcsin((t+2^2//3*(1+3^(1/2)))^-1*(t+2^2//3*(1+-1*3^(1/2)))),-7+-4*3^(1/2)))
@test integrate(tan(x)^2, x) == :(-1x+tan(x))
@test integrate(tan(x)^4, x) == :(x+-1*tan(x)+1//3*tan(x)^3)
@test integrate(cot(x)^2, x) == :(-1x+-1*cot(x))
@test integrate(cot(x)^4, x) == :(x+-1//3*cot(x)^3+cot(x))
@test integrate((2+3x)*sin(5x), x) == :(3//25*sin(5x)+(-2//5+-3//5*x)*cos(5x))
@test integrate(x*(1+x^2)^(1/2), x) == :(1//3*(1+x^2)^3//2)
@test integrate(x*(-1+x^2)^9, x) == :(1//20*(1+-1*x^2)^10)
@test integrate((7+6x)^-3*(3+2x), x) == :(-1//8*(3+2x)^2*(7+6x)^-2)
@test integrate(x^4*(1+x^5)^5, x) == :(1//30*(1+x^5)^6)
@test integrate(x^4*(1+-1x)^20, x) == :(-6//23*(1+-1x)^23+-1//21*(1+-1x)^21+-1//25*(1+-1x)^25+1//6*(1+-1x)^24+2//11*(1+-1x)^22)
@test integrate(x^-2*sin(x^-1), x) == :(cos(x^-1))
@test integrate(sin((-1+x)^1//4), x) == :(-24*sin((-1+x)^1//4)+-4*(-1+x)^3//4*cos((-1+x)^1//4)+12*(-1+x)^(1/2)*sin((-1+x)^1//4)+24*(-1+x)^1//4*cos((-1+x)^1//4))
@test integrate(x*cos(x^2)*sin(x^2), x) == :(1//4*sin(x^2)^2)
@test integrate((1+3*cos(x)^2)^(1/2)*sin(2x), x) == :(-2//9*(4+-3*sin(x)^2)^3//2)
@test integrate((2+3x)^-1, x) == :(1//3*log(2+3x))
@test integrate(log(x)^2, x) == :(2x+x*log(x)^2+-2*x*log(x))
@test integrate(x*log(x), x) == :(-1//4*x^2+(1/2)*x^2*log(x))
@test integrate(x*log(x)^2, x) == :(1//4*x^2+(1/2)*x^2*log(x)^2+-1//2*x^2*log(x))
@test integrate((1+t)^-1, t) == :(log(1+t))
@test integrate(cot(x), x) == :(log(sin(x)))
@test integrate(x^n*log(a*x), x) == :(-1*x^(1+n)*(1+n)^-2+x^(1+n)*(1+n)^-1*log(a*x))
@test integrate(x^2*log(x)^2, x) == :(2//27*x^3+-2//9*x^3*log(x)+1//3*x^3*log(x)^2)
@test integrate(x^-1*log(x)^-1, x) == :(log(log(x)))
@test integrate((1+-1t)^-1*log(1+-1t), t) == :(-1//2*log(1+-1t)^2)
@test integrate(x^-1*(1+log(x))^-1//2*log(x), x) == :(-2*(1+log(x))^(1/2)+2//3*(1+log(x))^3//2)
@test integrate(x^3*log(x)^3, x) == :(-3//128*x^4+-3//16*x^4*log(x)^2+1//4*x^4*log(x)^3+3//32*x^4*log(x))
@test integrate(x^2*exp(x^3), x) == :(1//3*exp(x^3))
@test integrate(2^(x^(1/2))*x^-1//2, x) == :(2^(1+x^(1/2))*log(2)^-1)
@test integrate(cos(x)*exp(2*sin(x)), x) == :((1/2)*exp(2*sin(x)))
@test integrate(exp(x)*sin(x), x) == :((1/2)*exp(x)*sin(x)+-1//2*cos(x)*exp(x))
@test integrate(cos(x)*exp(x), x) == :((1/2)*cos(x)*exp(x)+(1/2)*exp(x)*sin(x))
@test integrate((1+exp(x))^-1, x) == :(x+-1*log(1+exp(x)))
@test integrate(x*exp(x), x) == :(-1*exp(x)+x*exp(x))
@test integrate(x*exp(-1x), x) == :(-1*exp(-1x)+-1*x*exp(-1x))
@test integrate(x^2*exp(x), x) == :(2*exp(x)+x^2*exp(x)+-2*x*exp(x))
@test integrate(x^2*exp(-2x), x) == :(-1//4*exp(-2x)+-1//2*x*exp(-2x)+-1//2*x^2*exp(-2x))
@test integrate(exp(x^(1/2)), x) == :(-2*exp(x^(1/2))+2*x^(1/2)*exp(x^(1/2)))
@test integrate(x^3*exp(-1*x^2), x) == :(-1//2*exp(-1*x^2)+-1//2*x^2*exp(-1*x^2))
@test integrate(cos(b*x)*exp(a*x), x) == :(a*(a^2+b^2)^-1*cos(b*x)*exp(a*x)+b*(a^2+b^2)^-1*exp(a*x)*sin(b*x))
@test integrate(exp(a*x)*sin(b*x), x) == :(a*(a^2+b^2)^-1*exp(a*x)*sin(b*x)+-1*b*(a^2+b^2)^-1*cos(b*x)*exp(a*x))
@test integrate(arccot(x), x) == :((1/2)*log(1+x^2)+x*arccot(x))
@test integrate(arcsec(x), x) == :(-1*arctanh((1+-1*x^-2)^(1/2))+x*arcsec(x))
@test integrate(arccsc(x), x) == :(x*arccsc(x)+arctanh((1+-1*x^-2)^(1/2)))
@test integrate(arcsin(x)^2, x) == :(-2x+x*arcsin(x)^2+2*(1+-1*x^2)^(1/2)*arcsin(x))
@test integrate(x^-2*arcsin(x), x) == :(-1*arctanh((1+-1*x^2)^(1/2))+-1*x^-1*arcsin(x))
@test integrate((a^2+-1*x^2)^-1//2, x) == :(arctan(x*(a^2+-1*x^2)^-1//2))
@test integrate((1+-1*x^2+-2x)^-1//2, x) == :(arcsin((1/2)*2^(1/2)*(1+x)))
@test integrate((a^2+x^2)^-1, x) == :(a^-1*arctan(x*a^-1))
@test integrate((a+b*x^2)^-1, x) == :(a^-1//2*b^-1//2*arctan(x*a^-1//2*b^(1/2)))
@test integrate((2+x^2+-1x)^-1, x) == :(-2//7*7^(1/2)*arctan(1//7*7^(1/2)*(1+-2x)))
@test integrate(x*arctan(x), x) == :((1/2)*arctan(x)+-1//2*x+(1/2)*x^2*arctan(x))
@test integrate(x^2*arccos(x), x) == :(-1//3*(1+-1*x^2)^(1/2)+1//9*(1+-1*x^2)^3//2+1//3*x^3*arccos(x))
@test integrate(x*arctan(x)^2, x) == :((1/2)*arctan(x)^2+(1/2)*log(1+x^2)+(1/2)*x^2*arctan(x)^2+-1*x*arctan(x))
@test integrate(arctan(x^(1/2)), x) == :(-1*x^(1/2)+x*arctan(x^(1/2))+arctan(x^(1/2)))
@test integrate(x^-1//2*(1+x)^-1*arctan(x^(1/2)), x) == :(arctan(x^(1/2))^2)
@test integrate((1+-1*x^2)^(1/2), x) == :((1/2)*arcsin(x)+(1/2)*x*(1+-1*x^2)^(1/2))
@test integrate(x*(1+x^2)^-3//2*exp(arctan(x)), x) == :(-1//2*(1+x^2)^-1//2*(1+-1x)*exp(arctan(x)))
@test integrate((1+x^2)^-3//2*exp(arctan(x)), x) == :((1/2)*(1+x^2)^-1//2*(1+x)*exp(arctan(x)))
@test integrate(x^2*(1+x^2)^-2, x) == :((1/2)*arctan(x)+-1*x*(2+2*x^2)^-1)
@test integrate((1+exp(2x))^-1*exp(x), x) == :(arctan(exp(x)))
@test integrate(arccot(exp(x))*exp(-1x), x) == :((1/2)*log(1+exp(2x))+-1x+-1*arccot(exp(x))*exp(-1x))
@test integrate(((a+-1x)^-1*(a+x))^(1/2), x) == :(-1*((a+-1x)^-1*(a+x))^(1/2)*(a+-1x)+2*a*arctan(((a+-1x)^-1*(a+x))^(1/2)))
@test integrate(((b+-1x)*(x+-1a))^(1/2), x) == :((-1*x^2+x*(a+b)+-1*a*b)^(1/2)*((1/2)*x+-1//4*a+-1//4*b)+-1//8*(a+-1b)^2*arctan((1/2)*(-1*x^2+x*(a+b)+-1*a*b)^-1//2*(a+b+-2x)))
@test integrate(((b+-1x)*(x+-1a))^-1//2, x) == :(-1*arctan((1/2)*(-1*x^2+x*(a+b)+-1*a*b)^-1//2*(a+b+-2x)))
@test integrate((-3+x^2+2x)^-1*(3+5x), x) == :(2*log(1+-1x)+3*log(3+x))
@test integrate((-3+x^2+2x)^-1*(5+2x), x) == :(1//4*log(3+x)+7//4*log(1+-1x))
@test integrate((-3+x^2+-2x)^-1*(x^3+3x), x) == :((1/2)*x^2+2x+9*log(3+-1x)+log(1+x))
@test integrate((x^2+x^3+-2x)^-1*(-1+2*x^2+5x), x) == :((1/2)*log(x)+2*log(1+-1x)+-1//2*log(2+x))
@test integrate((1+x)^-2*(-1+x)^-1*(3+x^2+2x), x) == :((1+x)^-1+-1//2*log(1+x)+3//2*log(1+-1x))
@test integrate((-1+x^3)^-1*(-2+2x+3*x^2), x) == :(4//3*3^(1/2)*arctan(1//3*3^(1/2)*(1+2x))+log(1+-1*x^3))
@test integrate((-1+x)^-1*(2+x^2)^-2*(2+x^4+-1x+-1*x^3+2*x^2), x) == :((4+2*x^2)^-1+1//3*log(1+-1x)+1//3*log(2+x^2)+-1//6*2^(1/2)*arctan((1/2)*x*2^(1/2)))
@test integrate((cos(x)+sin(x))^-1, x) == :(-1//2*2^(1/2)*arctanh((1/2)*2^(1/2)*(-1*sin(x)+cos(x))))
@test integrate(x*(4+(4+-1*x^2)^(1/2)+-1*x^2)^-1, x) == :(-1*log(1+(4+-1*x^2)^(1/2)))
@test integrate((-2+x)^-1*(5+x)^-1*(3+2x), x) == :(log(2+-1x)+log(5+x))
@test integrate(x*(1+x)^-1*(2+x)^-1*(3+x)^-1, x) == :(2*log(2+x)+-3//2*log(3+x)+-1//2*log(1+x))
@test integrate(x*(2+x^3+-3x)^-1, x) == :((3+-3x)^-1+-2//9*log(2+x)+2//9*log(1+-1x))
@test integrate((x^2+x^3+-2x)^-1*(-6+x^4+2x), x) == :((1/2)*x^2+-1x+-1*log(1+-1x)+3*log(x)+log(2+x))
@test integrate((1+x)^-1*(1+2x)^-3*(7+8*x^3), x) == :(-3*(1+2x)^-2+3*(1+2x)^-1+log(1+x))
@test integrate((-1+x^3)^-1*(1+x+4*x^2), x) == :(2*log(1+-1x)+log(1+x+x^2))
@test integrate(x^4*(4+x^4+5*x^2)^-1, x) == :(x+-8//3*arctan((1/2)*x)+1//3*arctan(x))
@test integrate((x+x^2)^-1*(2+x), x) == :(-1*log(1+x)+2*log(x))
@test integrate(x^-1*(1+x^2)^-2, x) == :((2+2*x^2)^-1+-1//2*log(1+x^2)+log(x))
@test integrate((1+x)^-1*(2+x)^-2*(3+x)^-3, x) == :((2+x)^-1+2*log(2+x)+5*(12+4x)^-1+-17//8*log(3+x)+1//4*(3+x)^-2+1//8*log(1+x))
@test integrate(x*(1+x)^-2, x) == :((1+x)^-1+log(1+x))
@test integrate((x^3+-1x)^-1, x) == :((1/2)*log(1+-1*x^2)+-1*log(x))
@test integrate(x^2*(-6+x+x^2)^-1, x) == :(x+-9//5*log(3+x)+4//5*log(2+-1x))
@test integrate((4+x^2+-4x)^-1*(2+x), x) == :(4*(2+-1x)^-1+log(2+-1x))
@test integrate((4+x^2+-4x)^-1*(5+x^2+-4x)^-1, x) == :((2+-1x)^-1+arctan(2+-1x))
@test integrate((x^3+2x+3*x^2)^-1*(-3+x), x) == :(4*log(1+x)+-5//2*log(2+x)+-3//2*log(x))
@test integrate((-1+x^2)^-2, x) == :((1/2)*arctanh(x)+x*(2+-2*x^2)^-1)
@test integrate((-1+x^3)^-1*(1+x), x) == :(-1//3*log(1+x+x^2)+2//3*log(1+-1x))
@test integrate(x^-1*(1+x^2)^-2*(1+x^4), x) == :((1+x^2)^-1+log(x))
@test integrate((x^4+-2*x^3)^-1, x) == :(-1//8*log(x)+1//4*x^-1+1//4*x^-2+1//8*log(2+-1x))
@test integrate(x^-1*(1+x^2)^-1*(1+-1*x^3), x) == :(-1x+-1//2*log(1+x^2)+arctan(x)+log(x))
@test integrate((-1+x^4)^-1, x) == :(-1//2*arctan(x)+-1//2*arctanh(x))
@test integrate((1+x^4)^-1, x) == :(-1//4*2^(1/2)*arctan(1+-1*x*2^(1/2))+-1//8*2^(1/2)*log(1+x^2+-1*x*2^(1/2))+1//4*2^(1/2)*arctan(1+x*2^(1/2))+1//8*2^(1/2)*log(1+x^2+x*2^(1/2)))
@test integrate(x^2*(2+x^2+2x)^-2, x) == :(-1*x*(4+2*x^2+4x)^-1*(2+x)+arctan(1+x))
@test integrate((1+x+x^5)^-2*(-1+4*x^5), x) == :(-1*x*(1+x+x^5)^-1)
@test integrate((5+-1*cos(x)+2*sin(x))^-1, x) == :(1//5*5^(1/2)*arctan((5+-1*cos(x)+2*5^(1/2)+2*sin(x))^-1*(2*cos(x)+sin(x)))+1//10*x*5^(1/2))
@test integrate((1+a*cos(x))^-1, x) == :(2*(1+-1*a^2)^-1//2*arctan((1+a)^-1//2*(1+-1a)^(1/2)*tan((1/2)*x)))
@test integrate((1+2*cos(x))^-1, x) == :(-1//3*3^(1/2)*log(-1*sin((1/2)*x)+3^(1/2)*cos((1/2)*x))+1//3*3^(1/2)*log(3^(1/2)*cos((1/2)*x)+sin((1/2)*x)))
@test integrate((1+(1/2)*cos(x))^-1, x) == :(-4//3*3^(1/2)*arctan((2+3^(1/2)+cos(x))^-1*sin(x))+2//3*x*3^(1/2))
@test integrate((1+sin(x)^2)^-1*sin(x)^2, x) == :(x+-1//2*x*2^(1/2)+-1//2*2^(1/2)*arctan((1+2^(1/2)+sin(x)^2)^-1*cos(x)*sin(x)))
@test integrate((a^2*sin(x)^2+b^2*cos(x)^2)^-1, x) == :(a^-1*b^-1*arctan(a*b^-1*tan(x)))
@test integrate((a*sin(x)+b*cos(x))^-2, x) == :(b^-1*(a*sin(x)+b*cos(x))^-1*sin(x))
@test integrate((1+cos(x)+sin(x))^-1*sin(x), x) == :((1/2)*x+-1//2*log(1+tan((1/2)*x))+-1//2*log(1+cos(x)+sin(x)))
@test integrate((3+-1*x^2)^(1/2), x) == :(3//2*arcsin(1//3*x*3^(1/2))+(1/2)*x*(3+-1*x^2)^(1/2))
@test integrate(x*(3+-1*x^2)^-1//2, x) == :(-1*(3+-1*x^2)^(1/2))
@test integrate(x^-1*(3+-1*x^2)^(1/2), x) == :((3+-1*x^2)^(1/2)+-1*3^(1/2)*arctanh(1//3*3^(1/2)*(3+-1*x^2)^(1/2)))
@test integrate(x^-1*(x+x^2)^(1/2), x) == :((x+x^2)^(1/2)+arctanh(x*(x+x^2)^-1//2))
@test integrate((5+x^2)^(1/2), x) == :(5//2*arcsinh(1//5*x*5^(1/2))+(1/2)*x*(5+x^2)^(1/2))
@test integrate(x*(1+x+x^2)^-1//2, x) == :((1+x+x^2)^(1/2)+-1//2*arcsinh(1//3*3^(1/2)*(1+2x)))
@test integrate((x+x^2)^-1//2, x) == :(2*arctanh(x*(x+x^2)^-1//2))
@test integrate(x^-2*(2+-1x+-1*x^2)^(1/2), x) == :(-1*x^-1*(2+-1x+-1*x^2)^(1/2)+1//4*2^(1/2)*arctanh(1//4*2^(1/2)*(2+-1x+-1*x^2)^-1//2*(4+-1x))+arcsin(-1//3+-2//3*x))
@test integrate((1+t)^-1*log(t), t) == :(log(t)*log(1+t)+Polylogarithms.polylog(2,-1t))
@test integrate(log(exp(cos(x))), x) == :(x*log(exp(cos(x)))+-1*x*cos(x)+sin(x))
@test integrate(t^-1*exp(t), t) == :(expintegralei(t))
@test integrate(t^-1*exp(a*t), t) == :(expintegralei(a*t))
@test integrate(t^-2*exp(t), t) == :(-1*t^-1*exp(t)+expintegralei(t))
@test integrate(exp(t^-1), t) == :(-1*expintegralei(t^-1)+t*exp(t^-1))
@test integrate((-1+t+-1a)^-1*exp(-1t), t) == :(exp(-1+-1a)*expintegralei(1+a+-1t))
@test integrate(t*(1+t^2)^-1*exp(t^2), t) == :((1/2)*exp(-1)*expintegralei(1+t^2))
@test integrate((1+t)^-2*exp(t), t) == :(exp(-1)*expintegralei(1+t)+-1*(1+t)^-1*exp(t))
@test integrate(exp(t)*log(1+t), t) == :(exp(t)*log(1+t)+-1*exp(-1)*expintegralei(1+t))
@test integrate(t*exp(-1t), t) == :(-1*exp(-1t)+-1*t*exp(-1t))
@test integrate(t^2*exp(-1t), t) == :(-2*exp(-1t)+-1*t^2*exp(-1t)+-2*t*exp(-1t))
@test integrate(t^3*exp(-1t), t) == :(-6*exp(-1t)+-1*t^3*exp(-1t)+-6*t*exp(-1t)+-3*t^2*exp(-1t))
@test integrate((a*sin(x)+b*cos(x))^-1*(a1*sin(x)+b1*cos(x)), x) == :(x*(a^2+b^2)^-1*(a*a1+b*b1)+-1*(a^2+b^2)^-1*(a1*b+-1*a*b1)*log(a*sin(x)+b*cos(x)))
@test integrate(log(t)^-1, t) == :(logintegral(t))
@test integrate(log(t)^-2, t) == :(-1*t*log(t)^-1+logintegral(t))
@test integrate(log(t)^(-1+-1n), t) == :(-1*(-1*log(t))^n*log(t)^(-1n)*SpecialFunctions.gamma(-1n,-1*log(t)))
@test integrate((-1+t)^-1*exp(2t), t) == :(exp(2)*expintegralei(-2+2t))
@test integrate((2+x^2+-3x)^-1*exp(2x), x) == :(exp(4)*expintegralei(-4+2x)+-1*exp(2)*expintegralei(-2+2x))
@test integrate((1+t^3)^-1//2, t) == :(2//3*3^3//4*((1+t+3^(1/2))^-2*(1+t))^-1//2*((1+t+3^(1/2))^-2*(1+t^2+-1t))^(1/2)*(1+t^3)^-1//2*(2+3^(1/2))^(1/2)*(1+t)*Elliptic.F(arcsin((1+t+3^(1/2))^-1*(1+t+-1*3^(1/2))),-7+-4*3^(1/2)))

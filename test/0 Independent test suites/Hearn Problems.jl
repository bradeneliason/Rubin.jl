using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(1+x+x^2, x) == :(x+(1/2)*x^2+1//3*x^3)
@test integrate(x^2*(x+2*x^2)^2, x) == :(1//5*x^5+2//3*x^6+4//7*x^7)
@test integrate(x*(1+x^2+2x), x) == :((1/2)*x^2+1//4*x^4+2//3*x^3)
@test integrate(x^-1, x) == :(log(x))
@test integrate((1+x)^3*(-1+x)^-4, x) == :(-6*(1+-1x)^-2+6*(1+-1x)^-1+8//3*(1+-1x)^-3+log(1+-1x))
@test integrate(x^-1*(1+x)^-2*(-1+x)^-1, x) == :(-1*(2+2x)^-1+-1*log(x)+1//4*log(1+-1x)+3//4*log(1+x))
@test integrate((x+-1p)^-1*(x+-1q)^-1*(b+a*x), x) == :((p+-1q)^-1*(b+a*p)*log(p+-1x)+-1*(p+-1q)^-1*(b+a*q)*log(q+-1x))
@test integrate((c+a*x^2+b*x)^-1, x) == :(-2*(b^2+-4*a*c)^-1//2*arctanh((b^2+-4*a*c)^-1//2*(b+2*a*x)))
@test integrate((1+x^2)^-1*(b+a*x), x) == :(b*arctan(x)+(1/2)*a*log(1+x^2))
@test integrate((3+x^2+-2x)^-1, x) == :(-1//2*2^(1/2)*arctan((1/2)*2^(1/2)*(1+-1x)))
@test integrate((1+x^2)^-2*(-1+x)^-2, x) == :((4+-4x)^-1+-1*(4+4*x^2)^-1+-1//2*log(1+-1x)+1//4*arctan(x)+1//4*log(1+x^2))
@test integrate(x*(x+-1a)^-1*(x+-1b)^-1*(x+-1c)^-1, x) == :(a*(a+-1b)^-1*(a+-1c)^-1*log(a+-1x)+c*(a+-1c)^-1*(b+-1c)^-1*log(c+-1x)+-1*b*(a+-1b)^-1*(b+-1c)^-1*log(b+-1x))
@test integrate(x*(a^2+x^2)^-1*(b^2+x^2)^-1, x) == :((-2*b^2+2*a^2)^-1*log(b^2+x^2)+-1*(-2*b^2+2*a^2)^-1*log(a^2+x^2))
@test integrate(x^2*(a^2+x^2)^-1*(b^2+x^2)^-1, x) == :(a*(a^2+-1*b^2)^-1*arctan(x*a^-1)+-1*b*(a^2+-1*b^2)^-1*arctan(x*b^-1))
@test integrate(x*(1+x^2)^-1*(-1+x)^-1, x) == :((1/2)*arctan(x)+(1/2)*log(1+-1x)+-1//4*log(1+x^2))
@test integrate(x*(1+x^3)^-1, x) == :(-1//3*log(1+x)+1//6*log(1+x^2+-1x)+-1//3*3^(1/2)*arctan(1//3*3^(1/2)*(1+-2x)))
@test integrate(x^3*(1+x^3)^-1*(-1+x)^-2, x) == :((2+-2x)^-1+-1//3*log(1+x^2+-1x)+-1//12*log(1+x)+3//4*log(1+-1x))
@test integrate((1+x^4)^-1, x) == :(-1//4*2^(1/2)*arctan(1+-1*x*2^(1/2))+-1//8*2^(1/2)*log(1+x^2+-1*x*2^(1/2))+1//4*2^(1/2)*arctan(1+x*2^(1/2))+1//8*2^(1/2)*log(1+x^2+x*2^(1/2)))
@test integrate(x^2*(1+x^4)^-1, x) == :(-1//4*2^(1/2)*arctan(1+-1*x*2^(1/2))+-1//8*2^(1/2)*log(1+x^2+x*2^(1/2))+1//4*2^(1/2)*arctan(1+x*2^(1/2))+1//8*2^(1/2)*log(1+x^2+-1*x*2^(1/2)))
@test integrate((1+x^2+x^4)^-1, x) == :(-1//4*log(1+x^2+-1x)+1//4*log(1+x+x^2)+-1//6*3^(1/2)*arctan(1//3*3^(1/2)*(1+-2x))+1//6*3^(1/2)*arctan(1//3*3^(1/2)*(1+2x)))
@test integrate((a+b*x)^p, x) == :(b^-1*(1+p)^-1*(a+b*x)^(1+p))
@test integrate(x*(a+b*x)^p, x) == :(b^-2*(2+p)^-1*(a+b*x)^(2+p)+-1*a*b^-2*(1+p)^-1*(a+b*x)^(1+p))
@test integrate(x^2*(a+b*x)^p, x) == :(b^-3*(3+p)^-1*(a+b*x)^(3+p)+a^2*b^-3*(1+p)^-1*(a+b*x)^(1+p)+-2*a*b^-3*(2+p)^-1*(a+b*x)^(2+p))
@test integrate((a+b*x)^-1, x) == :(b^-1*log(a+b*x))
@test integrate((a+b*x)^-2, x) == :(-1*b^-1*(a+b*x)^-1)
@test integrate(x*(a+b*x)^-1, x) == :(x*b^-1+-1*a*b^-2*log(a+b*x))
@test integrate(x^2*(a+b*x)^-1, x) == :((1/2)*b^-1*x^2+a^2*b^-3*log(a+b*x)+-1*a*x*b^-2)
@test integrate(x^-1*(a+b*x)^-1, x) == :(a^-1*log(x)+-1*a^-1*log(a+b*x))
@test integrate(x^-2*(a+b*x)^-1, x) == :(-1*a^-1*x^-1+b*a^-2*log(a+b*x)+-1*b*a^-2*log(x))
@test integrate(x^-2*(a+b*x)^-2, x) == :(-1*a^-2*x^-1+-1*b*a^-2*(a+b*x)^-1+-2*b*a^-3*log(x)+2*b*a^-3*log(a+b*x))
@test integrate((c^2+x^2)^-1, x) == :(c^-1*arctan(x*c^-1))
@test integrate((c^2+-1*x^2)^-1, x) == :(c^-1*arctanh(x*c^-1))
@test integrate((-1+2*x^3)^-1, x) == :(-1//12*2^2//3*log(1+x*2^1//3+2^2//3*x^2)+1//6*2^2//3*log(1+-1*x*2^1//3)+-1//6*2^2//3*3^(1/2)*arctan(1//3*3^(1/2)*(1+2*x*2^1//3)))
@test integrate((-2+x^3)^-1, x) == :(-1//12*2^1//3*log(2^2//3+x^2+x*2^1//3)+1//6*2^1//3*log(2^1//3+-1x)+-1//6*2^1//3*3^(1/2)*arctan(1//3*3^(1/2)*(1+x*2^2//3)))
@test integrate((-1b+a*x^3)^-1, x) == :(-1//6*a^-1//3*b^-2//3*log(b^2//3+a^2//3*x^2+x*a^1//3*b^1//3)+1//3*a^-1//3*b^-2//3*log(b^1//3+-1*x*a^1//3)+-1//3*3^(1/2)*a^-1//3*b^-2//3*arctan(1//3*3^(1/2)*b^-1//3*(b^1//3+2*x*a^1//3)))
@test integrate((-2+x^4)^-1, x) == :(-1//4*2^1//4*arctan((1/2)*x*2^3//4)+-1//4*2^1//4*arctanh((1/2)*x*2^3//4))
@test integrate((-1+5*x^4)^-1, x) == :(-1//10*5^3//4*arctan(x*5^1//4)+-1//10*5^3//4*arctanh(x*5^1//4))
@test integrate((-1+x^4+3*x^2)^-1, x) == :(-1*(3//26+1//26*13^(1/2))^(1/2)*arctanh(x*2^(1/2)*(-3+13^(1/2))^-1//2)+-1*2^(1/2)*(39+13*13^(1/2))^-1//2*arctan(x*2^(1/2)*(3+13^(1/2))^-1//2))
@test integrate((-1+x^4+-3*x^2)^-1, x) == :(-1*(3//26+1//26*13^(1/2))^(1/2)*arctan(x*2^(1/2)*(-3+13^(1/2))^-1//2)+-1*2^(1/2)*(39+13*13^(1/2))^-1//2*arctanh(x*2^(1/2)*(3+13^(1/2))^-1//2))
@test integrate((1+x^4+-3*x^2)^-1, x) == :((3//10+1//10*5^(1/2))^(1/2)*arctanh(x*(3//2+(1/2)*5^(1/2))^(1/2))+-1*2^(1/2)*(15+5*5^(1/2))^-1//2*arctanh(x*2^(1/2)*(3+5^(1/2))^-1//2))
@test integrate((1+x^4+-4*x^2)^-1, x) == :((1/2)*(6+-3*3^(1/2))^-1//2*arctanh(x*(2+-1*3^(1/2))^-1//2)+-1//2*(6+3*3^(1/2))^-1//2*arctanh(x*(2+3^(1/2))^-1//2))
@test integrate((1+x^4+4*x^2)^-1, x) == :((1/2)*(6+-3*3^(1/2))^-1//2*arctan(x*(2+-1*3^(1/2))^-1//2)+-1//2*(6+3*3^(1/2))^-1//2*arctan(x*(2+3^(1/2))^-1//2))
@test integrate((2+x^2+x^4)^-1, x) == :((1/2)*(-1//14+1//7*2^(1/2))^(1/2)*arctan((1+2*2^(1/2))^-1//2*((-1+2*2^(1/2))^(1/2)+2x))+-1//2*(-1//14+1//7*2^(1/2))^(1/2)*arctan((1+2*2^(1/2))^-1//2*((-1+2*2^(1/2))^(1/2)+-2x))+-1//4*(-2+4*2^(1/2))^-1//2*log(2^(1/2)+x^2+-1*x*(-1+2*2^(1/2))^(1/2))+1//4*(-2+4*2^(1/2))^-1//2*log(2^(1/2)+x^2+x*(-1+2*2^(1/2))^(1/2)))
@test integrate((2+x^4+-1*x^2)^-1, x) == :((1/2)*(1//14+1//7*2^(1/2))^(1/2)*arctan((-1+2*2^(1/2))^-1//2*((1+2*2^(1/2))^(1/2)+2x))+-1//2*(1//14+1//7*2^(1/2))^(1/2)*arctan((-1+2*2^(1/2))^-1//2*((1+2*2^(1/2))^(1/2)+-2x))+-1//4*(2+4*2^(1/2))^-1//2*log(2^(1/2)+x^2+-1*x*(1+2*2^(1/2))^(1/2))+1//4*(2+4*2^(1/2))^-1//2*log(2^(1/2)+x^2+x*(1+2*2^(1/2))^(1/2)))
@test integrate((-1+x^6)^-1, x) == :(-1//3*arctanh(x)+-1//12*log(1+x+x^2)+1//12*log(1+x^2+-1x)+-1//6*3^(1/2)*arctan(1//3*3^(1/2)*(1+2x))+1//6*3^(1/2)*arctan(1//3*3^(1/2)*(1+-2x)))
@test integrate((-2+x^6)^-1, x) == :(-1//6*2^1//6*arctanh((1/2)*x*2^5//6)+-1//24*2^1//6*log(2^1//3+x^2+x*2^1//6)+1//24*2^1//6*log(2^1//3+x^2+-1*x*2^1//6)+-1//12*2^1//6*3^(1/2)*arctan(1//3*3^(1/2)+1//3*x*2^5//6*3^(1/2))+1//12*2^1//6*3^(1/2)*arctan(1//3*3^(1/2)+-1//3*x*2^5//6*3^(1/2)))
@test integrate((2+x^6)^-1, x) == :(-1//12*2^1//6*arctan(3^(1/2)+-1*x*2^5//6)+1//6*2^1//6*arctan((1/2)*x*2^5//6)+1//12*2^1//6*arctan(3^(1/2)+x*2^5//6)+-1//24*2^1//6*3^(1/2)*log(2^1//3+x^2+-1*x*2^1//6*3^(1/2))+1//24*2^1//6*3^(1/2)*log(2^1//3+x^2+x*2^1//6*3^(1/2)))
@test integrate((1+x^8)^-1, x) == :(-1//4*(4+-2*2^(1/2))^-1//2*arctan((2+2^(1/2))^-1//2*((2+-1*2^(1/2))^(1/2)+-2x))+-1//4*(4+2*2^(1/2))^-1//2*arctan((2+-1*2^(1/2))^-1//2*((2+2^(1/2))^(1/2)+-2x))+-1//16*(2+2^(1/2))^(1/2)*log(1+x^2+-1*x*(2+2^(1/2))^(1/2))+-1//16*(2+-1*2^(1/2))^(1/2)*log(1+x^2+-1*x*(2+-1*2^(1/2))^(1/2))+1//4*(4+-2*2^(1/2))^-1//2*arctan((2+2^(1/2))^-1//2*((2+-1*2^(1/2))^(1/2)+2x))+1//4*(4+2*2^(1/2))^-1//2*arctan((2+-1*2^(1/2))^-1//2*((2+2^(1/2))^(1/2)+2x))+1//16*(2+2^(1/2))^(1/2)*log(1+x^2+x*(2+2^(1/2))^(1/2))+1//16*(2+-1*2^(1/2))^(1/2)*log(1+x^2+x*(2+-1*2^(1/2))^(1/2)))
@test integrate((-1+x^8)^-1, x) == :(-1//4*arctan(x)+-1//4*arctanh(x)+-1//8*2^(1/2)*arctan(1+x*2^(1/2))+-1//16*2^(1/2)*log(1+x^2+x*2^(1/2))+1//8*2^(1/2)*arctan(1+-1*x*2^(1/2))+1//16*2^(1/2)*log(1+x^2+-1*x*2^(1/2)))
@test integrate((1+x^8+-1*x^4)^-1, x) == :(-1//12*6^(1/2)*arctan((2+3^(1/2))^-1//2*((2+-1*3^(1/2))^(1/2)+-2x))+-1//12*6^(1/2)*arctan((2+-1*3^(1/2))^-1//2*((2+3^(1/2))^(1/2)+-2x))+-1//24*6^(1/2)*log(1+x^2+-1*x*(2+3^(1/2))^(1/2))+-1//24*6^(1/2)*log(1+x^2+-1*x*(2+-1*3^(1/2))^(1/2))+1//12*6^(1/2)*arctan((2+3^(1/2))^-1//2*((2+-1*3^(1/2))^(1/2)+2x))+1//12*6^(1/2)*arctan((2+-1*3^(1/2))^-1//2*((2+3^(1/2))^(1/2)+2x))+1//24*6^(1/2)*log(1+x^2+x*(2+3^(1/2))^(1/2))+1//24*6^(1/2)*log(1+x^2+x*(2+-1*3^(1/2))^(1/2)))
@test integrate(x^7*(1+x^12)^-1, x) == :(-1//12*log(1+x^4)+1//24*log(1+x^8+-1*x^4)+-1//12*3^(1/2)*arctan(1//3*3^(1/2)*(1+-2*x^4)))
@test integrate(log(x), x) == :(-1x+x*log(x))
@test integrate(x*log(x), x) == :(-1//4*x^2+(1/2)*x^2*log(x))
@test integrate(x^2*log(x), x) == :(-1//9*x^3+1//3*x^3*log(x))
@test integrate(x^p*log(x), x) == :(-1*x^(1+p)*(1+p)^-2+x^(1+p)*(1+p)^-1*log(x))
@test integrate(log(x)^2, x) == :(2x+x*log(x)^2+-2*x*log(x))
@test integrate(x^9*log(x)^11, x) == :(-6237//156250000*x^10+-6237//3125000*x^10*log(x)^2+-2079//125000*x^10*log(x)^4+-693//12500*x^10*log(x)^6+-99//1000*x^10*log(x)^8+-11//100*x^10*log(x)^10+1//10*x^10*log(x)^11+11//100*x^10*log(x)^9+99//1250*x^10*log(x)^7+2079//62500*x^10*log(x)^5+2079//312500*x^10*log(x)^3+6237//15625000*x^10*log(x))
@test integrate(x^-1*log(x)^2, x) == :(1//3*log(x)^3)
@test integrate(log(x)^-1, x) == :(logintegral(x))
@test integrate(log(1+x)^-1, x) == :(logintegral(1+x))
@test integrate(x^-1*log(x)^-1, x) == :(log(log(x)))
@test integrate(x^-2*log(x)^-2, x) == :(-1*expintegralei(-1*log(x))+-1*x^-1*log(x)^-1)
@test integrate(x^-1*log(x)^p, x) == :((1+p)^-1*log(x)^(1+p))
@test integrate((b+a*x)*log(x), x) == :(-1*b*x+-1//4*a*x^2+b*x*log(x)+(1/2)*a*x^2*log(x))
@test integrate((b+a*x)^2*log(x), x) == :(-1*x*b^2+-1//9*a^2*x^3+-1//2*a*b*x^2+-1//3*a^-1*b^3*log(x)+1//3*a^-1*(b+a*x)^3*log(x))
@test integrate((b+a*x)^-2*log(x), x) == :(-1*a^-1*b^-1*log(b+a*x)+x*b^-1*(b+a*x)^-1*log(x))
@test integrate(x*log(b+a*x), x) == :(-1//4*x^2+(1/2)*x^2*log(b+a*x)+(1/2)*b*x*a^-1+-1//2*a^-2*b^2*log(b+a*x))
@test integrate(x^2*log(b+a*x), x) == :(-1//9*x^3+1//3*x^3*log(b+a*x)+-1//3*x*a^-2*b^2+1//3*a^-3*b^3*log(b+a*x)+1//6*b*a^-1*x^2)
@test integrate(log(a^2+x^2), x) == :(-2x+x*log(a^2+x^2)+2*a*arctan(x*a^-1))
@test integrate(x*log(a^2+x^2), x) == :(-1//2*x^2+((1/2)*a^2+(1/2)*x^2)*log(a^2+x^2))
@test integrate(x^2*log(a^2+x^2), x) == :(-2//9*x^3+-2//3*a^3*arctan(x*a^-1)+1//3*x^3*log(a^2+x^2)+2//3*x*a^2)
@test integrate(x^4*log(a^2+x^2), x) == :(-2//25*x^5+-2//5*x*a^4+1//5*x^5*log(a^2+x^2)+2//5*a^5*arctan(x*a^-1)+2//15*a^2*x^3)
@test integrate(log(x^2+-1*a^2), x) == :(-2x+x*log(x^2+-1*a^2)+2*a*arctanh(x*a^-1))
@test integrate(sin(x), x) == :(-1*cos(x))
@test integrate(cos(x), x) == :(sin(x))
@test integrate(tan(x), x) == :(-1*log(cos(x)))
@test integrate(tan(x)^-1, x) == :(log(sin(x)))
@test integrate((1+tan(x))^-2, x) == :((1/2)*log(cos(x)+sin(x))+-1*(2+2*tan(x))^-1)
@test integrate(cos(x)^-1, x) == :(arctanh(sin(x)))
@test integrate(sin(x)^-1, x) == :(-1*arctanh(cos(x)))
@test integrate(sin(x)^2, x) == :((1/2)*x+-1//2*cos(x)*sin(x))
@test integrate(x^3*sin(x^2), x) == :((1/2)*sin(x^2)+-1//2*x^2*cos(x^2))
@test integrate(sin(x)^3, x) == :(-1*cos(x)+1//3*cos(x)^3)
@test integrate((1+sin(x)^2)^2*cos(x), x) == :(1//5*sin(x)^5+2//3*sin(x)^3+sin(x))
@test integrate(cos(x)^2, x) == :((1/2)*x+(1/2)*cos(x)*sin(x))
@test integrate(cos(x)^3, x) == :(-1//3*sin(x)^3+sin(x))
@test integrate(cos(x)^-2, x) == :(tan(x))
@test integrate(sin(x)*sin(2x), x) == :((1/2)*sin(x)+-1//6*sin(3x))
@test integrate(x*sin(x), x) == :(-1*x*cos(x)+sin(x))
@test integrate(x^2*sin(x), x) == :(2*cos(x)+-1*x^2*cos(x)+2*x*sin(x))
@test integrate(x*sin(x)^2, x) == :(1//4*x^2+1//4*sin(x)^2+-1//2*x*cos(x)*sin(x))
@test integrate(x^2*sin(x)^2, x) == :(-1//4*x+1//6*x^3+(1/2)*x*sin(x)^2+1//4*cos(x)*sin(x)+-1//2*x^2*cos(x)*sin(x))
@test integrate(x*sin(x)^3, x) == :(1//9*sin(x)^3+2//3*sin(x)+-2//3*x*cos(x)+-1//3*x*sin(x)^2*cos(x))
@test integrate(x*cos(x), x) == :(x*sin(x)+cos(x))
@test integrate(x^2*cos(x), x) == :(-2*sin(x)+x^2*sin(x)+2*x*cos(x))
@test integrate(x*cos(x)^2, x) == :(1//4*x^2+1//4*cos(x)^2+(1/2)*x*cos(x)*sin(x))
@test integrate(x^2*cos(x)^2, x) == :(-1//4*x+1//6*x^3+(1/2)*x*cos(x)^2+-1//4*cos(x)*sin(x)+(1/2)*x^2*cos(x)*sin(x))
@test integrate(x*cos(x)^3, x) == :(1//9*cos(x)^3+2//3*cos(x)+2//3*x*sin(x)+1//3*x*cos(x)^2*sin(x))
@test integrate(x^-1*sin(x), x) == :(sinintegral(x))
@test integrate(x^-1*cos(x), x) == :(cosintegral(x))
@test integrate(x^-2*sin(x), x) == :(-1*x^-1*sin(x)+cosintegral(x))
@test integrate(x^-1*sin(x)^2, x) == :((1/2)*log(x)+-1//2*cosintegral(2x))
@test integrate(tan(x)^3, x) == :((1/2)*tan(x)^2+log(cos(x)))
@test integrate(sin(a+b*x), x) == :(-1*b^-1*cos(a+b*x))
@test integrate(cos(a+b*x), x) == :(b^-1*sin(a+b*x))
@test integrate(tan(a+b*x), x) == :(-1*b^-1*log(cos(a+b*x)))
@test integrate(tan(a+b*x)^-1, x) == :(b^-1*log(sin(a+b*x)))
@test integrate(sin(a+b*x)^-1, x) == :(-1*b^-1*arctanh(cos(a+b*x)))
@test integrate(cos(a+b*x)^-1, x) == :(b^-1*arctanh(sin(a+b*x)))
@test integrate(sin(a+b*x)^2, x) == :((1/2)*x+-1//2*b^-1*cos(a+b*x)*sin(a+b*x))
@test integrate(sin(a+b*x)^3, x) == :(-1*b^-1*cos(a+b*x)+1//3*b^-1*cos(a+b*x)^3)
@test integrate(cos(a+b*x)^2, x) == :((1/2)*x+(1/2)*b^-1*cos(a+b*x)*sin(a+b*x))
@test integrate(cos(a+b*x)^3, x) == :(b^-1*sin(a+b*x)+-1//3*b^-1*sin(a+b*x)^3)
@test integrate(cos(a+b*x)^-2, x) == :(b^-1*tan(a+b*x))
@test integrate((1+cos(x))^-1, x) == :((1+cos(x))^-1*sin(x))
@test integrate((1+-1*cos(x))^-1, x) == :(-1*(1+-1*cos(x))^-1*sin(x))
@test integrate((1+sin(x))^-1, x) == :(-1*(1+sin(x))^-1*cos(x))
@test integrate((1+-1*sin(x))^-1, x) == :((1+-1*sin(x))^-1*cos(x))
@test integrate((a+b*sin(x))^-1, x) == :(2*(a^2+-1*b^2)^-1//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*x))))
@test integrate((a+b*sin(x)+cos(x))^-1, x) == :(-2*(1+b^2+-1*a^2)^-1//2*arctanh((1+b^2+-1*a^2)^-1//2*(b+-1*(1+-1a)*tan((1/2)*x))))
@test integrate(x^2*sin(a+b*x)^2, x) == :(1//6*x^3+-1//4*x*b^-2+(1/2)*x*b^-2*sin(a+b*x)^2+1//4*b^-3*cos(a+b*x)*sin(a+b*x)+-1//2*b^-1*x^2*cos(a+b*x)*sin(a+b*x))
@test integrate(cos(x)*cos(2x), x) == :((1/2)*sin(x)+1//6*sin(3x))
@test integrate(x^2*cos(a+b*x)^2, x) == :(1//6*x^3+-1//4*x*b^-2+(1/2)*x*b^-2*cos(a+b*x)^2+-1//4*b^-3*cos(a+b*x)*sin(a+b*x)+(1/2)*b^-1*x^2*cos(a+b*x)*sin(a+b*x))
@test integrate(tan(x)^-3, x) == :(-1*log(sin(x))+-1//2*cot(x)^2)
@test integrate(x^3*tan(x)^4, x) == :(-2*Polylogarithms.polylog(3,-1*exp(2*im*x))+-1//2*x^2+1//4*x^4+x*tan(x)+-1*x^3*tan(x)+-4*x^2*log(1+exp(2*im*x))+-1//2*x^2*tan(x)^2+1//3*x^3*tan(x)^3+4//3*im*x^3+4*im*x*Polylogarithms.polylog(2,-1*exp(2*im*x))+log(cos(x)))
@test integrate(x^3*tan(x)^6, x) == :(-2*log(cos(x))+-1//4*x^4+-1//20*tan(x)^2+19//20*x^2+23//10*Polylogarithms.polylog(3,-1*exp(2*im*x))+x^3*tan(x)+-23//15*im*x^3+-19//10*x*tan(x)+-3//20*x^2*tan(x)^4+-1//3*x^3*tan(x)^3+1//5*x^3*tan(x)^5+1//10*x*tan(x)^3+4//5*x^2*tan(x)^2+23//5*x^2*log(1+exp(2*im*x))+-23//5*im*x*Polylogarithms.polylog(2,-1*exp(2*im*x)))
@test integrate(x*tan(x)^2, x) == :(-1//2*x^2+x*tan(x)+log(cos(x)))
@test integrate(cos(3x)*sin(2x), x) == :((1/2)*cos(x)+-1//10*cos(5x))
@test integrate(cos(x)^2*sin(x)^2, x) == :(1//8*x+-1//4*cos(x)^3*sin(x)+1//8*cos(x)*sin(x))
@test integrate(cos(x)^-2*sin(x)^-2, x) == :(-1*cot(x)+tan(x))
@test integrate(d^x*sin(x), x) == :(-1*d^x*(1+log(d)^2)^-1*cos(x)+d^x*(1+log(d)^2)^-1*log(d)*sin(x))
@test integrate(d^x*cos(x), x) == :(d^x*(1+log(d)^2)^-1*sin(x)+d^x*(1+log(d)^2)^-1*cos(x)*log(d))
@test integrate(x*d^x*sin(x), x) == :(d^x*(1+log(d)^2)^-2*sin(x)+-1*x*d^x*(1+log(d)^2)^-1*cos(x)+-1*d^x*(1+log(d)^2)^-2*log(d)^2*sin(x)+2*d^x*(1+log(d)^2)^-2*cos(x)*log(d)+x*d^x*(1+log(d)^2)^-1*log(d)*sin(x))
@test integrate(x*d^x*cos(x), x) == :(d^x*(1+log(d)^2)^-2*cos(x)+x*d^x*(1+log(d)^2)^-1*sin(x)+-1*d^x*(1+log(d)^2)^-2*log(d)^2*cos(x)+-2*d^x*(1+log(d)^2)^-2*log(d)*sin(x)+x*d^x*(1+log(d)^2)^-1*cos(x)*log(d))
@test integrate(d^x*x^2*sin(x), x) == :(2*d^x*(1+log(d)^2)^-3*cos(x)+-1*d^x*x^2*(1+log(d)^2)^-1*cos(x)+-6*d^x*(1+log(d)^2)^-3*log(d)^2*cos(x)+-6*d^x*(1+log(d)^2)^-3*log(d)*sin(x)+2*x*d^x*(1+log(d)^2)^-2*sin(x)+2*d^x*(1+log(d)^2)^-3*log(d)^3*sin(x)+d^x*x^2*(1+log(d)^2)^-1*log(d)*sin(x)+-2*x*d^x*(1+log(d)^2)^-2*log(d)^2*sin(x)+4*x*d^x*(1+log(d)^2)^-2*cos(x)*log(d))
@test integrate(d^x*x^2*cos(x), x) == :(-2*d^x*(1+log(d)^2)^-3*sin(x)+d^x*x^2*(1+log(d)^2)^-1*sin(x)+-6*d^x*(1+log(d)^2)^-3*cos(x)*log(d)+2*x*d^x*(1+log(d)^2)^-2*cos(x)+2*d^x*(1+log(d)^2)^-3*log(d)^3*cos(x)+6*d^x*(1+log(d)^2)^-3*log(d)^2*sin(x)+d^x*x^2*(1+log(d)^2)^-1*cos(x)*log(d)+-4*x*d^x*(1+log(d)^2)^-2*log(d)*sin(x)+-2*x*d^x*(1+log(d)^2)^-2*log(d)^2*cos(x))
@test integrate(d^x*x^3*sin(x), x) == :(-6*d^x*(1+log(d)^2)^-4*sin(x)+-1*d^x*x^3*(1+log(d)^2)^-1*cos(x)+-24*d^x*(1+log(d)^2)^-4*cos(x)*log(d)+-6*d^x*(1+log(d)^2)^-4*log(d)^4*sin(x)+3*d^x*x^2*(1+log(d)^2)^-2*sin(x)+6*x*d^x*(1+log(d)^2)^-3*cos(x)+24*d^x*(1+log(d)^2)^-4*log(d)^3*cos(x)+36*d^x*(1+log(d)^2)^-4*log(d)^2*sin(x)+d^x*x^3*(1+log(d)^2)^-1*log(d)*sin(x)+-18*x*d^x*(1+log(d)^2)^-3*log(d)^2*cos(x)+-18*x*d^x*(1+log(d)^2)^-3*log(d)*sin(x)+-3*d^x*x^2*(1+log(d)^2)^-2*log(d)^2*sin(x)+6*x*d^x*(1+log(d)^2)^-3*log(d)^3*sin(x)+6*d^x*x^2*(1+log(d)^2)^-2*cos(x)*log(d))
@test integrate(d^x*x^3*cos(x), x) == :(-6*d^x*(1+log(d)^2)^-4*cos(x)+d^x*x^3*(1+log(d)^2)^-1*sin(x)+-24*d^x*(1+log(d)^2)^-4*log(d)^3*sin(x)+-6*x*d^x*(1+log(d)^2)^-3*sin(x)+-6*d^x*(1+log(d)^2)^-4*log(d)^4*cos(x)+3*d^x*x^2*(1+log(d)^2)^-2*cos(x)+24*d^x*(1+log(d)^2)^-4*log(d)*sin(x)+36*d^x*(1+log(d)^2)^-4*log(d)^2*cos(x)+d^x*x^3*(1+log(d)^2)^-1*cos(x)*log(d)+-18*x*d^x*(1+log(d)^2)^-3*cos(x)*log(d)+-6*d^x*x^2*(1+log(d)^2)^-2*log(d)*sin(x)+-3*d^x*x^2*(1+log(d)^2)^-2*log(d)^2*cos(x)+6*x*d^x*(1+log(d)^2)^-3*log(d)^3*cos(x)+18*x*d^x*(1+log(d)^2)^-3*log(d)^2*sin(x))
@test integrate(sin(x)*sin(2x)*sin(3x), x) == :(-1//8*cos(2x)+-1//16*cos(4x)+1//24*cos(6x))
@test integrate(cos(x)*cos(2x)*cos(3x), x) == :(1//4*x+1//8*sin(2x)+1//16*sin(4x)+1//24*sin(6x))
@test integrate(x^2*sin(k*x)^3, x) == :(-2//27*k^-3*cos(k*x)^3+14//9*k^-3*cos(k*x)+-2//3*k^-1*x^2*cos(k*x)+2//9*x*k^-2*sin(k*x)^3+4//3*x*k^-2*sin(k*x)+-1//3*k^-1*x^2*sin(k*x)^2*cos(k*x))
@test integrate(sin(x)^-1*tan((1/2)*x)^-1*cos(x), x) == :(-1x+-1*cot((1/2)*x))
@test integrate((b+c*sin(a*x))^-2*sin(a*x), x) == :(-2*c*a^-1*(b^2+-1*c^2)^-3//2*arctan((b^2+-1*c^2)^-1//2*(c+b*tan((1/2)*a*x)))+-1*b*a^-1*(b+c*sin(a*x))^-1*(b^2+-1*c^2)^-1*cos(a*x))
@test integrate(sin(log(x)), x) == :((1/2)*x*sin(log(x))+-1//2*x*cos(log(x)))
@test integrate(cos(log(x)), x) == :((1/2)*x*cos(log(x))+(1/2)*x*sin(log(x)))
@test integrate(exp(x), x) == :(exp(x))
@test integrate(a^x, x) == :(a^x*log(a)^-1)
@test integrate(exp(a*x), x) == :(a^-1*exp(a*x))
@test integrate(x^-1*exp(a*x), x) == :(expintegralei(a*x))
@test integrate((a+b*exp(m*x))^-1, x) == :(x*a^-1+-1*a^-1*m^-1*log(a+b*exp(m*x)))
@test integrate((1+exp(x))^-1*exp(2x), x) == :(-1*log(1+exp(x))+exp(x))
@test integrate(exp(2x)*exp(a*x), x) == :((2+a)^-1*exp(x*(2+a)))
@test integrate((a*exp(m*x)+b*exp(-1*m*x))^-1, x) == :(a^-1//2*b^-1//2*m^-1*arctan(a^(1/2)*b^-1//2*exp(m*x)))
@test integrate(x*exp(a*x), x) == :(-1*a^-2*exp(a*x)+x*a^-1*exp(a*x))
@test integrate(x^20*exp(x), x) == :(2432902008176640000*exp(x)+x^20*exp(x)+-2432902008176640000*x*exp(x)+-405483668029440000*x^3*exp(x)+-20274183401472000*x^5*exp(x)+-482718652416000*x^7*exp(x)+-6704425728000*x^9*exp(x)+-60949324800*x^11*exp(x)+-390700800*x^13*exp(x)+-1860480*x^15*exp(x)+-6840*x^17*exp(x)+-20*x^19*exp(x)+380*x^18*exp(x)+116280*x^16*exp(x)+27907200*x^14*exp(x)+5079110400*x^12*exp(x)+670442572800*x^10*exp(x)+60339831552000*x^8*exp(x)+3379030566912000*x^6*exp(x)+101370917007360000*x^4*exp(x)+1216451004088320000*x^2*exp(x))
@test integrate(a^x*b^(-1x), x) == :(a^x*b^(-1x)*(-1*log(b)+log(a))^-1)
@test integrate(a^x*b^x, x) == :(a^x*b^x*(log(a)+log(b))^-1)
@test integrate(a^x*x^-2, x) == :(expintegralei(x*log(a))*log(a)+-1*a^x*x^-1)
@test integrate(x*a^x*(1+b*x)^-2, x) == :(a^x*b^-2*(1+b*x)^-1+a^(-1*b^-1)*b^-2*expintegralei(b^-1*(1+b*x)*log(a))+-1*a^(-1*b^-1)*b^-3*expintegralei(b^-1*(1+b*x)*log(a))*log(a))
@test integrate(x*(1+a*x)^-2*exp(a*x), x) == :(a^-2*(1+a*x)^-1*exp(a*x))
@test integrate(x*k^(x^2), x) == :((1/2)*k^(x^2)*log(k)^-1)
@test integrate(exp(x^2), x) == :((1/2)*pi^(1/2)*erfi(x))
@test integrate(x*exp(x^2), x) == :((1/2)*exp(x^2))
@test integrate(x^-4*(1+x)*exp(x^-1), x) == :(-1*exp(x^-1)+x^-1*exp(x^-1)+-1*x^-2*exp(x^-1))
@test integrate((1+-1*x*exp(x^2))^-2*(x+2*x^3)*exp(2*x^2)*exp(1+-1*x*exp(x^2)), x) == :(-1*(-1+x*exp(x^2))^-1*exp(1+-1*x*exp(x^2)))
@test integrate(exp(x)*log(x), x) == :(-1*expintegralei(x)+exp(x)*log(x))
@test integrate(x*exp(x)*log(x), x) == :(-1*exp(x)+-1*exp(x)*log(x)+x*exp(x)*log(x)+expintegralei(x))
@test integrate(exp(2x)*log(exp(x)), x) == :(-1//4*exp(2x)+(1/2)*exp(2x)*log(exp(x)))
@test integrate(2x+2^(1/2)*x^2, x) == :(x^2+1//3*2^(1/2)*x^3)
@test integrate((b+a*x)^-1//2*log(x), x) == :(-4*a^-1*(b+a*x)^(1/2)+2*a^-1*(b+a*x)^(1/2)*log(x)+4*a^-1*b^(1/2)*arctanh(b^-1//2*(b+a*x)^(1/2)))
@test integrate((a+b*x)^(1/2)*(c+d*x)^(1/2), x) == :((1/2)*b^-1*(a+b*x)^3//2*(c+d*x)^(1/2)+-1//4*b^-3//2*d^-3//2*(b*c+-1*a*d)^2*arctanh(b^-1//2*d^(1/2)*(a+b*x)^(1/2)*(c+d*x)^-1//2)+1//4*b^-1*d^-1*(a+b*x)^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d))
@test integrate((a+b*x)^(1/2), x) == :(2//3*b^-1*(a+b*x)^3//2)
@test integrate(x*(a+b*x)^(1/2), x) == :(2//5*b^-2*(a+b*x)^5//2+-2//3*a*b^-2*(a+b*x)^3//2)
@test integrate(x^2*(a+b*x)^(1/2), x) == :(2//7*b^-3*(a+b*x)^7//2+-4//5*a*b^-3*(a+b*x)^5//2+2//3*a^2*b^-3*(a+b*x)^3//2)
@test integrate(x^-1*(a+b*x)^(1/2), x) == :(2*(a+b*x)^(1/2)+-2*a^(1/2)*arctanh(a^-1//2*(a+b*x)^(1/2)))
@test integrate(x^-2*(a+b*x)^(1/2), x) == :(-1*x^-1*(a+b*x)^(1/2)+-1*b*a^-1//2*arctanh(a^-1//2*(a+b*x)^(1/2)))
@test integrate((a+b*x)^-1//2, x) == :(2*b^-1*(a+b*x)^(1/2))
@test integrate(x*(a+b*x)^-1//2, x) == :(2//3*b^-2*(a+b*x)^3//2+-2*a*b^-2*(a+b*x)^(1/2))
@test integrate(x^2*(a+b*x)^-1//2, x) == :(2//5*b^-3*(a+b*x)^5//2+2*a^2*b^-3*(a+b*x)^(1/2)+-4//3*a*b^-3*(a+b*x)^3//2)
@test integrate(x^-1*(a+b*x)^-1//2, x) == :(-2*a^-1//2*arctanh(a^-1//2*(a+b*x)^(1/2)))
@test integrate(x^-2*(a+b*x)^-1//2, x) == :(b*a^-3//2*arctanh(a^-1//2*(a+b*x)^(1/2))+-1*a^-1*x^-1*(a+b*x)^(1/2))
@test integrate((a+b*x)^((1/2)*p), x) == :(2*b^-1*(2+p)^-1*(a+b*x)^(1+(1/2)*p))
@test integrate(x*(a+b*x)^((1/2)*p), x) == :(2*b^-2*(4+p)^-1*(a+b*x)^(2+(1/2)*p)+-2*a*b^-2*(2+p)^-1*(a+b*x)^(1+(1/2)*p))
@test integrate(arctan((1/2)*2^(1/2)*(-1*2^(1/2)+2x)), x) == :((1/2)*2^(1/2)*arctan(1+-1*x*2^(1/2))+-1*x*arctan(1+-1*x*2^(1/2))+-1//4*2^(1/2)*log(1+x^2+-1*x*2^(1/2)))
@test integrate((-1+x^2)^-1//2, x) == :(arctanh(x*(-1+x^2)^-1//2))
@test integrate(x^(1/2)*(1+x)^(1/2), x) == :(-1//4*arcsinh(x^(1/2))+(1/2)*x^3//2*(1+x)^(1/2)+1//4*x^(1/2)*(1+x)^(1/2))
@test integrate(sin(x^(1/2)), x) == :(2*sin(x^(1/2))+-2*x^(1/2)*cos(x^(1/2)))
@test integrate(x*(1+-1*x^2)^-9//8, x) == :(4*(1+-1*x^2)^-1//8)
@test integrate(x*(1+-1*x^4)^-1//2, x) == :((1/2)*arcsin(x^2))
@test integrate(x^-1*(1+x^4)^-1//2, x) == :(-1//2*arctanh((1+x^4)^(1/2)))
@test integrate(x*(1+x^2+x^4)^-1//2, x) == :((1/2)*arcsinh(1//3*3^(1/2)*(1+2*x^2)))
@test integrate(x^-1*(-1+x^2+-1*x^4)^-1//2, x) == :(-1//2*arctan((1/2)*(-1+x^2+-1*x^4)^-1//2*(2+-1*x^2)))
@test integrate((1+x^2)^-1//2*(1+-1x)^-2*(1+x), x) == :((1+x^2)^(1/2)*(1+-1x)^-1)
@test integrate((1+x^2)^-1//2, x) == :(arcsinh(x))
@test integrate((1/2)*x^-1//2*(1+x)^-1//2*(2+x)^-1//2*(x^(1/2)*(1+x)^(1/2)+x^(1/2)*(2+x)^(1/2)+(1+x)^(1/2)*(2+x)^(1/2)), x) == :(x^(1/2)+(1+x)^(1/2)+(2+x)^(1/2))
@test integrate((1/2)*(1+x^3)^-1//2*(1+x^5+-2x)^-1//2*(-2*(1+x^3)^(1/2)+-3*x^2*(1+x^5+-2x)^(1/2)+5*x^4*(1+x^3)^(1/2)), x) == :((1+x^5+-2x)^(1/2)+-1*(1+x^3)^(1/2))
@test integrate((-1+x^2)^-1//2+10*(-4+x^2)^-1//2, x) == :(10*arctanh(x*(-4+x^2)^-1//2)+arctanh(x*(-1+x^2)^-1//2))
@test integrate(x^-1*(x+(a^2+x^2)^(1/2))^(1/2), x) == :(2*(x+(a^2+x^2)^(1/2))^(1/2)+-2*a^(1/2)*arctan(a^-1//2*(x+(a^2+x^2)^(1/2))^(1/2))+-2*a^(1/2)*arctanh(a^-1//2*(x+(a^2+x^2)^(1/2))^(1/2)))
@test integrate(3*x^2*(2+2*x^3+2*(1+x^3)^(1/2))^-1, x) == :(log(1+(1+x^3)^(1/2)))
@test integrate((-1*alpha^2+2*h*r^2)^-1//2, r) == :((1/2)*2^(1/2)*h^-1//2*arctanh(r*2^(1/2)*h^(1/2)*(-1*alpha^2+2*h*r^2)^-1//2))
@test integrate(r^-1*(-1*alpha^2+-1*epsilon^2+2*h*r^2)^-1//2, r) == :((alpha^2+epsilon^2)^-1//2*arctan((alpha^2+epsilon^2)^-1//2*(-1*alpha^2+-1*epsilon^2+2*h*r^2)^(1/2)))
@test integrate(r^-1*(-1*alpha^2+-2*k*r+2*h*r^2)^-1//2, r) == :(-1*alpha^-1*arctan(alpha^-1*(-1*alpha^2+-2*k*r+2*h*r^2)^-1//2*(alpha^2+k*r)))
@test integrate(r^-1*(-1*alpha^2+-1*epsilon^2+-2*k*r+2*h*r^2)^-1//2, r) == :(-1*(alpha^2+epsilon^2)^-1//2*arctan((alpha^2+epsilon^2)^-1//2*(-1*alpha^2+-1*epsilon^2+-2*k*r+2*h*r^2)^-1//2*(alpha^2+epsilon^2+k*r)))
@test integrate(r*(-1*alpha^2+2*e*r^2)^-1//2, r) == :((1/2)*e^-1*(-1*alpha^2+2*e*r^2)^(1/2))
@test integrate(r*(-1*alpha^2+-1*epsilon^2+2*e*r^2)^-1//2, r) == :((1/2)*e^-1*(-1*alpha^2+-1*epsilon^2+2*e*r^2)^(1/2))
@test integrate(r*(-1*alpha^2+-2*k*r^4+2*e*r^2)^-1//2, r) == :(-1//4*2^(1/2)*k^-1//2*arctan((1/2)*2^(1/2)*k^-1//2*(-1*alpha^2+-2*k*r^4+2*e*r^2)^-1//2*(e+-2*k*r^2)))
@test integrate(r*(-1*alpha^2+-2*k*r+2*e*r^2)^-1//2, r) == :((1/2)*e^-1*(-1*alpha^2+-2*k*r+2*e*r^2)^(1/2)+-1//4*k*2^(1/2)*e^-3//2*arctanh((1/2)*2^(1/2)*e^-1//2*(-1*alpha^2+-2*k*r+2*e*r^2)^-1//2*(k+-2*e*r)))
@test integrate(r^-1*(-1*alpha^2+-2*k*r^4+2*h*r^2)^-1//2, r) == :(-1//2*alpha^-1*arctan(alpha^-1*(-1*alpha^2+-2*k*r^4+2*h*r^2)^-1//2*(alpha^2+-1*h*r^2)))
@test integrate(r^-1*(-1*alpha^2+-1*epsilon^2+-2*k*r^4+2*h*r^2)^-1//2, r) == :(-1//2*(alpha^2+epsilon^2)^-1//2*arctan((alpha^2+epsilon^2)^-1//2*(-1*alpha^2+-1*epsilon^2+-2*k*r^4+2*h*r^2)^-1//2*(alpha^2+epsilon^2+-1*h*r^2)))
@test integrate(a*sin(5+3x)^2*cos(5+3x), x) == :(1//9*a*sin(5+3x)^3)
@test integrate(x^-3*log(x^2), x) == :(-1//2*x^-2+-1//2*x^-2*log(x^2))
@test integrate(x*sin(a+x), x) == :(-1*x*cos(a+x)+sin(a+x))
@test integrate(log(x)^-2*(-1+(1+-1x)*log(x))*exp(-1x), x) == :(x*log(x)^-1*exp(-1x))
@test integrate(x^3*(b+a*x^2)^-1, x) == :((1/2)*a^-1*x^2+-1//2*b*a^-2*log(b+a*x^2))
@test integrate(x^(1/2)*(1+x)^-7//2, x) == :(2//5*x^3//2*(1+x)^-5//2+4//15*x^3//2*(1+x)^-3//2)
@test integrate(x^-1*(1+x)^-1, x) == :(-1*log(1+x)+log(x))
@test integrate(x^-1//2*(-1+2x)^-1, x) == :(-1*2^(1/2)*arctanh(2^(1/2)*x^(1/2)))
@test integrate(x^(1/2)*(1+x^2), x) == :(2//3*x^3//2+2//7*x^7//2)
@test integrate(x^-1*(x+-1a)^1//3, x) == :(3*(x+-1a)^1//3+(1/2)*a^1//3*log(x)+-3//2*a^1//3*log(a^1//3+(x+-1a)^1//3)+3^(1/2)*a^1//3*arctan(1//3*3^(1/2)*a^-1//3*(a^1//3+-2*(x+-1a)^1//3)))
@test integrate(x*sinh(x), x) == :(-1*sinh(x)+x*cosh(x))
@test integrate(x*cosh(x), x) == :(-1*cosh(x)+x*sinh(x))
@test integrate(cosh(2x)^-1*sinh(2x), x) == :((1/2)*log(cosh(2x)))
@test integrate((-1x+im*a+im*eps*cosh(x))^-1*(-1+im*eps*sinh(x)), x) == :(log(a+im*x+eps*cosh(x)))
@test integrate(cos(x)^2*sin(3+2x), x) == :(-1//4*cos(3+2x)+-1//16*cos(3+4x)+1//4*x*sin(3))
@test integrate(x*arctan(x), x) == :((1/2)*arctan(x)+-1//2*x+(1/2)*x^2*arctan(x))
@test integrate(x*arccot(x), x) == :((1/2)*x+-1//2*arctan(x)+(1/2)*x^2*arccot(x))
@test integrate(x*log(a+x^2), x) == :(-1//2*x^2+((1/2)*a+(1/2)*x^2)*log(a+x^2))
@test integrate(cos(x)*sin(a+x), x) == :(-1//4*cos(a+2x)+(1/2)*x*sin(a))
@test integrate(cos(a+x)*sin(x), x) == :(-1//4*cos(a+2x)+-1//2*x*sin(a))
@test integrate((1+sin(x))^(1/2), x) == :(-2*(1+sin(x))^-1//2*cos(x))
@test integrate((1+-1*sin(x))^(1/2), x) == :(2*(1+-1*sin(x))^-1//2*cos(x))
@test integrate((1+cos(x))^(1/2), x) == :(2*(1+cos(x))^-1//2*sin(x))
@test integrate((1+-1*cos(x))^(1/2), x) == :(-2*(1+-1*cos(x))^-1//2*sin(x))
@test integrate((x^(1/2)+-1*(-1+x)^(1/2))^-1, x) == :(2//3*x^3//2+2//3*(-1+x)^3//2)
@test integrate((1+-1*(1+x)^(1/2))^-1, x) == :(-2*(1+x)^(1/2)+-2*log(1+-1*(1+x)^(1/2)))
@test integrate(x*(36+x^4)^-1//2, x) == :((1/2)*arcsinh(1//6*x^2))
@test integrate((x^(1/2)+x^1//3)^-1, x) == :(-6*log(1+x^1//6)+-3*x^1//3+2*x^(1/2)+6*x^1//6)
@test integrate(log(2+3*x^2), x) == :(-2x+x*log(2+3*x^2)+2//3*6^(1/2)*arctan((1/2)*x*6^(1/2)))
@test integrate(cot(x), x) == :(log(sin(x)))
@test integrate(cot(x)^4, x) == :(x+-1//3*cot(x)^3+cot(x))
@test integrate(tanh(x), x) == :(log(cosh(x)))
@test integrate(coth(x), x) == :(log(sinh(x)))
@test integrate(b^x, x) == :(b^x*log(b)^-1)
@test integrate((2+x^-4+x^4)^(1/2), x) == :(x^5*(3+3*x^4)^-1*(2+x^-4+x^4)^(1/2)+-1*x*(1+x^4)^-1*(2+x^-4+x^4)^(1/2))
@test integrate((2+3x)^-1*(1+2x), x) == :(-1//9*log(2+3x)+2//3*x)
@test integrate(x*log(x+(1+x^2)^(1/2)), x) == :(1//4*arcsinh(x)+(1/2)*x^2*log(x+(1+x^2)^(1/2))+-1//4*x*(1+x^2)^(1/2))
@test integrate(x*(1+exp(x)*sin(x))^2, x) == :((1/2)*x^2+-3//32*exp(2x)+cos(x)*exp(x)+-1//16*sin(x)^2*exp(2x)+-1//32*cos(2x)*exp(2x)+1//8*x*exp(2x)+1//32*exp(2x)*sin(2x)+x*exp(x)*sin(x)+-1*x*cos(x)*exp(x)+1//4*x*sin(x)^2*exp(2x)+1//16*cos(x)*exp(2x)*sin(x)+-1//4*x*cos(x)*exp(2x)*sin(x))
@test integrate(x*cos(x)*exp(x), x) == :(-1//2*exp(x)*sin(x)+(1/2)*x*cos(x)*exp(x)+(1/2)*x*exp(x)*sin(x))
@test integrate((-3+x)^-4, x) == :(1//3*(3+-1x)^-3)
@test integrate(x*(-1+x^3)^-1, x) == :(-1//6*log(1+x+x^2)+1//3*log(1+-1x)+1//3*3^(1/2)*arctan(1//3*3^(1/2)*(1+2x)))
@test integrate(x*(-1+x^4)^-1, x) == :(-1//2*arctanh(x^2))
@test integrate((2+x^4)^-1*(1+x^3)*log(x), x) == :((1//4+-1//8*(-2)^1//4)*Polylogarithms.polylog(2,-1//2*x*(-2)^3//4)+(1//4+1//8*(-2)^1//4)*Polylogarithms.polylog(2,(1/2)*x*(-2)^3//4)+(1//4+1//8*(-1)^3//4*2^1//4)*Polylogarithms.polylog(2,(1/2)*x*2^1//4*(1+im))+(1//4+1//16*2^3//4*(1+-1im))*Polylogarithms.polylog(2,-1//2*x*2^1//4*(1+im))+(1//4+-1//8*(-2)^1//4)*log(x)*log(1+(1/2)*x*(-2)^3//4)+(1//4+1//8*(-2)^1//4)*log(x)*log(1+-1//2*x*(-2)^3//4)+(1//4+1//8*(-1)^3//4*2^1//4)*log(x)*log(1+-1//2*x*2^1//4*(1+im))+(1//4+1//16*2^3//4*(1+-1im))*log(x)*log(1+(1/2)*x*2^1//4*(1+im)))
@test integrate(log(x)+log(1+x)+log(2+x), x) == :(-3x+x*log(x)+(1+x)*log(1+x)+(2+x)*log(2+x))
@test integrate((5+x^3)^-1, x) == :(-1//30*5^1//3*log(5^2//3+x^2+-1*x*5^1//3)+1//15*5^1//3*log(x+5^1//3)+-1//15*3^(1/2)*5^1//3*arctan(1//15*3^(1/2)*5^2//3*(5^1//3+-2x)))
@test integrate((1+x^2)^-1//2, x) == :(arcsinh(x))
@test integrate((3+x^2)^(1/2), x) == :(3//2*arcsinh(1//3*x*3^(1/2))+(1/2)*x*(3+x^2)^(1/2))
@test integrate(x*(1+x)^-2, x) == :((1+x)^-1+log(1+x))
@test integrate(arcsin(x), x) == :((1+-1*x^2)^(1/2)+x*arcsin(x))
@test integrate(x^2*arcsin(x), x) == :(-1//9*(1+-1*x^2)^3//2+1//3*(1+-1*x^2)^(1/2)+1//3*x^3*arcsin(x))
@test integrate((1+sec(x)^2+-3*tan(x))^-1*sec(x)^2, x) == :(-1*log(-1*sin(x)+cos(x))+log(-1*sin(x)+2*cos(x)))
@test integrate(sec(x)^-2, x) == :((1/2)*x+(1/2)*cos(x)*sin(x))
@test integrate(x^-2*(-2+x)^-1*(-2+-3x+5*x^2), x) == :(-1*x^-1+2*log(x)+3*log(2+-1x))
@test integrate((9+4*x^2)^-1//2, x) == :((1/2)*arcsinh(2//3*x))
@test integrate((4+x^2)^-1//2, x) == :(arcsinh((1/2)*x))
@test integrate((10+-12x+9*x^2)^-1, x) == :(-1//18*6^(1/2)*arctan(1//6*6^(1/2)*(2+-3x)))
@test integrate((x^4+x^8+-2*x^5+-2*x^7+2*x^6)^-1, x) == :((2+-2x)^-1+-1*x^-2+-2*x^-1+2*log(x)+-5//2*log(1+-1x)+-1//3*x^-3+1//4*log(1+x^2))
@test integrate(x^-1*(1+x)^-1*(-3+x)^-1*(d+a*x^3+b*x^2+c*x), x) == :(a*x+(1//4*c+1//12*d+3//4*b+9//4*a)*log(3+-1x)+-1*(-1//4*b+-1//4*d+1//4*a+1//4*c)*log(1+x)+-1//3*d*log(x))
@test integrate(x^-1*exp(x^2)+(x+log(x)^2)^-1*(1+x^-1+2*x^-1*log(x))+(x+log(x)^2)^-2*(-2+log(x))+2*x*exp(x^2)*log(x), x) == :(exp(x^2)*log(x)+-1*(x+log(x)^2)^-1*log(x)+log(x+log(x)^2))
@test integrate(x^4*sin(pi*z)^4*exp((1/2)*x+x*z), z) == :(x^5*(x^2+16*pi^2)^-1*sin(pi*z)^4*exp((1/2)*x+x*z)+24*pi^4*x^3*(x^4+64*pi^4+20*pi^2*x^2)^-1*exp((1/2)*x+x*z)+12*pi^2*x^5*(x^4+64*pi^4+20*pi^2*x^2)^-1*sin(pi*z)^2*exp((1/2)*x+x*z)+-24*pi^3*x^4*(x^4+64*pi^4+20*pi^2*x^2)^-1*cos(pi*z)*exp((1/2)*x+x*z)*sin(pi*z)+-4*pi*x^4*(x^2+16*pi^2)^-1*sin(pi*z)^3*cos(pi*z)*exp((1/2)*x+x*z))
@test integrate(erf(x), x) == :(x*erf(x)+pi^-1//2*exp(-1*x^2))
@test integrate(erf(a+x), x) == :(pi^-1//2*exp(-1*(a+x)^2)+(a+x)*erf(a+x))
@test integrate((-1+2*x^2)^-2*(1+x^4+2*x^2+4*x^3)^-1//2*(-8+-1*x^2+-8x+-3*x^3+2*x^6+4*x^5+7*x^4), x) == :(-1*arctanh(x*(2+31*x^3+37*x^2)^-1*(1+x^4+2*x^2+4*x^3)^-1//2*(2+x)*(7+-1x+27*x^2+33*x^3))+(-2+4*x^2)^-1*(1+x^4+2*x^2+4*x^3)^(1/2)*(1+2x))
@test integrate(y^-1*(1+y)^-1*(2+y)^-1*(1+-1y+-1*y^2)^-1//2*(1+-5y+-5*y^2)^(1/2)*(1+2y), y) == :(-1//2*arctanh((6+5y)^-1*(1+-1y+-1*y^2)^-1//2*(1+-5y+-5*y^2)^(1/2)*(4+3y))+-1//4*arctanh((1+-5y)^-1*(1+-1y+-1*y^2)^-1//2*(1+-5y+-5*y^2)^(1/2)*(1+-3y))+9//4*arctanh((21+15y)^-1*(1+-1y+-1*y^2)^-1//2*(1+-5y+-5*y^2)^(1/2)*(11+7y)))
@test integrate(x*(1+(-1+x^2)^(1/2)+(-4+x^2)^(1/2))^-1*(4+x^4+-5*x^2)^-1*(-1*(-4+x^2)^(1/2)+-4*(-1+x^2)^(1/2)+x^2*(-1+x^2)^(1/2)+x^2*(-4+x^2)^(1/2)), x) == :(log(1+(-1+x^2)^(1/2)+(-4+x^2)^(1/2)))
@test integrate(1//384*x^-2*(pi^2*(-3*mc^8+3*x^4+4*mc^9+-144*mc^5*x^2+-48*x*mc^7+-24*mc^2*x^3+12*mc*x^4+24*x*mc^6+176*mc^3*x^3)+12*pi^2*mc^3*x^2*(-12*mc^2+-8x+3mc)*log(x*mc^-2))*exp(-1*x*y^-1), x) == :(pi^2*mc^6*(1//16+-1//8*mc)*expintegralei(-1*x*y^-1)+-1*pi^2*y^3*(1//64+1//16*mc)*exp(-1*x*y^-1)+1//4*pi^2*mc^3*y^2*exp(-1*x*y^-1)+3//8*y*pi^2*mc^5*exp(-1*x*y^-1)+pi^2*mc^2*y^2*(1//16+-11//24*mc)*exp(-1*x*y^-1)+-1*x*pi^2*y^2*(1//64+1//16*mc)*exp(-1*x*y^-1)+-1*y*pi^2*x^2*(1//128+1//32*mc)*exp(-1*x*y^-1)+1//4*pi^2*mc^3*y^2*exp(-1*x*y^-1)*log(x*mc^-2)+1//32*y*pi^2*mc^3*(-12*mc^2+-8y+3mc)*expintegralei(-1*x*y^-1)+1//384*pi^2*mc^8*x^-1*(3+-4mc)*exp(-1*x*y^-1)+1//384*pi^2*mc^8*y^-1*(3+-4mc)*expintegralei(-1*x*y^-1)+x*y*pi^2*mc^2*(1//16+-11//24*mc)*exp(-1*x*y^-1)+-1//32*y*pi^2*mc^3*(-8x+mc*(3+-12mc))*exp(-1*x*y^-1)*log(x*mc^-2))
@test integrate(cos(x)^-1*sin(2x), x) == :(-2*cos(x))
@test integrate((1+x^14+-1*x^2+-4*x^3+-2*x^4+-2*x^7+-2*x^8+2x)^-1*(3+-7*x^6+-4*x^2+-4*x^3+3x+4*x^7+7*x^13+10*x^8), x) == :((1/2)*(1+2^(1/2))*log(1+x+-1*x^7+x*2^(1/2)+2^(1/2)*x^2)+-1//2*(-1+2^(1/2))*log(-1+x^7+x*(-1+2^(1/2))+2^(1/2)*x^2))

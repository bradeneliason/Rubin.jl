using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(cot(x)^4, x) == :(x+-1//3*cot(x)^3+cot(x))
@test integrate(x^-4*(1+x^2)^-1, x) == :(x^-1+-1//3*x^-3+arctan(x))
@test integrate(x^-1//2*(x+x^2), x) == :(2//3*x^3//2+2//5*x^5//2)
@test integrate(cos(x), x) == :(sin(x))
@test integrate(x*exp(x^2), x) == :((1/2)*exp(x^2))
@test integrate(sec(x)^2*tan(x), x) == :((1/2)*sec(x)^2)
@test integrate(x*(1+x^2)^(1/2), x) == :(1//3*(1+x^2)^3//2)
@test integrate(exp(x)*sin(x), x) == :((1/2)*exp(x)*sin(x)+-1//2*cos(x)*exp(x))
@test integrate(csc(x)^2*sin(x)^-2*cos(x), x) == :(-1//3*csc(x)^3)
@test integrate(sin(exp(x)), x) == :(sinintegral(exp(x)))
@test integrate(y^-1*sin(y), y) == :(sinintegral(y))
@test integrate(exp(x)+sin(x), x) == :(-1*cos(x)+exp(x))
@test integrate(2*x^2*exp(x^2)+exp(x^2), x) == :(x*exp(x^2))
@test integrate((x+exp(x))^2, x) == :((1/2)*exp(2x)+-2*exp(x)+1//3*x^3+2*x*exp(x))
@test integrate(x^2+2*exp(x)+exp(2x), x) == :((1/2)*exp(2x)+2*exp(x)+1//3*x^3)
@test integrate(cos(x)*sin(x), x) == :((1/2)*sin(x)^2)
@test integrate(x*exp(x^2), x) == :((1/2)*exp(x^2))
@test integrate(x*(1+x^2)^(1/2), x) == :(1//3*(1+x^2)^3//2)
@test integrate((1+exp(x))^-1*exp(x), x) == :(log(1+exp(x)))
@test integrate(x^3//2, x) == :(2//5*x^5//2)
@test integrate(cos(3+2x), x) == :((1/2)*sin(3+2x))
@test integrate(2*y*z*exp(2x), x) == :(y*z*exp(2x))
@test integrate(cos(exp(x))^2*exp(x)*sin(exp(x)), x) == :(-1//3*cos(exp(x))^3)
@test integrate(x*(1+x)^(1/2), x) == :(-2//3*(1+x)^3//2+2//5*(1+x)^5//2)
@test integrate((-1+x^4)^-1, x) == :(-1//2*arctan(x)+-1//2*arctanh(x))
@test integrate((2+3*exp(2x))^-1*exp(x), x) == :(1//6*6^(1/2)*arctan((1/2)*6^(1/2)*exp(x)))
@test integrate((A+B*exp(4x))^-1*exp(2x), x) == :((1/2)*A^-1//2*B^-1//2*arctan(A^-1//2*B^(1/2)*exp(2x)))
@test integrate((1+exp(x))^-1*exp(1+x), x) == :(ℯ*log(1+exp(x)))
@test integrate(10^x*exp(x), x) == :((10ℯ)^x*(1+log(10))^-1)
@test integrate(x^3*sin(x^2), x) == :((1/2)*sin(x^2)+-1//2*x^2*cos(x^2))
@test integrate(x^7*(1+x^12)^-1, x) == :(-1//12*log(1+x^4)+1//24*log(1+x^8+-1*x^4)+-1//12*3^(1/2)*arctan(1//3*3^(1/2)*(1+-2*x^4)))
@test integrate(x^(3a)*sin(x^(2a)), x) == :(-1//4*im*a^-1*x^(1+3a)*(im*x^(2a))^(-1//2*a^-1*(1+3a))*SpecialFunctions.gamma(3//2+(1/2)*a^-1,im*x^(2a))+1//4*im*a^-1*x^(1+3a)*(-1*im*x^(2a))^(-1//2*a^-1*(1+3a))*SpecialFunctions.gamma(3//2+(1/2)*a^-1,-1*im*x^(2a)))
@test integrate(cos(x^(1/2)), x) == :(2*cos(x^(1/2))+2*x^(1/2)*sin(x^(1/2)))
@test integrate(x*(1+x)^(1/2), x) == :(-2//3*(1+x)^3//2+2//5*(1+x)^5//2)
@test integrate((x^(1/2)+x^1//3)^-1, x) == :(-6*log(1+x^1//6)+-3*x^1//3+2*x^(1/2)+6*x^1//6)
@test integrate(((3+2x)^-1*(1+x))^(1/2), x) == :((1/2)*(1+x)^(1/2)*(3+2x)^(1/2)+-1//4*2^(1/2)*arcsinh(2^(1/2)*(1+x)^(1/2)))
@test integrate(x^4*(1+-1*x^2)^-5//2, x) == :(-1*x*(1+-1*x^2)^-1//2+1//3*x^3*(1+-1*x^2)^-3//2+arcsin(x))
@test integrate(x^(1/2)*(1+x)^5//2, x) == :(-5//64*arcsinh(x^(1/2))+1//4*x^3//2*(1+x)^5//2+5//24*x^3//2*(1+x)^3//2+5//32*x^3//2*(1+x)^(1/2)+5//64*x^(1/2)*(1+x)^(1/2))
@test integrate(x^4*(1+-1*x^2)^-5//2, x) == :(-1*x*(1+-1*x^2)^-1//2+1//3*x^3*(1+-1*x^2)^-3//2+arcsin(x))
@test integrate((1+-1*y^2)^-1*(A^2+B^2+-1*B^2*y^2)^(1/2), y) == :(A*arctanh(A*y*(A^2+B^2+-1*B^2*y^2)^-1//2)+B*arctan(B*y*(A^2+B^2+-1*B^2*y^2)^-1//2))
@test integrate(sin(x)^2, x) == :((1/2)*x+-1//2*cos(x)*sin(x))
@test integrate((1+cos(x))^-1, x) == :((1+cos(x))^-1*sin(x))
@test integrate(x*exp(x), x) == :(-1*exp(x)+x*exp(x))
@test integrate(x*(1+x)^-2*exp(x), x) == :((1+x)^-1*exp(x))
@test integrate((1+2*x^2)*exp(x^2), x) == :(x*exp(x^2))
@test integrate(exp(x^2), x) == :((1/2)*pi^(1/2)*erfi(x))
@test integrate(x^-1*exp(x), x) == :(expintegralei(x))
@test integrate(x*(1+x^3)^-1, x) == :(-1//3*log(1+x)+1//6*log(1+x^2+-1x)+-1//3*3^(1/2)*arctan(1//3*3^(1/2)*(1+-2x)))
@test integrate((A^4+x^2*(B^2+-1*A^2)+-1*A^2*B^2)^-1, x) == :(A^-1*(A^2+-1*B^2)^-1*arctanh(x*A^-1))
@test integrate(x*log(x), x) == :(-1//4*x^2+(1/2)*x^2*log(x))
@test integrate(x^2*arcsin(x), x) == :(-1//9*(1+-1*x^2)^3//2+1//3*(1+-1*x^2)^(1/2)+1//3*x^3*arcsin(x))
@test integrate((1+x^2+2x)^-1, x) == :(-1*(1+x)^-1)
@test integrate((1+log(x))^-2*log(x), x) == :(x*(1+log(x))^-1)
@test integrate(x^-1*(1+log(x)^2)^-1, x) == :(arctan(log(x)))
@test integrate(log(x)^-1, x) == :(logintegral(x))
@test integrate(x*(cos(x)+sin(x)), x) == :(x*sin(x)+-1*x*cos(x)+cos(x)+sin(x))
@test integrate((x+exp(x))*exp(-1x), x) == :(x+-1*exp(-1x)+-1*x*exp(-1x))
@test integrate(x*(1+exp(x))^2, x) == :((1/2)*x^2+-2*exp(x)+-1//4*exp(2x)+(1/2)*x*exp(2x)+2*x*exp(x))
@test integrate(x*cos(x), x) == :(x*sin(x)+cos(x))
@test integrate(cos(x^(1/2)), x) == :(2*cos(x^(1/2))+2*x^(1/2)*sin(x^(1/2)))
@test integrate(x*cos(x), x) == :(x*sin(x)+cos(x))
@test integrate(x*log(x)^2, x) == :(1//4*x^2+(1/2)*x^2*log(x)^2+-1//2*x^2*log(x))
@test integrate((1+sin(x)^3)*cos(x), x) == :(1//4*sin(x)^4+sin(x))
@test integrate(x^-1*(1+log(x)^2)^-1, x) == :(arctan(log(x)))
@test integrate((1+arcsin(x)^2)^-1*(1+-1*x^2)^-1//2, x) == :(arctan(arcsin(x)))
@test integrate((cos(x)+sin(x))^-1*sin(x), x) == :((1/2)*x+-1//2*log(cos(x)+sin(x)))
@test integrate(-1*(1+-1*y^2)^-1*(A^2+B^2*(1+-1*y^2))^(1/2), y) == :(-1*A*arctanh(A*y*(A^2+B^2+-1*B^2*y^2)^-1//2)+-1*B*arctan(B*y*(A^2+B^2+-1*B^2*y^2)^-1//2))
@test integrate(B^-1*(1+-1*B^-2*sin(z)^2*(A^2+B^2))^-1*cos(z)^2*(-1*A^2+-1*B^2), z) == :(-1*A*arctanh(A*B^-1*tan(z))+-1*B*z)
@test integrate(B^-1*(1+w^2)^-2*(1+-1*B^-2*w^2*(1+w^2)^-1*(A^2+B^2))^-1*(-1*A^2+-1*B^2), w) == :(-1*A*arctanh(A*w*B^-1)+-1*B*arctan(w))
@test integrate(-1*B*(1+w^2)^-1*(B^2+-1*A^2*w^2)^-1*(A^2+B^2), w) == :(-1*A*arctanh(A*w*B^-1)+-1*B*arctan(w))
@test integrate(x^4*(1+-1*x^2)^-5//2, x) == :(-1*x*(1+-1*x^2)^-1//2+1//3*x^3*(1+-1*x^2)^-3//2+arcsin(x))
@test integrate(cos(y)^-4*sin(y)^4, y) == :(y+-1*tan(y)+1//3*tan(y)^3)
@test integrate(z^4*(1+z^2)^-1, z) == :(-1z+1//3*z^3+arctan(z))
@test integrate((1+2*x^2)*exp(x^2), x) == :(x*exp(x^2))
@test integrate((1+x^2)^-2*(1+x^3+2*x^6+4*x^2+5*x^4)*exp(x^2), x) == :(x*exp(x^2)+(2+2*x^2)^-1*exp(x^2))
@test integrate(exp(-1)*exp(-1x), x) == :(-1*exp(-1+-1x))
@test integrate((x+x^-1)*log(x), x) == :((1/2)*log(x)^2+-1//4*x^2+(1/2)*x^2*log(x))
@test integrate(x*(1+x^4)^-1, x) == :((1/2)*arctan(x^2))
@test integrate(x^5*(1+x^4)^-1, x) == :((1/2)*x^2+-1//2*arctan(x^2))
@test integrate((1+tan(x)^2)^-1, x) == :((1/2)*x+(1/2)*cos(x)*sin(x))
@test integrate(x^4*(1+-1*x^2)^-5//2, x) == :(-1*x*(1+-1*x^2)^-1//2+1//3*x^3*(1+-1*x^2)^-3//2+arcsin(x))
@test integrate(-1*x^2*(1+-1*x^2)^-3//2, x) == :(-1*x*(1+-1*x^2)^-1//2+arcsin(x))
@test integrate(exp(x)*sin(x), x) == :((1/2)*exp(x)*sin(x)+-1//2*cos(x)*exp(x))
@test integrate(x^-1, x) == :(log(x))
@test integrate((1+sec(t)^2+3*tan(t))^-1*sec(2t), t) == :(-1*(2+2*tan(t))^-1+-1//4*log(cos(t)+sin(t))+-1//12*log(-1*sin(t)+cos(t))+1//3*log(2*cos(t)+sin(t)))
@test integrate(sec(x)^-2, x) == :((1/2)*x+(1/2)*cos(x)*sin(x))
@test integrate(x^-1//2*(1+x^2), x) == :(2*x^(1/2)+2//5*x^5//2)
@test integrate(x*(5+x^2+2x)^-1//2, x) == :((5+x^2+2x)^(1/2)+-1*arcsinh(1/2+(1/2)*x))
@test integrate(sin(x)^2*cos(x), x) == :(1//3*sin(x)^3)
@test integrate((1+exp(x))^-1*exp(x), x) == :(log(1+exp(x)))
@test integrate((1+exp(x))^-1*exp(2x), x) == :(-1*log(1+exp(x))+exp(x))
@test integrate((1+-1*cos(x))^-1, x) == :(-1*(1+-1*cos(x))^-1*sin(x))
@test integrate(sec(x)^2*tan(x), x) == :((1/2)*sec(x)^2)
@test integrate(x*log(x), x) == :(-1//4*x^2+(1/2)*x^2*log(x))
@test integrate(cos(x)*sin(x), x) == :((1/2)*sin(x)^2)
@test integrate((-1*x^2+2x)^-1//2*(1+x), x) == :(-1*(-1*x^2+2x)^(1/2)+-2*arcsin(1+-1x))
@test integrate(2*(2+3*exp(2x))^-1*exp(x), x) == :(1//3*6^(1/2)*arctan((1/2)*6^(1/2)*exp(x)))
@test integrate(x^4*(1+-1*x^2)^-5//2, x) == :(-1*x*(1+-1*x^2)^-1//2+1//3*x^3*(1+-1*x^2)^-3//2+arcsin(x))
@test integrate((1+exp(4x))^-1*exp(6x), x) == :((1/2)*exp(2x)+-1//2*arctan(exp(2x)))
@test integrate(log(2+3*x^2), x) == :(-2x+x*log(2+3*x^2)+2//3*6^(1/2)*arctan((1/2)*x*6^(1/2)))
@test integrate(r^-1*(-1*a^2+2*H*r^2)^-1//2, x) == :(x*r^-1*(-1*a^2+2*H*r^2)^-1//2)
@test integrate(r^-1*(-1*a^2+-1*e^2+2*H*r^2)^-1//2, x) == :(x*r^-1*(-1*a^2+-1*e^2+2*H*r^2)^-1//2)
@test integrate(r^-1*(-1*a^2+-2*K*r^4+2*H*r^2)^-1//2, x) == :(x*r^-1*(-1*a^2+-2*K*r^4+2*H*r^2)^-1//2)
@test integrate(r^-1*(-1*a^2+-1*e^2+-2*K*r^4+2*H*r^2)^-1//2, x) == :(x*r^-1*(-1*a^2+-1*e^2+-2*K*r^4+2*H*r^2)^-1//2)
@test integrate(r^-1*(-1*a^2+-2*K*r+2*H*r^2)^-1//2, x) == :(x*r^-1*(-1*a^2+-2*r*(K+-1*H*r))^-1//2)
@test integrate(r*(-1*a^2+2*ℯ*r^2)^-1//2, x) == :(r*x*(-1*a^2+2*ℯ*r^2)^-1//2)
@test integrate(r*(-1*a^2+-1*e^2+2*ℯ*r^2)^-1//2, x) == :(r*x*(-1*a^2+-1*e^2+2*ℯ*r^2)^-1//2)
@test integrate(r*(-1*a^2+-2*K*r^4+2*ℯ*r^2)^-1//2, x) == :(r*x*(-1*a^2+-2*K*r^4+2*ℯ*r^2)^-1//2)
@test integrate(r*(-1*a^2+-1*e^2+-2*K*r^4+2*ℯ*r^2)^-1//2, x) == :(r*x*(-1*a^2+-1*e^2+-2*K*r^4+2*ℯ*r^2)^-1//2)

using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(x*(1+-1*x^2)^-1//2*arcsin(x), x) == :(x+-1*(1+-1*x^2)^(1/2)*arcsin(x))
@test integrate(arcsin((1+x)^(1/2)+-1*x^(1/2)), x) == :(-1*(3//8+x)*arcsin(x^(1/2)+-1*(1+x)^(1/2))+1//8*2^(1/2)*(-1x+x^(1/2)*(1+x)^(1/2))^(1/2)*(x^(1/2)+3*(1+x)^(1/2)))
@test integrate(log(1+x*(1+x^2)^(1/2)), x) == :(-2x+x*log(1+x*(1+x^2)^(1/2))+(2+2*5^(1/2))^(1/2)*arctan((-2+5^(1/2))^(1/2)*(x+(1+x^2)^(1/2)))+-1*(-2+2*5^(1/2))^(1/2)*arctanh((2+5^(1/2))^(1/2)*(x+(1+x^2)^(1/2))))
@test integrate((1+cos(x)^2+cos(x)^4)^-1//2*cos(x)^2, x) == :(1//3*x+1//3*arctan((1+(1+cos(x)^2+cos(x)^4)^(1/2)*cos(x)^2)^-1*(1+cos(x)^2)*cos(x)*sin(x)))
@test integrate((1+tan(x)^4)^(1/2)*tan(x), x) == :((1/2)*(1+tan(x)^4)^(1/2)+-1//2*arcsinh(tan(x)^2)+-1//2*2^(1/2)*arctanh((1/2)*2^(1/2)*(1+tan(x)^4)^-1//2*(1+-1*tan(x)^2)))
@test integrate((1+sec(x)^3)^-1//2*tan(x), x) == :(-2//3*arctanh((1+sec(x)^3)^(1/2)))
@test integrate((2+tan(x)^2+2*tan(x))^(1/2), x) == :(-1*(1/2+(1/2)*5^(1/2))^(1/2)*arctan((10+10*5^(1/2))^-1//2*(2+tan(x)^2+2*tan(x))^-1//2*(2*5^(1/2)+-1*(5+5^(1/2))*tan(x)))+-1*(-1//2+(1/2)*5^(1/2))^(1/2)*arctanh((-10+10*5^(1/2))^-1//2*(2+tan(x)^2+2*tan(x))^-1//2*(2*5^(1/2)+(5+-1*5^(1/2))*tan(x)))+arcsinh(1+tan(x)))
@test integrate(arctan((-1+sec(x))^(1/2))*sin(x), x) == :((1/2)*arctan((-1+sec(x))^(1/2))+(1/2)*(-1+sec(x))^(1/2)*cos(x)+-1*arctan((-1+sec(x))^(1/2))*cos(x))
@test integrate(x*(1+x^2)^-1//2*log(1+x^2)*log(x+(1+x^2)^(1/2)), x) == :(-2*arctan(x)+4x+-1*x*log(1+x^2)+-2*(1+x^2)^(1/2)*log(x+(1+x^2)^(1/2))+(1+x^2)^(1/2)*log(1+x^2)*log(x+(1+x^2)^(1/2)))
@test integrate(arctan(x+(1+-1*x^2)^(1/2)), x) == :(-1//2*arcsin(x)+-1//4*arctanh(x*(1+-1*x^2)^(1/2))+-1//8*log(1+x^4+-1*x^2)+x*arctan(x+(1+-1*x^2)^(1/2))+-1//4*3^(1/2)*arctan(1//3*3^(1/2)*(-1+2*x^2))+1//4*3^(1/2)*arctan((1+-1*x^2)^-1//2*(1+x*3^(1/2)))+1//4*3^(1/2)*arctan((1+-1*x^2)^-1//2*(-1+x*3^(1/2))))
@test integrate(x*(1+-1*x^2)^-1//2*arctan(x+(1+-1*x^2)^(1/2)), x) == :(-1//2*arcsin(x)+1//4*arctanh(x*(1+-1*x^2)^(1/2))+1//8*log(1+x^4+-1*x^2)+-1*(1+-1*x^2)^(1/2)*arctan(x+(1+-1*x^2)^(1/2))+-1//4*3^(1/2)*arctan(1//3*3^(1/2)*(-1+2*x^2))+1//4*3^(1/2)*arctan((1+-1*x^2)^-1//2*(1+x*3^(1/2)))+1//4*3^(1/2)*arctan((1+-1*x^2)^-1//2*(-1+x*3^(1/2))))
@test integrate((1+-1*x^2)^-3//2*log(x+(1+x^2)^(1/2)), x) == :(-1//2*arcsin(x^2)+x*(1+-1*x^2)^-1//2*log(x+(1+x^2)^(1/2)))
@test integrate((1+x^2)^-3//2*arcsin(x), x) == :(-1//2*arcsin(x^2)+x*(1+x^2)^-1//2*arcsin(x))
@test integrate((1+x^2)^-3//2*log(x+(-1+x^2)^(1/2)), x) == :(-1//2*arccosh(x^2)+x*(1+x^2)^-1//2*log(x+(-1+x^2)^(1/2)))
@test integrate(x^-2*(-1+x^2)^-1//2*log(x), x) == :(-1*arctanh(x*(-1+x^2)^-1//2)+x^-1*(-1+x^2)^(1/2)+x^-1*(-1+x^2)^(1/2)*log(x))
@test integrate(x^-1*(1+x^3)^(1/2), x) == :(-2//3*arctanh((1+x^3)^(1/2))+2//3*(1+x^3)^(1/2))
@test integrate(x*(-1+x^2)^-1//2*log(x+(-1+x^2)^(1/2)), x) == :(-1x+(-1+x^2)^(1/2)*log(x+(-1+x^2)^(1/2)))
@test integrate(x^3*(1+-1*x^4)^-1//2*arcsin(x), x) == :(1//4*arcsinh(x)+-1//2*(1+-1*x^4)^(1/2)*arcsin(x)+1//4*x*(1+x^2)^(1/2))
@test integrate(x*(1+x^2)^-1//2*arctan(x)*log(x+(1+x^2)^(1/2)), x) == :((1/2)*log(1+x^2)+-1//2*log(x+(1+x^2)^(1/2))^2+-1*x*arctan(x)+(1+x^2)^(1/2)*arctan(x)*log(x+(1+x^2)^(1/2)))
@test integrate(x*(1+-1*x^2)^-1//2*log(1+(1+-1*x^2)^(1/2)), x) == :((1+-1*x^2)^(1/2)+-1*log(1+(1+-1*x^2)^(1/2))+-1*(1+-1*x^2)^(1/2)*log(1+(1+-1*x^2)^(1/2)))
@test integrate(x*(1+x^2)^-1//2*log(x+(1+x^2)^(1/2)), x) == :(-1x+(1+x^2)^(1/2)*log(x+(1+x^2)^(1/2)))
@test integrate(x*(1+-1*x^2)^-1//2*log(x+(1+-1*x^2)^(1/2)), x) == :((1+-1*x^2)^(1/2)+(1/2)*2^(1/2)*arctanh(x*2^(1/2))+-1*(1+-1*x^2)^(1/2)*log(x+(1+-1*x^2)^(1/2))+-1//2*2^(1/2)*arctanh(2^(1/2)*(1+-1*x^2)^(1/2)))
@test integrate(x^-2*(1+-1*x^2)^-1//2*log(x), x) == :(-1*arcsin(x)+-1*x^-1*(1+-1*x^2)^(1/2)+-1*x^-1*(1+-1*x^2)^(1/2)*log(x))
@test integrate(x*(1+x^2)^-1//2*arctan(x), x) == :(-1*arcsinh(x)+(1+x^2)^(1/2)*arctan(x))
@test integrate(x^-2*(1+-1*x^2)^-1//2*arctan(x), x) == :(-1*arctanh((1+-1*x^2)^(1/2))+2^(1/2)*arctanh((1/2)*2^(1/2)*(1+-1*x^2)^(1/2))+-1*x^-1*(1+-1*x^2)^(1/2)*arctan(x))
@test integrate(x*(1+-1*x^2)^-1//2*arctan(x), x) == :(-1*arcsin(x)+2^(1/2)*arctan(x*2^(1/2)*(1+-1*x^2)^-1//2)+-1*(1+-1*x^2)^(1/2)*arctan(x))
@test integrate(x^-2*(1+x^2)^-1//2*arctan(x), x) == :(-1*arctanh((1+x^2)^(1/2))+-1*x^-1*(1+x^2)^(1/2)*arctan(x))
@test integrate(x^-2*(1+-1*x^2)^-1//2*arcsin(x), x) == :(-1*x^-1*(1+-1*x^2)^(1/2)*arcsin(x)+log(x))
@test integrate(x*(-1+x^2)^-1//2*log(x), x) == :(-1*(-1+x^2)^(1/2)+(-1+x^2)^(1/2)*log(x)+arctan((-1+x^2)^(1/2)))
@test integrate(x^-2*(1+x^2)^-1//2*log(x), x) == :(-1*x^-1*(1+x^2)^(1/2)+-1*x^-1*(1+x^2)^(1/2)*log(x)+arcsinh(x))
@test integrate(x*(-1+x^2)^-1//2*arcsec(x), x) == :((-1+x^2)^(1/2)*arcsec(x)+-1*x*(x^2)^-1//2*log(x))
@test integrate(x*(1+x^2)^-1//2*log(x), x) == :(-1*(1+x^2)^(1/2)+(1+x^2)^(1/2)*log(x)+arctanh((1+x^2)^(1/2)))
@test integrate((1+sin(x)^2)^-1*sin(x), x) == :(-1//2*2^(1/2)*arctanh((1/2)*2^(1/2)*cos(x)))
@test integrate((1+x^4)^-1//2*(1+-1*x^2)^-1*(1+x^2), x) == :((1/2)*2^(1/2)*arctanh(x*2^(1/2)*(1+x^4)^-1//2))
@test integrate((1+x^2)^-1*(1+x^4)^-1//2*(1+-1*x^2), x) == :((1/2)*2^(1/2)*arctan(x*2^(1/2)*(1+x^4)^-1//2))
@test integrate((1+sin(x))^-1*log(sin(x)), x) == :(-1x+-1*arctanh(cos(x))+-1*(1+sin(x))^-1*cos(x)*log(sin(x)))
@test integrate((1+sin(x))^(1/2)*log(sin(x)), x) == :(-4*arctanh((1+sin(x))^-1//2*cos(x))+4*(1+sin(x))^-1//2*cos(x)+-2*(1+sin(x))^-1//2*cos(x)*log(sin(x)))
@test integrate((-1+sec(x)^4)^-1//2*sec(x), x) == :(-1//2*2^(1/2)*arctanh((1/2)*2^(1/2)*(-1+sec(x)^4)^(1/2)*cos(x)*cot(x)))
@test integrate((1+tan(x)^4)^-1//2*tan(x), x) == :(-1//4*2^(1/2)*arctanh((1/2)*2^(1/2)*(1+tan(x)^4)^-1//2*(1+-1*tan(x)^2)))
@test integrate(((1+sec(x))^(1/2)+-1*(-1+sec(x))^(1/2))^(1/2), x) == :(2^(1/2)*(1+sec(x))^(1/2)*(-1+sec(x))^(1/2)*((-1+2^(1/2))^(1/2)*arctan((1/2)*(-2+2*2^(1/2))^(1/2)*((1+sec(x))^(1/2)+-1*(-1+sec(x))^(1/2))^-1//2*((1+sec(x))^(1/2)+-1*2^(1/2)+-1*(-1+sec(x))^(1/2)))+(-1+2^(1/2))^(1/2)*arctanh((2+2*2^(1/2))^(1/2)*((1+sec(x))^(1/2)+-1*(-1+sec(x))^(1/2))^(1/2)*(2^(1/2)+(1+sec(x))^(1/2)+-1*(-1+sec(x))^(1/2))^-1)+-1*(1+2^(1/2))^(1/2)*arctan((1/2)*(2+2*2^(1/2))^(1/2)*((1+sec(x))^(1/2)+-1*(-1+sec(x))^(1/2))^-1//2*((1+sec(x))^(1/2)+-1*2^(1/2)+-1*(-1+sec(x))^(1/2)))+-1*(1+2^(1/2))^(1/2)*arctanh((-2+2*2^(1/2))^(1/2)*((1+sec(x))^(1/2)+-1*(-1+sec(x))^(1/2))^(1/2)*(2^(1/2)+(1+sec(x))^(1/2)+-1*(-1+sec(x))^(1/2))^-1))*cot(x))
@test integrate(x*arctan(x)^2*log(1+x^2), x) == :(-3//2*arctan(x)^2+-3//2*log(1+x^2)+1//4*log(1+x^2)^2+3*x*arctan(x)+-1//2*x^2*arctan(x)^2+arctan(x)^2*(1/2+(1/2)*x^2)*log(1+x^2)+-1*x*arctan(x)*log(1+x^2))
@test integrate(arctan(x*(1+x^2)^(1/2)), x) == :((1/2)*arctan(3^(1/2)+-2*(1+x^2)^(1/2))+-1//2*arctan(3^(1/2)+2*(1+x^2)^(1/2))+x*arctan(x*(1+x^2)^(1/2))+-1//4*3^(1/2)*log(2+x^2+-1*3^(1/2)*(1+x^2)^(1/2))+1//4*3^(1/2)*log(2+x^2+3^(1/2)*(1+x^2)^(1/2)))
@test integrate(arcsin(x*(1+-1*x^2)^-1//2), x) == :(x*arcsin(x*(1+-1*x^2)^-1//2)+arctan((1+-2*x^2)^(1/2)))

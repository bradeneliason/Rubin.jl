using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((d+e*x)^4*(a+b*arctan(c*x)), x) == :(1//5*e^-1*(d+e*x)^5*(a+b*arctan(c*x))+-1//10*b*c^-5*(e^4+5*c^4*d^4+-10*c^2*d^2*e^2)*log(1+c^2*x^2)+-1//20*b*c^-1*e^4*x^4+-1//3*b*d*c^-1*e^3*x^3+-1//10*b*c^-3*e^2*x^2*(-1*e^2+10*c^2*d^2)+-1*b*d*e*x*c^-3*(-1*e^2+2*c^2*d^2)+-1//5*b*d*c^-4*e^-1*(5*e^4+c^4*d^4+-10*c^2*d^2*e^2)*arctan(c*x))
@test integrate((d+e*x)^3*(a+b*arctan(c*x)), x) == :(1//4*e^-1*(d+e*x)^4*(a+b*arctan(c*x))+-1//12*b*c^-1*e^3*x^3+-1//2*b*d*c^-1*e^2*x^2+-1//4*b*e*x*c^-3*(-1*e^2+6*c^2*d^2)+-1//4*b*c^-4*e^-1*(e^4+c^4*d^4+-6*c^2*d^2*e^2)*arctan(c*x)+-1//2*b*d*c^-3*(e+c*d)*(-1*e+c*d)*log(1+c^2*x^2))
@test integrate((d+e*x)^2*(a+b*arctan(c*x)), x) == :(1//3*e^-1*(d+e*x)^3*(a+b*arctan(c*x))+-1//6*b*c^-1*e^2*x^2+-1//6*b*c^-3*(-1*e^2+3*c^2*d^2)*log(1+c^2*x^2)+-1*b*d*e*x*c^-1+-1//3*b*d*e^-1*(d^2+-3*c^-2*e^2)*arctan(c*x))
@test integrate((a+b*arctan(c*x))*(d+e*x), x) == :((1/2)*e^-1*(d+e*x)^2*(a+b*arctan(c*x))+-1//2*b*d*c^-1*log(1+c^2*x^2)+-1//2*b*e*x*c^-1+-1//2*b*e^-1*(d^2+-1*c^-2*e^2)*arctan(c*x))
@test integrate((d+e*x)^-1*(a+b*arctan(c*x)), x) == :(e^-1*(a+b*arctan(c*x))*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-1*e^-1*(a+b*arctan(c*x))*log(2*(1+-1*im*c*x)^-1)+(1/2)*im*b*e^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1)+-1//2*im*b*e^-1*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x)))
@test integrate((d+e*x)^-2*(a+b*arctan(c*x)), x) == :(-1*e^-1*(d+e*x)^-1*(a+b*arctan(c*x))+b*c*(e^2+c^2*d^2)^-1*log(d+e*x)+-1*b*c*(2*e^2+2*c^2*d^2)^-1*log(1+c^2*x^2)+b*d*c^2*e^-1*(e^2+c^2*d^2)^-1*arctan(c*x))
@test integrate((d+e*x)^-3*(a+b*arctan(c*x)), x) == :(-1//2*e^-1*(d+e*x)^-2*(a+b*arctan(c*x))+-1*b*c*(d+e*x)^-1*(2*e^2+2*c^2*d^2)^-1+b*d*c^3*(e^2+c^2*d^2)^-2*log(d+e*x)+-1//2*b*d*c^3*(e^2+c^2*d^2)^-2*log(1+c^2*x^2)+(1/2)*b*c^2*e^-1*(e^2+c^2*d^2)^-2*(e+c*d)*(-1*e+c*d)*arctan(c*x))
@test integrate((d+e*x)^-4*(a+b*arctan(c*x)), x) == :(-1//3*e^-1*(d+e*x)^-3*(a+b*arctan(c*x))+-1*b*c*(d+e*x)^-2*(6*e^2+6*c^2*d^2)^-1+-2//3*b*d*c^3*(d+e*x)^-1*(e^2+c^2*d^2)^-2+-1//6*b*c^3*(e^2+c^2*d^2)^-3*(-1*e^2+3*c^2*d^2)*log(1+c^2*x^2)+1//3*b*c^3*(e^2+c^2*d^2)^-3*(-1*e^2+3*c^2*d^2)*log(d+e*x)+1//3*b*d*c^4*e^-1*(e^2+c^2*d^2)^-3*(-3*e^2+c^2*d^2)*arctan(c*x))
@test integrate((a+b*arctan(c*x))^2*(d+e*x)^3, x) == :(1//4*e^-1*(a+b*arctan(c*x))^2*(d+e*x)^4+-1//4*c^-4*e^-1*(a+b*arctan(c*x))^2*(e^4+c^4*d^4+-6*c^2*d^2*e^2)+-1//12*b^2*c^-4*e^3*log(1+c^2*x^2)+1//12*b^2*c^-2*e^3*x^2+d*x*b^2*c^-2*e^2+-1*d*b^2*c^-3*e^2*arctan(c*x)+-1//6*b*c^-1*e^3*x^3*(a+b*arctan(c*x))+1//4*e*b^2*c^-4*(-1*e^2+6*c^2*d^2)*log(1+c^2*x^2)+im*d*c^-3*(a+b*arctan(c*x))^2*(e+c*d)*(-1*e+c*d)+-1*b*d*c^-1*e^2*x^2*(a+b*arctan(c*x))+-1//2*a*b*e*x*c^-3*(-1*e^2+6*c^2*d^2)+-1//2*e*x*b^2*c^-3*(-1*e^2+6*c^2*d^2)*arctan(c*x)+im*d*b^2*c^-3*(e+c*d)*(-1*e+c*d)*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+2*b*d*c^-3*(a+b*arctan(c*x))*(e+c*d)*(-1*e+c*d)*log(2*(1+im*c*x)^-1))
@test integrate((a+b*arctan(c*x))^2*(d+e*x)^2, x) == :(1//3*e^-1*(a+b*arctan(c*x))^2*(d+e*x)^3+-1//3*d*e^-1*(a+b*arctan(c*x))^2*(d^2+-3*c^-2*e^2)+-1//3*b^2*c^-3*e^2*arctan(c*x)+1//3*im*c^-3*(a+b*arctan(c*x))^2*(-1*e^2+3*c^2*d^2)+1//3*x*b^2*c^-2*e^2+d*e*b^2*c^-2*log(1+c^2*x^2)+-1//3*b*c^-1*e^2*x^2*(a+b*arctan(c*x))+1//3*im*b^2*c^-3*(-1*e^2+3*c^2*d^2)*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+2//3*b*c^-3*(a+b*arctan(c*x))*(-1*e^2+3*c^2*d^2)*log(2*(1+im*c*x)^-1)+-2*a*b*d*e*x*c^-1+-2*d*e*x*b^2*c^-1*arctan(c*x))
@test integrate((a+b*arctan(c*x))^2*(d+e*x), x) == :((1/2)*e^-1*(a+b*arctan(c*x))^2*(d+e*x)^2+-1//2*e^-1*(a+b*arctan(c*x))^2*(d^2+-1*c^-2*e^2)+im*d*c^-1*(a+b*arctan(c*x))^2+(1/2)*e*b^2*c^-2*log(1+c^2*x^2)+im*d*b^2*c^-1*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+-1*a*b*e*x*c^-1+-1*e*x*b^2*c^-1*arctan(c*x)+2*b*d*c^-1*(a+b*arctan(c*x))*log(2*(1+im*c*x)^-1))
@test integrate((a+b*arctan(c*x))^2*(d+e*x)^-1, x) == :(e^-1*(a+b*arctan(c*x))^2*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+(1/2)*b^2*e^-1*Polylogarithms.polylog(3,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-1*e^-1*(a+b*arctan(c*x))^2*log(2*(1+-1*im*c*x)^-1)+-1//2*b^2*e^-1*Polylogarithms.polylog(3,1+-2*(1+-1*im*c*x)^-1)+im*b*e^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1)+-1*im*b*e^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x)))
@test integrate((a+b*arctan(c*x))^2*(d+e*x)^-2, x) == :(-1*e^-1*(a+b*arctan(c*x))^2*(d+e*x)^-1+im*c*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-1+im*c*b^2*(e^2+c^2*d^2)^-1*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+im*c*b^2*(e^2+c^2*d^2)^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1)+d*c^2*e^-1*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-1+-1*im*c*b^2*(e^2+c^2*d^2)^-1*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-2*b*c*(e^2+c^2*d^2)^-1*(a+b*arctan(c*x))*log(2*(1+-1*im*c*x)^-1)+2*b*c*(e^2+c^2*d^2)^-1*(a+b*arctan(c*x))*log(2*(1+im*c*x)^-1)+2*b*c*(e^2+c^2*d^2)^-1*(a+b*arctan(c*x))*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x)))
@test integrate((a+b*arctan(c*x))^2*(d+e*x)^-3, x) == :(-1//2*e^-1*(a+b*arctan(c*x))^2*(d+e*x)^-2+im*d*c^3*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-2+d*b^2*c^3*(e^2+c^2*d^2)^-2*arctan(c*x)+e*b^2*c^2*(e^2+c^2*d^2)^-2*log(d+e*x)+-1*b*c*(d+e*x)^-1*(e^2+c^2*d^2)^-1*(a+b*arctan(c*x))+-1//2*e*b^2*c^2*(e^2+c^2*d^2)^-2*log(1+c^2*x^2)+im*d*b^2*c^3*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+im*d*b^2*c^3*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1)+(1/2)*c^2*e^-1*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-2*(e+c*d)*(-1*e+c*d)+-1*im*d*b^2*c^3*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-2*b*d*c^3*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*log(2*(1+-1*im*c*x)^-1)+2*b*d*c^3*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*log(2*(1+im*c*x)^-1)+2*b*d*c^3*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x)))
@test integrate((a+b*arctan(c*x))^3*(d+e*x)^3, x) == :(1//4*e^-1*(a+b*arctan(c*x))^3*(d+e*x)^4+-1//4*x*b^3*c^-3*e^3+-1//4*c^-4*e^-1*(a+b*arctan(c*x))^3*(e^4+c^4*d^4+-6*c^2*d^2*e^2)+1//4*b^3*c^-4*e^3*arctan(c*x)+(1/2)*b^2*c^-4*e^3*(a+b*arctan(c*x))*log(2*(1+im*c*x)^-1)+-3//2*b*d*c^-3*e^2*(a+b*arctan(c*x))^2+-3//2*d*b^3*c^-3*e^2*log(1+c^2*x^2)+-1//4*b*c^-1*e^3*x^3*(a+b*arctan(c*x))^2+1//4*im*b*c^-4*e^3*(a+b*arctan(c*x))^2+1//4*im*b^3*c^-4*e^3*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+1//4*b^2*c^-2*e^3*x^2*(a+b*arctan(c*x))+im*d*c^-3*(a+b*arctan(c*x))^3*(e+c*d)*(-1*e+c*d)+3*a*d*x*b^2*c^-2*e^2+3*d*x*b^3*c^-2*e^2*arctan(c*x)+-3//2*b*d*c^-1*e^2*x^2*(a+b*arctan(c*x))^2+-3//2*e*b^2*c^-4*(a+b*arctan(c*x))*(-1*e^2+6*c^2*d^2)*log(2*(1+im*c*x)^-1)+-3//4*im*b*e*c^-4*(a+b*arctan(c*x))^2*(-1*e^2+6*c^2*d^2)+-3//4*im*e*b^3*c^-4*(-1*e^2+6*c^2*d^2)*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+-3//4*b*e*x*c^-3*(a+b*arctan(c*x))^2*(-1*e^2+6*c^2*d^2)+3//2*d*b^3*c^-3*(e+c*d)*(-1*e+c*d)*Polylogarithms.polylog(3,1+-2*(1+im*c*x)^-1)+3*b*d*c^-3*(a+b*arctan(c*x))^2*(e+c*d)*(-1*e+c*d)*log(2*(1+im*c*x)^-1)+3*im*d*b^2*c^-3*(a+b*arctan(c*x))*(e+c*d)*(-1*e+c*d)*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1))
@test integrate((a+b*arctan(c*x))^3*(d+e*x)^2, x) == :(1//3*e^-1*(a+b*arctan(c*x))^3*(d+e*x)^3+(1/2)*b^3*c^-3*(-1*e^2+3*c^2*d^2)*Polylogarithms.polylog(3,1+-2*(1+im*c*x)^-1)+-1//2*b*c^-3*e^2*(a+b*arctan(c*x))^2+-1//2*b^3*c^-3*e^2*log(1+c^2*x^2)+-1//3*d*e^-1*(a+b*arctan(c*x))^3*(d^2+-3*c^-2*e^2)+1//3*im*c^-3*(a+b*arctan(c*x))^3*(-1*e^2+3*c^2*d^2)+a*x*b^2*c^-2*e^2+b*c^-3*(a+b*arctan(c*x))^2*(-1*e^2+3*c^2*d^2)*log(2*(1+im*c*x)^-1)+x*b^3*c^-2*e^2*arctan(c*x)+-1//2*b*c^-1*e^2*x^2*(a+b*arctan(c*x))^2+im*b^2*c^-3*(a+b*arctan(c*x))*(-1*e^2+3*c^2*d^2)*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+-6*d*e*b^2*c^-2*(a+b*arctan(c*x))*log(2*(1+im*c*x)^-1)+-3*im*b*d*e*c^-2*(a+b*arctan(c*x))^2+-3*im*d*e*b^3*c^-2*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+-3*b*d*e*x*c^-1*(a+b*arctan(c*x))^2)
@test integrate((a+b*arctan(c*x))^3*(d+e*x), x) == :((1/2)*e^-1*(a+b*arctan(c*x))^3*(d+e*x)^2+-1//2*e^-1*(a+b*arctan(c*x))^3*(d^2+-1*c^-2*e^2)+im*d*c^-1*(a+b*arctan(c*x))^3+3//2*d*b^3*c^-1*Polylogarithms.polylog(3,1+-2*(1+im*c*x)^-1)+-3*e*b^2*c^-2*(a+b*arctan(c*x))*log(2*(1+im*c*x)^-1)+3*b*d*c^-1*(a+b*arctan(c*x))^2*log(2*(1+im*c*x)^-1)+-3//2*im*b*e*c^-2*(a+b*arctan(c*x))^2+-3//2*im*e*b^3*c^-2*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+-3//2*b*e*x*c^-1*(a+b*arctan(c*x))^2+3*im*d*b^2*c^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1))
@test integrate((a+b*arctan(c*x))^3*(d+e*x)^-1, x) == :(e^-1*(a+b*arctan(c*x))^3*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-1*e^-1*(a+b*arctan(c*x))^3*log(2*(1+-1*im*c*x)^-1)+-3//2*b^2*e^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(3,1+-2*(1+-1*im*c*x)^-1)+-3//4*im*b^3*e^-1*Polylogarithms.polylog(4,1+-2*(1+-1*im*c*x)^-1)+3//2*b^2*e^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(3,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+3//4*im*b^3*e^-1*Polylogarithms.polylog(4,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-3//2*im*b*e^-1*(a+b*arctan(c*x))^2*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+3//2*im*b*e^-1*(a+b*arctan(c*x))^2*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1))
@test integrate((a+b*arctan(c*x))^3*(d+e*x)^-2, x) == :(-1*e^-1*(a+b*arctan(c*x))^3*(d+e*x)^-1+im*c*(a+b*arctan(c*x))^3*(e^2+c^2*d^2)^-1+-3*c*b^3*(2*e^2+2*c^2*d^2)^-1*Polylogarithms.polylog(3,1+-2*(1+-1*im*c*x)^-1)+3*c*b^3*(2*e^2+2*c^2*d^2)^-1*Polylogarithms.polylog(3,1+-2*(1+im*c*x)^-1)+3*c*b^3*(2*e^2+2*c^2*d^2)^-1*Polylogarithms.polylog(3,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+d*c^2*e^-1*(a+b*arctan(c*x))^3*(e^2+c^2*d^2)^-1+-3*b*c*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-1*log(2*(1+-1*im*c*x)^-1)+3*b*c*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-1*log(2*(1+im*c*x)^-1)+3*b*c*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-1*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-3*im*c*b^2*(e^2+c^2*d^2)^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+3*im*c*b^2*(e^2+c^2*d^2)^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+3*im*c*b^2*(e^2+c^2*d^2)^-1*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1))
@test integrate((a+b*arctan(c*x))^3*(d+e*x)^-3, x) == :(-1//2*e^-1*(a+b*arctan(c*x))^3*(d+e*x)^-2+im*d*c^3*(a+b*arctan(c*x))^3*(e^2+c^2*d^2)^-2+-3*b*c*(a+b*arctan(c*x))^2*(d+e*x)^-1*(2*e^2+2*c^2*d^2)^-1+-3//2*d*b^3*c^3*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(3,1+-2*(1+-1*im*c*x)^-1)+3//2*b*d*c^3*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-2+3//2*d*b^3*c^3*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(3,1+-2*(1+im*c*x)^-1)+3//2*d*b^3*c^3*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(3,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+(1/2)*c^2*e^-1*(a+b*arctan(c*x))^3*(e^2+c^2*d^2)^-2*(e+c*d)*(-1*e+c*d)+-3*b*d*c^3*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-2*log(2*(1+-1*im*c*x)^-1)+-3*e*b^2*c^2*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*log(2*(1+-1*im*c*x)^-1)+3*b*d*c^3*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-2*log(2*(1+im*c*x)^-1)+3*b*d*c^3*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-2*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+3*e*b^2*c^2*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*log(2*(1+im*c*x)^-1)+3*e*b^2*c^2*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-3//2*im*e*b^3*c^2*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+3//2*im*b*e*c^2*(a+b*arctan(c*x))^2*(e^2+c^2*d^2)^-2+3//2*im*e*b^3*c^2*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+3//2*im*e*b^3*c^2*(e^2+c^2*d^2)^-2*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1)+-3*im*d*b^2*c^3*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+3*im*d*b^2*c^3*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+3*im*d*b^2*c^3*(e^2+c^2*d^2)^-2*(a+b*arctan(c*x))*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1))
@test integrate((d+e*x)^2*(a+b*arctan(c*x^2)), x) == :(1//3*e^-1*(d+e*x)^3*(a+b*arctan(c*x^2))+-2//3*b*x*c^-1*e^2+-1//3*b*d^3*e^-1*arctan(c*x^2)+-1//2*b*d*e*c^-1*log(1+c^2*x^4)+-1//6*b*2^(1/2)*c^-3//2*(-1*e^2+3*c*d^2)*arctan(1+x*2^(1/2)*c^(1/2))+-1//12*b*2^(1/2)*c^-3//2*(e^2+3*c*d^2)*log(1+c*x^2+-1*x*2^(1/2)*c^(1/2))+1//6*b*2^(1/2)*c^-3//2*(-1*e^2+3*c*d^2)*arctan(1+-1*x*2^(1/2)*c^(1/2))+1//12*b*2^(1/2)*c^-3//2*(e^2+3*c*d^2)*log(1+c*x^2+x*2^(1/2)*c^(1/2)))
@test integrate((a+b*arctan(c*x^2))*(d+e*x), x) == :((1/2)*e^-1*(d+e*x)^2*(a+b*arctan(c*x^2))+-1//2*b*d^2*e^-1*arctan(c*x^2)+-1//4*b*e*c^-1*log(1+c^2*x^4)+(1/2)*b*d*2^(1/2)*c^-1//2*arctan(1+-1*x*2^(1/2)*c^(1/2))+-1//2*b*d*2^(1/2)*c^-1//2*arctan(1+x*2^(1/2)*c^(1/2))+-1//4*b*d*2^(1/2)*c^-1//2*log(1+c*x^2+-1*x*2^(1/2)*c^(1/2))+1//4*b*d*2^(1/2)*c^-1//2*log(1+c*x^2+x*2^(1/2)*c^(1/2)))
@test integrate((d+e*x)^-1*(a+b*arctan(c*x^2)), x) == :(e^-1*(a+b*arctan(c*x^2))*log(d+e*x)+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//4*(e+d*(-1*c^2)^1//4)^-1*(d+e*x))+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//4*(-1*e+d*(-1*c^2)^1//4)^-1*(d+e*x))+-1//2*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*(-1*c^2)^(1/2))^(1/2)*(e+d*(-1*(-1*c^2)^(1/2))^(1/2))^-1*(d+e*x))+-1//2*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*(-1*c^2)^(1/2))^(1/2)*(-1*e+d*(-1*(-1*c^2)^(1/2))^(1/2))^-1*(d+e*x))+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*log(e*(e+d*(-1*c^2)^1//4)^-1*(1+-1*x*(-1*c^2)^1//4))*log(d+e*x)+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*log(-1*e*(-1*e+d*(-1*c^2)^1//4)^-1*(1+x*(-1*c^2)^1//4))*log(d+e*x)+-1//2*b*c*e^-1*(-1*c^2)^-1//2*log(e*(e+d*(-1*(-1*c^2)^(1/2))^(1/2))^-1*(1+-1*x*(-1*(-1*c^2)^(1/2))^(1/2)))*log(d+e*x)+-1//2*b*c*e^-1*(-1*c^2)^-1//2*log(-1*e*(-1*e+d*(-1*(-1*c^2)^(1/2))^(1/2))^-1*(1+x*(-1*(-1*c^2)^(1/2))^(1/2)))*log(d+e*x))
@test integrate((d+e*x)^-2*(a+b*arctan(c*x^2)), x) == :(-1*e^-1*(d+e*x)^-1*(a+b*arctan(c*x^2))+b*c*d*e*(2*e^4+2*c^2*d^4)^-1*log(1+c^2*x^4)+b*c^2*d^3*e^-1*(e^4+c^2*d^4)^-1*arctan(c*x^2)+(1/2)*b*2^(1/2)*c^(1/2)*(e^4+c^2*d^4)^-1*(-1*e^2+c*d^2)*arctan(1+-1*x*2^(1/2)*c^(1/2))+-2*b*c*d*e*(e^4+c^2*d^4)^-1*log(d+e*x)+-1//2*b*2^(1/2)*c^(1/2)*(e^4+c^2*d^4)^-1*(-1*e^2+c*d^2)*arctan(1+x*2^(1/2)*c^(1/2))+-1//4*b*2^(1/2)*c^(1/2)*(e^4+c^2*d^4)^-1*(e^2+c*d^2)*log(1+c*x^2+-1*x*2^(1/2)*c^(1/2))+1//4*b*2^(1/2)*c^(1/2)*(e^4+c^2*d^4)^-1*(e^2+c*d^2)*log(1+c*x^2+x*2^(1/2)*c^(1/2)))
@test integrate((a+b*arctan(c*x^2))^2*(d+e*x), x) == :(d*x*a^2+(1/2)*e*x^2*(a+b*arctan(c*x^2))^2+(1/2)*im*e*c^-1*(a+b*arctan(c*x^2))^2+-1//4*d*x*b^2*log(1+im*c*x^2)^2+-1//4*d*x*b^2*log(1+-1*im*c*x^2)^2+b*e*c^-1*(a+b*arctan(c*x^2))*log(2*(1+im*c*x^2)^-1)+d*(-1)^1//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+-2*(1+x*(-1)^3//4*c^(1/2))^-1)+d*(-1)^1//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+-2*(1+-1*x*(-1)^3//4*c^(1/2))^-1)+d*(-1)^3//4*b^2*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))^2+d*(-1)^3//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+-2*(1+x*(-1)^1//4*c^(1/2))^-1)+d*(-1)^3//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+-2*(1+-1*x*(-1)^1//4*c^(1/2))^-1)+(1/2)*im*e*b^2*c^-1*Polylogarithms.polylog(2,1+-2*(1+im*c*x^2)^-1)+(1/2)*d*x*b^2*log(1+im*c*x^2)*log(1+-1*im*c*x^2)+-1*d*(-1)^1//4*b^2*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))^2+-1//2*d*(-1)^1//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+2^(1/2)*(1+x*(-1)^3//4*c^(1/2))^-1*((-1)^3//4+x*c^(1/2)))+-1//2*d*(-1)^1//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+-1*(1+x*(-1)^3//4*c^(1/2))^-1*(1+im)*(1+x*(-1)^1//4*c^(1/2)))+-1//2*d*(-1)^3//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+-1*2^(1/2)*(1+x*(-1)^1//4*c^(1/2))^-1*((-1)^1//4+x*c^(1/2)))+-1//2*d*(-1)^3//4*b^2*c^-1//2*Polylogarithms.polylog(2,1+-1*(1+x*(-1)^1//4*c^(1/2))^-1*(1+-1im)*(1+x*(-1)^3//4*c^(1/2)))+im*a*b*d*x*log(1+-1*im*c*x^2)+d*(-1)^1//4*b^2*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))*log(2^(1/2)*(1+x*(-1)^1//4*c^(1/2))^-1*((-1)^1//4+x*c^(1/2)))+d*(-1)^1//4*b^2*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))*log((1+x*(-1)^1//4*c^(1/2))^-1*(1+-1im)*(1+x*(-1)^3//4*c^(1/2)))+d*(-1)^1//4*b^2*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))*log(1+-1*im*c*x^2)+d*(-1)^1//4*b^2*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))*log((1+x*(-1)^3//4*c^(1/2))^-1*(1+im)*(1+x*(-1)^1//4*c^(1/2)))+d*(-1)^1//4*b^2*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))*log(-1*2^(1/2)*(1+x*(-1)^3//4*c^(1/2))^-1*((-1)^3//4+x*c^(1/2)))+d*(-1)^1//4*b^2*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))*log(1+im*c*x^2)+-1*im*a*b*d*x*log(1+im*c*x^2)+-1*d*(-1)^1//4*b^2*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))*log(1+im*c*x^2)+-1*d*(-1)^1//4*b^2*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))*log(1+-1*im*c*x^2)+-2*a*b*d*(-1)^3//4*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))+-2*d*(-1)^1//4*b^2*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))*log(2*(1+x*(-1)^1//4*c^(1/2))^-1)+-2*d*(-1)^1//4*b^2*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))*log(2*(1+x*(-1)^3//4*c^(1/2))^-1)+2*a*b*d*(-1)^3//4*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))+2*d*(-1)^1//4*b^2*c^-1//2*arctan(x*(-1)^3//4*c^(1/2))*log(2*(1+-1*x*(-1)^1//4*c^(1/2))^-1)+2*d*(-1)^1//4*b^2*c^-1//2*arctanh(x*(-1)^3//4*c^(1/2))*log(2*(1+-1*x*(-1)^3//4*c^(1/2))^-1))
@test integrate((d+e*x)^2*(a+b*arctan(c*x^3)), x) == :(1//3*e^-1*(d+e*x)^3*(a+b*arctan(c*x^3))+(1/2)*b*c^-1//3*d^2*log(1+c^2//3*x^2)+-1//3*b*d^3*e^-1*arctan(c*x^3)+-1//4*b*c^-1//3*d^2*log(1+c^4//3*x^4+-1*c^2//3*x^2)+-1//6*b*c^-1*e^2*log(1+c^2*x^6)+(1/2)*b*d*e*c^-2//3*arctan(3^(1/2)+-2*x*c^1//3)+(1/2)*b*3^(1/2)*c^-1//3*d^2*arctan(1//3*3^(1/2)*(1+-2*c^2//3*x^2))+-1*b*d*e*c^-2//3*arctan(x*c^1//3)+-1//2*b*d*e*c^-2//3*arctan(3^(1/2)+2*x*c^1//3)+-1//4*b*d*e*3^(1/2)*c^-2//3*log(1+c^2//3*x^2+-1*x*3^(1/2)*c^1//3)+1//4*b*d*e*3^(1/2)*c^-2//3*log(1+c^2//3*x^2+x*3^(1/2)*c^1//3))
@test integrate((a+b*arctan(c*x^3))*(d+e*x), x) == :((1/2)*e^-1*(d+e*x)^2*(a+b*arctan(c*x^3))+(1/2)*b*d*c^-1//3*log(1+c^2//3*x^2)+-1//2*b*e*c^-2//3*arctan(x*c^1//3)+-1//2*b*d^2*e^-1*arctan(c*x^3)+-1//4*b*d*c^-1//3*log(1+c^4//3*x^4+-1*c^2//3*x^2)+-1//4*b*e*c^-2//3*arctan(3^(1/2)+2*x*c^1//3)+1//4*b*e*c^-2//3*arctan(3^(1/2)+-2*x*c^1//3)+(1/2)*b*d*3^(1/2)*c^-1//3*arctan(1//3*3^(1/2)*(1+-2*c^2//3*x^2))+-1//8*b*e*3^(1/2)*c^-2//3*log(1+c^2//3*x^2+-1*x*3^(1/2)*c^1//3)+1//8*b*e*3^(1/2)*c^-2//3*log(1+c^2//3*x^2+x*3^(1/2)*c^1//3))
@test integrate((d+e*x)^-1*(a+b*arctan(c*x^3)), x) == :(e^-1*(a+b*arctan(c*x^3))*log(d+e*x)+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//6*(e+d*(-1*c^2)^1//6)^-1*(d+e*x))+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//6*(d*(-1*c^2)^1//6+e*(-1)^2//3)^-1*(d+e*x))+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//6*(d*(-1*c^2)^1//6+-1*e*(-1)^1//3)^-1*(d+e*x))+-1//2*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//6*(-1*e+d*(-1*c^2)^1//6)^-1*(d+e*x))+-1//2*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//6*(d*(-1*c^2)^1//6+e*(-1)^1//3)^-1*(d+e*x))+-1//2*b*c*e^-1*(-1*c^2)^-1//2*Polylogarithms.polylog(2,(-1*c^2)^1//6*(d*(-1*c^2)^1//6+-1*e*(-1)^2//3)^-1*(d+e*x))+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*log(e*(e+d*(-1*c^2)^1//6)^-1*(1+-1*x*(-1*c^2)^1//6))*log(d+e*x)+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*log(-1*e*(d*(-1*c^2)^1//6+-1*e*(-1)^1//3)^-1*((-1)^1//3+x*(-1*c^2)^1//6))*log(d+e*x)+(1/2)*b*c*e^-1*(-1*c^2)^-1//2*log(e*(-1)^2//3*(d*(-1*c^2)^1//6+e*(-1)^2//3)^-1*(1+x*(-1)^1//3*(-1*c^2)^1//6))*log(d+e*x)+-1//2*b*c*e^-1*(-1*c^2)^-1//2*log(-1*e*(-1*e+d*(-1*c^2)^1//6)^-1*(1+x*(-1*c^2)^1//6))*log(d+e*x)+-1//2*b*c*e^-1*(-1*c^2)^-1//2*log(-1*e*(d*(-1*c^2)^1//6+-1*e*(-1)^2//3)^-1*((-1)^2//3+x*(-1*c^2)^1//6))*log(d+e*x)+-1//2*b*c*e^-1*(-1*c^2)^-1//2*log(e*(-1)^1//3*(d*(-1*c^2)^1//6+e*(-1)^1//3)^-1*(1+x*(-1)^2//3*(-1*c^2)^1//6))*log(d+e*x))
@test integrate((d+e*x)^-2*(a+b*arctan(c*x^3)), x) == :(-1*e^-1*(d+e*x)^-1*(a+b*arctan(c*x^3))+b*c^5//3*d^4*(2*e^6+2*c^2*d^6)^-1*log(1+c^2//3*x^2)+b*d*c^2//3*(2*e^6+2*c^2*d^6)^-1*(e^3+c*3^(1/2)*d^3)*arctan(3^(1/2)+-2*x*c^1//3)+b*d*c^2//3*(2*e^6+2*c^2*d^6)^-1*(-1*e^3+c*3^(1/2)*d^3)*arctan(3^(1/2)+2*x*c^1//3)+b*c^2*d^5*e^-1*(e^6+c^2*d^6)^-1*arctan(c*x^3)+-1*b*c*d^2*e^2*(2*e^6+2*c^2*d^6)^-1*log(1+c^2*x^6)+-1*b*d*c^2//3*e^3*(e^6+c^2*d^6)^-1*arctan(x*c^1//3)+-1*b*d*c^2//3*(4*e^6+4*c^2*d^6)^-1*(c*d^3+3^(1/2)*e^3)*log(1+c^2//3*x^2+x*3^(1/2)*c^1//3)+-1*b*d*c^2//3*(4*e^6+4*c^2*d^6)^-1*(c*d^3+-1*3^(1/2)*e^3)*log(1+c^2//3*x^2+-1*x*3^(1/2)*c^1//3)+3*b*c*d^2*e^2*(e^6+c^2*d^6)^-1*log(d+e*x)+(1/2)*b*e*c^5//3*(-1*c^2)^-2//3*(e^6+c^2*d^6)^-1*(e^3+d^3*(-1*c^2)^(1/2))*log((-1*c^2)^1//6+-1*x*c^2//3)+-1//2*b*e*c^5//3*(-1*c^2)^-2//3*(e^6+c^2*d^6)^-1*(-1*e^3+d^3*(-1*c^2)^(1/2))*log((-1*c^2)^1//6+x*c^2//3)+-1//4*b*e*c^5//3*(-1*c^2)^-2//3*(e^6+c^2*d^6)^-1*(e^3+d^3*(-1*c^2)^(1/2))*log((-1*c^2)^1//3+c^4//3*x^2+x*c^2//3*(-1*c^2)^1//6)+1//4*b*e*c^5//3*(-1*c^2)^-2//3*(e^6+c^2*d^6)^-1*(-1*e^3+d^3*(-1*c^2)^(1/2))*log((-1*c^2)^1//3+c^4//3*x^2+-1*x*c^2//3*(-1*c^2)^1//6)+(1/2)*b*e*3^(1/2)*c^5//3*(-1*c^2)^-2//3*(e^6+c^2*d^6)^-1*(e^3+d^3*(-1*c^2)^(1/2))*arctan(1//3*3^(1/2)*(1+2*x*c^2//3*(-1*c^2)^-1//6))+-1//2*b*e*3^(1/2)*c^5//3*(-1*c^2)^-2//3*(e^6+c^2*d^6)^-1*(-1*e^3+d^3*(-1*c^2)^(1/2))*arctan(1//3*3^(1/2)*c^-4//3*(c^4//3+2*x*(-1*c^2)^5//6)))

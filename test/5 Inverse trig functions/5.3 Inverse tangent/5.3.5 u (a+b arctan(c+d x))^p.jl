using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate((c*e+d*e*x)^3*(a+b*arctan(c+d*x)), x) == :(1//4*b*x*e^3+-1//4*b*d^-1*e^3*arctan(c+d*x)+-1//12*b*d^-1*e^3*(c+d*x)^3+1//4*d^-1*e^3*(c+d*x)^4*(a+b*arctan(c+d*x)))
@test integrate((c*e+d*e*x)^2*(a+b*arctan(c+d*x)), x) == :(-1//6*b*d^-1*e^2*(c+d*x)^2+1//3*d^-1*e^2*(c+d*x)^3*(a+b*arctan(c+d*x))+1//6*b*d^-1*e^2*log(1+(c+d*x)^2))
@test integrate((a+b*arctan(c+d*x))*(c*e+d*e*x), x) == :(-1//2*b*e*x+(1/2)*b*e*d^-1*arctan(c+d*x)+(1/2)*e*d^-1*(c+d*x)^2*(a+b*arctan(c+d*x)))
@test integrate((c*e+d*e*x)^-1*(a+b*arctan(c+d*x)), x) == :(a*d^-1*e^-1*log(c+d*x)+(1/2)*im*b*d^-1*e^-1*Polylogarithms.polylog(2,-1*im*(c+d*x))+-1//2*im*b*d^-1*e^-1*Polylogarithms.polylog(2,im*(c+d*x)))
@test integrate((c*e+d*e*x)^-2*(a+b*arctan(c+d*x)), x) == :(b*d^-1*e^-2*log(c+d*x)+-1*d^-1*e^-2*(c+d*x)^-1*(a+b*arctan(c+d*x))+-1//2*b*d^-1*e^-2*log(1+(c+d*x)^2))
@test integrate((c*e+d*e*x)^-3*(a+b*arctan(c+d*x)), x) == :(-1//2*b*d^-1*e^-3*(c+d*x)^-1+-1//2*b*d^-1*e^-3*arctan(c+d*x)+-1//2*d^-1*e^-3*(c+d*x)^-2*(a+b*arctan(c+d*x)))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^3, x) == :(-1//4*d^-1*e^3*(a+b*arctan(c+d*x))^2+(1/2)*a*b*x*e^3+-1//3*b^2*d^-1*e^3*log(1+(c+d*x)^2)+1//4*d^-1*e^3*(a+b*arctan(c+d*x))^2*(c+d*x)^4+1//12*b^2*d^-1*e^3*(c+d*x)^2+(1/2)*b^2*d^-1*e^3*(c+d*x)*arctan(c+d*x)+-1//6*b*d^-1*e^3*(c+d*x)^3*(a+b*arctan(c+d*x)))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^2, x) == :(1//3*x*b^2*e^2+-1//3*im*d^-1*e^2*(a+b*arctan(c+d*x))^2+-1//3*b^2*d^-1*e^2*arctan(c+d*x)+1//3*d^-1*e^2*(a+b*arctan(c+d*x))^2*(c+d*x)^3+-2//3*b*d^-1*e^2*(a+b*arctan(c+d*x))*log(2*(1+im*(c+d*x))^-1)+-1//3*im*b^2*d^-1*e^2*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+-1//3*b*d^-1*e^2*(c+d*x)^2*(a+b*arctan(c+d*x)))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x), x) == :((1/2)*e*d^-1*(a+b*arctan(c+d*x))^2+(1/2)*e*b^2*d^-1*log(1+(c+d*x)^2)+(1/2)*e*d^-1*(a+b*arctan(c+d*x))^2*(c+d*x)^2+-1*a*b*e*x+-1*e*b^2*d^-1*(c+d*x)*arctan(c+d*x))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^-1, x) == :((1/2)*b^2*d^-1*e^-1*Polylogarithms.polylog(3,-1+2*(1+im*(c+d*x))^-1)+2*d^-1*e^-1*(a+b*arctan(c+d*x))^2*arctanh(1+-2*(1+im*(c+d*x))^-1)+-1//2*b^2*d^-1*e^-1*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+im*b*d^-1*e^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,-1+2*(1+im*(c+d*x))^-1)+-1*im*b*d^-1*e^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^-2, x) == :(-1*im*d^-1*e^-2*(a+b*arctan(c+d*x))^2+-1*d^-1*e^-2*(a+b*arctan(c+d*x))^2*(c+d*x)^-1+-1*im*b^2*d^-1*e^-2*Polylogarithms.polylog(2,-1+2*(1+-1*im*(c+d*x))^-1)+2*b*d^-1*e^-2*(a+b*arctan(c+d*x))*log(2+-2*(1+-1*im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^-3, x) == :(-1//2*d^-1*e^-3*(a+b*arctan(c+d*x))^2+b^2*d^-1*e^-3*log(c+d*x)+-1//2*b^2*d^-1*e^-3*log(1+(c+d*x)^2)+-1//2*d^-1*e^-3*(a+b*arctan(c+d*x))^2*(c+d*x)^-2+-1*b*d^-1*e^-3*(c+d*x)^-1*(a+b*arctan(c+d*x)))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^-4, x) == :(-1//3*b^2*d^-1*e^-4*(c+d*x)^-1+-1//3*b^2*d^-1*e^-4*arctan(c+d*x)+-1//3*d^-1*e^-4*(a+b*arctan(c+d*x))^2*(c+d*x)^-3+1//3*im*d^-1*e^-4*(a+b*arctan(c+d*x))^2+-2//3*b*d^-1*e^-4*(a+b*arctan(c+d*x))*log(2+-2*(1+-1*im*(c+d*x))^-1)+-1//3*b*d^-1*e^-4*(c+d*x)^-2*(a+b*arctan(c+d*x))+1//3*im*b^2*d^-1*e^-4*Polylogarithms.polylog(2,-1+2*(1+-1*im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^-5, x) == :(1//4*d^-1*e^-5*(a+b*arctan(c+d*x))^2+-2//3*b^2*d^-1*e^-5*log(c+d*x)+-1//4*d^-1*e^-5*(a+b*arctan(c+d*x))^2*(c+d*x)^-4+-1//12*b^2*d^-1*e^-5*(c+d*x)^-2+1//3*b^2*d^-1*e^-5*log(1+(c+d*x)^2)+(1/2)*b*d^-1*e^-5*(c+d*x)^-1*(a+b*arctan(c+d*x))+-1//6*b*d^-1*e^-5*(c+d*x)^-3*(a+b*arctan(c+d*x)))
@test integrate((a+b*arctan(c+d*x))^3*(c*e+d*e*x)^2, x) == :(a*x*b^2*e^2+-1//2*b*d^-1*e^2*(a+b*arctan(c+d*x))^2+-1//2*b^3*d^-1*e^2*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+-1//2*b^3*d^-1*e^2*log(1+(c+d*x)^2)+-1//3*im*d^-1*e^2*(a+b*arctan(c+d*x))^3+1//3*d^-1*e^2*(a+b*arctan(c+d*x))^3*(c+d*x)^3+b^3*d^-1*e^2*(c+d*x)*arctan(c+d*x)+-1*b*d^-1*e^2*(a+b*arctan(c+d*x))^2*log(2*(1+im*(c+d*x))^-1)+-1//2*b*d^-1*e^2*(a+b*arctan(c+d*x))^2*(c+d*x)^2+-1*im*b^2*d^-1*e^2*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^3*(c*e+d*e*x), x) == :((1/2)*e*d^-1*(a+b*arctan(c+d*x))^3+(1/2)*e*d^-1*(a+b*arctan(c+d*x))^3*(c+d*x)^2+-3*e*b^2*d^-1*(a+b*arctan(c+d*x))*log(2*(1+im*(c+d*x))^-1)+-3//2*im*b*e*d^-1*(a+b*arctan(c+d*x))^2+-3//2*im*e*b^3*d^-1*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+-3//2*b*e*d^-1*(a+b*arctan(c+d*x))^2*(c+d*x))
@test integrate((a+b*arctan(c+d*x))^3*(c*e+d*e*x)^-1, x) == :(2*d^-1*e^-1*(a+b*arctan(c+d*x))^3*arctanh(1+-2*(1+im*(c+d*x))^-1)+-3//2*b^2*d^-1*e^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+-3//4*im*b^3*d^-1*e^-1*Polylogarithms.polylog(4,-1+2*(1+im*(c+d*x))^-1)+3//2*b^2*d^-1*e^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(3,-1+2*(1+im*(c+d*x))^-1)+3//4*im*b^3*d^-1*e^-1*Polylogarithms.polylog(4,1+-2*(1+im*(c+d*x))^-1)+-3//2*im*b*d^-1*e^-1*(a+b*arctan(c+d*x))^2*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+3//2*im*b*d^-1*e^-1*(a+b*arctan(c+d*x))^2*Polylogarithms.polylog(2,-1+2*(1+im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^3*(c*e+d*e*x)^-2, x) == :(-1*im*d^-1*e^-2*(a+b*arctan(c+d*x))^3+-1*d^-1*e^-2*(a+b*arctan(c+d*x))^3*(c+d*x)^-1+3//2*b^3*d^-1*e^-2*Polylogarithms.polylog(3,-1+2*(1+-1*im*(c+d*x))^-1)+3*b*d^-1*e^-2*(a+b*arctan(c+d*x))^2*log(2+-2*(1+-1*im*(c+d*x))^-1)+-3*im*b^2*d^-1*e^-2*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,-1+2*(1+-1*im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^3*(c*e+d*e*x)^-3, x) == :(-1//2*d^-1*e^-3*(a+b*arctan(c+d*x))^3+-1//2*d^-1*e^-3*(a+b*arctan(c+d*x))^3*(c+d*x)^-2+3*b^2*d^-1*e^-3*(a+b*arctan(c+d*x))*log(2+-2*(1+-1*im*(c+d*x))^-1)+-3//2*im*b*d^-1*e^-3*(a+b*arctan(c+d*x))^2+-3//2*im*b^3*d^-1*e^-3*Polylogarithms.polylog(2,-1+2*(1+-1*im*(c+d*x))^-1)+-3//2*b*d^-1*e^-3*(a+b*arctan(c+d*x))^2*(c+d*x)^-1)
@test integrate((a+b*arctan(c+d*x))^3*(c*e+d*e*x)^-4, x) == :(b^3*d^-1*e^-4*log(c+d*x)+-1//2*b*d^-1*e^-4*(a+b*arctan(c+d*x))^2+-1//2*b^3*d^-1*e^-4*Polylogarithms.polylog(3,-1+2*(1+-1*im*(c+d*x))^-1)+-1//2*b^3*d^-1*e^-4*log(1+(c+d*x)^2)+-1//3*d^-1*e^-4*(a+b*arctan(c+d*x))^3*(c+d*x)^-3+1//3*im*d^-1*e^-4*(a+b*arctan(c+d*x))^3+-1*b*d^-1*e^-4*(a+b*arctan(c+d*x))^2*log(2+-2*(1+-1*im*(c+d*x))^-1)+-1*b^2*d^-1*e^-4*(c+d*x)^-1*(a+b*arctan(c+d*x))+-1//2*b*d^-1*e^-4*(a+b*arctan(c+d*x))^2*(c+d*x)^-2+im*b^2*d^-1*e^-4*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,-1+2*(1+-1*im*(c+d*x))^-1))
@test integrate((2+2x)^-1*arctan(1+x), x) == :(-1//4*im*Polylogarithms.polylog(2,im*(1+x))+1//4*im*Polylogarithms.polylog(2,-1*im*(1+x)))
@test integrate((d*x+a*d*b^-1)^-1*arctan(a+b*x), x) == :((1/2)*im*d^-1*Polylogarithms.polylog(2,-1*im*(a+b*x))+-1//2*im*d^-1*Polylogarithms.polylog(2,im*(a+b*x)))
@test integrate((e+f*x)^3*(a+b*arctan(c+d*x)), x) == :(1//4*f^-1*(e+f*x)^4*(a+b*arctan(c+d*x))+-1//12*b*d^-4*f^3*(c+d*x)^3+-1//2*b*d^-4*f^2*(c+d*x)^2*(d*e+-1*c*f)+-1//4*b*f*x*d^-3*(-1*f^2*(1+-6*c^2)+6*d^2*e^2+-12*c*d*e*f)+-1//4*b*d^-4*f^-1*(d^4*e^4+f^4*(1+c^4+-6*c^2)+-1*d^2*e^2*f^2*(6+-6*c^2)+-4*c*f*d^3*e^3+4*c*d*e*f^3*(3+-1*c^2))*arctan(c+d*x)+-1//2*b*d^-4*(d*e+-1*c*f)*(d*e+-1*f*(1+c))*(f+d*e+-1*c*f)*log(1+(c+d*x)^2))
@test integrate((e+f*x)^2*(a+b*arctan(c+d*x)), x) == :(1//3*f^-1*(e+f*x)^3*(a+b*arctan(c+d*x))+-1//6*b*d^-3*f^2*(c+d*x)^2+-1//6*b*d^-3*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)*log(1+(c+d*x)^2)+-1*b*f*x*d^-2*(d*e+-1*c*f)+-1//3*b*d^-3*f^-1*(d*e+-1*c*f)*(d^2*e^2+-1*f^2*(3+-1*c^2)+-2*c*d*e*f)*arctan(c+d*x))
@test integrate((a+b*arctan(c+d*x))*(e+f*x), x) == :((1/2)*f^-1*(e+f*x)^2*(a+b*arctan(c+d*x))+-1//2*b*f*x*d^-1+-1//2*b*d^-2*(d*e+-1*c*f)*log(1+(c+d*x)^2)+-1//2*b*d^-2*f^-1*(d*e+-1*f*(1+c))*(f+d*e+-1*c*f)*arctan(c+d*x))
@test integrate(a+b*arctan(c+d*x), x) == :(a*x+-1//2*b*d^-1*log(1+(c+d*x)^2)+b*d^-1*(c+d*x)*arctan(c+d*x))
@test integrate((e+f*x)^-1*(a+b*arctan(c+d*x)), x) == :(f^-1*(a+b*arctan(c+d*x))*log(2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+-1*f^-1*(a+b*arctan(c+d*x))*log(2*(1+-1*im*(c+d*x))^-1)+(1/2)*im*b*f^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*(c+d*x))^-1)+-1//2*im*b*f^-1*Polylogarithms.polylog(2,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x)))
@test integrate((e+f*x)^-2*(a+b*arctan(c+d*x)), x) == :(-1*f^-1*(e+f*x)^-1*(a+b*arctan(c+d*x))+b*d*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*log(e+f*x)+-1*b*d*(2*d^2*e^2+2*f^2*(1+c^2)+-4*c*d*e*f)^-1*log(1+c^2+d^2*x^2+2*c*d*x)+b*d*f^-1*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*(d*e+-1*c*f)*arctan(c+d*x))
@test integrate((e+f*x)^-3*(a+b*arctan(c+d*x)), x) == :(-1//2*f^-1*(e+f*x)^-2*(a+b*arctan(c+d*x))+-1*b*d*(e+f*x)^-1*(2*d^2*e^2+2*f^2*(1+c^2)+-4*c*d*e*f)^-1+b*d^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-2*(d*e+-1*c*f)*log(e+f*x)+-1//2*b*d^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-2*(d*e+-1*c*f)*log(1+c^2+d^2*x^2+2*c*d*x)+(1/2)*b*d^2*f^-1*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-2*(d*e+-1*f*(1+c))*(f+d*e+-1*c*f)*arctan(c+d*x))
@test integrate((a+b*arctan(c+d*x))^2*(e+f*x)^2, x) == :(1//3*f^-1*(a+b*arctan(c+d*x))^2*(e+f*x)^3+-1//3*b^2*d^-3*f^2*arctan(c+d*x)+1//3*im*d^-3*(a+b*arctan(c+d*x))^2*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)+1//3*x*b^2*d^-2*f^2+f*b^2*d^-3*(d*e+-1*c*f)*log(1+(c+d*x)^2)+-1//3*b*d^-3*f^2*(c+d*x)^2*(a+b*arctan(c+d*x))+-1//3*d^-3*f^-1*(a+b*arctan(c+d*x))^2*(d*e+-1*c*f)*(d^2*e^2+-1*f^2*(3+-1*c^2)+-2*c*d*e*f)+1//3*im*b^2*d^-3*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+2//3*b*d^-3*(a+b*arctan(c+d*x))*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)*log(2*(1+im*(c+d*x))^-1)+-2*a*b*f*x*d^-2*(d*e+-1*c*f)+-2*f*b^2*d^-3*(c+d*x)*(d*e+-1*c*f)*arctan(c+d*x))
@test integrate((a+b*arctan(c+d*x))^2*(e+f*x), x) == :((1/2)*f^-1*(a+b*arctan(c+d*x))^2*(e+f*x)^2+im*d^-2*(a+b*arctan(c+d*x))^2*(d*e+-1*c*f)+(1/2)*f*b^2*d^-2*log(1+(c+d*x)^2)+im*b^2*d^-2*(d*e+-1*c*f)*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+-1*a*b*f*x*d^-1+-1*f*b^2*d^-2*(c+d*x)*arctan(c+d*x)+2*b*d^-2*(a+b*arctan(c+d*x))*(d*e+-1*c*f)*log(2*(1+im*(c+d*x))^-1)+-1//2*d^-2*f^-1*(a+b*arctan(c+d*x))^2*(d*e+-1*f*(1+c))*(f+d*e+-1*c*f))
@test integrate((a+b*arctan(c+d*x))^2, x) == :(im*d^-1*(a+b*arctan(c+d*x))^2+d^-1*(a+b*arctan(c+d*x))^2*(c+d*x)+im*b^2*d^-1*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+2*b*d^-1*(a+b*arctan(c+d*x))*log(2*(1+im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^2*(e+f*x)^-1, x) == :(f^-1*(a+b*arctan(c+d*x))^2*log(2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+(1/2)*b^2*f^-1*Polylogarithms.polylog(3,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+-1*f^-1*(a+b*arctan(c+d*x))^2*log(2*(1+-1*im*(c+d*x))^-1)+-1//2*b^2*f^-1*Polylogarithms.polylog(3,1+-2*(1+-1*im*(c+d*x))^-1)+im*b*f^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,1+-2*(1+-1*im*(c+d*x))^-1)+-1*im*b*f^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x)))
@test integrate((a+b*arctan(c+d*x))^2*(e+f*x)^-2, x) == :(-1*f^-1*(a+b*arctan(c+d*x))^2*(e+f*x)^-1+im*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^2+im*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+im*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*(c+d*x))^-1)+-1*im*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+-1*a*b*d*(f^2+(d*e+-1*c*f)^2)^-1*log(1+(c+d*x)^2)+-2*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)*log(2*(1+-1*im*(c+d*x))^-1)+2*a*b*d*(f^2+(d*e+-1*c*f)^2)^-1*log(e+f*x)+2*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)*log(2*(1+im*(c+d*x))^-1)+2*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)*log(2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+d*b^2*f^-1*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^2*(d*e+-1*c*f)+2*a*b*d*f^-1*(f^2+(d*e+-1*c*f)^2)^-1*(d*e+-1*c*f)*arctan(c+d*x))
@test integrate((a+b*arctan(c+d*x))^3*(e+f*x)^2, x) == :(1//3*f^-1*(a+b*arctan(c+d*x))^3*(e+f*x)^3+(1/2)*b^3*d^-3*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+-1//2*b*d^-3*f^2*(a+b*arctan(c+d*x))^2+-1//2*b^3*d^-3*f^2*log(1+(c+d*x)^2)+1//3*im*d^-3*(a+b*arctan(c+d*x))^3*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)+a*x*b^2*d^-2*f^2+b*d^-3*(a+b*arctan(c+d*x))^2*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)*log(2*(1+im*(c+d*x))^-1)+b^3*d^-3*f^2*(c+d*x)*arctan(c+d*x)+-1//2*b*d^-3*f^2*(a+b*arctan(c+d*x))^2*(c+d*x)^2+-1//3*d^-3*f^-1*(a+b*arctan(c+d*x))^3*(d*e+-1*c*f)*(d^2*e^2+-1*f^2*(3+-1*c^2)+-2*c*d*e*f)+im*b^2*d^-3*(a+b*arctan(c+d*x))*(-1*f^2*(1+-3*c^2)+3*d^2*e^2+-6*c*d*e*f)*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+-6*f*b^2*d^-3*(a+b*arctan(c+d*x))*(d*e+-1*c*f)*log(2*(1+im*(c+d*x))^-1)+-3*im*b*f*d^-3*(a+b*arctan(c+d*x))^2*(d*e+-1*c*f)+-3*im*f*b^3*d^-3*(d*e+-1*c*f)*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+-3*b*f*d^-3*(a+b*arctan(c+d*x))^2*(c+d*x)*(d*e+-1*c*f))
@test integrate((a+b*arctan(c+d*x))^3*(e+f*x), x) == :((1/2)*f^-1*(a+b*arctan(c+d*x))^3*(e+f*x)^2+im*d^-2*(a+b*arctan(c+d*x))^3*(d*e+-1*c*f)+3//2*b^3*d^-2*(d*e+-1*c*f)*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+-3*f*b^2*d^-2*(a+b*arctan(c+d*x))*log(2*(1+im*(c+d*x))^-1)+3*b*d^-2*(a+b*arctan(c+d*x))^2*(d*e+-1*c*f)*log(2*(1+im*(c+d*x))^-1)+-3//2*im*b*f*d^-2*(a+b*arctan(c+d*x))^2+-3//2*im*f*b^3*d^-2*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+-3//2*b*f*d^-2*(a+b*arctan(c+d*x))^2*(c+d*x)+-1//2*d^-2*f^-1*(a+b*arctan(c+d*x))^3*(d*e+-1*f*(1+c))*(f+d*e+-1*c*f)+3*im*b^2*d^-2*(a+b*arctan(c+d*x))*(d*e+-1*c*f)*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^3, x) == :(im*d^-1*(a+b*arctan(c+d*x))^3+d^-1*(a+b*arctan(c+d*x))^3*(c+d*x)+3//2*b^3*d^-1*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+3*b*d^-1*(a+b*arctan(c+d*x))^2*log(2*(1+im*(c+d*x))^-1)+3*im*b^2*d^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^3*(e+f*x)^-1, x) == :(f^-1*(a+b*arctan(c+d*x))^3*log(2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+-1*f^-1*(a+b*arctan(c+d*x))^3*log(2*(1+-1*im*(c+d*x))^-1)+-3//2*b^2*f^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(3,1+-2*(1+-1*im*(c+d*x))^-1)+-3//4*im*b^3*f^-1*Polylogarithms.polylog(4,1+-2*(1+-1*im*(c+d*x))^-1)+3//2*b^2*f^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(3,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+3//4*im*b^3*f^-1*Polylogarithms.polylog(4,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+-3//2*im*b*f^-1*(a+b*arctan(c+d*x))^2*Polylogarithms.polylog(2,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+3//2*im*b*f^-1*(a+b*arctan(c+d*x))^2*Polylogarithms.polylog(2,1+-2*(1+-1*im*(c+d*x))^-1))
@test integrate((a+b*arctan(c+d*x))^3*(e+f*x)^-2, x) == :(-1*f^-1*(a+b*arctan(c+d*x))^3*(e+f*x)^-1+-3*d*b^3*(2*d^2*e^2+2*f^2*(1+c^2)+-4*c*d*e*f)^-1*Polylogarithms.polylog(3,1+-2*(1+-1*im*(c+d*x))^-1)+3*d*b^3*(2*d^2*e^2+2*f^2*(1+c^2)+-4*c*d*e*f)^-1*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+3*d*b^3*(2*d^2*e^2+2*f^2*(1+c^2)+-4*c*d*e*f)^-1*Polylogarithms.polylog(3,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+im*d*b^3*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^3+-3*b*d*a^2*(2*f^2+2*(d*e+-1*c*f)^2)^-1*log(1+(c+d*x)^2)+-3*d*b^3*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^2*log(2*(1+-1*im*(c+d*x))^-1)+3*b*d*a^2*(f^2+(d*e+-1*c*f)^2)^-1*log(e+f*x)+3*d*b^3*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^2*log(2*(1+im*(c+d*x))^-1)+3*d*b^3*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^2*log(2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+d*b^3*f^-1*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^3*(d*e+-1*c*f)+-6*a*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)*log(2*(1+-1*im*(c+d*x))^-1)+-3*im*a*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+-3*im*d*b^3*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))*arctan(c+d*x)+3*im*a*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^2+3*im*a*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+3*im*a*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*(c+d*x))^-1)+3*im*d*b^3*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)*arctan(c+d*x)+3*im*d*b^3*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*(c+d*x))^-1)*arctan(c+d*x)+6*a*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)*log(2*(1+im*(c+d*x))^-1)+6*a*d*b^2*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)*log(2*d*(1+-1*im*(c+d*x))^-1*(im*f+d*e+-1*c*f)^-1*(e+f*x))+3*a*d*b^2*f^-1*(d^2*e^2+f^2*(1+c^2)+-2*c*d*e*f)^-1*arctan(c+d*x)^2*(d*e+-1*c*f)+3*b*d*a^2*f^-1*(f^2+(d*e+-1*c*f)^2)^-1*(d*e+-1*c*f)*arctan(c+d*x))
@test integrate(x^3*arctan(a+b*x), x) == :(-1//12*b^-4*(a+b*x)^3+1//4*x^4*arctan(a+b*x)+(1/2)*a*b^-4*(a+b*x)^2+-1//4*b^-4*(1+a^4+-6*a^2)*arctan(a+b*x)+1//4*x*b^-3*(1+-6*a^2)+-1//2*a*b^-4*(1+-1*a^2)*log(1+(a+b*x)^2))
@test integrate(x^2*arctan(a+b*x), x) == :(-1//6*b^-3*(a+b*x)^2+1//3*x^3*arctan(a+b*x)+a*x*b^-2+1//6*b^-3*(1+-3*a^2)*log(1+(a+b*x)^2)+-1//3*a*b^-3*(3+-1*a^2)*arctan(a+b*x))
@test integrate(x*arctan(a+b*x), x) == :((1/2)*x^2*arctan(a+b*x)+-1//2*x*b^-1+(1/2)*a*b^-2*log(1+(a+b*x)^2)+(1/2)*b^-2*(1+-1*a^2)*arctan(a+b*x))
@test integrate(arctan(a+b*x), x) == :(-1//2*b^-1*log(1+(a+b*x)^2)+b^-1*(a+b*x)*arctan(a+b*x))
@test integrate(x^-1*arctan(a+b*x), x) == :(arctan(a+b*x)*log(2*b*x*(1+-1*im*(a+b*x))^-1*(im+-1a)^-1)+(1/2)*im*Polylogarithms.polylog(2,1+-2*(1+-1*im*(a+b*x))^-1)+-1*arctan(a+b*x)*log(2*(1+-1*im*(a+b*x))^-1)+-1//2*im*Polylogarithms.polylog(2,1+-2*b*x*(1+-1*im*(a+b*x))^-1*(im+-1a)^-1))
@test integrate(x^-2*arctan(a+b*x), x) == :(-1*x^-1*arctan(a+b*x)+b*(1+a^2)^-1*log(x)+-1*b*(2+2*a^2)^-1*log(1+(a+b*x)^2)+-1*a*b*(1+a^2)^-1*arctan(a+b*x))
@test integrate(x^-3*arctan(a+b*x), x) == :(-1//2*x^-2*arctan(a+b*x)+-1*b*x^-1*(2+2*a^2)^-1+(1/2)*a*b^2*(1+a^2)^-2*log(1+(a+b*x)^2)+-1*a*b^2*(1+a^2)^-2*log(x)+-1//2*b^2*(1+a^2)^-2*(1+-1*a^2)*arctan(a+b*x))
@test integrate(x^-4*arctan(a+b*x), x) == :(-1//3*x^-3*arctan(a+b*x)+-1*b*x^-2*(6+6*a^2)^-1+-1//3*b^3*(1+a^2)^-3*(1+-3*a^2)*log(x)+1//6*b^3*(1+a^2)^-3*(1+-3*a^2)*log(1+(a+b*x)^2)+2//3*a*b^2*x^-1*(1+a^2)^-2+1//3*a*b^3*(1+a^2)^-3*(3+-1*a^2)*arctan(a+b*x))
@test integrate((c+d*x^3)^-1*arctan(a+b*x), x) == :(-1//6*im*c^-2//3*d^-1//3*Polylogarithms.polylog(2,d^1//3*(b*c^1//3+d^1//3*(im+-1a))^-1*(im+-1a+-1*b*x))+-1//6*(-1)^1//6*c^-2//3*d^-1//3*Polylogarithms.polylog(2,(-1)^1//3*d^1//3*(b*c^1//3+(-1)^1//3*d^1//3*(im+a))^-1*(im+a+b*x))+-1//6*(-1)^5//6*c^-2//3*d^-1//3*Polylogarithms.polylog(2,-1*(-1)^2//3*d^1//3*(b*c^1//3+-1*(-1)^2//3*d^1//3*(im+a))^-1*(im+a+b*x))+1//6*im*c^-2//3*d^-1//3*Polylogarithms.polylog(2,-1*d^1//3*(b*c^1//3+-1*d^1//3*(im+a))^-1*(im+a+b*x))+1//6*(-1)^1//6*c^-2//3*d^-1//3*Polylogarithms.polylog(2,-1*(-1)^1//3*d^1//3*(b*c^1//3+-1*(-1)^1//3*d^1//3*(im+-1a))^-1*(im+-1a+-1*b*x))+1//6*(-1)^5//6*c^-2//3*d^-1//3*Polylogarithms.polylog(2,-1*(-1)^1//6*d^1//3*(im*b*c^1//3+-1*(-1)^1//6*d^1//3*(im+-1a))^-1*(im+-1a+-1*b*x))+-1//6*im*c^-2//3*d^-1//3*log(b*(b*c^1//3+d^1//3*(im+-1a))^-1*(c^1//3+x*d^1//3))*log(1+im*a+im*b*x)+-1//6*(-1)^1//6*c^-2//3*d^-1//3*log(b*(b*c^1//3+(-1)^1//3*d^1//3*(im+a))^-1*(c^1//3+-1*x*(-1)^1//3*d^1//3))*log(1+-1*im*a+-1*im*b*x)+-1//6*(-1)^5//6*c^-2//3*d^-1//3*log(b*(b*c^1//3+(-1)^1//6*d^1//3*(1+-1*im*a))^-1*(c^1//3+x*(-1)^2//3*d^1//3))*log(1+-1*im*a+-1*im*b*x)+1//6*im*c^-2//3*d^-1//3*log(b*(b*c^1//3+-1*d^1//3*(im+a))^-1*(c^1//3+x*d^1//3))*log(1+-1*im*a+-1*im*b*x)+1//6*(-1)^1//6*c^-2//3*d^-1//3*log(b*(b*c^1//3+-1*(-1)^1//3*d^1//3*(im+-1a))^-1*(c^1//3+-1*x*(-1)^1//3*d^1//3))*log(1+im*a+im*b*x)+1//6*(-1)^5//6*c^-2//3*d^-1//3*log(b*(b*c^1//3+(-1)^2//3*d^1//3*(im+-1a))^-1*(c^1//3+x*(-1)^2//3*d^1//3))*log(1+im*a+im*b*x))
@test integrate((c+d*x^2)^-1*arctan(a+b*x), x) == :(-1//4*im*d^-1//2*(-1c)^-1//2*Polylogarithms.polylog(2,-1*d^(1/2)*(b*(-1c)^(1/2)+-1*d^(1/2)*(im+a))^-1*(im+a+b*x))+-1//4*im*d^-1//2*(-1c)^-1//2*Polylogarithms.polylog(2,-1*d^(1/2)*(b*(-1c)^(1/2)+-1*d^(1/2)*(im+-1a))^-1*(im+-1a+-1*b*x))+1//4*im*d^-1//2*(-1c)^-1//2*Polylogarithms.polylog(2,d^(1/2)*(b*(-1c)^(1/2)+d^(1/2)*(im+a))^-1*(im+a+b*x))+1//4*im*d^-1//2*(-1c)^-1//2*Polylogarithms.polylog(2,d^(1/2)*(b*(-1c)^(1/2)+d^(1/2)*(im+-1a))^-1*(im+-1a+-1*b*x))+-1//4*im*d^-1//2*(-1c)^-1//2*log(b*(b*(-1c)^(1/2)+-1*d^(1/2)*(im+a))^-1*((-1c)^(1/2)+x*d^(1/2)))*log(1+-1*im*a+-1*im*b*x)+-1//4*im*d^-1//2*(-1c)^-1//2*log(b*(b*(-1c)^(1/2)+-1*d^(1/2)*(im+-1a))^-1*((-1c)^(1/2)+-1*x*d^(1/2)))*log(1+im*a+im*b*x)+1//4*im*d^-1//2*(-1c)^-1//2*log(b*(b*(-1c)^(1/2)+d^(1/2)*(im+a))^-1*((-1c)^(1/2)+-1*x*d^(1/2)))*log(1+-1*im*a+-1*im*b*x)+1//4*im*d^-1//2*(-1c)^-1//2*log(b*(b*(-1c)^(1/2)+d^(1/2)*(im+-1a))^-1*((-1c)^(1/2)+x*d^(1/2)))*log(1+im*a+im*b*x))
@test integrate((c+d*x)^-1*arctan(a+b*x), x) == :(d^-1*arctan(a+b*x)*log(2*b*(1+-1*im*(a+b*x))^-1*(im*d+b*c+-1*a*d)^-1*(c+d*x))+(1/2)*im*d^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*(a+b*x))^-1)+-1*d^-1*arctan(a+b*x)*log(2*(1+-1*im*(a+b*x))^-1)+-1//2*im*d^-1*Polylogarithms.polylog(2,1+-2*b*(1+-1*im*(a+b*x))^-1*(im*d+b*c+-1*a*d)^-1*(c+d*x)))
@test integrate((c+d*x^-1)^-1*arctan(a+b*x), x) == :((1/2)*im*d*c^-2*Polylogarithms.polylog(2,c*(im*c+b*d+-1*a*c)^-1*(im+-1a+-1*b*x))+-1//2*im*d*c^-2*Polylogarithms.polylog(2,c*(c*(im+a)+-1*b*d)^-1*(im+a+b*x))+-1//2*b^-1*c^-1*(1+im*a+im*b*x)*log(1+im*a+im*b*x)+-1//2*b^-1*c^-1*(1+-1*im*a+-1*im*b*x)*log(-1*im*(im+a+b*x))+(1/2)*im*d*c^-2*log(b*(b*d+c*(im+-1a))^-1*(d+c*x))*log(1+im*a+im*b*x)+-1//2*im*d*c^-2*log(-1*b*(c*(im+a)+-1*b*d)^-1*(d+c*x))*log(1+-1*im*a+-1*im*b*x))
@test integrate((c+d*x^-2)^-1*arctan(a+b*x), x) == :(-1//2*b^-1*c^-1*(1+im*a+im*b*x)*log(1+im*a+im*b*x)+-1//2*b^-1*c^-1*(1+-1*im*a+-1*im*b*x)*log(-1*im*(im+a+b*x))+-1//4*im*d^(1/2)*(-1c)^-3//2*Polylogarithms.polylog(2,(-1c)^(1/2)*((-1c)^(1/2)*(1+im*a)+-1*im*b*d^(1/2))^-1*(1+im*a+im*b*x))+-1//4*im*d^(1/2)*(-1c)^-3//2*Polylogarithms.polylog(2,(-1c)^(1/2)*(im*(-1c)^(1/2)+a*(-1c)^(1/2)+b*d^(1/2))^-1*(im+a+b*x))+1//4*im*d^(1/2)*(-1c)^-3//2*Polylogarithms.polylog(2,(-1c)^(1/2)*(im*(-1c)^(1/2)+a*(-1c)^(1/2)+-1*b*d^(1/2))^-1*(im+a+b*x))+1//4*im*d^(1/2)*(-1c)^-3//2*Polylogarithms.polylog(2,(-1c)^(1/2)*(im*(-1c)^(1/2)+-1*a*(-1c)^(1/2)+-1*b*d^(1/2))^-1*(im+-1a+-1*b*x))+-1//4*im*d^(1/2)*(-1c)^-3//2*log(b*(im*(-1c)^(1/2)+a*(-1c)^(1/2)+b*d^(1/2))^-1*(d^(1/2)+-1*x*(-1c)^(1/2)))*log(1+-1*im*a+-1*im*b*x)+-1//4*im*d^(1/2)*(-1c)^-3//2*log(b*(im*(-1c)^(1/2)+b*d^(1/2)+-1*a*(-1c)^(1/2))^-1*(d^(1/2)+x*(-1c)^(1/2)))*log(1+im*a+im*b*x)+1//4*im*d^(1/2)*(-1c)^-3//2*log(-1*b*((-1c)^(1/2)*(im+a)+-1*b*d^(1/2))^-1*(d^(1/2)+x*(-1c)^(1/2)))*log(1+-1*im*a+-1*im*b*x)+1//4*im*d^(1/2)*(-1c)^-3//2*log(-1*b*(im*(-1c)^(1/2)+-1*a*(-1c)^(1/2)+-1*b*d^(1/2))^-1*(d^(1/2)+-1*x*(-1c)^(1/2)))*log(1+im*a+im*b*x))
@test integrate((c+d*x^-3)^-1*arctan(a+b*x), x) == :(-1//2*b^-1*c^-1*(1+im*a+im*b*x)*log(1+im*a+im*b*x)+-1//2*b^-1*c^-1*(1+-1*im*a+-1*im*b*x)*log(-1*im*(im+a+b*x))+-1//6*im*c^-4//3*d^1//3*Polylogarithms.polylog(2,c^1//3*(c^1//3*(im+a)+-1*b*d^1//3)^-1*(im+a+b*x))+-1//6*(-1)^1//6*c^-4//3*d^1//3*Polylogarithms.polylog(2,(-1)^1//3*c^1//3*(-1*b*d^1//3+(-1)^1//3*c^1//3*(im+-1a))^-1*(im+-1a+-1*b*x))+-1//6*(-1)^5//6*c^-4//3*d^1//3*Polylogarithms.polylog(2,(-1)^1//6*c^1//3*((-1)^1//6*c^1//3*(im+-1a)+-1*im*b*d^1//3)^-1*(im+-1a+-1*b*x))+1//6*im*c^-4//3*d^1//3*Polylogarithms.polylog(2,c^1//3*(b*d^1//3+c^1//3*(im+-1a))^-1*(im+-1a+-1*b*x))+1//6*(-1)^1//6*c^-4//3*d^1//3*Polylogarithms.polylog(2,(-1)^1//3*c^1//3*(b*d^1//3+(-1)^1//3*c^1//3*(im+a))^-1*(im+a+b*x))+1//6*(-1)^5//6*c^-4//3*d^1//3*Polylogarithms.polylog(2,(-1)^2//3*c^1//3*(-1*b*d^1//3+(-1)^2//3*c^1//3*(im+a))^-1*(im+a+b*x))+-1//6*im*c^-4//3*d^1//3*log(-1*b*(c^1//3*(im+a)+-1*b*d^1//3)^-1*(d^1//3+x*c^1//3))*log(1+-1*im*a+-1*im*b*x)+-1//6*(-1)^1//6*c^-4//3*d^1//3*log(-1*b*(-1*b*d^1//3+(-1)^1//3*c^1//3*(im+-1a))^-1*(d^1//3+-1*x*(-1)^1//3*c^1//3))*log(1+im*a+im*b*x)+-1//6*(-1)^5//6*c^-4//3*d^1//3*log(b*(b*d^1//3+(-1)^2//3*c^1//3*(im+-1a))^-1*(d^1//3+x*(-1)^2//3*c^1//3))*log(1+im*a+im*b*x)+1//6*im*c^-4//3*d^1//3*log(b*(b*d^1//3+c^1//3*(im+-1a))^-1*(d^1//3+x*c^1//3))*log(1+im*a+im*b*x)+1//6*(-1)^1//6*c^-4//3*d^1//3*log(b*(b*d^1//3+(-1)^1//3*c^1//3*(im+a))^-1*(d^1//3+-1*x*(-1)^1//3*c^1//3))*log(1+-1*im*a+-1*im*b*x)+1//6*(-1)^5//6*c^-4//3*d^1//3*log(b*(b*d^1//3+(-1)^1//6*c^1//3*(1+-1*im*a))^-1*(d^1//3+x*(-1)^2//3*c^1//3))*log(1+-1*im*a+-1*im*b*x))
@test integrate((c+d*x^(1/2))^-1*arctan(a+b*x), x) == :(im*c*d^-2*Polylogarithms.polylog(2,b^(1/2)*(c*b^(1/2)+d*(-1im+-1a)^(1/2))^-1*(c+d*x^(1/2)))+im*c*d^-2*Polylogarithms.polylog(2,b^(1/2)*(c*b^(1/2)+-1*d*(-1im+-1a)^(1/2))^-1*(c+d*x^(1/2)))+im*d^-1*x^(1/2)*log(1+-1*im*a+-1*im*b*x)+-1*im*c*d^-2*Polylogarithms.polylog(2,b^(1/2)*(c*b^(1/2)+d*(im+-1a)^(1/2))^-1*(c+d*x^(1/2)))+-1*im*c*d^-2*Polylogarithms.polylog(2,b^(1/2)*(c*b^(1/2)+-1*d*(im+-1a)^(1/2))^-1*(c+d*x^(1/2)))+-1*im*d^-1*x^(1/2)*log(1+im*a+im*b*x)+im*c*d^-2*log(d*(c*b^(1/2)+d*(-1im+-1a)^(1/2))^-1*((-1im+-1a)^(1/2)+-1*b^(1/2)*x^(1/2)))*log(c+d*x^(1/2))+im*c*d^-2*log(-1*d*(c*b^(1/2)+-1*d*(-1im+-1a)^(1/2))^-1*((-1im+-1a)^(1/2)+b^(1/2)*x^(1/2)))*log(c+d*x^(1/2))+im*c*d^-2*log(c+d*x^(1/2))*log(1+im*a+im*b*x)+-1*im*c*d^-2*log(d*(c*b^(1/2)+d*(im+-1a)^(1/2))^-1*((im+-1a)^(1/2)+-1*b^(1/2)*x^(1/2)))*log(c+d*x^(1/2))+-1*im*c*d^-2*log(-1*d*(c*b^(1/2)+-1*d*(im+-1a)^(1/2))^-1*((im+-1a)^(1/2)+b^(1/2)*x^(1/2)))*log(c+d*x^(1/2))+-1*im*c*d^-2*log(c+d*x^(1/2))*log(1+-1*im*a+-1*im*b*x)+-2*im*b^-1//2*d^-1*(im+-1a)^(1/2)*arctanh(b^(1/2)*x^(1/2)*(im+-1a)^-1//2)+2*im*b^-1//2*d^-1*(im+a)^(1/2)*arctan(b^(1/2)*x^(1/2)*(im+a)^-1//2))
@test integrate((c+d*x^-1//2)^-1*arctan(a+b*x), x) == :(im*c^-3*d^2*Polylogarithms.polylog(2,b^(1/2)*(c*(im+-1a)^(1/2)+d*b^(1/2))^-1*(d+c*x^(1/2)))+im*c^-3*d^2*Polylogarithms.polylog(2,-1*b^(1/2)*(c*(im+-1a)^(1/2)+-1*d*b^(1/2))^-1*(d+c*x^(1/2)))+-1*im*c^-3*d^2*Polylogarithms.polylog(2,b^(1/2)*(c*(-1im+-1a)^(1/2)+d*b^(1/2))^-1*(d+c*x^(1/2)))+-1*im*c^-3*d^2*Polylogarithms.polylog(2,-1*b^(1/2)*(c*(-1im+-1a)^(1/2)+-1*d*b^(1/2))^-1*(d+c*x^(1/2)))+-1//2*b^-1*c^-1*(1+im*a+im*b*x)*log(1+im*a+im*b*x)+-1//2*b^-1*c^-1*(1+-1*im*a+-1*im*b*x)*log(-1*im*(im+a+b*x))+im*d*c^-2*x^(1/2)*log(1+im*a+im*b*x)+im*c^-3*d^2*log(c*(c*(im+-1a)^(1/2)+d*b^(1/2))^-1*((im+-1a)^(1/2)+-1*b^(1/2)*x^(1/2)))*log(d+c*x^(1/2))+im*c^-3*d^2*log(c*(c*(im+-1a)^(1/2)+-1*d*b^(1/2))^-1*((im+-1a)^(1/2)+b^(1/2)*x^(1/2)))*log(d+c*x^(1/2))+im*c^-3*d^2*log(d+c*x^(1/2))*log(1+-1*im*a+-1*im*b*x)+-1*im*d*c^-2*x^(1/2)*log(1+-1*im*a+-1*im*b*x)+-1*im*c^-3*d^2*log(c*(c*(-1im+-1a)^(1/2)+d*b^(1/2))^-1*((-1im+-1a)^(1/2)+-1*b^(1/2)*x^(1/2)))*log(d+c*x^(1/2))+-1*im*c^-3*d^2*log(c*(c*(-1im+-1a)^(1/2)+-1*d*b^(1/2))^-1*((-1im+-1a)^(1/2)+b^(1/2)*x^(1/2)))*log(d+c*x^(1/2))+-1*im*c^-3*d^2*log(d+c*x^(1/2))*log(1+im*a+im*b*x)+-2*im*d*b^-1//2*c^-2*(im+a)^(1/2)*arctan(b^(1/2)*x^(1/2)*(im+a)^-1//2)+2*im*d*b^-1//2*c^-2*(im+-1a)^(1/2)*arctanh(b^(1/2)*x^(1/2)*(im+-1a)^-1//2))
@test integrate((1+x^2)^-1*arctan(a+b*x), x) == :(-1//4*Polylogarithms.polylog(2,(im+a+-1*im*b)^-1*(im+a+b*x))+-1//4*Polylogarithms.polylog(2,-1*(a+-1*im*(1+-1b))^-1*(im+-1a+-1*b*x))+1//4*Polylogarithms.polylog(2,(a+im*(1+b))^-1*(im+a+b*x))+1//4*Polylogarithms.polylog(2,-1*(a+-1*im*(1+b))^-1*(im+-1a+-1*b*x))+-1//4*log(b*(a+-1*im*(1+-1b))^-1*(im+-1x))*log(1+im*a+im*b*x)+-1//4*log(-1*b*(a+im*(1+-1b))^-1*(im+x))*log(1+-1*im*a+-1*im*b*x)+1//4*log(b*(a+im*(1+b))^-1*(im+-1x))*log(1+-1*im*a+-1*im*b*x)+1//4*log(-1*b*(a+-1*im*(1+b))^-1*(im+x))*log(1+im*a+im*b*x))
@test integrate((a+b*x^2)^-1*arctan(d+e*x), x) == :(-1//4*im*b^-1//2*(-1a)^-1//2*Polylogarithms.polylog(2,b^(1/2)*(b^(1/2)*(im+d)+-1*e*(-1a)^(1/2))^-1*(im+d+e*x))+-1//4*im*b^-1//2*(-1a)^-1//2*Polylogarithms.polylog(2,b^(1/2)*(b^(1/2)*(im+-1d)+-1*e*(-1a)^(1/2))^-1*(im+-1d+-1*e*x))+1//4*im*b^-1//2*(-1a)^-1//2*Polylogarithms.polylog(2,b^(1/2)*(e*(-1a)^(1/2)+b^(1/2)*(im+d))^-1*(im+d+e*x))+1//4*im*b^-1//2*(-1a)^-1//2*Polylogarithms.polylog(2,b^(1/2)*(e*(-1a)^(1/2)+b^(1/2)*(im+-1d))^-1*(im+-1d+-1*e*x))+-1//4*im*b^-1//2*(-1a)^-1//2*log(-1*e*(b^(1/2)*(im+d)+-1*e*(-1a)^(1/2))^-1*((-1a)^(1/2)+x*b^(1/2)))*log(1+-1*im*d+-1*im*e*x)+-1//4*im*b^-1//2*(-1a)^-1//2*log(-1*e*(b^(1/2)*(im+-1d)+-1*e*(-1a)^(1/2))^-1*((-1a)^(1/2)+-1*x*b^(1/2)))*log(1+im*d+im*e*x)+1//4*im*b^-1//2*(-1a)^-1//2*log(e*(e*(-1a)^(1/2)+b^(1/2)*(im+d))^-1*((-1a)^(1/2)+-1*x*b^(1/2)))*log(1+-1*im*d+-1*im*e*x)+1//4*im*b^-1//2*(-1a)^-1//2*log(e*(e*(-1a)^(1/2)+b^(1/2)*(im+-1d))^-1*((-1a)^(1/2)+x*b^(1/2)))*log(1+im*d+im*e*x))
@test integrate((a+b*x+c*x^2)^-1*arctan(d+e*x), x) == :((b^2+-4*a*c)^-1//2*arctan(d+e*x)*log(2*e*(1+-1*im*(d+e*x))^-1*(e*(b+-1*(b^2+-4*a*c)^(1/2))+2*c*(im+-1d))^-1*(b+-1*(b^2+-4*a*c)^(1/2)+2*c*x))+(1/2)*im*(b^2+-4*a*c)^-1//2*Polylogarithms.polylog(2,1+(1+-1*im*(d+e*x))^-1*(e*(b+(b^2+-4*a*c)^(1/2))+2*c*(im+-1d))^-1*(-4*c*(d+e*x)+-2*e*(b+(b^2+-4*a*c)^(1/2))+4*c*d))+-1*(b^2+-4*a*c)^-1//2*arctan(d+e*x)*log(2*e*(1+-1*im*(d+e*x))^-1*(e*(b+(b^2+-4*a*c)^(1/2))+2*c*(im+-1d))^-1*(b+(b^2+-4*a*c)^(1/2)+2*c*x))+-1//2*im*(b^2+-4*a*c)^-1//2*Polylogarithms.polylog(2,1+(1+-1*im*(d+e*x))^-1*(b*e+-1*e*(b^2+-4*a*c)^(1/2)+-2*c*d+2*im*c)^-1*(-4*c*(d+e*x)+-2*e*(b+-1*(b^2+-4*a*c)^(1/2))+4*c*d)))
@test integrate((1+a^2+b^2*x^2+2*a*b*x)^-1//2*arctan(a+b*x), x) == :(im*b^-1*Polylogarithms.polylog(2,-1*im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+-1*im*b^-1*Polylogarithms.polylog(2,im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+-2*im*b^-1*arctan((1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)*arctan(a+b*x))
@test integrate((c*(1+a^2)+c*b^2*x^2+2*a*b*c*x)^-1//2*arctan(a+b*x), x) == :(im*b^-1*(1+(a+b*x)^2)^(1/2)*(c+c*(a+b*x)^2)^-1//2*Polylogarithms.polylog(2,-1*im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+-1*im*b^-1*(1+(a+b*x)^2)^(1/2)*(c+c*(a+b*x)^2)^-1//2*Polylogarithms.polylog(2,im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+-2*im*b^-1*(1+(a+b*x)^2)^(1/2)*(c+c*(a+b*x)^2)^-1//2*arctan((1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)*arctan(a+b*x))
@test integrate((a+b*x)^2*(1+a^2+b^2*x^2+2*a*b*x)^-1//2*arctan(a+b*x), x) == :(-1//2*b^-1*(1+(a+b*x)^2)^(1/2)+(1/2)*im*b^-1*Polylogarithms.polylog(2,im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+-1//2*im*b^-1*Polylogarithms.polylog(2,-1*im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+im*b^-1*arctan((1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)*arctan(a+b*x)+(1/2)*b^-1*(1+(a+b*x)^2)^(1/2)*(a+b*x)*arctan(a+b*x))
@test integrate((a+b*x)^2*(c*(1+a^2)+c*b^2*x^2+2*a*b*c*x)^-1//2*arctan(a+b*x), x) == :(-1//2*b^-1*c^-1*(c+c*(a+b*x)^2)^(1/2)+(1/2)*im*b^-1*(1+(a+b*x)^2)^(1/2)*(c+c*(a+b*x)^2)^-1//2*Polylogarithms.polylog(2,im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+(1/2)*b^-1*c^-1*(c+c*(a+b*x)^2)^(1/2)*(a+b*x)*arctan(a+b*x)+-1//2*im*b^-1*(1+(a+b*x)^2)^(1/2)*(c+c*(a+b*x)^2)^-1//2*Polylogarithms.polylog(2,-1*im*(1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)+im*b^-1*(1+(a+b*x)^2)^(1/2)*(c+c*(a+b*x)^2)^-1//2*arctan((1+im*(a+b*x))^(1/2)*(1+-1*im*(a+b*x))^-1//2)*arctan(a+b*x))

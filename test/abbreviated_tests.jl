using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@testset "Apostol Problems.jl" begin
	@test integrate((1+2x)^(1/2), x) == :(1//3*(1+2x)^3//2)
	@test integrate(x*(1+3x)^(1/2), x) == :(-2//27*(1+3x)^3//2+2//45*(1+3x)^5//2)
	@test integrate(x^2*(1+x)^(1/2), x) == :(-4//5*(1+x)^5//2+2//3*(1+x)^3//2+2//7*(1+x)^7//2)
	@test integrate(x*(2+-3x)^-1//2, x) == :(-4//9*(2+-3x)^(1/2)+2//27*(2+-3x)^3//2)
	@test integrate((2+x^2+2x)^-3*(1+x), x) == :(-1//4*(2+x^2+2x)^-2)
	@test integrate(sin(x)^3, x) == :(-1*cos(x)+1//3*cos(x)^3)
	@test integrate(z*(-1+z)^1//3, z) == :(3//4*(-1+z)^4//3+3//7*(-1+z)^7//3)
	@test integrate(sin(x)^-3*cos(x), x) == :(-1//2*csc(x)^2)
	@test integrate((4+-1*sin(2x))^(1/2)*cos(2x), x) == :(-1//3*(4+-1*sin(2x))^3//2)
	@test integrate((3+cos(x))^-2*sin(x), x) == :((3+cos(x))^-1)
end

@testset "Bondarenko Problems.jl" begin
	@test integrate((2^(1/2)+cos(z)+sin(z))^-1, z) == :(-1*(-1*sin(z)+cos(z))^-1*(1+-1*2^(1/2)*sin(z)))
	@test integrate(((1+x)^(1/2)+(1+-1x)^(1/2))^-2, x) == :((1/2)*arcsin(x)+-1//2*x^-1+(1/2)*x^-1*(1+-1*x^2)^(1/2))
	@test integrate((1+cos(x))^-2, x) == :((3+3*cos(x))^-1*sin(x)+1//3*(1+cos(x))^-2*sin(x))
	@test integrate((1+x)^-1//2*sin(x), x) == :(2^(1/2)*pi^(1/2)*cos(1)*fresnels(2^(1/2)*pi^-1//2*(1+x)^(1/2))+-1*2^(1/2)*pi^(1/2)*fresnelc(2^(1/2)*pi^-1//2*(1+x)^(1/2))*sin(1))
	@test integrate((cos(x)+sin(x))^-6, x) == :(2*(15*cos(x)+15*sin(x))^-1*sin(x)+-1//10*(cos(x)+sin(x))^-5*(-1*sin(x)+cos(x))+-1//15*(cos(x)+sin(x))^-3*(-1*sin(x)+cos(x)))
	@test integrate(log(x^-4+x^4), x) == :(-4x+x*log(x^-4+x^4)+(2+2^(1/2))^(1/2)*arctan((2+2^(1/2))^-1//2*((2+-1*2^(1/2))^(1/2)+2x))+(2+-1*2^(1/2))^(1/2)*arctan((2+-1*2^(1/2))^-1//2*((2+2^(1/2))^(1/2)+2x))+(1/2)*(2+2^(1/2))^(1/2)*log(1+x^2+x*(2+2^(1/2))^(1/2))+(1/2)*(2+-1*2^(1/2))^(1/2)*log(1+x^2+x*(2+-1*2^(1/2))^(1/2))+-1*(2+2^(1/2))^(1/2)*arctan((2+2^(1/2))^-1//2*((2+-1*2^(1/2))^(1/2)+-2x))+-1*(2+-1*2^(1/2))^(1/2)*arctan((2+-1*2^(1/2))^-1//2*((2+2^(1/2))^(1/2)+-2x))+-1//2*(2+2^(1/2))^(1/2)*log(1+x^2+-1*x*(2+2^(1/2))^(1/2))+-1//2*(2+-1*2^(1/2))^(1/2)*log(1+x^2+-1*x*(2+-1*2^(1/2))^(1/2)))
	@test integrate(x^-1*(1+(1+x)^(1/2))^-1//2*log(1+x), x) == :(-8*arctanh((1+(1+x)^(1/2))^(1/2))+2^(1/2)*Polylogarithms.polylog(2,2^(1/2)*(2+2^(1/2))^-1*(1+(1+(1+x)^(1/2))^(1/2)))+2^(1/2)*Polylogarithms.polylog(2,-1*2^(1/2)*(2+-1*2^(1/2))^-1*(1+-1*(1+(1+x)^(1/2))^(1/2)))+-1*2^(1/2)*Polylogarithms.polylog(2,2^(1/2)*(2+2^(1/2))^-1*(1+-1*(1+(1+x)^(1/2))^(1/2)))+-1*2^(1/2)*Polylogarithms.polylog(2,-1*2^(1/2)*(2+-1*2^(1/2))^-1*(1+(1+(1+x)^(1/2))^(1/2)))+-2*(1+(1+x)^(1/2))^-1//2*log(1+x)+-1*2^(1/2)*arctanh((1/2)*2^(1/2)*(1+(1+x)^(1/2))^(1/2))*log(1+x)+-2*2^(1/2)*arctanh((1/2)*2^(1/2))*log(1+(1+(1+x)^(1/2))^(1/2))+2*2^(1/2)*arctanh((1/2)*2^(1/2))*log(1+-1*(1+(1+x)^(1/2))^(1/2)))
	@test integrate(x^-1*(1+(1+x)^(1/2))^(1/2)*log(1+x), x) == :(-16*(1+(1+x)^(1/2))^(1/2)+16*arctanh((1+(1+x)^(1/2))^(1/2))+-2*2^(1/2)*Polylogarithms.polylog(2,2^(1/2)*(2+2^(1/2))^-1*(1+-1*(1+(1+x)^(1/2))^(1/2)))+-2*2^(1/2)*Polylogarithms.polylog(2,-1*2^(1/2)*(2+-1*2^(1/2))^-1*(1+(1+(1+x)^(1/2))^(1/2)))+2*2^(1/2)*Polylogarithms.polylog(2,2^(1/2)*(2+2^(1/2))^-1*(1+(1+(1+x)^(1/2))^(1/2)))+2*2^(1/2)*Polylogarithms.polylog(2,-1*2^(1/2)*(2+-1*2^(1/2))^-1*(1+-1*(1+(1+x)^(1/2))^(1/2)))+4*(1+(1+x)^(1/2))^(1/2)*log(1+x)+-4*2^(1/2)*arctanh((1/2)*2^(1/2))*log(1+(1+(1+x)^(1/2))^(1/2))+-2*2^(1/2)*arctanh((1/2)*2^(1/2)*(1+(1+x)^(1/2))^(1/2))*log(1+x)+4*2^(1/2)*arctanh((1/2)*2^(1/2))*log(1+-1*(1+(1+x)^(1/2))^(1/2)))
	@test integrate((1+(x+(1+x^2)^(1/2))^(1/2))^-1, x) == :((x+(1+x^2)^(1/2))^(1/2)+(x+(1+x^2)^(1/2))^-1//2+(1/2)*log(x+(1+x^2)^(1/2))+-1*(2x+2*(1+x^2)^(1/2))^-1+-2*log(1+(x+(1+x^2)^(1/2))^(1/2)))
	@test integrate((1+x)^(1/2)*(x+(1+(1+x)^(1/2))^(1/2))^-1, x) == :(2*(1+x)^(1/2)+8//5*5^(1/2)*arctanh(1//5*5^(1/2)*(1+2*(1+(1+x)^(1/2))^(1/2))))
end

@testset "Bronstein Problems.jl" begin
	@test integrate((1+x^8)^(1/2)*(x+x^17+2*x^9)^-1*(1+2*x^8), x) == :(-1//4*(1+x^8)^-1//2+-1//4*arctanh((1+x^8)^(1/2)))
	@test integrate((1+x^2)^-1, x) == :(arctan(x))
	@test integrate(x^-1*(1+x^8)^-1//2, x) == :(-1//4*arctanh((1+x^8)^(1/2)))
	@test integrate(x*(1+-1*x^3)^-1//2, x) == :(2*(1+-1*x^3)^(1/2)*(1+3^(1/2)+-1x)^-1+-1*3^1//4*((1+3^(1/2)+-1x)^-2*(1+-1x))^-1//2*((1+3^(1/2)+-1x)^-2*(1+x+x^2))^(1/2)*(1+-1*x^3)^-1//2*(2+-1*3^(1/2))^(1/2)*(1+-1x)*Elliptic.E(arcsin((1+3^(1/2)+-1x)^-1*(1+-1x+-1*3^(1/2))),-7+-4*3^(1/2))+2//3*2^(1/2)*3^3//4*((1+3^(1/2)+-1x)^-2*(1+-1x))^-1//2*((1+3^(1/2)+-1x)^-2*(1+x+x^2))^(1/2)*(1+-1*x^3)^-1//2*(1+-1x)*Elliptic.F(arcsin((1+3^(1/2)+-1x)^-1*(1+-1x+-1*3^(1/2))),-7+-4*3^(1/2)))
	@test integrate(x^-1*(1+-1*x^3)^-1//2, x) == :(-2//3*arctanh((1+-1*x^3)^(1/2)))
	@test integrate(x*(-71+x^4+-96x+10*x^2)^-1//2, x) == :(1//8*log(10001+x^8+-1408*x^3+-128*x^5+20*x^6+54*x^4+3124*x^2+(-71+x^4+-96x+10*x^2)^(1/2)*(781+x^6+-528x+-80*x^3+15*x^4+27*x^2)))
	@test integrate(tan(x)^-2*(x+-1*tan(x)), x) == :(-1//2*x^2+-1*x*cot(x))
	@test integrate(1+tan(x)^2+x*tan(x), x) == :((1/2)*im*x^2+(1/2)*im*Polylogarithms.polylog(2,-1*exp(2*im*x))+-1*x*log(1+exp(2*im*x))+tan(x))
	@test integrate(x^-1*sin(x), x) == :(sinintegral(x))
	@test integrate(x^-1*(x+exp(x))^-1//3*(3*(x+exp(x))^1//3+5*x^2+(2*x^2+3x)*exp(x)), x) == :(3*log(x)+3*x*(x+exp(x))^2//3)
end

@testset "Charlwood Problems.jl" begin
	@test integrate(x*(1+-1*x^2)^-1//2*arcsin(x), x) == :(x+-1*(1+-1*x^2)^(1/2)*arcsin(x))
	@test integrate(arcsin((1+x)^(1/2)+-1*x^(1/2)), x) == :(-1*(3//8+x)*arcsin(x^(1/2)+-1*(1+x)^(1/2))+1//8*2^(1/2)*(-1x+x^(1/2)*(1+x)^(1/2))^(1/2)*(x^(1/2)+3*(1+x)^(1/2)))
	@test integrate(log(1+x*(1+x^2)^(1/2)), x) == :(-2x+x*log(1+x*(1+x^2)^(1/2))+(2+2*5^(1/2))^(1/2)*arctan((-2+5^(1/2))^(1/2)*(x+(1+x^2)^(1/2)))+-1*(-2+2*5^(1/2))^(1/2)*arctanh((2+5^(1/2))^(1/2)*(x+(1+x^2)^(1/2))))
	@test integrate((1+cos(x)^2+cos(x)^4)^-1//2*cos(x)^2, x) == :(1//3*x+1//3*arctan((1+(1+cos(x)^2+cos(x)^4)^(1/2)*cos(x)^2)^-1*(1+cos(x)^2)*cos(x)*sin(x)))
	@test integrate((1+tan(x)^4)^(1/2)*tan(x), x) == :((1/2)*(1+tan(x)^4)^(1/2)+-1//2*arcsinh(tan(x)^2)+-1//2*2^(1/2)*arctanh((1/2)*2^(1/2)*(1+tan(x)^4)^-1//2*(1+-1*tan(x)^2)))
	@test integrate((1+sec(x)^3)^-1//2*tan(x), x) == :(-2//3*arctanh((1+sec(x)^3)^(1/2)))
	@test integrate((2+tan(x)^2+2*tan(x))^(1/2), x) == :(-1*(1/2+(1/2)*5^(1/2))^(1/2)*arctan((10+10*5^(1/2))^-1//2*(2+tan(x)^2+2*tan(x))^-1//2*(2*5^(1/2)+-1*(5+5^(1/2))*tan(x)))+-1*(-1//2+(1/2)*5^(1/2))^(1/2)*arctanh((-10+10*5^(1/2))^-1//2*(2+tan(x)^2+2*tan(x))^-1//2*(2*5^(1/2)+(5+-1*5^(1/2))*tan(x)))+arcsinh(1+tan(x)))
	@test integrate(arctan((-1+sec(x))^(1/2))*sin(x), x) == :((1/2)*arctan((-1+sec(x))^(1/2))+(1/2)*(-1+sec(x))^(1/2)*cos(x)+-1*arctan((-1+sec(x))^(1/2))*cos(x))
	@test integrate(x*(1+x^2)^-1//2*log(1+x^2)*log(x+(1+x^2)^(1/2)), x) == :(-2*arctan(x)+4x+-1*x*log(1+x^2)+-2*(1+x^2)^(1/2)*log(x+(1+x^2)^(1/2))+(1+x^2)^(1/2)*log(1+x^2)*log(x+(1+x^2)^(1/2)))
	@test integrate(arctan(x+(1+-1*x^2)^(1/2)), x) == :(-1//2*arcsin(x)+-1//4*arctanh(x*(1+-1*x^2)^(1/2))+-1//8*log(1+x^4+-1*x^2)+x*arctan(x+(1+-1*x^2)^(1/2))+-1//4*3^(1/2)*arctan(1//3*3^(1/2)*(-1+2*x^2))+1//4*3^(1/2)*arctan((1+-1*x^2)^-1//2*(1+x*3^(1/2)))+1//4*3^(1/2)*arctan((1+-1*x^2)^-1//2*(-1+x*3^(1/2))))
end

@testset "Hearn Problems.jl" begin
	@test integrate(1+x+x^2, x) == :(x+(1/2)*x^2+1//3*x^3)
	@test integrate(x^2*(x+2*x^2)^2, x) == :(1//5*x^5+2//3*x^6+4//7*x^7)
	@test integrate(x*(1+x^2+2x), x) == :((1/2)*x^2+1//4*x^4+2//3*x^3)
	@test integrate(x^-1, x) == :(log(x))
	@test integrate((1+x)^3*(-1+x)^-4, x) == :(-6*(1+-1x)^-2+6*(1+-1x)^-1+8//3*(1+-1x)^-3+log(1+-1x))
	@test integrate(x^-1*(1+x)^-2*(-1+x)^-1, x) == :(-1*(2+2x)^-1+-1*log(x)+1//4*log(1+-1x)+3//4*log(1+x))
	@test integrate((x+-1p)^-1*(x+-1q)^-1*(b+a*x), x) == :((p+-1q)^-1*(b+a*p)*log(p+-1x)+-1*(p+-1q)^-1*(b+a*q)*log(q+-1x))
	@test integrate((c+a*x^2+b*x)^-1, x) == :(-2*(b^2+-4*a*c)^-1//2*arctanh((b^2+-4*a*c)^-1//2*(b+2*a*x)))
	@test integrate((1+x^2)^-1*(b+a*x), x) == :(b*arctan(x)+(1/2)*a*log(1+x^2))
	@test integrate((3+x^2+-2x)^-1, x) == :(-1//2*2^(1/2)*arctan((1/2)*2^(1/2)*(1+-1x)))
end

@testset "Hebisch Problems.jl" begin
	@test integrate((1+x^4+x^6+-1*x^3+-1*x^5)*exp(x), x) == :(871*exp(x)+x^6*exp(x)+-870*x*exp(x)+-145*x^3*exp(x)+-7*x^5*exp(x)+36*x^4*exp(x)+435*x^2*exp(x))
	@test integrate((x^3+2x)^-1*(2+-1*x^2)*exp(x*(2+x^2)^-1), x) == :(expintegralei(x*(2+x^2)^-1))
	@test integrate((x^3+2x)^-1*(2+-1*x^3+2x+2*x^4+3*x^2)*exp(x*(2+x^2)^-1), x) == :((2+x^2)*exp(x*(2+x^2)^-1)+expintegralei(x*(2+x^2)^-1))
	@test integrate((x+exp(x))^-1*(1+exp(x))*exp(x+exp(x)), x) == :(expintegralei(x+exp(x)))
	@test integrate((1+x^3+-1x+-1*x^2)^-1*(1+x^3+-1*x^2+-3x)*exp((-1+x^2)^-1), x) == :((1+x)*exp((-1+x^2)^-1))
	@test integrate(log(x)^-2*(-1+log(x)^2)*exp(1+log(x)^-1), x) == :(x*exp(1+log(x)^-1))
	@test integrate(log(x)^-2*(-1+log(x)^2*(1+x))*exp(x+log(x)^-1), x) == :(x*exp(x+log(x)^-1))
end

@testset "Jeffrey Problems.jl" begin
	@test integrate(3*(5+-4*cos(x))^-1, x) == :(x+2*arctan((2+-1*cos(x))^-1*sin(x)))
	@test integrate((3+cos(x)^2+2*sin(x)+-2*cos(x)*sin(x))^-1*(1+2*sin(x)+cos(x)), x) == :(-1*arctan((2+sin(x))^-1*(-1*sin(x)+2*cos(x))))
	@test integrate((-2*sin(x)^2+-2*sin(x)+4*cos(x)+cos(x)*sin(x))^-1*(2+5*sin(x)+cos(x)), x) == :(-1*log(1+-3*cos(x)+sin(x))+log(3+cos(x)+sin(x)))
	@test integrate((1+-5*sin(x)+3*cos(x)^2+4*cos(x)+-1*cos(x)*sin(x))^-1*(3+2*sin(x)+7*cos(x)), x) == :(-1*log(1+-2*sin(x)+cos(x))+log(3+cos(x)+sin(x)))
	@test integrate((-1+-4*cos(x)+-3*cos(x)^2+4*cos(x)^3)^-1*(-1+4*cos(x)+5*cos(x)^2), x) == :(x+-2*arctan((3+cos(x))^-1*sin(x))+-2*arctan((1+2*cos(x)+5*cos(x)^2)^-1*(3*sin(x)+7*cos(x)*sin(x))))
	@test integrate((-1+-9*cos(x)^2+2*cos(x)+4*cos(x)^3)^-1*(-5+2*cos(x)+7*cos(x)^2), x) == :(x+-2*arctan(2*(1+-1*cos(x)+2*cos(x)^2)^-1*cos(x)*sin(x)))
	@test integrate(3*(5+4*sin(x))^-1, x) == :(x+2*arctan((2+sin(x))^-1*cos(x)))
	@test integrate(2*(1+cos(x)^2)^-1, x) == :(x*2^(1/2)+-1*2^(1/2)*arctan((1+2^(1/2)+cos(x)^2)^-1*cos(x)*sin(x)))
	@test integrate((p+q*cos(x)+r*sin(x))^-1, x) == :(2*(p^2+-1*q^2+-1*r^2)^-1//2*arctan((p^2+-1*q^2+-1*r^2)^-1//2*(r+(p+-1q)*tan((1/2)*x))))
end

@testset "Moses Problems.jl" begin
	@test integrate(cot(x)^4, x) == :(x+-1//3*cot(x)^3+cot(x))
	@test integrate(x^-4*(1+x^2)^-1, x) == :(x^-1+-1//3*x^-3+arctan(x))
	@test integrate(x^-1//2*(x+x^2), x) == :(2//3*x^3//2+2//5*x^5//2)
	@test integrate(cos(x), x) == :(sin(x))
	@test integrate(x*exp(x^2), x) == :((1/2)*exp(x^2))
	@test integrate(sec(x)^2*tan(x), x) == :((1/2)*sec(x)^2)
	@test integrate(x*(1+x^2)^(1/2), x) == :(1//3*(1+x^2)^3//2)
	@test integrate(exp(x)*sin(x), x) == :((1/2)*exp(x)*sin(x)+-1//2*cos(x)*exp(x))
	@test integrate(csc(x)^2*sin(x)^-2*cos(x), x) == :(-1//3*csc(x)^3)
	@test integrate(sin(exp(x)), x) == :(sinintegral(exp(x)))
end

@testset "Stewart Problems.jl" begin
	@test integrate(x^n, x) == :(x^(1+n)*(1+n)^-1)
	@test integrate(exp(x), x) == :(exp(x))
	@test integrate(x^-1, x) == :(log(x))
	@test integrate(a^x, x) == :(a^x*log(a)^-1)
	@test integrate(sin(x), x) == :(-1*cos(x))
	@test integrate(cos(x), x) == :(sin(x))
	@test integrate(sec(x)^2, x) == :(tan(x))
	@test integrate(csc(x)^2, x) == :(-1*cot(x))
	@test integrate(sec(x)*tan(x), x) == :(sec(x))
	@test integrate(cot(x)*csc(x), x) == :(-1*csc(x))
end

@testset "Timofeev Problems.jl" begin
	@test integrate((a^2+-1*b^2*x^2)^-1, x) == :(a^-1*b^-1*arctanh(b*x*a^-1))
	@test integrate((a^2+b^2*x^2)^-1, x) == :(a^-1*b^-1*arctan(b*x*a^-1))
	@test integrate(sec(2*a*x), x) == :((1/2)*a^-1*arctanh(sin(2*a*x)))
	@test integrate(1//4*sin(1//3*x)^-1, x) == :(-3//4*arctanh(cos(1//3*x)))
	@test integrate(-1*cos(2x+1//4*pi)^-1, x) == :(-1//2*arctanh(sin(2x+1//4*pi)))
	@test integrate(sec(x)*tan(x), x) == :(sec(x))
	@test integrate(cot(x)*csc(x), x) == :(-1*csc(x))
	@test integrate(sin(2x)^-1*tan(x), x) == :((1/2)*tan(x))
	@test integrate((1+cos(x))^-1, x) == :((1+cos(x))^-1*sin(x))
	@test integrate((1+-1*cos(x))^-1, x) == :(-1*(1+-1*cos(x))^-1*sin(x))
end

@testset "Welz Problems.jl" begin
	@test integrate((1+-1*a*x)^-1//2, x) == :(-2*a^-1*(1+-1*a*x)^(1/2))
	@test integrate(((1+x^2)^(1/2)+2x)^-2, x) == :(-2*(1+x^2)^(1/2)*(3+-9*x^2)^-1+4*x*(3+-9*x^2)^-1+-1//9*3^(1/2)*arctanh(x*3^(1/2))+1//9*3^(1/2)*arctanh((1/2)*3^(1/2)*(1+x^2)^(1/2)))
	@test integrate((-1+x^2)^-1//2*(-4+3*x^2)^-2, x) == :(5//16*arctanh((1/2)*x*(-1+x^2)^-1//2)+3*x*(-1+x^2)^(1/2)*(32+-24*x^2)^-1)
	@test integrate(((1+x)^(1/2)+2*x^(1/2))^-2, x) == :(8*(9+-27x)^-1+-8//9*arcsinh(x^(1/2))+5//9*log(1+-3x)+10//9*arctanh(2*x^(1/2)*(1+x)^-1//2)+-4*x^(1/2)*(1+x)^(1/2)*(3+-9x)^-1)
	@test integrate((-1+x^2)^(1/2)*(x+-1im)^-2, x) == :((-1+x^2)^(1/2)*(im+-1x)^-1+-1//2*im*2^(1/2)*arctan((1/2)*2^(1/2)*(-1+x^2)^-1//2*(1+-1*im*x))+arctanh(x*(-1+x^2)^-1//2))
	@test integrate((1+x^2)^-2*(-1+x^2)^-1//2, x) == :(3//8*2^(1/2)*arctanh(x*2^(1/2)*(-1+x^2)^-1//2)+-1*x*(-1+x^2)^(1/2)*(4+4*x^2)^-1)
	@test integrate((-1+x)^-1//2*(x^(1/2)+(-1+x)^(1/2))^-2, x) == :(2*(-1+x)^(1/2)+-4//3*x^3//2+4//3*(-1+x)^3//2)
	@test integrate((-1+x^2)^-1//2*(x^(1/2)+(-1+x^2)^(1/2))^-2, x) == :((5*x^(1/2)+5*(-1+x^2)^(1/2))^-1*(2+-4x)+-1//25*(110+50*5^(1/2))^(1/2)*arctanh((1/2)*x^(1/2)*(-2+2*5^(1/2))^(1/2))+-1//50*(-110+50*5^(1/2))^(1/2)*arctan((-1+x^2)^(1/2)*(-2+2*5^(1/2))^(1/2)*(2+-1*x*(1+-1*5^(1/2)))^-1)+-1//50*(110+50*5^(1/2))^(1/2)*arctanh((-1+x^2)^(1/2)*(2+2*5^(1/2))^(1/2)*(2+-1x+-1*x*5^(1/2))^-1)+1//25*(-110+50*5^(1/2))^(1/2)*arctan((1/2)*x^(1/2)*(2+2*5^(1/2))^(1/2)))
	@test integrate((-1+x^2)^-1//2*(x^(1/2)+-1*(-1+x^2)^(1/2))^2*(1+x+-1*x^2)^-2, x) == :((5*x^(1/2)+5*(-1+x^2)^(1/2))^-1*(2+-4x)+-1//25*(110+50*5^(1/2))^(1/2)*arctanh((1/2)*x^(1/2)*(-2+2*5^(1/2))^(1/2))+-1//50*(-110+50*5^(1/2))^(1/2)*arctan((-1+x^2)^(1/2)*(-2+2*5^(1/2))^(1/2)*(2+-1*x*(1+-1*5^(1/2)))^-1)+-1//50*(110+50*5^(1/2))^(1/2)*arctanh((-1+x^2)^(1/2)*(2+2*5^(1/2))^(1/2)*(2+-1x+-1*x*5^(1/2))^-1)+1//25*(-110+50*5^(1/2))^(1/2)*arctan((1/2)*x^(1/2)*(2+2*5^(1/2))^(1/2)))
	@test integrate((1/2)*2^(1/2)*(1+x)^-2*(im+x^2)^-1//2+(1/2)*2^(1/2)*(1+x)^-2*(x^2+-1im)^-1//2, x) == :((1/2)*2^(1/2)*(1+-1im)^-3//2*arctanh((1+-1im)^-1//2*(x^2+-1im)^-1//2*(im+x))+-1//2*2^(1/2)*(1+im)^-3//2*arctanh((1+im)^-1//2*(im+x^2)^-1//2*(im+-1x))+-1//2*2^(1/2)*(1+x)^-1*(im+x^2)^(1/2)*(1/2+-1//2*im)+-1//2*2^(1/2)*(1+x)^-1*(x^2+-1im)^(1/2)*(1/2+(1/2)*im))
end

@testset "Wester Problems.jl" begin
	@test integrate((-1+2x)^-7//2*(-5+3x)^2, x) == :(-49//20*(-1+2x)^-5//2+-9//4*(-1+2x)^-1//2+7//2*(-1+2x)^-3//2)
	@test integrate((-5*exp(-1*m*x)+2*exp(m*x))^-1, x) == :(-1//10*10^(1/2)*m^-1*arctanh(1//5*10^(1/2)*exp(m*x)))
	@test integrate((a+b*cos(x))^-1, x) == :(2*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
	@test integrate((3+3*cos(x)+4*sin(x))^-1, x) == :(1//4*log(3+4*tan((1/2)*x)))
	@test integrate((4+3*cos(x)+4*sin(x))^-1, x) == :(-1//3*log(4+3*cot((1/2)*x+1//4*pi)))
	@test integrate((6+3*cos(x)+4*sin(x))^-1, x) == :(1//11*x*11^(1/2)+2//11*11^(1/2)*arctan((6+11^(1/2)+3*cos(x)+4*sin(x))^-1*(-3*sin(x)+4*cos(x))))
	@test integrate((1/2)*log((x^2+-1*a^2)^2), x) == :(-2x+(1/2)*x*log((x^2+-1*a^2)^2)+2*a*arctanh(x*a^-1))
end

@testset "1.1.1.2 (a+b x)^m (c+d x)^n.jl" begin
	@test integrate(1, x) == :(x)
	@test integrate(5, x) == :(5x)
	@test integrate(-2, x) == :(-2x)
	@test integrate(-3//2, x) == :(-3//2*x)
	@test integrate(pi, x) == :(pi*x)
	@test integrate(a, x) == :(a*x)
	@test integrate(3a, x) == :(3*a*x)
	@test integrate(pi*(16+-1*exp(2))^-1//2, x) == :(pi*x*(16+-1*exp(2))^-1//2)
	@test integrate(x^100, x) == :(1//101*x^101)
	@test integrate(x^3, x) == :(1//4*x^4)
end

@testset "1.1.1.3 (a+b x)^m (c+d x)^n (e+f x)^p.jl" begin
	@test integrate(x^2*(a*c+-1*b*c*x)^3*(a+b*x), x) == :(-1//7*b^4*c^3*x^7+1//3*a^4*c^3*x^3+-1//2*b*a^3*c^3*x^4+1//3*a*b^3*c^3*x^6)
	@test integrate(x*(a*c+-1*b*c*x)^3*(a+b*x), x) == :((1/2)*a^4*c^3*x^2+-1//6*b^4*c^3*x^6+-2//3*b*a^3*c^3*x^3+2//5*a*b^3*c^3*x^5)
	@test integrate((a*c+-1*b*c*x)^3*(a+b*x), x) == :(1//5*b^-1*c^3*(a+-1*b*x)^5+-1//2*a*b^-1*c^3*(a+-1*b*x)^4)
	@test integrate(x^-1*(a*c+-1*b*c*x)^3*(a+b*x), x) == :(a^4*c^3*log(x)+-1//4*b^4*c^3*x^4+-2*b*x*a^3*c^3+2//3*a*b^3*c^3*x^3)
	@test integrate(x^-2*(a*c+-1*b*c*x)^3*(a+b*x), x) == :(-1*a^4*c^3*x^-1+-1//3*b^4*c^3*x^3+a*b^3*c^3*x^2+-2*b*a^3*c^3*log(x))
	@test integrate(x^-3*(a*c+-1*b*c*x)^3*(a+b*x), x) == :(-1//2*c^3*x^-2*(a+-1*b*x)^4)
	@test integrate(x^-4*(a*c+-1*b*c*x)^3*(a+b*x), x) == :(-1*x*b^4*c^3+-1//3*a^4*c^3*x^-3+b*a^3*c^3*x^-2+2*a*b^3*c^3*log(x))
	@test integrate(x^-5*(a*c+-1*b*c*x)^3*(a+b*x), x) == :(-1*b^4*c^3*log(x)+-1//4*a^4*c^3*x^-4+-2*a*b^3*c^3*x^-1+2//3*b*a^3*c^3*x^-3)
	@test integrate(x^-6*(a*c+-1*b*c*x)^3*(a+b*x), x) == :(b^4*c^3*x^-1+-1//5*a^4*c^3*x^-5+(1/2)*b*a^3*c^3*x^-4+-1*a*b^3*c^3*x^-2)
	@test integrate(x^-7*(a*c+-1*b*c*x)^3*(a+b*x), x) == :((1/2)*b^4*c^3*x^-2+-1//6*a^4*c^3*x^-6+-2//3*a*b^3*c^3*x^-3+2//5*b*a^3*c^3*x^-5)
end

@testset "1.1.1.4 (a+b x)^m (c+d x)^n (e+f x)^p (g+h x)^q.jl" begin
	@test integrate((a+b*x)*(c+d*x)*(e+f*x)*(g+h*x), x) == :(x^2*((1/2)*a*(c*e*h+c*f*g+d*e*g)+(1/2)*b*c*e*g)+x^3*(1//3*a*(c*f*h+d*e*h+d*f*g)+1//3*b*(c*e*h+c*f*g+d*e*g))+x^4*(1//4*b*(c*f*h+d*e*h+d*f*g)+1//4*a*d*f*h)+a*c*e*g*x+1//5*b*d*f*h*x^5)
	@test integrate((g+h*x)^-1*(a+b*x)*(c+d*x)*(e+f*x), x) == :(x*h^-3*(b*(d*g+-1*c*h)*(f*g+-1*e*h)+-1*a*h*(d*f*g+-1*c*f*h+-1*d*e*h))+(1/2)*h^-2*x^2*(-1*b*(d*f*g+-1*c*f*h+-1*d*e*h)+a*d*f*h)+-1*h^-4*(b*g+-1*a*h)*(d*g+-1*c*h)*(f*g+-1*e*h)*log(g+h*x)+1//3*b*d*f*h^-1*x^3)
	@test integrate((e+f*x)^-1*(g+h*x)^-1*(a+b*x)*(c+d*x), x) == :(b*d*x*f^-1*h^-1+f^-2*(f*g+-1*e*h)^-1*(b*e+-1*a*f)*(d*e+-1*c*f)*log(e+f*x)+-1*h^-2*(f*g+-1*e*h)^-1*(b*g+-1*a*h)*(d*g+-1*c*h)*log(g+h*x))
	@test integrate((c+d*x)^-1*(e+f*x)^-1*(g+h*x)^-1*(a+b*x), x) == :((d*e+-1*c*f)^-1*(f*g+-1*e*h)^-1*(b*e+-1*a*f)*log(e+f*x)+-1*(d*e+-1*c*f)^-1*(d*g+-1*c*h)^-1*(b*c+-1*a*d)*log(c+d*x)+-1*(d*g+-1*c*h)^-1*(f*g+-1*e*h)^-1*(b*g+-1*a*h)*log(g+h*x))
	@test integrate((a+b*x)^-1*(c+d*x)^-1*(e+f*x)^-1*(g+h*x)^-1, x) == :(b^2*(b*c+-1*a*d)^-1*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*log(a+b*x)+f^2*(b*e+-1*a*f)^-1*(d*e+-1*c*f)^-1*(f*g+-1*e*h)^-1*log(e+f*x)+-1*d^2*(b*c+-1*a*d)^-1*(d*e+-1*c*f)^-1*(d*g+-1*c*h)^-1*log(c+d*x)+-1*h^2*(b*g+-1*a*h)^-1*(d*g+-1*c*h)^-1*(f*g+-1*e*h)^-1*log(g+h*x))
	@test integrate(x*(1+x)^-1*(2+x)^-1*(3+x)^-1, x) == :(2*log(2+x)+-3//2*log(3+x)+-1//2*log(1+x))
	@test integrate((-6+x)^-1*(3+5x)^-3*(x^3+-1*x^2), x) == :(201*(45375+75625x)^-1+-12//1375*(3+5x)^-2+20//3993*log(6+-1x)+1493//499125*log(3+5x))
	@test integrate(x^-1*(a+b*x)^3*(c+d*x)^(1/2)*(e+f*x), x) == :(2*e*a^3*(c+d*x)^(1/2)+2//315*d^-4*(c+d*x)^3//2*(8*b^3*c^2*(-2*c*f+3*d*e)+40*f*a^3*d^3+3*b*d*x*(-1*(-4*a*d+4*b*c)*(-2*b*c*f+2*a*d*f+3*b*d*e)+21*a*b*e*d^2)+6*b*a^2*d^2*(-16*c*f+45*d*e)+-18*a*c*d*b^2*(-4*c*f+7*d*e))+-2*e*a^3*c^(1/2)*arctanh(c^-1//2*(c+d*x)^(1/2))+1//21*d^-2*(a+b*x)^2*(c+d*x)^3//2*(-4*b*c*f+4*a*d*f+6*b*d*e)+2//9*f*d^-1*(a+b*x)^3*(c+d*x)^3//2)
	@test integrate(x^-1*(a+b*x)^2*(c+d*x)^(1/2)*(e+f*x), x) == :(2*e*a^2*(c+d*x)^(1/2)+2//105*d^-3*(c+d*x)^3//2*(-2*c*b^2*(-4*c*f+7*d*e)+20*f*a^2*d^2+3*b*d*x*(-4*b*c*f+4*a*d*f+7*b*d*e)+14*a*b*d*(-2*c*f+5*d*e))+-2*e*a^2*c^(1/2)*arctanh(c^-1//2*(c+d*x)^(1/2))+2//7*f*d^-1*(a+b*x)^2*(c+d*x)^3//2)
	@test integrate(x^-1*(c+d*x)^(1/2)*(a+b*x)*(e+f*x), x) == :(2*a*e*(c+d*x)^(1/2)+-2//15*d^-2*(c+d*x)^3//2*(-5*d*(a*f+b*e)+2*b*c*f+-3*b*d*f*x)+-2*a*e*c^(1/2)*arctanh(c^-1//2*(c+d*x)^(1/2)))
end

@testset "1.1.1.5 P(x) (a+b x)^m (c+d x)^n.jl" begin
	@test integrate((a+b*x)^3*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(1//7*d^-7*(c+d*x)^7//2*(2*b^3*(A*d^3+-20*D*c^3+-4*B*c*d^2+10*C*d*c^2)+2*D*a^3*d^3+-6*a*d*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+6*b*a^2*d^2*(C*d+-4*D*c))+-2*d^-7*(c+d*x)^(1/2)*(b*c+-1*a*d)^3*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+-2//3*d^-7*(c+d*x)^3//2*(b*c+-1*a*d)^2*(-1*b*(-6*D*c^3+3*A*d^3+-4*B*c*d^2+5*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+-1//5*d^-7*(c+d*x)^5//2*(-2*a*d+2*b*c)*(b^2*(-15*D*c^3+3*A*d^3+-6*B*c*d^2+10*C*d*c^2)+a^2*d^2*(C*d+-3*D*c)+-1*a*b*d*(-15*D*c^2+-3*B*d^2+8*C*c*d))+2//9*b*d^-7*(c+d*x)^9//2*(-1*b^2*(-1*B*d^2+-15*D*c^2+5*C*c*d)+3*D*a^2*d^2+3*a*b*d*(C*d+-5*D*c))+2//11*b^2*d^-7*(c+d*x)^11//2*(C*b*d+-6*D*b*c+3*D*a*d)+2//13*D*b^3*d^-7*(c+d*x)^13//2)
	@test integrate((a+b*x)^2*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(1//5*d^-6*(c+d*x)^5//2*(2*b^2*(A*d^3+-10*D*c^3+-3*B*c*d^2+6*C*d*c^2)+2*a^2*d^2*(C*d+-3*D*c)+-4*a*b*d*(-1*B*d^2+-6*D*c^2+3*C*c*d))+1//7*d^-6*(c+d*x)^7//2*(-2*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+2*D*a^2*d^2+4*a*b*d*(C*d+-4*D*c))+2*d^-6*(c+d*x)^(1/2)*(b*c+-1*a*d)^2*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+1//3*d^-6*(c+d*x)^3//2*(-1*b*(-5*D*c^3+2*A*d^3+-3*B*c*d^2+4*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))*(-2*a*d+2*b*c)+2//9*b*d^-6*(c+d*x)^9//2*(C*b*d+-5*D*b*c+2*D*a*d)+2//11*D*b^2*d^-6*(c+d*x)^11//2)
	@test integrate((c+d*x)^-1//2*(a+b*x)*(A+B*x+C*x^2+D*x^3), x) == :(-1//3*d^-5*(c+d*x)^3//2*(-2*b*(A*d^3+-4*D*c^3+-2*B*c*d^2+3*C*d*c^2)+2*a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+1//5*d^-5*(c+d*x)^5//2*(-2*b*(-1*B*d^2+-6*D*c^2+3*C*c*d)+2*a*d*(C*d+-3*D*c))+1//7*d^-5*(c+d*x)^7//2*(-8*D*b*c+2*C*b*d+2*D*a*d)+-1*d^-5*(c+d*x)^(1/2)*(-2*a*d+2*b*c)*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+2//9*D*b*d^-5*(c+d*x)^9//2)
	@test integrate((c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(d^-4*(c+d*x)^(1/2)*(-2*D*c^3+2*A*d^3+-2*B*c*d^2+2*C*d*c^2)+-1//3*d^-4*(c+d*x)^3//2*(-6*D*c^2+-2*B*d^2+4*C*c*d)+1//5*d^-4*(c+d*x)^5//2*(-6*D*c+2*C*d)+2//7*D*d^-4*(c+d*x)^7//2)
	@test integrate((a+b*x)^-1*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(b^-3*d^-3*(c+d*x)^(1/2)*(-2*b^2*(-1*B*d^2+-1*D*c^2+C*c*d)+2*D*a^2*d^2+-2*a*b*d*(C*d+-1*D*c))+-1*b^-7//2*(b*c+-1*a*d)^-1//2*(-2*a*(B*b^2+D*a^2+-1*C*a*b)+2*A*b^3)*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+1//3*b^-2*d^-3*(c+d*x)^3//2*(-4*D*b*c+-2*D*a*d+2*C*b*d)+2//5*D*b^-1*d^-3*(c+d*x)^5//2)
	@test integrate((a+b*x)^-2*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(b^-3*d^-2*(c+d*x)^(1/2)*(-4*D*a*d+-2*D*b*c+2*C*b*d)+-1*b^-7//2*(b*c+-1*a*d)^-3//2*(b^3*(-1*A*d+2*B*c)+-1*a*b^2*(B*d+4*C*c)+-5*D*d*a^3+3*b*a^2*(C*d+2*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A+-1*a*b^-3*(B*b^2+D*a^2+-1*C*a*b))+2//3*D*b^-2*d^-2*(c+d*x)^3//2)
	@test integrate((a+b*x)^-3*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(2*D*b^-3*d^-1*(c+d*x)^(1/2)+-1//4*b^-7//2*(b*c+-1*a*d)^-5//2*(b^3*(3*A*d^2+8*C*c^2+-4*B*c*d)+-1*a*b^2*(-1*B*d^2+24*D*c^2+8*C*c*d)+-15*D*a^3*d^2+3*b*d*a^2*(C*d+12*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//2*b^-3*(a+b*x)^-2*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//4*b^-3*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-2*(b^3*(-3*A*d+4*B*c)+b*a^2*(5*C*d+12*D*c)+-1*a*b^2*(B*d+8*C*c)+-9*D*d*a^3))
	@test integrate((a+b*x)^-4*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(1//8*b^-7//2*(b*c+-1*a*d)^-7//2*(b^3*(-16*D*c^3+5*A*d^3+-6*B*c*d^2+8*C*d*c^2)+5*D*a^3*d^3+b*a^2*d^2*(C*d+-18*D*c)+-1*a*d*b^2*(-1*B*d^2+-24*D*c^2+4*C*c*d))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//3*b^-3*(a+b*x)^-3*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//8*b^-3*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-3*(b^3*(5*A*d^2+8*C*c^2+-6*B*c*d)+-1*a*b^2*(-1*B*d^2+24*D*c^2+4*C*c*d)+-11*D*a^3*d^2+b*d*a^2*(C*d+30*D*c))+-1//12*b^-3*(a+b*x)^-2*(c+d*x)^(1/2)*(b*c+-1*a*d)^-2*(b^3*(-5*A*d+6*B*c)+b*a^2*(7*C*d+18*D*c)+-1*a*b^2*(B*d+12*C*c)+-13*D*d*a^3))
	@test integrate((a+b*x)^-5*(c+d*x)^-1//2*(A+B*x+C*x^2+D*x^3), x) == :(-1//4*b^-3*(a+b*x)^-4*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1*(A*b^3+-1*a*(B*b^2+D*a^2+-1*C*a*b))+-1//24*b^-3*(a+b*x)^-3*(c+d*x)^(1/2)*(b*c+-1*a*d)^-2*(b^3*(-7*A*d+8*B*c)+-1*a*b^2*(B*d+16*C*c)+-17*D*d*a^3+3*b*a^2*(3*C*d+8*D*c))+-1//64*d*b^-7//2*(b*c+-1*a*d)^-9//2*(b^3*(-64*D*c^3+35*A*d^3+-40*B*c*d^2+48*C*d*c^2)+5*D*a^3*d^3+-1*a*d*b^2*(-48*D*c^2+-5*B*d^2+16*C*c*d)+3*b*a^2*d^2*(C*d+-8*D*c))*arctanh(b^(1/2)*(c+d*x)^(1/2)*(b*c+-1*a*d)^-1//2)+-1//96*b^-3*(a+b*x)^-2*(c+d*x)^(1/2)*(b*c+-1*a*d)^-3*(b^3*(35*A*d^2+48*C*c^2+-40*B*c*d)+-1*a*b^2*(-5*B*d^2+144*D*c^2+16*C*c*d)+-59*D*a^3*d^2+3*b*d*a^2*(C*d+56*D*c))+1//64*b^-3*(a+b*x)^-1*(c+d*x)^(1/2)*(b*c+-1*a*d)^-4*(b^3*(-64*D*c^3+35*A*d^3+-40*B*c*d^2+48*C*d*c^2)+5*D*a^3*d^3+-1*a*d*b^2*(-48*D*c^2+-5*B*d^2+16*C*c*d)+3*b*a^2*d^2*(C*d+-8*D*c)))
	@test integrate((a+b*x)^3*(c+d*x)^-3//2*(A+B*x+C*x^2+D*x^3), x) == :(1//5*d^-7*(c+d*x)^5//2*(2*b^3*(A*d^3+-20*D*c^3+-4*B*c*d^2+10*C*d*c^2)+2*D*a^3*d^3+-6*a*d*b^2*(-1*B*d^2+-10*D*c^2+4*C*c*d)+6*b*a^2*d^2*(C*d+-4*D*c))+-2*d^-7*(c+d*x)^(1/2)*(b*c+-1*a*d)^2*(-1*b*(-6*D*c^3+3*A*d^3+-4*B*c*d^2+5*C*d*c^2)+a*d*(-1*B*d^2+-3*D*c^2+2*C*c*d))+2*d^-7*(c+d*x)^-1//2*(b*c+-1*a*d)^3*(A*d^3+-1*D*c^3+C*d*c^2+-1*B*c*d^2)+-1//3*d^-7*(c+d*x)^3//2*(-2*a*d+2*b*c)*(b^2*(-15*D*c^3+3*A*d^3+-6*B*c*d^2+10*C*d*c^2)+a^2*d^2*(C*d+-3*D*c)+-1*a*b*d*(-15*D*c^2+-3*B*d^2+8*C*c*d))+2//7*b*d^-7*(c+d*x)^7//2*(-1*b^2*(-1*B*d^2+-15*D*c^2+5*C*c*d)+3*D*a^2*d^2+3*a*b*d*(C*d+-5*D*c))+2//9*b^2*d^-7*(c+d*x)^9//2*(C*b*d+-6*D*b*c+3*D*a*d)+2//11*D*b^3*d^-7*(c+d*x)^11//2)
end

@testset "1.1.1.6 P(x) (a+b x)^m (c+d x)^n (e+f x)^p.jl" begin
	@test integrate((1+d*x)^(1/2)*(1+-1*d*x)^(1/2)*(e+f*x)^3*(A+B*x+C*x^2), x) == :(1//16*d^-5*(B*f^3+2*C*d^2*e^3+3*C*e*f^2+8*A*d^4*e^3+6*A*e*d^2*f^2+6*B*f*d^2*e^2)*arcsin(d*x)+1//16*x*d^-4*(1+-1*d^2*x^2)^(1/2)*(B*f^3+2*C*d^2*e^3+3*C*e*f^2+8*A*d^4*e^3+6*A*e*d^2*f^2+6*B*f*d^2*e^2)+1//840*d^-6*f^-1*(1+-1*d^2*x^2)^3//2*(8*C*(-8*f^4+3*d^4*e^4+-30*d^2*e^2*f^2)+-56*f*d^2*(B*(d^2*e^3+6*e*f^2)+2*A*f*(f^2+6*d^2*e^2))+3*f*x*d^2*(-35*B*f^3+-41*C*e*f^2+6*C*d^2*e^3+-98*A*e*d^2*f^2+-14*B*f*d^2*e^2))+-1//7*C*d^-2*f^-1*(1+-1*d^2*x^2)^3//2*(e+f*x)^4+-1//70*d^-4*f^-1*(1+-1*d^2*x^2)^3//2*(e+f*x)^2*(-1*C*(-8*f^2+3*d^2*e^2)+7*f*d^2*(B*e+2*A*f))+1//42*d^-2*f^-1*(1+-1*d^2*x^2)^3//2*(e+f*x)^3*(-7*B*f+3*C*e))
	@test integrate((1+d*x)^(1/2)*(1+-1*d*x)^(1/2)*(e+f*x)^2*(A+B*x+C*x^2), x) == :(1//16*d^-5*(C*(f^2+2*d^2*e^2)+2*d^2*(A*(f^2+4*d^2*e^2)+2*B*e*f))*arcsin(d*x)+1//16*x*d^-4*(1+-1*d^2*x^2)^(1/2)*(C*(f^2+2*d^2*e^2)+2*d^2*(A*(f^2+4*d^2*e^2)+2*B*e*f))+1//120*d^-4*f^-1*(1+-1*d^2*x^2)^3//2*(-16*f*(B*(f^2+d^2*e^2)+5*A*e*f*d^2)+8*C*(d^2*e^3+-4*e*f^2)+-3*f*x*(f^2*(5C+10*A*d^2)+-2*e*d^2*(C*e+-2*B*f)))+-1//6*C*d^-2*f^-1*(1+-1*d^2*x^2)^3//2*(e+f*x)^3+1//10*d^-2*f^-1*(1+-1*d^2*x^2)^3//2*(e+f*x)^2*(C*e+-2*B*f))
	@test integrate((1+d*x)^(1/2)*(1+-1*d*x)^(1/2)*(e+f*x)*(A+B*x+C*x^2), x) == :(1//8*d^-3*(B*f+C*e+4*A*e*d^2)*arcsin(d*x)+-1//60*d^-4*f^-1*(1+-1*d^2*x^2)^3//2*(-4*C*(-2*f^2+3*d^2*e^2)+20*f*d^2*(A*f+B*e)+-3*f*x*d^2*(-5*B*f+3*C*e))+1//8*x*d^-2*(1+-1*d^2*x^2)^(1/2)*(B*f+C*e+4*A*e*d^2)+-1//5*C*d^-2*f^-1*(1+-1*d^2*x^2)^3//2*(e+f*x)^2)
	@test integrate((1+d*x)^(1/2)*(1+-1*d*x)^(1/2)*(A+B*x+C*x^2), x) == :(-1//3*B*d^-2*(1+-1*d^2*x^2)^3//2+1//8*d^-3*(C+4*A*d^2)*arcsin(d*x)+-1//4*C*x*d^-2*(1+-1*d^2*x^2)^3//2+1//8*x*d^-2*(1+-1*d^2*x^2)^(1/2)*(C+4*A*d^2))
	@test integrate((1+d*x)^-1//2*(1+-1*d*x)^-1//2*(e+f*x)^-1*(A+B*x+C*x^2), x) == :(f^-2*(-1*f^2+d^2*e^2)^-1//2*(A*f^2+C*e^2+-1*B*e*f)*arctan((1+-1*d^2*x^2)^-1//2*(-1*f^2+d^2*e^2)^-1//2*(f+e*x*d^2))+-1*C*d^-2*f^-1*(1+-1*d^2*x^2)^(1/2)+-1*d^-1*f^-2*(C*e+-1*B*f)*arcsin(d*x))
	@test integrate((1+d*x)^-1//2*(1+-1*d*x)^-1//2*(e+f*x)^-2*(A+B*x+C*x^2), x) == :(C*d^-1*f^-2*arcsin(d*x)+-1*f^-2*(-1*f^2+d^2*e^2)^-3//2*(B*f^3+C*d^2*e^3+-2*C*e*f^2+-1*A*e*d^2*f^2)*arctan((1+-1*d^2*x^2)^-1//2*(-1*f^2+d^2*e^2)^-1//2*(f+e*x*d^2))+f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^-1*(-1*f^2+d^2*e^2)^-1*(A*f^2+C*e^2+-1*B*e*f))
	@test integrate((1+d*x)^-1//2*(1+-1*d*x)^-1//2*(e+f*x)^-3*(A+B*x+C*x^2), x) == :((1/2)*(-1*f^2+d^2*e^2)^-5//2*(C*(2*f^2+d^2*e^2)+-1*d^2*(-1*A*(f^2+2*d^2*e^2)+3*B*e*f))*arctan((1+-1*d^2*x^2)^-1//2*(-1*f^2+d^2*e^2)^-1//2*(f+e*x*d^2))+(1/2)*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^-2*(-1*f^2+d^2*e^2)^-1*(A*f^2+C*e^2+-1*B*e*f)+-1//2*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^-1*(-1*f^2+d^2*e^2)^-2*(2*B*f^3+C*d^2*e^3+-4*C*e*f^2+B*f*d^2*e^2+-3*A*e*d^2*f^2))
	@test integrate((1+d*x)^-1//2*(1+-1*d*x)^-1//2*(e+f*x)^3*(A+B*x+C*x^2), x) == :(1//8*d^-5*(3*B*f^3+4*C*d^2*e^3+8*A*d^4*e^3+9*C*e*f^2+12*A*e*d^2*f^2+12*B*f*d^2*e^2)*arcsin(d*x)+1//120*d^-6*f^-1*(1+-1*d^2*x^2)^(1/2)*(4*C*(-16*f^4+3*d^4*e^4+-52*d^2*e^2*f^2)+-20*f*d^2*(3*B*(d^2*e^3+4*e*f^2)+4*A*f*(f^2+4*d^2*e^2))+f*x*d^2*(-45*B*f^3+-71*C*e*f^2+6*C*d^2*e^3+-100*A*e*d^2*f^2+-30*B*f*d^2*e^2))+-1//5*C*d^-2*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^4+-1//60*d^-4*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^2*(f^2*(16C+20*A*d^2)+-3*e*d^2*(C*e+-5*B*f))+1//20*d^-2*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^3*(C*e+-5*B*f))
	@test integrate((1+d*x)^-1//2*(1+-1*d*x)^-1//2*(e+f*x)^2*(A+B*x+C*x^2), x) == :(1//8*d^-5*(C*(3*f^2+4*d^2*e^2)+4*d^2*(A*(f^2+2*d^2*e^2)+2*B*e*f))*arcsin(d*x)+1//24*d^-4*f^-1*(1+-1*d^2*x^2)^(1/2)*(-16*f*(B*(f^2+d^2*e^2)+3*A*e*f*d^2)+4*C*(d^2*e^3+-8*e*f^2)+-1*f*x*(f^2*(9C+12*A*d^2)+-2*e*d^2*(C*e+-4*B*f)))+-1//4*C*d^-2*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^3+1//12*d^-2*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^2*(C*e+-4*B*f))
	@test integrate((1+d*x)^-1//2*(1+-1*d*x)^-1//2*(e+f*x)*(A+B*x+C*x^2), x) == :((1/2)*d^-3*(B*f+C*e+2*A*e*d^2)*arcsin(d*x)+-1//6*d^-4*f^-1*(1+-1*d^2*x^2)^(1/2)*(-2*C*(-2*f^2+d^2*e^2)+6*f*d^2*(A*f+B*e)+-1*f*x*d^2*(C*e+-3*B*f))+-1//3*C*d^-2*f^-1*(1+-1*d^2*x^2)^(1/2)*(e+f*x)^2)
end

@testset "1.1.1.7 P(x) (a+b x)^m (c+d x)^n (e+f x)^p (g+h x)^q.jl" begin
	@test integrate((a+b*x)^2*(c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(A+B*x), x) == :(2//15*b*d^-2*f^-2*h^-2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*(-4*B*(c*f*h+d*e*h+d*f*g)+5*A*d*f*h)+7*B*a*d*f*h)+2//5*B*b*d^-1*f^-1*h^-1*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(a+b*x)+-2//15*d^-3*f^-5//2*h^-3*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^(1/2)*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+-1*d*e)^(1/2)*(-1*b^2*(-1*B*(g*d^2*(4*e^2*h^2+8*f^2*g^2+3*e*f*g*h)+c*d*h*(-4*e^2*h^2+3*f^2*g^2+e*f*g*h)+4*f*c^2*h^2*(f*g+-1*e*h))+5*A*d*f*h*(c*h*(f*g+-1*e*h)+d*g*(e*h+2*f*g)))+15*a^2*d^2*f^2*h^2*(B*g+-1*A*h)+10*a*b*d*f*h*(-1*B*(c*h*(f*g+-1*e*h)+d*g*(e*h+2*f*g))+3*A*d*f*g*h))*Elliptic.F(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f))+2//15*d^-3*f^-5//2*h^-3*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^-1//2*(e+f*x)^-1//2*(g+h*x)^(1/2)*(c*f+-1*d*e)^(1/2)*(-1*b^2*(-1*B*(d^2*(8*e^2*h^2+8*f^2*g^2+7*e*f*g*h)+8*c^2*f^2*h^2+7*c*d*f*h*(e*h+f*g))+10*A*d*f*h*(c*f*h+d*e*h+d*f*g))+15*B*a^2*d^2*f^2*h^2+10*a*b*d*f*h*(-2*B*(c*f*h+d*e*h+d*f*g)+3*A*d*f*h))*Elliptic.E(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f)))
	@test integrate((c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(A+B*x)*(a+b*x), x) == :(2//3*B*b*d^-1*f^-1*h^-1*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)+-2//3*d^-2*f^-3//2*h^-2*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^(1/2)*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+-1*d*e)^(1/2)*(b*(-1*B*(c*h*(f*g+-1*e*h)+d*g*(e*h+2*f*g))+3*A*d*f*g*h)+3*a*d*f*h*(B*g+-1*A*h))*Elliptic.F(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f))+2//3*d^-2*f^-3//2*h^-2*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^-1//2*(e+f*x)^-1//2*(g+h*x)^(1/2)*(c*f+-1*d*e)^(1/2)*(b*(-2*B*(c*f*h+d*e*h+d*f*g)+3*A*d*f*h)+3*B*a*d*f*h)*Elliptic.E(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f)))
	@test integrate((c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(A+B*x), x) == :(-2*d^-1*f^-1//2*h^-1*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^(1/2)*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+-1*d*e)^(1/2)*(B*g+-1*A*h)*Elliptic.F(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f))+2*B*d^-1*f^-1//2*h^-1*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^-1//2*(e+f*x)^-1//2*(g+h*x)^(1/2)*(c*f+-1*d*e)^(1/2)*Elliptic.E(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f)))
	@test integrate((a+b*x)^-3//2*(c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(A+B*x), x) == :(d*(a+b*x)^(1/2)*(c+d*x)^-1//2*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-1*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(-2*B*a+2*A*b)+((a+b*x)^-1*(d*e+-1*c*f)^-1*(c+d*x)*(b*e+-1*a*f))^(1/2)*(-1*(a+b*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(b*e+-1*a*f))^-1//2*(c+d*x)^-1//2*(g+h*x)^(1/2)*(b*c+-1*a*d)^-1*(b*g+-1*a*h)^-1//2*(f*g+-1*e*h)^-1//2*(-2*A*d+2*B*c)*Elliptic.F(arcsin((a+b*x)^-1//2*(e+f*x)^(1/2)*(b*g+-1*a*h)^(1/2)*(f*g+-1*e*h)^-1//2),-1*(b*g+-1*a*h)^-1*(d*e+-1*c*f)^-1*(b*c+-1*a*d)*(f*g+-1*e*h))+-2*b*(a+b*x)^-1//2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-1*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(A*b+-1*B*a)+-1*((c+d*x)^-1*(b*e+-1*a*f)^-1*(a+b*x)*(d*e+-1*c*f))^-1//2*(-1*(c+d*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(d*e+-1*c*f))^(1/2)*(a+b*x)^(1/2)*(g+h*x)^-1//2*(b*c+-1*a*d)^-1*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^(1/2)*(-2*B*a+2*A*b)*Elliptic.E(arcsin((c+d*x)^-1//2*(e+f*x)^(1/2)*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^-1//2),(b*e+-1*a*f)^-1*(d*g+-1*c*h)^-1*(b*c+-1*a*d)*(f*g+-1*e*h)))
	@test integrate((a+b*x)^-5//2*(c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(A+B*x), x) == :(-2*b*(a+b*x)^-3//2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(-3*a*d+3*b*c)^-1*(A*b+-1*B*a)+-2//3*b*(a+b*x)^-1//2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-2*(b*g+-1*a*h)^-2*(b^3*(-2*A*(c*e*h+c*f*g+d*e*g)+3*B*c*e*g)+-1*a*b^2*(B*(c*e*h+c*f*g+d*e*g)+-4*A*(c*f*h+d*e*h+d*f*g))+-1*b*a^2*(B*(c*f*h+d*e*h+d*f*g)+6*A*d*f*h)+3*B*d*f*h*a^3)+2//3*d*(a+b*x)^(1/2)*(c+d*x)^-1//2*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-2*(b*g+-1*a*h)^-2*(b^3*(-2*A*(c*e*h+c*f*g+d*e*g)+3*B*c*e*g)+-1*a*b^2*(B*(c*e*h+c*f*g+d*e*g)+-4*A*(c*f*h+d*e*h+d*f*g))+-1*b*a^2*(B*(c*f*h+d*e*h+d*f*g)+6*A*d*f*h)+3*B*d*f*h*a^3)+-1//3*((a+b*x)^-1*(d*e+-1*c*f)^-1*(c+d*x)*(b*e+-1*a*f))^(1/2)*(-1*(a+b*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(b*e+-1*a*f))^-1//2*(c+d*x)^-1//2*(g+h*x)^(1/2)*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-3//2*(f*g+-1*e*h)^-1//2*(2*b^2*(-1*A*(c*d*(e*h+f*g)+-1*f*h*c^2+2*e*g*d^2)+3*B*c*d*e*g)+2*a*b*(-1*B*(e*g*d^2+f*h*c^2+2*c*d*(e*h+f*g))+3*A*d^2*(e*h+f*g))+6*d*f*h*a^2*(B*c+-1*A*d))*Elliptic.F(arcsin((a+b*x)^-1//2*(e+f*x)^(1/2)*(b*g+-1*a*h)^(1/2)*(f*g+-1*e*h)^-1//2),-1*(b*g+-1*a*h)^-1*(d*e+-1*c*f)^-1*(b*c+-1*a*d)*(f*g+-1*e*h))+-2//3*((c+d*x)^-1*(b*e+-1*a*f)^-1*(a+b*x)*(d*e+-1*c*f))^-1//2*(-1*(c+d*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(d*e+-1*c*f))^(1/2)*(a+b*x)^(1/2)*(g+h*x)^-1//2*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-2*(b*g+-1*a*h)^-2*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^(1/2)*(b^3*(-2*A*(c*e*h+c*f*g+d*e*g)+3*B*c*e*g)+-1*a*b^2*(B*(c*e*h+c*f*g+d*e*g)+-4*A*(c*f*h+d*e*h+d*f*g))+-1*b*a^2*(B*(c*f*h+d*e*h+d*f*g)+6*A*d*f*h)+3*B*d*f*h*a^3)*Elliptic.E(arcsin((c+d*x)^-1//2*(e+f*x)^(1/2)*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^-1//2),(b*e+-1*a*f)^-1*(d*g+-1*c*h)^-1*(b*c+-1*a*d)*(f*g+-1*e*h)))
	@test integrate((a+b*x)^-3//2*(c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+d*e+2*d*f*x), x) == :(-2*b*(a+b*x)^-1//2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-1*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(b*c*f+b*d*e+-2*a*d*f)+2*d*(a+b*x)^(1/2)*(c+d*x)^-1//2*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-1*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(b*c*f+b*d*e+-2*a*d*f)+-2*d*((a+b*x)^-1*(d*e+-1*c*f)^-1*(c+d*x)*(b*e+-1*a*f))^(1/2)*(-1*(a+b*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(b*e+-1*a*f))^-1//2*(c+d*x)^-1//2*(g+h*x)^(1/2)*(b*c+-1*a*d)^-1*(b*g+-1*a*h)^-1//2*(f*g+-1*e*h)^-1//2*(d*e+-1*c*f)*Elliptic.F(arcsin((a+b*x)^-1//2*(e+f*x)^(1/2)*(b*g+-1*a*h)^(1/2)*(f*g+-1*e*h)^-1//2),-1*(b*g+-1*a*h)^-1*(d*e+-1*c*f)^-1*(b*c+-1*a*d)*(f*g+-1*e*h))+-1*((c+d*x)^-1*(b*e+-1*a*f)^-1*(a+b*x)*(d*e+-1*c*f))^-1//2*(-1*(c+d*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(d*e+-1*c*f))^(1/2)*(a+b*x)^(1/2)*(g+h*x)^-1//2*(b*c+-1*a*d)^-1*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^(1/2)*(-4*a*d*f+2*b*c*f+2*b*d*e)*Elliptic.E(arcsin((c+d*x)^-1//2*(e+f*x)^(1/2)*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^-1//2),(b*e+-1*a*f)^-1*(d*g+-1*c*h)^-1*(b*c+-1*a*d)*(f*g+-1*e*h)))
	@test integrate((a+b*x)^-5//2*(c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+d*e+2*d*f*x), x) == :(-2*b*(a+b*x)^-3//2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-1*(-3*a*d+3*b*c)^-1*(b*c*f+b*d*e+-2*a*d*f)+-4//3*b*(a+b*x)^-1//2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-2*(b*g+-1*a*h)^-2*(-1*b^3*(f*c^2*(e*h+f*g)+g*d^2*e^2+-1*c*d*e*(f*g+-1*e*h))+a*b^2*(e*d^2*(f*g+2*e*h)+2*h*c^2*f^2+c*d*f*(f*g+3*e*h))+3*h*a^3*d^2*f^2+-1*b*d*f*a^2*(d*f*g+4*c*f*h+4*d*e*h))+4//3*d*(a+b*x)^(1/2)*(c+d*x)^-1//2*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-2*(b*g+-1*a*h)^-2*(-1*b^3*(f*c^2*(e*h+f*g)+g*d^2*e^2+-1*c*d*e*(f*g+-1*e*h))+a*b^2*(e*d^2*(f*g+2*e*h)+2*h*c^2*f^2+c*d*f*(f*g+3*e*h))+3*h*a^3*d^2*f^2+-1*b*d*f*a^2*(d*f*g+4*c*f*h+4*d*e*h))+-4//3*((c+d*x)^-1*(b*e+-1*a*f)^-1*(a+b*x)*(d*e+-1*c*f))^-1//2*(-1*(c+d*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(d*e+-1*c*f))^(1/2)*(a+b*x)^(1/2)*(g+h*x)^-1//2*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-2*(b*g+-1*a*h)^-2*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^(1/2)*(-1*b^3*(f*c^2*(e*h+f*g)+g*d^2*e^2+-1*c*d*e*(f*g+-1*e*h))+a*b^2*(e*d^2*(f*g+2*e*h)+2*h*c^2*f^2+c*d*f*(f*g+3*e*h))+3*h*a^3*d^2*f^2+-1*b*d*f*a^2*(d*f*g+4*c*f*h+4*d*e*h))*Elliptic.E(arcsin((c+d*x)^-1//2*(e+f*x)^(1/2)*(d*g+-1*c*h)^(1/2)*(f*g+-1*e*h)^-1//2),(b*e+-1*a*f)^-1*(d*g+-1*c*h)^-1*(b*c+-1*a*d)*(f*g+-1*e*h))+1//3*((a+b*x)^-1*(d*e+-1*c*f)^-1*(c+d*x)*(b*e+-1*a*f))^(1/2)*(-1*(a+b*x)^-1*(f*g+-1*e*h)^-1*(g+h*x)*(b*e+-1*a*f))^-1//2*(c+d*x)^-1//2*(g+h*x)^(1/2)*(b*c+-1*a*d)^-2*(b*e+-1*a*f)^-1*(b*g+-1*a*h)^-3//2*(f*g+-1*e*h)^-1//2*(-2*c*f+2*d*e)*(b^2*(f*h*c^2+2*e*g*d^2+c*d*e*h+-1*c*d*f*g)+-1*a*b*d*(d*f*g+2*c*f*h+3*d*e*h)+3*f*h*a^2*d^2)*Elliptic.F(arcsin((a+b*x)^-1//2*(e+f*x)^(1/2)*(b*g+-1*a*h)^(1/2)*(f*g+-1*e*h)^-1//2),-1*(b*g+-1*a*h)^-1*(d*e+-1*c*f)^-1*(b*c+-1*a*d)*(f*g+-1*e*h)))
	@test integrate((c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(a+b*x)*(-1*C*a^2+B*a*b+B*x*b^2+C*b^2*x^2), x) == :(2//15*b^2*d^-2*f^-2*h^-2*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(2*C*(-2*b*(c*f*h+d*e*h+d*f*g)+a*d*f*h)+5*B*b*d*f*h)+2//5*C*b^2*d^-1*f^-1*h^-1*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)*(a+b*x)+-2//15*d^-3*f^-5//2*h^-3*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^(1/2)*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+-1*d*e)^(1/2)*(-1*b^3*(-1*C*(g*d^2*(4*e^2*h^2+8*f^2*g^2+3*e*f*g*h)+c*d*h*(-4*e^2*h^2+3*f^2*g^2+e*f*g*h)+4*f*c^2*h^2*(f*g+-1*e*h))+5*B*d*f*h*(c*h*(f*g+-1*e*h)+d*g*(e*h+2*f*g)))+15*C*a^3*d^2*f^2*h^3+-15*b*a^2*d^2*f^2*h^2*(B*h+C*g)+5*a*d*f*h*b^2*(-1*C*(c*h*(f*g+-1*e*h)+d*g*(e*h+2*f*g))+6*B*d*f*g*h))*Elliptic.F(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f))+-2//15*b*d^-3*f^-5//2*h^-3*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^-1//2*(e+f*x)^-1//2*(g+h*x)^(1/2)*(c*f+-1*d*e)^(1/2)*(b^2*(-1*C*(d^2*(8*e^2*h^2+8*f^2*g^2+7*e*f*g*h)+8*c^2*f^2*h^2+7*c*d*f*h*(e*h+f*g))+10*B*d*f*h*(c*f*h+d*e*h+d*f*g))+15*C*a^2*d^2*f^2*h^2+-10*a*b*d*f*h*(-1*C*(c*f*h+d*e*h+d*f*g)+3*B*d*f*h))*Elliptic.E(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f)))
	@test integrate((c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(-1*C*a^2+B*a*b+B*x*b^2+C*b^2*x^2), x) == :(2//3*C*b^2*d^-1*f^-1*h^-1*(c+d*x)^(1/2)*(e+f*x)^(1/2)*(g+h*x)^(1/2)+2//3*d^-2*f^-3//2*h^-2*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^(1/2)*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+-1*d*e)^(1/2)*(-1*b^2*(-1*C*(c*h*(f*g+-1*e*h)+d*g*(e*h+2*f*g))+3*B*d*f*g*h)+-3*C*d*f*a^2*h^2+3*B*a*b*d*f*h^2)*Elliptic.F(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f))+2//3*b^2*d^-2*f^-3//2*h^-2*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^-1//2*(e+f*x)^-1//2*(g+h*x)^(1/2)*(c*f+-1*d*e)^(1/2)*(-2*C*(c*f*h+d*e*h+d*f*g)+3*B*d*f*h)*Elliptic.E(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f)))
	@test integrate((a+b*x)^-1*(c+d*x)^-1//2*(e+f*x)^-1//2*(g+h*x)^-1//2*(-1*C*a^2+B*a*b+B*x*b^2+C*b^2*x^2), x) == :(-2*d^-1*f^-1//2*h^-1*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^(1/2)*(e+f*x)^-1//2*(g+h*x)^-1//2*(c*f+-1*d*e)^(1/2)*(C*a*h+C*b*g+-1*B*b*h)*Elliptic.F(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f))+2*C*b*d^-1*f^-1//2*h^-1*(d*(d*e+-1*c*f)^-1*(e+f*x))^(1/2)*(d*(d*g+-1*c*h)^-1*(g+h*x))^-1//2*(e+f*x)^-1//2*(g+h*x)^(1/2)*(c*f+-1*d*e)^(1/2)*Elliptic.E(arcsin(f^(1/2)*(c+d*x)^(1/2)*(c*f+-1*d*e)^-1//2),h*f^-1*(d*g+-1*c*h)^-1*(d*e+-1*c*f)))
end

@testset "1.1.2.2 (c x)^m (a+b x^2)^p.jl" begin
	@test integrate(x^4*(a+b*x^2), x) == :(1//5*a*x^5+1//7*b*x^7)
	@test integrate(x^3*(a+b*x^2), x) == :(1//4*a*x^4+1//6*b*x^6)
	@test integrate(x^2*(a+b*x^2), x) == :(1//3*a*x^3+1//5*b*x^5)
	@test integrate(x*(a+b*x^2), x) == :((1/2)*a*x^2+1//4*b*x^4)
	@test integrate(a+b*x^2, x) == :(a*x+1//3*b*x^3)
	@test integrate(x^-1*(a+b*x^2), x) == :(a*log(x)+(1/2)*b*x^2)
	@test integrate(x^-2*(a+b*x^2), x) == :(b*x+-1*a*x^-1)
	@test integrate(x^-3*(a+b*x^2), x) == :(b*log(x)+-1//2*a*x^-2)
	@test integrate(x^-4*(a+b*x^2), x) == :(-1*b*x^-1+-1//3*a*x^-3)
	@test integrate(x^-5*(a+b*x^2), x) == :(-1//2*b*x^-2+-1//4*a*x^-4)
end

@testset "1.1.2.3 (a+b x^2)^p (c+d x^2)^q.jl" begin
	@test integrate((c+d*x^2)^4*(a+b*x^2), x) == :(a*x*c^4+1//3*c^3*x^3*(b*c+4*a*d)+1//9*d^3*x^9*(a*d+4*b*c)+1//11*b*d^4*x^11+2//5*d*c^2*x^5*(2*b*c+3*a*d)+2//7*c*d^2*x^7*(2*a*d+3*b*c))
	@test integrate((c+d*x^2)^3*(a+b*x^2), x) == :(a*x*c^3+1//3*c^2*x^3*(b*c+3*a*d)+1//7*d^2*x^7*(a*d+3*b*c)+1//9*b*d^3*x^9+3//5*c*d*x^5*(a*d+b*c))
	@test integrate((c+d*x^2)^2*(a+b*x^2), x) == :(a*x*c^2+1//3*c*x^3*(b*c+2*a*d)+1//5*d*x^5*(a*d+2*b*c)+1//7*b*d^2*x^7)
	@test integrate((a+b*x^2)*(c+d*x^2), x) == :(x^3*(1//3*a*d+1//3*b*c)+a*c*x+1//5*b*d*x^5)
	@test integrate((c+d*x^2)^-1*(a+b*x^2), x) == :(b*x*d^-1+-1*c^-1//2*d^-3//2*(b*c+-1*a*d)*arctan(x*c^-1//2*d^(1/2)))
	@test integrate((c+d*x^2)^-2*(a+b*x^2), x) == :((1/2)*c^-3//2*d^-3//2*(a*d+b*c)*arctan(x*c^-1//2*d^(1/2))+-1//2*x*c^-1*d^-1*(c+d*x^2)^-1*(b*c+-1*a*d))
	@test integrate((c+d*x^2)^-3*(a+b*x^2), x) == :(1//8*c^-5//2*d^-3//2*(b*c+3*a*d)*arctan(x*c^-1//2*d^(1/2))+-1//4*x*c^-1*d^-1*(c+d*x^2)^-2*(b*c+-1*a*d)+1//8*x*c^-2*d^-1*(c+d*x^2)^-1*(b*c+3*a*d))
	@test integrate((a+b*x^2)^2*(c+d*x^2)^3, x) == :(x*a^2*c^3+1//5*c*x^5*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+1//7*d*x^7*(a^2*d^2+3*b^2*c^2+6*a*b*c*d)+1//11*b^2*d^3*x^11+1//3*a*c^2*x^3*(2*b*c+3*a*d)+1//9*b*d^2*x^9*(2*a*d+3*b*c))
	@test integrate((a+b*x^2)^2*(c+d*x^2)^2, x) == :(x^5*(1//5*a^2*d^2+1//5*b^2*c^2+4//5*a*b*c*d)+x*a^2*c^2+1//9*b^2*d^2*x^9+2//3*a*c*x^3*(a*d+b*c)+2//7*b*d*x^7*(a*d+b*c))
	@test integrate((a+b*x^2)^2*(c+d*x^2), x) == :(c*x*a^2+1//3*a*x^3*(a*d+2*b*c)+1//5*b*x^5*(b*c+2*a*d)+1//7*d*b^2*x^7)
end

@testset "1.1.2.4 (e x)^m (a+b x^2)^p (c+d x^2)^q.jl" begin
	@test integrate(x^2*(A+B*x^2)*(a+b*x^2), x) == :(1//5*x^5*(A*b+B*a)+1//3*A*a*x^3+1//7*B*b*x^7)
	@test integrate(x*(A+B*x^2)*(a+b*x^2), x) == :(1//4*x^4*(A*b+B*a)+(1/2)*A*a*x^2+1//6*B*b*x^6)
	@test integrate((A+B*x^2)*(a+b*x^2), x) == :(x^3*(1//3*A*b+1//3*B*a)+A*a*x+1//5*B*b*x^5)
	@test integrate(x^-1*(A+B*x^2)*(a+b*x^2), x) == :((1/2)*x^2*(A*b+B*a)+A*a*log(x)+1//4*B*b*x^4)
	@test integrate(x^-2*(A+B*x^2)*(a+b*x^2), x) == :(x*(A*b+B*a)+-1*A*a*x^-1+1//3*B*b*x^3)
	@test integrate(x^-3*(A+B*x^2)*(a+b*x^2), x) == :((A*b+B*a)*log(x)+(1/2)*B*b*x^2+-1//2*A*a*x^-2)
	@test integrate(x^-4*(A+B*x^2)*(a+b*x^2), x) == :(-1*x^-1*(A*b+B*a)+B*b*x+-1//3*A*a*x^-3)
	@test integrate(x^-5*(A+B*x^2)*(a+b*x^2), x) == :(-1//2*x^-2*(A*b+B*a)+B*b*log(x)+-1//4*A*a*x^-4)
	@test integrate(x^-6*(A+B*x^2)*(a+b*x^2), x) == :(-1//3*x^-3*(A*b+B*a)+-1*B*b*x^-1+-1//5*A*a*x^-5)
	@test integrate(x^-7*(A+B*x^2)*(a+b*x^2), x) == :(-1//4*x^-4*(A*b+B*a)+-1//2*B*b*x^-2+-1//6*A*a*x^-6)
end

@testset "1.1.2.5 (a+b x^2)^p (c+d x^2)^q (e+f x^2)^r.jl" begin
	@test integrate((e+f*x^2)^4*(a+b*x^2)*(c+d*x^2), x) == :(1//3*e^3*x^3*(a*d*e+b*c*e+4*a*c*f)+1//5*e^2*x^5*(b*e*(d*e+4*c*f)+2*a*f*(2*d*e+3*c*f))+1//9*f^2*x^9*(a*f*(c*f+4*d*e)+2*b*e*(2*c*f+3*d*e))+1//11*f^3*x^11*(a*d*f+b*c*f+4*b*d*e)+a*c*x*e^4+1//13*b*d*f^4*x^13+2//7*e*f*x^7*(a*f*(2*c*f+3*d*e)+b*e*(2*d*e+3*c*f)))
	@test integrate((e+f*x^2)^3*(a+b*x^2)*(c+d*x^2), x) == :(1//3*e^2*x^3*(a*d*e+b*c*e+3*a*c*f)+1//5*e*x^5*(b*e*(d*e+3*c*f)+3*a*f*(c*f+d*e))+1//7*f*x^7*(a*f*(c*f+3*d*e)+3*b*e*(c*f+d*e))+1//9*f^2*x^9*(a*d*f+b*c*f+3*b*d*e)+a*c*x*e^3+1//11*b*d*f^3*x^11)
	@test integrate((e+f*x^2)^2*(a+b*x^2)*(c+d*x^2), x) == :(x^5*(1//5*a*f*(c*f+2*d*e)+1//5*b*e*(d*e+2*c*f))+1//3*e*x^3*(a*d*e+b*c*e+2*a*c*f)+1//7*f*x^7*(a*d*f+b*c*f+2*b*d*e)+a*c*x*e^2+1//9*b*d*f^2*x^9)
	@test integrate((a+b*x^2)*(c+d*x^2)*(e+f*x^2), x) == :(x^3*(1//3*a*c*f+1//3*a*d*e+1//3*b*c*e)+x^5*(1//5*a*d*f+1//5*b*c*f+1//5*b*d*e)+a*c*e*x+1//7*b*d*f*x^7)
	@test integrate((e+f*x^2)^-1*(a+b*x^2)*(c+d*x^2), x) == :(-1//3*x*f^-2*(-3*b*c*f+-2*a*d*f+3*b*d*e)+1//3*d*x*f^-1*(a+b*x^2)+e^-1//2*f^-5//2*(b*e+-1*a*f)*(d*e+-1*c*f)*arctan(x*e^-1//2*f^(1/2)))
	@test integrate((e+f*x^2)^-2*(a+b*x^2)*(c+d*x^2), x) == :(-1//2*e^-3//2*f^-5//2*(b*e*(-1*c*f+3*d*e)+-1*a*f*(c*f+d*e))*arctan(x*e^-1//2*f^(1/2))+(1/2)*b*x*e^-1*f^-2*(-1*c*f+3*d*e)+-1//2*x*e^-1*f^-1*(e+f*x^2)^-1*(a+b*x^2)*(d*e+-1*c*f))
	@test integrate((e+f*x^2)^-3*(a+b*x^2)*(c+d*x^2), x) == :(1//8*e^-5//2*f^-5//2*(a*f*(d*e+3*c*f)+b*e*(c*f+3*d*e))*arctan(x*e^-1//2*f^(1/2))+-1//8*x*e^-2*f^-2*(e+f*x^2)^-1*(b*e*(c*f+3*d*e)+-1*a*f*(d*e+3*c*f))+-1//4*x*e^-1*f^-1*(e+f*x^2)^-2*(a+b*x^2)*(d*e+-1*c*f))
	@test integrate((e+f*x^2)^-4*(a+b*x^2)*(c+d*x^2), x) == :(1//16*e^-7//2*f^-5//2*(a*f*(d*e+5*c*f)+b*e*(c*f+d*e))*arctan(x*e^-1//2*f^(1/2))+-1//24*x*e^-2*f^-2*(e+f*x^2)^-2*(-1*a*f*(d*e+5*c*f)+3*b*e*(c*f+d*e))+1//16*x*e^-3*f^-2*(e+f*x^2)^-1*(a*f*(d*e+5*c*f)+b*e*(c*f+d*e))+-1//6*x*e^-1*f^-1*(e+f*x^2)^-3*(a+b*x^2)*(d*e+-1*c*f))
	@test integrate((c+d*x^2)^2*(e+f*x^2)^3*(a+b*x^2), x) == :(x^7*(1//7*a*f*(c^2*f^2+3*d^2*e^2+6*c*d*e*f)+1//7*b*e*(d^2*e^2+3*c^2*f^2+6*c*d*e*f))+1//5*e*x^5*(a*(d^2*e^2+3*c^2*f^2+6*c*d*e*f)+b*c*e*(2*d*e+3*c*f))+1//9*f*x^9*(b*(c^2*f^2+3*d^2*e^2+6*c*d*e*f)+a*d*f*(2*c*f+3*d*e))+a*x*c^2*e^3+1//3*c*e^2*x^3*(b*c*e+2*a*d*e+3*a*c*f)+1//11*d*f^2*x^11*(a*d*f+2*b*c*f+3*b*d*e)+1//13*b*d^2*f^3*x^13)
	@test integrate((c+d*x^2)^2*(e+f*x^2)^2*(a+b*x^2), x) == :(x^5*(1//5*a*(c^2*f^2+d^2*e^2+4*c*d*e*f)+2//5*b*c*e*(c*f+d*e))+x^7*(1//7*b*(c^2*f^2+d^2*e^2+4*c*d*e*f)+2//7*a*d*f*(c*f+d*e))+a*x*c^2*e^2+1//3*c*e*x^3*(2*a*(c*f+d*e)+b*c*e)+1//9*d*f*x^9*(2*b*(c*f+d*e)+a*d*f)+1//11*b*d^2*f^2*x^11)
end

@testset "1.1.2.6 (g x)^m (a+b x^2)^p (c+d x^2)^q (e+f x^2)^r.jl" begin
	@test integrate((e*x)^m*(a+b*x^2)^3*(A+B*x^2)*(c+d*x^2), x) == :(a*e^-5*(e*x)^(5+m)*(5+m)^-1*(B*a*(a*d+3*b*c)+3*A*b*(a*d+b*c))+b*e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*(b*c+3*a*d)+3*B*a*(a*d+b*c))+a^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(A*a*d+B*a*c+3*A*b*c)+b^2*e^-9*(e*x)^(9+m)*(9+m)^-1*(A*b*d+B*b*c+3*B*a*d)+A*c*a^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^3*e^-11*(e*x)^(11+m)*(11+m)^-1)
	@test integrate((e*x)^m*(a+b*x^2)^2*(A+B*x^2)*(c+d*x^2), x) == :(e^-5*(e*x)^(5+m)*(5+m)^-1*(A*b*(b*c+2*a*d)+B*a*(a*d+2*b*c))+a*e^-3*(e*x)^(3+m)*(3+m)^-1*(A*a*d+B*a*c+2*A*b*c)+b*e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*d+B*b*c+2*B*a*d)+A*c*a^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^2*e^-9*(e*x)^(9+m)*(9+m)^-1)
	@test integrate((e*x)^m*(A+B*x^2)*(a+b*x^2)*(c+d*x^2), x) == :(e^-5*(e*x)^(5+m)*(5+m)^-1*(A*b*d+B*a*d+B*b*c)+e^-3*(e*x)^(3+m)*(3+m)^-1*(A*a*d+A*b*c+B*a*c)+A*a*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d*e^-7*(e*x)^(7+m)*(7+m)^-1)
	@test integrate((e*x)^m*(A+B*x^2)*(c+d*x^2), x) == :(e^-3*(e*x)^(3+m)*(3+m)^-1*(A*d+B*c)+A*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*e^-5*(e*x)^(5+m)*(5+m)^-1)
	@test integrate((e*x)^m*(a+b*x^2)^3*(c+d*x^2)^2*(A+B*x^2), x) == :(e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*(a^2*d^2+3*b^2*c^2+6*a*b*c*d))+a*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(a^2*d^2+3*b^2*c^2+6*a*b*c*d)+B*a*c*(2*a*d+3*b*c))+b*e^-9*(e*x)^(9+m)*(9+m)^-1*(c*b^2*(B*c+2*A*d)+3*B*a^2*d^2+3*a*b*d*(A*d+2*B*c))+A*a^3*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^2*e^-13*(e*x)^(13+m)*(13+m)^-1+c*a^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(B*a*c+2*A*a*d+3*A*b*c)+d*b^2*e^-11*(e*x)^(11+m)*(11+m)^-1*(A*b*d+2*B*b*c+3*B*a*d))
	@test integrate((e*x)^m*(a+b*x^2)^2*(c+d*x^2)^2*(A+B*x^2), x) == :(e^-7*(e*x)^(7+m)*(7+m)^-1*(B*a^2*d^2+c*b^2*(B*c+2*A*d)+2*a*b*d*(A*d+2*B*c))+e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(a^2*d^2+b^2*c^2+4*a*b*c*d)+2*B*a*c*(a*d+b*c))+A*a^2*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^2*e^-11*(e*x)^(11+m)*(11+m)^-1+a*c*e^-3*(e*x)^(3+m)*(3+m)^-1*(2*A*(a*d+b*c)+B*a*c)+b*d*e^-9*(e*x)^(9+m)*(9+m)^-1*(A*b*d+2*B*a*d+2*B*b*c))
	@test integrate((e*x)^m*(c+d*x^2)^2*(A+B*x^2)*(a+b*x^2), x) == :(e^-5*(e*x)^(5+m)*(5+m)^-1*(a*d*(A*d+2*B*c)+b*c*(B*c+2*A*d))+c*e^-3*(e*x)^(3+m)*(3+m)^-1*(A*b*c+B*a*c+2*A*a*d)+d*e^-7*(e*x)^(7+m)*(7+m)^-1*(A*b*d+B*a*d+2*B*b*c)+A*a*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d^2*e^-9*(e*x)^(9+m)*(9+m)^-1)
	@test integrate((e*x)^m*(c+d*x^2)^2*(A+B*x^2), x) == :(A*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d^2*e^-7*(e*x)^(7+m)*(7+m)^-1+c*e^-3*(e*x)^(3+m)*(3+m)^-1*(B*c+2*A*d)+d*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*d+2*B*c))
	@test integrate((e*x)^m*(a+b*x^2)^3*(c+d*x^2)^3*(A+B*x^2), x) == :(e^-9*(e*x)^(9+m)*(9+m)^-1*(B*a^3*d^3+b^3*c^2*(B*c+3*A*d)+3*b*a^2*d^2*(A*d+3*B*c)+9*a*c*d*b^2*(A*d+B*c))+e^-7*(e*x)^(7+m)*(7+m)^-1*(A*(a^3*d^3+b^3*c^3+9*a*d*b^2*c^2+9*b*c*a^2*d^2)+3*B*a*c*(a^2*d^2+b^2*c^2+3*a*b*c*d))+A*a^3*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^3*e^-15*(e*x)^(15+m)*(15+m)^-1+a^2*c^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(3*A*(a*d+b*c)+B*a*c)+b^2*d^2*e^-13*(e*x)^(13+m)*(13+m)^-1*(A*b*d+3*B*a*d+3*B*b*c)+3*a*c*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(a^2*d^2+b^2*c^2+3*a*b*c*d)+B*a*c*(a*d+b*c))+3*b*d*e^-11*(e*x)^(11+m)*(11+m)^-1*(B*a^2*d^2+c*b^2*(A*d+B*c)+a*b*d*(A*d+3*B*c)))
	@test integrate((e*x)^m*(a+b*x^2)^2*(c+d*x^2)^3*(A+B*x^2), x) == :(e^-7*(e*x)^(7+m)*(7+m)^-1*(a^2*d^2*(A*d+3*B*c)+b^2*c^2*(B*c+3*A*d)+6*a*b*c*d*(A*d+B*c))+c*e^-5*(e*x)^(5+m)*(5+m)^-1*(A*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*c*(2*b*c+3*a*d))+d*e^-9*(e*x)^(9+m)*(9+m)^-1*(B*a^2*d^2+3*c*b^2*(A*d+B*c)+2*a*b*d*(A*d+3*B*c))+A*a^2*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^3*e^-13*(e*x)^(13+m)*(13+m)^-1+a*c^2*e^-3*(e*x)^(3+m)*(3+m)^-1*(B*a*c+2*A*b*c+3*A*a*d)+b*d^2*e^-11*(e*x)^(11+m)*(11+m)^-1*(A*b*d+2*B*a*d+3*B*b*c))
end

@testset "1.1.2.8 P(x) (c x)^m (a+b x^2)^p.jl" begin
	@test integrate(x^3*(a+b*x^2)^(1/2)*(A+B*x), x) == :(-1//120*a*b^-2*(a+b*x^2)^3//2*(16A+15*B*x)+1//5*A*b^-1*x^2*(a+b*x^2)^3//2+1//6*B*b^-1*x^3*(a+b*x^2)^3//2+1//16*B*a^3*b^-5//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+1//16*B*x*a^2*b^-2*(a+b*x^2)^(1/2))
	@test integrate(x^2*(a+b*x^2)^(1/2)*(A+B*x), x) == :(-1//60*b^-2*(a+b*x^2)^3//2*(8*B*a+-15*A*b*x)+-1//8*A*a^2*b^-3//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+1//5*B*b^-1*x^2*(a+b*x^2)^3//2+-1//8*A*a*x*b^-1*(a+b*x^2)^(1/2))
	@test integrate(x*(a+b*x^2)^(1/2)*(A+B*x), x) == :(1//12*b^-1*(a+b*x^2)^3//2*(4A+3*B*x)+-1//8*B*a^2*b^-3//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+-1//8*B*a*x*b^-1*(a+b*x^2)^(1/2))
	@test integrate((a+b*x^2)^(1/2)*(A+B*x), x) == :((1/2)*A*x*(a+b*x^2)^(1/2)+1//3*B*b^-1*(a+b*x^2)^3//2+(1/2)*A*a*b^-1//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2))
	@test integrate(x^-1*(a+b*x^2)^(1/2)*(A+B*x), x) == :((1/2)*(a+b*x^2)^(1/2)*(2A+B*x)+-1*A*a^(1/2)*arctanh(a^-1//2*(a+b*x^2)^(1/2))+(1/2)*B*a*b^-1//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2))
	@test integrate(x^-2*(a+b*x^2)^(1/2)*(A+B*x), x) == :(A*b^(1/2)*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+-1*B*a^(1/2)*arctanh(a^-1//2*(a+b*x^2)^(1/2))+-1*x^-1*(a+b*x^2)^(1/2)*(A+-1*B*x))
	@test integrate(x^-3*(a+b*x^2)^(1/2)*(A+B*x), x) == :(B*b^(1/2)*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+-1//2*x^-2*(a+b*x^2)^(1/2)*(A+2*B*x)+-1//2*A*b*a^-1//2*arctanh(a^-1//2*(a+b*x^2)^(1/2)))
	@test integrate(x^3*(a+b*x^2)^3//2*(A+B*x), x) == :(-1//560*a*b^-2*(a+b*x^2)^5//2*(32A+35*B*x)+1//7*A*b^-1*x^2*(a+b*x^2)^5//2+1//8*B*b^-1*x^3*(a+b*x^2)^5//2+3//128*B*a^4*b^-5//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+1//64*B*x*a^2*b^-2*(a+b*x^2)^3//2+3//128*B*x*a^3*b^-2*(a+b*x^2)^(1/2))
	@test integrate(x^2*(a+b*x^2)^3//2*(A+B*x), x) == :(-1//210*b^-2*(a+b*x^2)^5//2*(12*B*a+-35*A*b*x)+-1//16*A*a^3*b^-3//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+1//7*B*b^-1*x^2*(a+b*x^2)^5//2+-1//16*A*x*a^2*b^-1*(a+b*x^2)^(1/2)+-1//24*A*a*x*b^-1*(a+b*x^2)^3//2)
	@test integrate(x*(a+b*x^2)^3//2*(A+B*x), x) == :(1//30*b^-1*(a+b*x^2)^5//2*(6A+5*B*x)+-1//16*B*a^3*b^-3//2*arctanh(x*b^(1/2)*(a+b*x^2)^-1//2)+-1//16*B*x*a^2*b^-1*(a+b*x^2)^(1/2)+-1//24*B*a*x*b^-1*(a+b*x^2)^3//2)
end

@testset "1.1.3.2 (c x)^m (a+b x^n)^p.jl" begin
	@test integrate((b*x)^p*(c*x)^m, x) == :(b^-1*(b*x)^(1+p)*(c*x)^m*(1+m+p)^-1)
	@test integrate(x^3*(b*x^2)^(1/2), x) == :(1//5*x^4*(b*x^2)^(1/2))
	@test integrate(x^2*(b*x^2)^(1/2), x) == :(1//4*x^3*(b*x^2)^(1/2))
	@test integrate(x*(b*x^2)^(1/2), x) == :(1//3*x^2*(b*x^2)^(1/2))
	@test integrate((b*x^2)^(1/2), x) == :((1/2)*x*(b*x^2)^(1/2))
	@test integrate(x^-1*(b*x^2)^(1/2), x) == :((b*x^2)^(1/2))
	@test integrate(x^-2*(b*x^2)^(1/2), x) == :(x^-1*(b*x^2)^(1/2)*log(x))
	@test integrate(x^-3*(b*x^2)^(1/2), x) == :(-1*x^-2*(b*x^2)^(1/2))
	@test integrate(x^-4*(b*x^2)^(1/2), x) == :(-1//2*x^-3*(b*x^2)^(1/2))
	@test integrate(x^-5*(b*x^2)^(1/2), x) == :(-1//3*x^-4*(b*x^2)^(1/2))
end

@testset "1.1.3.3 (a+b x^n)^p (c+d x^n)^q.jl" begin
	@test integrate((c+d*x^3)^4*(a+b*x^3), x) == :(a*x*c^4+1//4*c^3*x^4*(b*c+4*a*d)+1//13*d^3*x^13*(a*d+4*b*c)+1//16*b*d^4*x^16+1//5*c*d^2*x^10*(2*a*d+3*b*c)+2//7*d*c^2*x^7*(2*b*c+3*a*d))
	@test integrate((c+d*x^3)^3*(a+b*x^3), x) == :(a*x*c^3+1//4*c^2*x^4*(b*c+3*a*d)+1//10*d^2*x^10*(a*d+3*b*c)+1//13*b*d^3*x^13+3//7*c*d*x^7*(a*d+b*c))
	@test integrate((c+d*x^3)^2*(a+b*x^3), x) == :(a*x*c^2+1//4*c*x^4*(b*c+2*a*d)+1//7*d*x^7*(a*d+2*b*c)+1//10*b*d^2*x^10)
	@test integrate((a+b*x^3)*(c+d*x^3), x) == :(x^4*(1//4*a*d+1//4*b*c)+a*c*x+1//7*b*d*x^7)
	@test integrate((c+d*x^3)^-1*(a+b*x^3), x) == :(b*x*d^-1+-1//3*c^-2//3*d^-4//3*(b*c+-1*a*d)*log(c^1//3+x*d^1//3)+1//6*c^-2//3*d^-4//3*(b*c+-1*a*d)*log(c^2//3+d^2//3*x^2+-1*x*c^1//3*d^1//3)+1//3*3^(1/2)*c^-2//3*d^-4//3*(b*c+-1*a*d)*arctan(1//3*3^(1/2)*c^-1//3*(c^1//3+-2*x*d^1//3)))
	@test integrate((c+d*x^3)^-2*(a+b*x^3), x) == :(-1//18*c^-5//3*d^-4//3*(b*c+2*a*d)*log(c^2//3+d^2//3*x^2+-1*x*c^1//3*d^1//3)+1//9*c^-5//3*d^-4//3*(b*c+2*a*d)*log(c^1//3+x*d^1//3)+-1//3*x*c^-1*d^-1*(c+d*x^3)^-1*(b*c+-1*a*d)+-1//9*3^(1/2)*c^-5//3*d^-4//3*(b*c+2*a*d)*arctan(1//3*3^(1/2)*c^-1//3*(c^1//3+-2*x*d^1//3)))
	@test integrate((c+d*x^3)^-3*(a+b*x^3), x) == :(-1//54*c^-8//3*d^-4//3*(b*c+5*a*d)*log(c^2//3+d^2//3*x^2+-1*x*c^1//3*d^1//3)+1//27*c^-8//3*d^-4//3*(b*c+5*a*d)*log(c^1//3+x*d^1//3)+-1//6*x*c^-1*d^-1*(c+d*x^3)^-2*(b*c+-1*a*d)+-1//27*3^(1/2)*c^-8//3*d^-4//3*(b*c+5*a*d)*arctan(1//3*3^(1/2)*c^-1//3*(c^1//3+-2*x*d^1//3))+1//18*x*c^-2*d^-1*(c+d*x^3)^-1*(b*c+5*a*d))
	@test integrate((a+b*x^3)^2*(c+d*x^3)^3, x) == :(x*a^2*c^3+1//7*c*x^7*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+1//10*d*x^10*(a^2*d^2+3*b^2*c^2+6*a*b*c*d)+1//16*b^2*d^3*x^16+1//4*a*c^2*x^4*(2*b*c+3*a*d)+1//13*b*d^2*x^13*(2*a*d+3*b*c))
	@test integrate((a+b*x^3)^2*(c+d*x^3)^2, x) == :(x^7*(1//7*a^2*d^2+1//7*b^2*c^2+4//7*a*b*c*d)+x*a^2*c^2+1//13*b^2*d^2*x^13+(1/2)*a*c*x^4*(a*d+b*c)+1//5*b*d*x^10*(a*d+b*c))
	@test integrate((a+b*x^3)^2*(c+d*x^3), x) == :(c*x*a^2+1//4*a*x^4*(a*d+2*b*c)+1//7*b*x^7*(b*c+2*a*d)+1//10*d*b^2*x^10)
end

@testset "1.1.3.4 (e x)^m (a+b x^n)^p (c+d x^n)^q.jl" begin
	@test integrate(x^2*(A+B*x^3)*(a+b*x^3), x) == :(1//6*x^6*(A*b+B*a)+1//3*A*a*x^3+1//9*B*b*x^9)
	@test integrate(x*(A+B*x^3)*(a+b*x^3), x) == :(1//5*x^5*(A*b+B*a)+(1/2)*A*a*x^2+1//8*B*b*x^8)
	@test integrate((A+B*x^3)*(a+b*x^3), x) == :(1//4*x^4*(A*b+B*a)+A*a*x+1//7*B*b*x^7)
	@test integrate(x^-1*(A+B*x^3)*(a+b*x^3), x) == :(1//3*x^3*(A*b+B*a)+A*a*log(x)+1//6*B*b*x^6)
	@test integrate(x^-2*(A+B*x^3)*(a+b*x^3), x) == :((1/2)*x^2*(A*b+B*a)+-1*A*a*x^-1+1//5*B*b*x^5)
	@test integrate(x^-3*(A+B*x^3)*(a+b*x^3), x) == :(x*(A*b+B*a)+-1//2*A*a*x^-2+1//4*B*b*x^4)
	@test integrate(x^-4*(A+B*x^3)*(a+b*x^3), x) == :((A*b+B*a)*log(x)+-1//3*A*a*x^-3+1//3*B*b*x^3)
	@test integrate(x^-5*(A+B*x^3)*(a+b*x^3), x) == :(-1*x^-1*(A*b+B*a)+(1/2)*B*b*x^2+-1//4*A*a*x^-4)
	@test integrate(x^-6*(A+B*x^3)*(a+b*x^3), x) == :(-1//2*x^-2*(A*b+B*a)+B*b*x+-1//5*A*a*x^-5)
	@test integrate(x^-7*(A+B*x^3)*(a+b*x^3), x) == :(-1//3*x^-3*(A*b+B*a)+B*b*log(x)+-1//6*A*a*x^-6)
end

@testset "1.1.3.6 (g x)^m (a+b x^n)^p (c+d x^n)^q (e+f x^n)^r.jl" begin
	@test integrate((e*x)^m*(a+b*x^n)^3*(A+B*x^n)*(c+d*x^n), x) == :(a*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(B*a*(a*d+3*b*c)+3*A*b*(a*d+b*c))+b*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*(b*c+3*a*d)+3*B*a*(a*d+b*c))+a^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*a*d+B*a*c+3*A*b*c)+b^2*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(A*b*d+B*b*c+3*B*a*d)+A*c*a^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^3*x^(1+5n)*(e*x)^m*(1+m+5n)^-1)
	@test integrate((e*x)^m*(a+b*x^n)^2*(A+B*x^n)*(c+d*x^n), x) == :(x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*b*(b*c+2*a*d)+B*a*(a*d+2*b*c))+a*x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*a*d+B*a*c+2*A*b*c)+b*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*d+B*b*c+2*B*a*d)+A*c*a^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*b^2*x^(1+4n)*(e*x)^m*(1+m+4n)^-1)
	@test integrate((e*x)^m*(A+B*x^n)*(a+b*x^n)*(c+d*x^n), x) == :(x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*a*d+A*b*c+B*a*c)+x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*b*d+B*a*d+B*b*c)+A*a*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d*x^(1+3n)*(e*x)^m*(1+m+3n)^-1)
	@test integrate((e*x)^m*(A+B*x^n)*(c+d*x^n), x) == :(x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*d+B*c)+A*c*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d*x^(1+2n)*(e*x)^m*(1+m+2n)^-1)
	@test integrate((e*x)^m*(a+b*x^n)^3*(c+d*x^n)^2*(A+B*x^n), x) == :(x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*(a^2*d^2+3*b^2*c^2+6*a*b*c*d))+a*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(a^2*d^2+3*b^2*c^2+6*a*b*c*d)+B*a*c*(2*a*d+3*b*c))+b*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(c*b^2*(B*c+2*A*d)+3*B*a^2*d^2+3*a*b*d*(A*d+2*B*c))+A*a^3*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^2*x^(1+6n)*(e*x)^m*(1+m+6n)^-1+c*a^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(B*a*c+2*A*a*d+3*A*b*c)+d*b^2*x^(1+5n)*(e*x)^m*(1+m+5n)^-1*(A*b*d+2*B*b*c+3*B*a*d))
	@test integrate((e*x)^m*(a+b*x^n)^2*(c+d*x^n)^2*(A+B*x^n), x) == :(x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(a^2*d^2+b^2*c^2+4*a*b*c*d)+2*B*a*c*(a*d+b*c))+x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(B*a^2*d^2+c*b^2*(B*c+2*A*d)+2*a*b*d*(A*d+2*B*c))+A*a^2*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^2*x^(1+5n)*(e*x)^m*(1+m+5n)^-1+a*c*x^(1+n)*(e*x)^m*(1+m+n)^-1*(2*A*(a*d+b*c)+B*a*c)+b*d*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(A*b*d+2*B*a*d+2*B*b*c))
	@test integrate((e*x)^m*(c+d*x^n)^2*(A+B*x^n)*(a+b*x^n), x) == :(x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(a*d*(A*d+2*B*c)+b*c*(B*c+2*A*d))+c*x^(1+n)*(e*x)^m*(1+m+n)^-1*(A*b*c+B*a*c+2*A*a*d)+d*x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*b*d+B*a*d+2*B*b*c)+A*a*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b*d^2*x^(1+4n)*(e*x)^m*(1+m+4n)^-1)
	@test integrate((e*x)^m*(c+d*x^n)^2*(A+B*x^n), x) == :(A*c^2*e^-1*(e*x)^(1+m)*(1+m)^-1+B*d^2*x^(1+3n)*(e*x)^m*(1+m+3n)^-1+c*x^(1+n)*(e*x)^m*(1+m+n)^-1*(B*c+2*A*d)+d*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*d+2*B*c))
	@test integrate((e*x)^m*(a+b*x^n)^3*(c+d*x^n)^3*(A+B*x^n), x) == :(x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(A*(a^3*d^3+b^3*c^3+9*a*d*b^2*c^2+9*b*c*a^2*d^2)+3*B*a*c*(a^2*d^2+b^2*c^2+3*a*b*c*d))+x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(B*a^3*d^3+b^3*c^2*(B*c+3*A*d)+3*b*a^2*d^2*(A*d+3*B*c)+9*a*c*d*b^2*(A*d+B*c))+A*a^3*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^3*d^3*x^(1+7n)*(e*x)^m*(1+m+7n)^-1+a^2*c^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(3*A*(a*d+b*c)+B*a*c)+b^2*d^2*x^(1+6n)*(e*x)^m*(1+m+6n)^-1*(A*b*d+3*B*a*d+3*B*b*c)+3*a*c*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(a^2*d^2+b^2*c^2+3*a*b*c*d)+B*a*c*(a*d+b*c))+3*b*d*x^(1+5n)*(e*x)^m*(1+m+5n)^-1*(B*a^2*d^2+c*b^2*(A*d+B*c)+a*b*d*(A*d+3*B*c)))
	@test integrate((e*x)^m*(a+b*x^n)^2*(c+d*x^n)^3*(A+B*x^n), x) == :(x^(1+3n)*(e*x)^m*(1+m+3n)^-1*(a^2*d^2*(A*d+3*B*c)+b^2*c^2*(B*c+3*A*d)+6*a*b*c*d*(A*d+B*c))+c*x^(1+2n)*(e*x)^m*(1+m+2n)^-1*(A*(b^2*c^2+3*a^2*d^2+6*a*b*c*d)+B*a*c*(2*b*c+3*a*d))+d*x^(1+4n)*(e*x)^m*(1+m+4n)^-1*(B*a^2*d^2+3*c*b^2*(A*d+B*c)+2*a*b*d*(A*d+3*B*c))+A*a^2*c^3*e^-1*(e*x)^(1+m)*(1+m)^-1+B*b^2*d^3*x^(1+6n)*(e*x)^m*(1+m+6n)^-1+a*c^2*x^(1+n)*(e*x)^m*(1+m+n)^-1*(B*a*c+2*A*b*c+3*A*a*d)+b*d^2*x^(1+5n)*(e*x)^m*(1+m+5n)^-1*(A*b*d+2*B*a*d+3*B*b*c))
end

@testset "1.1.3.8 P(x) (c x)^m (a+b x^n)^p.jl" begin
	@test integrate((a+b*x)^-1//2*(c+d*x+e*x^2), x) == :(b^-3*(a+b*x)^(1/2)*(2*c*b^2+2*e*a^2+-2*a*b*d)+1//3*b^-3*(a+b*x)^3//2*(-4*a*e+2*b*d)+2//5*e*b^-3*(a+b*x)^5//2)
	@test integrate((a+b*x)^-1//2*(c+d*x+e*x^2)^2, x) == :(2*b^-5*(a+b*x)^(1/2)*(c*b^2+e*a^2+-1*a*b*d)^2+-1//5*b^-5*(a+b*x)^5//2*(-12*a^2*e^2+-2*b^2*(d^2+2*c*e)+12*a*b*d*e)+2//9*b^-5*e^2*(a+b*x)^9//2+1//3*b^-5*(a+b*x)^3//2*(-8*a*e+4*b*d)*(c*b^2+e*a^2+-1*a*b*d)+4//7*e*b^-5*(a+b*x)^7//2*(b*d+-2*a*e))
	@test integrate((a+b*x)^-1//2*(c+d*x+e*x^2)^3, x) == :(2*b^-7*(a+b*x)^(1/2)*(c*b^2+e*a^2+-1*a*b*d)^3+2//13*b^-7*e^3*(a+b*x)^13//2+b^-7*(a+b*x)^3//2*(c*b^2+e*a^2+-1*a*b*d)^2*(-4*a*e+2*b*d)+-2//3*e*b^-7*(a+b*x)^9//2*(-1*b^2*(d^2+c*e)+-5*a^2*e^2+5*a*b*d*e)+-1//5*b^-7*(a+b*x)^5//2*(-1*b^2*(d^2+c*e)+-5*a^2*e^2+5*a*b*d*e)*(6*c*b^2+6*e*a^2+-6*a*b*d)+-1//7*b^-7*(a+b*x)^7//2*(-4*a*e+2*b*d)*(-1*b^2*(d^2+6*c*e)+-10*a^2*e^2+10*a*b*d*e)+6//11*b^-7*e^2*(a+b*x)^11//2*(b*d+-2*a*e))
	@test integrate((a+b*x)^-1//2*(c+d*x+e*x^2+f*x^3), x) == :(b^-4*(a+b*x)^(1/2)*(-2*f*a^3+2*c*b^3+-2*a*d*b^2+2*b*e*a^2)+1//3*b^-4*(a+b*x)^3//2*(2*d*b^2+6*f*a^2+-4*a*b*e)+1//5*b^-4*(a+b*x)^5//2*(-6*a*f+2*b*e)+2//7*f*b^-4*(a+b*x)^7//2)
	@test integrate((a+b*x)^-1//2*(c+d*x+e*x^2+f*x^3)^2, x) == :(2*b^-7*(a+b*x)^(1/2)*(c*b^3+-1*f*a^3+b*e*a^2+-1*a*d*b^2)^2+-1//9*b^-7*(a+b*x)^9//2*(-30*a^2*f^2+-2*b^2*(e^2+2*d*f)+20*a*b*e*f)+1//5*b^-7*(a+b*x)^5//2*(2*b^4*(d^2+2*c*e)+30*a^4*f^2+-12*a*b^3*(c*f+d*e)+12*a^2*b^2*(e^2+2*d*f)+-40*b*e*f*a^3)+1//7*b^-7*(a+b*x)^7//2*(-40*a^3*f^2+4*b^3*(c*f+d*e)+-8*a*b^2*(e^2+2*d*f)+40*b*e*f*a^2)+2//13*b^-7*f^2*(a+b*x)^13//2+1//3*b^-7*(a+b*x)^3//2*(4*d*b^2+12*f*a^2+-8*a*b*e)*(c*b^3+-1*f*a^3+b*e*a^2+-1*a*d*b^2)+4//11*f*b^-7*(a+b*x)^11//2*(b*e+-3*a*f))
	@test integrate((a+b*x)^-1//2*(c+d*x+e*x^2+f*x^3)^3, x) == :(2*b^-10*(a+b*x)^(1/2)*(c*b^3+-1*f*a^3+b*e*a^2+-1*a*d*b^2)^3+-1//7*b^-10*(a+b*x)^7//2*(-168*a^6*f^3+-2*b^6*(d^3+3*f*c^2+6*c*d*e)+-60*a^2*b^4*(d*e^2+f*d^2+2*c*e*f)+24*a*b^5*(c*e^2+e*d^2+2*c*d*f)+40*a^3*b^3*(e^3+3*c*f^2+6*d*e*f)+-210*f*a^4*b^2*(e^2+d*f)+336*b*e*a^5*f^2)+-1//11*b^-10*(a+b*x)^11//2*(-252*a^4*f^3+-6*b^4*(d*e^2+f*d^2+2*c*e*f)+12*a*b^3*(e^3+3*c*f^2+6*d*e*f)+-126*f*a^2*b^2*(e^2+d*f)+336*b*e*a^3*f^2)+1//3*b^-10*(a+b*x)^9//2*(-84*a^5*f^3+2*b^5*(c*e^2+e*d^2+2*c*d*f)+-10*a*b^4*(d*e^2+f*d^2+2*c*e*f)+10*a^2*b^3*(e^3+3*c*f^2+6*d*e*f)+-70*f*a^3*b^2*(e^2+d*f)+140*b*e*a^4*f^2)+1//13*b^-10*(a+b*x)^13//2*(-168*a^3*f^3+2*b^3*(e^3+3*c*f^2+6*d*e*f)+-42*a*f*b^2*(e^2+d*f)+168*b*e*a^2*f^2)+2//19*b^-10*f^3*(a+b*x)^19//2+b^-10*(a+b*x)^3//2*(c*b^3+-1*f*a^3+b*e*a^2+-1*a*d*b^2)^2*(2*d*b^2+6*f*a^2+-4*a*b*e)+-2//5*f*b^-10*(a+b*x)^15//2*(-1*b^2*(e^2+d*f)+-12*a^2*f^2+8*a*b*e*f)+1//5*b^-10*(a+b*x)^5//2*(-6*f*a^3+6*c*b^3+-6*a*d*b^2+6*b*e*a^2)*(b^4*(d^2+c*e)+12*a^4*f^2+a^2*b^2*(5*e^2+9*d*f)+-1*a*b^3*(3*c*f+5*d*e)+-16*b*e*f*a^3)+6//17*b^-10*f^2*(a+b*x)^17//2*(b*e+-3*a*f))
	@test integrate((a+b*x^3)^-1*(c+d*x), x) == :(-1//6*a^-2//3*b^-1//3*(c+-1*d*a^1//3*b^-1//3)*log(a^2//3+b^2//3*x^2+-1*x*a^1//3*b^1//3)+1//3*a^-2//3*b^-2//3*(c*b^1//3+-1*d*a^1//3)*log(a^1//3+x*b^1//3)+-1//3*3^(1/2)*a^-2//3*b^-2//3*(c*b^1//3+d*a^1//3)*arctan(1//3*3^(1/2)*a^-1//3*(a^1//3+-2*x*b^1//3)))
	@test integrate((a+b*x^3)^-2*(c+d*x), x) == :(-1//18*a^-5//3*b^-2//3*(-1*d*a^1//3+2*c*b^1//3)*log(a^2//3+b^2//3*x^2+-1*x*a^1//3*b^1//3)+1//3*x*a^-1*(a+b*x^3)^-1*(c+d*x)+1//9*a^-5//3*b^-2//3*(-1*d*a^1//3+2*c*b^1//3)*log(a^1//3+x*b^1//3)+-1//9*3^(1/2)*a^-5//3*b^-2//3*(d*a^1//3+2*c*b^1//3)*arctan(1//3*3^(1/2)*a^-1//3*(a^1//3+-2*x*b^1//3)))
	@test integrate((a+b*x^3)^-3*(c+d*x), x) == :(-1//54*a^-8//3*b^-2//3*(-2*d*a^1//3+5*c*b^1//3)*log(a^2//3+b^2//3*x^2+-1*x*a^1//3*b^1//3)+1//6*x*a^-1*(a+b*x^3)^-2*(c+d*x)+1//18*x*a^-2*(a+b*x^3)^-1*(5c+4*d*x)+1//27*a^-8//3*b^-2//3*(-2*d*a^1//3+5*c*b^1//3)*log(a^1//3+x*b^1//3)+-1//27*3^(1/2)*a^-8//3*b^-2//3*(2*d*a^1//3+5*c*b^1//3)*arctan(1//3*3^(1/2)*a^-1//3*(a^1//3+-2*x*b^1//3)))
	@test integrate((a+b*x^3)^-4*(c+d*x), x) == :(-1//243*a^-11//3*b^-2//3*(-7*d*a^1//3+20*c*b^1//3)*log(a^2//3+b^2//3*x^2+-1*x*a^1//3*b^1//3)+1//9*x*a^-1*(a+b*x^3)^-3*(c+d*x)+1//54*x*a^-2*(a+b*x^3)^-2*(8c+7*d*x)+1//243*a^-11//3*b^-2//3*(-14*d*a^1//3+40*c*b^1//3)*log(a^1//3+x*b^1//3)+2//81*x*a^-3*(a+b*x^3)^-1*(10c+7*d*x)+-1//243*3^(1/2)*a^-11//3*b^-2//3*(14*d*a^1//3+40*c*b^1//3)*arctan(1//3*3^(1/2)*a^-1//3*(a^1//3+-2*x*b^1//3)))
end

@testset "1.1.4.2 (c x)^m (a x^j+b x^n)^p.jl" begin
	@test integrate(x^2*(a*x+b*x^3), x) == :(1//4*a*x^4+1//6*b*x^6)
	@test integrate(x*(a*x+b*x^3), x) == :(1//3*a*x^3+1//5*b*x^5)
	@test integrate(a*x+b*x^3, x) == :((1/2)*a*x^2+1//4*b*x^4)
	@test integrate(x^-1*(a*x+b*x^3), x) == :(a*x+1//3*b*x^3)
	@test integrate(x^-2*(a*x+b*x^3), x) == :(a*log(x)+(1/2)*b*x^2)
	@test integrate(x^2*(a*x+b*x^3)^2, x) == :(1//5*a^2*x^5+1//9*b^2*x^9+2//7*a*b*x^7)
	@test integrate(x*(a*x+b*x^3)^2, x) == :(1//4*a^2*x^4+1//8*b^2*x^8+1//3*a*b*x^6)
	@test integrate((a*x+b*x^3)^2, x) == :(1//3*a^2*x^3+1//7*b^2*x^7+2//5*a*b*x^5)
	@test integrate(x^-1*(a*x+b*x^3)^2, x) == :(1//6*b^-1*(a+b*x^2)^3)
	@test integrate(x^-2*(a*x+b*x^3)^2, x) == :(x*a^2+1//5*b^2*x^5+2//3*a*b*x^3)
end

@testset "1.1.4.3 (e x)^m (a x^j+b x^k)^p (c+d x^n)^q.jl" begin
	@test integrate(x^2*(A+B*x^2)*(b*x^2+c*x^4), x) == :(x^7*(1//7*A*c+1//7*B*b)+1//5*A*b*x^5+1//9*B*c*x^9)
	@test integrate(x*(A+B*x^2)*(b*x^2+c*x^4), x) == :(x^6*(1//6*A*c+1//6*B*b)+1//4*A*b*x^4+1//8*B*c*x^8)
	@test integrate((A+B*x^2)*(b*x^2+c*x^4), x) == :(x^5*(1//5*A*c+1//5*B*b)+1//3*A*b*x^3+1//7*B*c*x^7)
	@test integrate(x^-1*(A+B*x^2)*(b*x^2+c*x^4), x) == :(x^4*(1//4*A*c+1//4*B*b)+(1/2)*A*b*x^2+1//6*B*c*x^6)
	@test integrate(x^-2*(A+B*x^2)*(b*x^2+c*x^4), x) == :(x^3*(1//3*A*c+1//3*B*b)+A*b*x+1//5*B*c*x^5)
	@test integrate(x^-3*(A+B*x^2)*(b*x^2+c*x^4), x) == :(x^2*((1/2)*A*c+(1/2)*B*b)+A*b*log(x)+1//4*B*c*x^4)
	@test integrate(x^-4*(A+B*x^2)*(b*x^2+c*x^4), x) == :(x*(A*c+B*b)+-1*A*b*x^-1+1//3*B*c*x^3)
	@test integrate(x^-5*(A+B*x^2)*(b*x^2+c*x^4), x) == :((A*c+B*b)*log(x)+(1/2)*B*c*x^2+-1//2*A*b*x^-2)
	@test integrate(x^-6*(A+B*x^2)*(b*x^2+c*x^4), x) == :(-1*x^-1*(A*c+B*b)+B*c*x+-1//3*A*b*x^-3)
	@test integrate(x^-7*(A+B*x^2)*(b*x^2+c*x^4), x) == :(-1//2*x^-2*(A*c+B*b)+B*c*log(x)+-1//4*A*b*x^-4)
end

@testset "1.2.1.1 (a+b x+c x^2)^p.jl" begin
	@test integrate((b*x+c*x^2)^7//2, x) == :(1//16*c^-1*(b*x+c*x^2)^7//2*(b+2*c*x)+35//16384*b^8*c^-9//2*arctanh(x*c^(1/2)*(b*x+c*x^2)^-1//2)+-35//16384*b^6*c^-4*(b*x+c*x^2)^(1/2)*(b+2*c*x)+-7//384*b^2*c^-2*(b*x+c*x^2)^5//2*(b+2*c*x)+35//6144*b^4*c^-3*(b*x+c*x^2)^3//2*(b+2*c*x))
	@test integrate((4*x^2+3*im*x)^7//2, x) == :((4*x^2+3*im*x)^7//2*(1//8*x+3//64*im)+1//2048*(4*x^2+3*im*x)^5//2*(63im+168x)+1//131072*(4*x^2+3*im*x)^3//2*(2835im+7560x)+1//4194304*(4*x^2+3*im*x)^(1/2)*(76545im+204120x)+229635//16777216*im*arcsin(1+-8//3*im*x))
	@test integrate((4*x^2+3*im*x)^5//2, x) == :((4*x^2+3*im*x)^5//2*(1//6*x+1//16*im)+1//1024*(4*x^2+3*im*x)^3//2*(45im+120x)+1//32768*(4*x^2+3*im*x)^(1/2)*(1215im+3240x)+3645//131072*im*arcsin(1+-8//3*im*x))
	@test integrate((4*x^2+3*im*x)^3//2, x) == :((4*x^2+3*im*x)^3//2*(1//4*x+3//32*im)+1//1024*(4*x^2+3*im*x)^(1/2)*(81im+216x)+243//4096*im*arcsin(1+-8//3*im*x))
	@test integrate((4*x^2+3*im*x)^(1/2), x) == :((4*x^2+3*im*x)^(1/2)*((1/2)*x+3//16*im)+9//64*im*arcsin(1+-8//3*im*x))
	@test integrate((-4*x^2+3x)^7//2, x) == :(-229635//16777216*arcsin(1+-8//3*x)+-1*(-4*x^2+3x)^7//2*(3//64+-1//8*x)+-1//2048*(-4*x^2+3x)^5//2*(63+-168x)+-1//131072*(-4*x^2+3x)^3//2*(2835+-7560x)+-1//4194304*(-4*x^2+3x)^(1/2)*(76545+-204120x))
	@test integrate((-4*x^2+3x)^5//2, x) == :(-3645//131072*arcsin(1+-8//3*x)+-1*(-4*x^2+3x)^5//2*(1//16+-1//6*x)+-1//1024*(-4*x^2+3x)^3//2*(45+-120x)+-1//32768*(-4*x^2+3x)^(1/2)*(1215+-3240x))
	@test integrate((-4*x^2+3x)^3//2, x) == :(-243//4096*arcsin(1+-8//3*x)+-1*(-4*x^2+3x)^3//2*(3//32+-1//4*x)+-1//1024*(-4*x^2+3x)^(1/2)*(81+-216x))
	@test integrate((-4*x^2+3x)^(1/2), x) == :(-9//64*arcsin(1+-8//3*x)+(-4*x^2+3x)^(1/2)*(-3//16+(1/2)*x))
	@test integrate((-1*x^2+6x)^(1/2), x) == :(-9//2*arcsin(1+-1//3*x)+(-1*x^2+6x)^(1/2)*(-3//2+(1/2)*x))
end

@testset "1.2.1.2 (d+e x)^m (a+b x+c x^2)^p.jl" begin
	@test integrate(x^3*(b*x+c*x^2)^(1/2), x) == :(1//5*c^-1*x^2*(b*x+c*x^2)^3//2+7//48*b^2*c^-3*(b*x+c*x^2)^3//2+7//128*b^5*c^-9//2*arctanh(x*c^(1/2)*(b*x+c*x^2)^-1//2)+-7//40*b*x*c^-2*(b*x+c*x^2)^3//2+-7//128*b^3*c^-4*(b*x+c*x^2)^(1/2)*(b+2*c*x))
	@test integrate(x^2*(b*x+c*x^2)^(1/2), x) == :(-5//24*b*c^-2*(b*x+c*x^2)^3//2+-5//64*b^4*c^-7//2*arctanh(x*c^(1/2)*(b*x+c*x^2)^-1//2)+1//4*x*c^-1*(b*x+c*x^2)^3//2+5//64*b^2*c^-3*(b*x+c*x^2)^(1/2)*(b+2*c*x))
	@test integrate(x*(b*x+c*x^2)^(1/2), x) == :(1//3*c^-1*(b*x+c*x^2)^3//2+1//8*b^3*c^-5//2*arctanh(x*c^(1/2)*(b*x+c*x^2)^-1//2)+-1//8*b*c^-2*(b*x+c*x^2)^(1/2)*(b+2*c*x))
	@test integrate((b*x+c*x^2)^(1/2), x) == :(-1//4*b^2*c^-3//2*arctanh(x*c^(1/2)*(b*x+c*x^2)^-1//2)+1//4*c^-1*(b*x+c*x^2)^(1/2)*(b+2*c*x))
	@test integrate(x^-1*(b*x+c*x^2)^(1/2), x) == :((b*x+c*x^2)^(1/2)+b*c^-1//2*arctanh(x*c^(1/2)*(b*x+c*x^2)^-1//2))
	@test integrate(x^-2*(b*x+c*x^2)^(1/2), x) == :(-2*x^-1*(b*x+c*x^2)^(1/2)+2*c^(1/2)*arctanh(x*c^(1/2)*(b*x+c*x^2)^-1//2))
	@test integrate(x^-3*(b*x+c*x^2)^(1/2), x) == :(-2//3*b^-1*x^-3*(b*x+c*x^2)^3//2)
	@test integrate(x^-4*(b*x+c*x^2)^(1/2), x) == :(-2//5*b^-1*x^-4*(b*x+c*x^2)^3//2+4//15*c*b^-2*x^-3*(b*x+c*x^2)^3//2)
	@test integrate(x^-5*(b*x+c*x^2)^(1/2), x) == :(-2//7*b^-1*x^-5*(b*x+c*x^2)^3//2+-16//105*b^-3*c^2*x^-3*(b*x+c*x^2)^3//2+8//35*c*b^-2*x^-4*(b*x+c*x^2)^3//2)
	@test integrate(x^-6*(b*x+c*x^2)^(1/2), x) == :(-2//9*b^-1*x^-6*(b*x+c*x^2)^3//2+-16//105*b^-3*c^2*x^-4*(b*x+c*x^2)^3//2+4//21*c*b^-2*x^-5*(b*x+c*x^2)^3//2+32//315*b^-4*c^3*x^-3*(b*x+c*x^2)^3//2)
end

@testset "1.2.1.3 (d+e x)^m (f+g x) (a+b x+c x^2)^p.jl" begin
	@test integrate(x^m*(A+B*x)*(b*x+c*x^2), x) == :(x^(3+m)*(3+m)^-1*(A*c+B*b)+A*b*x^(2+m)*(2+m)^-1+B*c*x^(4+m)*(4+m)^-1)
	@test integrate(x^3*(A+B*x)*(b*x+c*x^2), x) == :(1//6*x^6*(A*c+B*b)+1//5*A*b*x^5+1//7*B*c*x^7)
	@test integrate(x^2*(A+B*x)*(b*x+c*x^2), x) == :(1//5*x^5*(A*c+B*b)+1//4*A*b*x^4+1//6*B*c*x^6)
	@test integrate(x*(A+B*x)*(b*x+c*x^2), x) == :(1//4*x^4*(A*c+B*b)+1//3*A*b*x^3+1//5*B*c*x^5)
	@test integrate((A+B*x)*(b*x+c*x^2), x) == :(1//3*x^3*(A*c+B*b)+(1/2)*A*b*x^2+1//4*B*c*x^4)
	@test integrate(x^-1*(A+B*x)*(b*x+c*x^2), x) == :((1/2)*x^2*(A*c+B*b)+A*b*x+1//3*B*c*x^3)
	@test integrate(x^-2*(A+B*x)*(b*x+c*x^2), x) == :(x*(A*c+B*b)+A*b*log(x)+(1/2)*B*c*x^2)
	@test integrate(x^-3*(A+B*x)*(b*x+c*x^2), x) == :((A*c+B*b)*log(x)+B*c*x+-1*A*b*x^-1)
	@test integrate(x^-4*(A+B*x)*(b*x+c*x^2), x) == :(-1*x^-1*(A*c+B*b)+B*c*log(x)+-1//2*A*b*x^-2)
	@test integrate(x^-5*(A+B*x)*(b*x+c*x^2), x) == :(-1//2*x^-2*(A*c+B*b)+-1*B*c*x^-1+-1//3*A*b*x^-3)
end

@testset "1.2.1.4 (d+e x)^m (f+g x)^n (a+b x+c x^2)^p.jl" begin
	@test integrate(x^2*(d^2+-1*e^2*x^2)^(1/2)*(d+e*x), x) == :(1//5*e^-3*(d^2+-1*e^2*x^2)^5//2+-1//3*d^2*e^-3*(d^2+-1*e^2*x^2)^3//2+1//8*d^5*e^-3*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//4*d*x*e^-2*(d^2+-1*e^2*x^2)^3//2+1//8*x*d^3*e^-2*(d^2+-1*e^2*x^2)^(1/2))
	@test integrate(x^4*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(-1//9*e^-1*x^4*(d^2+-1*e^2*x^2)^5//2+3//128*d^9*e^-5*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-4//63*d^2*e^-3*x^2*(d^2+-1*e^2*x^2)^5//2+-1//8*d*e^-2*x^3*(d^2+-1*e^2*x^2)^5//2+-1//5040*d^3*e^-5*(d^2+-1*e^2*x^2)^5//2*(128d+315*e*x)+1//64*x*d^5*e^-4*(d^2+-1*e^2*x^2)^3//2+3//128*x*d^7*e^-4*(d^2+-1*e^2*x^2)^(1/2))
	@test integrate(x^3*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(-1//8*e^-1*x^3*(d^2+-1*e^2*x^2)^5//2+3//128*d^8*e^-4*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//7*d*e^-2*x^2*(d^2+-1*e^2*x^2)^5//2+-1//560*d^2*e^-4*(d^2+-1*e^2*x^2)^5//2*(32d+35*e*x)+1//64*x*d^4*e^-3*(d^2+-1*e^2*x^2)^3//2+3//128*x*d^6*e^-3*(d^2+-1*e^2*x^2)^(1/2))
	@test integrate(x^2*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(1//7*e^-3*(d^2+-1*e^2*x^2)^7//2+-1//5*d^2*e^-3*(d^2+-1*e^2*x^2)^5//2+1//16*d^7*e^-3*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//6*d*x*e^-2*(d^2+-1*e^2*x^2)^5//2+1//16*x*d^5*e^-2*(d^2+-1*e^2*x^2)^(1/2)+1//24*x*d^3*e^-2*(d^2+-1*e^2*x^2)^3//2)
	@test integrate(x*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(-1//30*e^-2*(d^2+-1*e^2*x^2)^5//2*(6d+5*e*x)+1//16*d^6*e^-2*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+1//16*x*d^4*e^-1*(d^2+-1*e^2*x^2)^(1/2)+1//24*x*d^2*e^-1*(d^2+-1*e^2*x^2)^3//2)
	@test integrate(x*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(-1//30*e^-2*(d^2+-1*e^2*x^2)^5//2*(6d+5*e*x)+1//16*d^6*e^-2*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+1//16*x*d^4*e^-1*(d^2+-1*e^2*x^2)^(1/2)+1//24*x*d^2*e^-1*(d^2+-1*e^2*x^2)^3//2)
	@test integrate(x^-1*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :((d^2+-1*e^2*x^2)^3//2*(1//3*d+1//4*e*x)+-1*d^4*arctanh(d^-1*(d^2+-1*e^2*x^2)^(1/2))+3//8*d^4*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+1//8*d^2*(d^2+-1*e^2*x^2)^(1/2)*(8d+3*e*x))
	@test integrate(x^-2*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(-1*e*d^3*arctanh(d^-1*(d^2+-1*e^2*x^2)^(1/2))+-3//2*e*d^3*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//3*x^-1*(d^2+-1*e^2*x^2)^3//2*(3d+-1*e*x)+(1/2)*d*e*(d^2+-1*e^2*x^2)^(1/2)*(2d+-3*e*x))
	@test integrate(x^-3*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(-3//2*d^2*e^2*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//2*x^-2*(d^2+-1*e^2*x^2)^3//2*(d+-1*e*x)+3//2*d^2*e^2*arctanh(d^-1*(d^2+-1*e^2*x^2)^(1/2))+-3//2*d*e*x^-1*(d^2+-1*e^2*x^2)^(1/2)*(d+e*x))
	@test integrate(x^-4*(d^2+-1*e^2*x^2)^3//2*(d+e*x), x) == :(d*e^3*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//6*x^-3*(d^2+-1*e^2*x^2)^3//2*(2d+3*e*x)+3//2*d*e^3*arctanh(d^-1*(d^2+-1*e^2*x^2)^(1/2))+(1/2)*e^2*x^-1*(d^2+-1*e^2*x^2)^(1/2)*(2d+-3*e*x))
end

@testset "1.2.1.5 (a+b x+c x^2)^p (d+e x+f x^2)^q.jl" begin
	@test integrate((a+b*x+b*f*e^-1*x^2)^2*(d+e*x+f*x^2)^-1//2, x) == :(1//128*e^-2*f^-5//2*((b^2*(3*e^4+48*d^2*f^2+8*d*f*e^2)+128*a^2*e^2*f^2+-32*a*b*e*f*(e^2+4*d*f))*log(e+2*f*x+2*f^(1/2)*(d+x*(e+f*x))^(1/2))+2*b*f^(1/2)*(d+x*(e+f*x))^(1/2)*(e+2*f*x)*(b*(-3*e^2+4*f*(-3d+2*f*x^2)+8*e*f*x)+32*a*e*f)))
	@test integrate((d+e*x+f*x^2)^-1//2*(a+b*x+b*f*e^-1*x^2), x) == :(1//4*b*f^-1*(d+e*x+f*x^2)^(1/2)+1//8*f^-3//2*(-1*b*(e+4*d*f*e^-1)+8*a*f)*arctanh((1/2)*f^-1//2*(d+e*x+f*x^2)^-1//2*(e+2*f*x))+(1/2)*b*x*e^-1*(d+e*x+f*x^2)^(1/2))
	@test integrate((a+b*x+b*f*e^-1*x^2)^-1*(d+e*x+f*x^2)^-1//2, x) == :(-2*e^(1/2)*(b*d+-1*a*e)^-1//2*(b*e+-4*a*f)^-1//2*arctanh(e^-1//2*(b*d+-1*a*e)^(1/2)*(b*e+-4*a*f)^-1//2*(d+e*x+f*x^2)^-1//2*(e+2*f*x)))
	@test integrate((a+b*x+b*f*e^-1*x^2)^-3*(d+e*x+f*x^2)^-1//2, x) == :(1//8*e^(1/2)*((b*d+-1*a*e)^-5//2*(b*e+-4*a*f)^-5//2*(b^2*(3*e^4+48*d^2*f^2+8*d*f*e^2)+128*a^2*e^2*f^2+-32*a*b*e*f*(e^2+4*d*f))*log(b^(1/2)*(b^(1/2)*(e^2+-4*d*f)+e^3//2*(b*e+-4*a*f)^(1/2)+-4*f*(d+x*(e+f*x))^(1/2)*(b*d+-1*a*e)^(1/2)+2*f*x*e^(1/2)*(b*e+-4*a*f)^(1/2)))+(b*d+-1*a*e)^-5//2*(b*e+-4*a*f)^-5//2*(b^2*(3*e^4+48*d^2*f^2+8*d*f*e^2)+128*a^2*e^2*f^2+-32*a*b*e*f*(e^2+4*d*f))*log(b*(e+2*f*x)+-1*b^(1/2)*e^(1/2)*(b*e+-4*a*f)^(1/2))+-1*(b*d+-1*a*e)^-5//2*(b*e+-4*a*f)^-5//2*(b^2*(3*e^4+48*d^2*f^2+8*d*f*e^2)+128*a^2*e^2*f^2+-32*a*b*e*f*(e^2+4*d*f))*log(b^(1/2)*(e^3//2*(b*e+-4*a*f)^(1/2)+-1*b^(1/2)*(e^2+-4*d*f)+4*f*(d+x*(e+f*x))^(1/2)*(b*d+-1*a*e)^(1/2)+2*f*x*e^(1/2)*(b*e+-4*a*f)^(1/2)))+-1*(b*d+-1*a*e)^-5//2*(b*e+-4*a*f)^-5//2*(b^2*(3*e^4+48*d^2*f^2+8*d*f*e^2)+128*a^2*e^2*f^2+-32*a*b*e*f*(e^2+4*d*f))*log(b*(e+2*f*x)+b^(1/2)*e^(1/2)*(b*e+-4*a*f)^(1/2))+2*b*e^(1/2)*(d+x*(e+f*x))^(1/2)*(a*e+b*x*(e+f*x))^-2*(b*d+-1*a*e)^-2*(b*e+-4*a*f)^-2*(e+2*f*x)*(b^2*(-2*d*(e^2+-6*f^2*x^2+-6*e*f*x)+3*x*e^2*(e+f*x))+-32*f*a^2*e^2+a*b*e*(5*e^2+4*f*(5d+-6*f*x^2)+-24*e*f*x))))
	@test integrate((a+b*x+c*x^2)^-1//2*(d+b*x+c*x^2)^-1, x) == :(-2*(a+-1d)^-1//2*(b^2+-4*c*d)^-1//2*arctanh((a+-1d)^(1/2)*(b^2+-4*c*d)^-1//2*(a+b*x+c*x^2)^-1//2*(b+2*c*x)))
	@test integrate((a+b*x+c*x^2)^-1//2*(d+b*x+c*x^2)^-2, x) == :((a+-1d)^-3//2*(b^2+-4*c*d)^-3//2*(b^2+4*c*(a+-2d))*arctanh((a+-1d)^(1/2)*(b^2+-4*c*d)^-1//2*(a+b*x+c*x^2)^-1//2*(b+2*c*x))+-1*(a+-1d)^-1*(b^2+-4*c*d)^-1*(a+b*x+c*x^2)^(1/2)*(d+b*x+c*x^2)^-1*(b+2*c*x))
	@test integrate((a+b*x+c*x^2)^-1//2*(d+b*x+c*x^2)^-3, x) == :(-1//4*(a+-1d)^-5//2*(b^2+-4*c*d)^-5//2*(3*b^4+16*c^2*(3*a^2+8*d^2+-8*a*d)+8*c*b^2*(a+-4d))*arctanh((a+-1d)^(1/2)*(b^2+-4*c*d)^-1//2*(a+b*x+c*x^2)^-1//2*(b+2*c*x))+-1*(b^2+-4*c*d)^-1*(-2d+2a)^-1*(a+b*x+c*x^2)^(1/2)*(d+b*x+c*x^2)^-2*(b+2*c*x)+1//4*(a+-1d)^-2*(b^2+-4*c*d)^-2*(a+b*x+c*x^2)^(1/2)*(d+b*x+c*x^2)^-1*(b+2*c*x)*(3*b^2+12*c*(a+-2d)))
	@test integrate((a+b*x+c*x^2)^-1//2*(d+b*x+c*x^2)^-4, x) == :(-1*(b^2+-4*c*d)^-1*(-3d+3a)^-1*(a+b*x+c*x^2)^(1/2)*(d+b*x+c*x^2)^-3*(b+2*c*x)+1//8*(a+-1d)^-7//2*(b^2+-4*c*d)^-7//2*(b^2+4*c*(a+-2d))*(5*b^4+16*c^2*(5*a^2+8*d^2+-8*a*d)+-8*c*b^2*(a+4d))*arctanh((a+-1d)^(1/2)*(b^2+-4*c*d)^-1//2*(a+b*x+c*x^2)^-1//2*(b+2*c*x))+-1//24*(a+-1d)^-3*(b^2+-4*c*d)^-3*(a+b*x+c*x^2)^(1/2)*(d+b*x+c*x^2)^-1*(b+2*c*x)*(15*b^4+16*c^2*(15*a^2+44*d^2+-44*a*d)+8*c*b^2*(-22d+7a))+1//12*(a+-1d)^-2*(b^2+-4*c*d)^-2*(a+b*x+c*x^2)^(1/2)*(d+b*x+c*x^2)^-2*(b+2*c*x)*(5*b^2+20*c*(a+-2d)))
	@test integrate((d+e*x+f*x^2)^-1//2*(a*e+b*e*x+b*f*x^2)^-2, x) == :(-1*e^-3//2*(b*d+-1*a*e)^-3//2*(b*e+-4*a*f)^-3//2*(-1*b*(e^2+4*d*f)+8*a*e*f)*arctanh(e^-1//2*(b*d+-1*a*e)^(1/2)*(b*e+-4*a*f)^-1//2*(d+e*x+f*x^2)^-1//2*(e+2*f*x))+-1*b*e^-1*(b*d+-1*a*e)^-1*(b*e+-4*a*f)^-1*(d+e*x+f*x^2)^(1/2)*(a*e+b*e*x+b*f*x^2)^-1*(e+2*f*x))
	@test integrate((4+x^2+2x)^-1*(5+x^2+2x)^-1//2, x) == :(1//3*3^(1/2)*arctan(1//3*3^(1/2)*(5+x^2+2x)^-1//2*(1+x)))
end

@testset "1.2.1.6 (g+h x)^m (a+b x+c x^2)^p (d+e x+f x^2)^q.jl" begin
	@test integrate((d+f*x^2)^-1*(A+B*x)*(a+b*x+c*x^2), x) == :(x*f^-1*(A*c+B*b)+-1//2*f^-2*(B*c*d+-1*A*b*f+-1*B*a*f)*log(d+f*x^2)+(1/2)*B*c*f^-1*x^2+-1*d^-1//2*f^-3//2*(A*c*d+B*b*d+-1*A*a*f)*arctan(x*d^-1//2*f^(1/2)))
	@test integrate((d+f*x^2)^-1*(a+b*x+c*x^2)^2*(A+B*x), x) == :(x*f^-2*(A*f*b^2+-1*A*c*(c*d+-2*a*f)+-1*B*b*(-2*a*f+2*c*d))+(1/2)*f^-2*x^2*(-1*B*(d*c^2+-1*f*b^2+-2*a*c*f)+2*A*b*c*f)+-1//2*f^-3*(-1*B*(c^2*d^2+-1*f*(d*b^2+-1*f*a^2)+-2*a*c*d*f)+2*A*b*f*(c*d+-1*a*f))*log(d+f*x^2)+-1*d^-1//2*f^-5//2*(-1*A*(c*d+-1*a*f)^2+A*d*f*b^2+-2*B*b*d*(c*d+-1*a*f))*arctan(x*d^-1//2*f^(1/2))+1//3*c*f^-1*x^3*(A*c+2*B*b)+1//4*B*c^2*f^-1*x^4)
	@test integrate((d+f*x^2)^-1*(a+b*x+c*x^2)^3*(A+B*x), x) == :((1/2)*f^-4*(-1*B*(c*d+-1*a*f)*(c^2*d^2+-1*f*(-1*f*a^2+3*d*b^2)+-2*a*c*d*f)+A*b*f*(-1*f*(d*b^2+-3*f*a^2)+3*c^2*d^2+-6*a*c*d*f))*log(d+f*x^2)+-1*x*f^-3*(-1*A*c*(c^2*d^2+3*a^2*f^2+-3*a*c*d*f)+-3*B*b*(c*d+-1*a*f)^2+B*d*f*b^3+3*A*f*b^2*(c*d+-1*a*f))+-1//2*f^-3*x^2*(-1*B*(c^3*d^2+-3*c*f*(d*b^2+-1*f*a^2)+3*a*b^2*f^2+-3*a*d*f*c^2)+A*b*f*(-1*f*b^2+3*d*c^2+-6*a*c*f))+1//3*f^-2*x^3*(B*f*b^3+-1*A*c^2*(c*d+-3*a*f)+-3*B*b*c*(c*d+-2*a*f)+3*A*c*f*b^2)+d^-1//2*f^-7//2*(-1*A*(c*d+-1*a*f)^3+B*f*b^3*d^2+-3*B*b*d*(c*d+-1*a*f)^2+3*A*d*f*b^2*(c*d+-1*a*f))*arctan(x*d^-1//2*f^(1/2))+1//4*c*f^-2*x^4*(-1*B*(d*c^2+-3*f*b^2+-3*a*c*f)+3*A*b*c*f)+1//5*c^2*f^-1*x^5*(A*c+3*B*b)+1//6*B*c^3*f^-1*x^6)
	@test integrate((d+f*x^2)^-1*(a+b*x+c*x^2)^-1*(A+B*x), x) == :((2*f*(d*b^2+f*a^2)+2*c^2*d^2+-4*a*c*d*f)^-1*(A*b*f+B*c*d+-1*B*a*f)*log(a+b*x+c*x^2)+-1*(2*f*(d*b^2+f*a^2)+2*c^2*d^2+-4*a*c*d*f)^-1*(A*b*f+B*c*d+-1*B*a*f)*log(d+f*x^2)+-1*(b^2+-4*a*c)^-1//2*(f*(d*b^2+f*a^2)+c^2*d^2+-2*a*c*d*f)^-1*(A*f*b^2+-1*B*b*(a*f+c*d)+2*A*c*(c*d+-1*a*f))*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*x))+d^-1//2*f^(1/2)*(f*(d*b^2+f*a^2)+c^2*d^2+-2*a*c*d*f)^-1*(A*a*f+B*b*d+-1*A*c*d)*arctan(x*d^-1//2*f^(1/2)))
	@test integrate((d+f*x^2)^-1*(a+b*x+c*x^2)^-2*(A+B*x), x) == :((b^2+-4*a*c)^-1*((c*d+-1*a*f)^2+d*f*b^2)^-1*(a+b*x+c*x^2)^-1*(-1*(A*b+-1*B*a)*(f*b^2+2*d*c^2+-2*a*c*f)+-1*c*x*(A*f*b^2+-1*B*b*(a*f+c*d)+2*A*c*(c*d+-1*a*f))+A*b*c*(a*f+c*d))+(1/2)*f*(f*(d*b^2+f*a^2)+c^2*d^2+-2*a*c*d*f)^-2*(B*(c^2*d^2+-1*f*(d*b^2+-1*f*a^2)+-2*a*c*d*f)+2*A*b*f*(c*d+-1*a*f))*log(d+f*x^2)+-1*(b^2+-4*a*c)^-3//2*(f*(d*b^2+f*a^2)+c^2*d^2+-2*a*c*d*f)^-2*(B*d*b^5*f^2+B*f*b^3*(-1*a^2*f^2+5*c^2*d^2+-4*a*c*d*f)+-4*A*c^2*(c*d+-1*a*f)^2*(c*d+-3*a*f)+-2*A*b^4*f^2*(c*d+-1*a*f)+2*B*b*c*(c^3*d^3+3*a^3*f^3+-7*a*f*c^2*d^2+3*c*d*a^2*f^2)+-4*A*c*f*b^2*(2*c^2*d^2+3*a^2*f^2+-3*a*c*d*f))*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*x))+-1//2*f*(f*(d*b^2+f*a^2)+c^2*d^2+-2*a*c*d*f)^-2*(B*(c^2*d^2+-1*f*(d*b^2+-1*f*a^2)+-2*a*c*d*f)+2*A*b*f*(c*d+-1*a*f))*log(a+b*x+c*x^2)+-1*d^-1//2*f^3//2*(f*(d*b^2+f*a^2)+c^2*d^2+-2*a*c*d*f)^-2*(-1*A*(c*d+-1*a*f)^2+A*d*f*b^2+2*B*b*d*(c*d+-1*a*f))*arctan(x*d^-1//2*f^(1/2)))
	@test integrate((d+-1*f*x^2)^-1*(a+b*x+c*x^2)^(1/2)*(A+B*x), x) == :(-1*B*f^-1*(a+b*x+c*x^2)^(1/2)+-1//2*c^-1//2*f^-1*(B*b+2*A*c)*arctanh((1/2)*c^-1//2*(a+b*x+c*x^2)^-1//2*(b+2*c*x))+(1/2)*d^-1//2*f^-3//2*(a*f+c*d+b*d^(1/2)*f^(1/2))^(1/2)*(A*f^(1/2)+B*d^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(b*f^(1/2)+2*c*d^(1/2))+2*a*f^(1/2)))+-1//2*d^-1//2*f^-3//2*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^(1/2)*(B*d^(1/2)+-1*A*f^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(-1*b*f^(1/2)+2*c*d^(1/2))+-2*a*f^(1/2))))
	@test integrate((d+-1*f*x^2)^-1*(a+b*x+c*x^2)^-1//2*(A+B*x), x) == :((1/2)*f^-1//2*(a*f+c*d+b*d^(1/2)*f^(1/2))^-1//2*(B+A*d^-1//2*f^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(b*f^(1/2)+2*c*d^(1/2))+2*a*f^(1/2)))+-1//2*f^-1//2*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^-1//2*(B+-1*A*d^-1//2*f^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(-1*b*f^(1/2)+2*c*d^(1/2))+-2*a*f^(1/2))))
	@test integrate((d+-1*f*x^2)^-1*(a+b*x+c*x^2)^-3//2*(A+B*x), x) == :(-1*(b^2+-4*a*c)^-1*(-1*(a*f+c*d)^2+d*f*b^2)^-1*(a+b*x+c*x^2)^-1//2*(2*A*(f*b^3+-1*b*c*(c*d+3*a*f))+2*B*a*(-1*f*b^2+2*d*c^2+2*a*c*f)+2*c*x*(A*f*b^2+B*b*(c*d+-1*a*f)+-2*A*c*(a*f+c*d)))+(1/2)*d^-1//2*f^(1/2)*(a*f+c*d+b*d^(1/2)*f^(1/2))^-3//2*(A*f^(1/2)+B*d^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(b*f^(1/2)+2*c*d^(1/2))+2*a*f^(1/2)))+-1//2*d^-1//2*f^(1/2)*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^-3//2*(B*d^(1/2)+-1*A*f^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(-1*b*f^(1/2)+2*c*d^(1/2))+-2*a*f^(1/2))))
	@test integrate((d+-1*f*x^2)^-1*(a+b*x+c*x^2)^-5//2*(A+B*x), x) == :(-1*(-1*(a*f+c*d)^2+d*f*b^2)^-1*(3*b^2+-12*a*c)^-1*(a+b*x+c*x^2)^-3//2*(2*A*(f*b^3+-1*b*c*(c*d+3*a*f))+2*B*a*(-1*f*b^2+2*d*c^2+2*a*c*f)+2*c*x*(A*f*b^2+B*b*(c*d+-1*a*f)+-2*A*c*(a*f+c*d)))+-1//3*(b^2+-4*a*c)^-2*(a+b*x+c*x^2)^-1//2*(c^2*d^2+-1*f*(d*b^2+-1*f*a^2)+2*a*c*d*f)^-2*(2*c*x*(-1*B*f*b^3*(-3*a^2*f^2+17*c^2*d^2+10*a*c*d*f)+-8*A*c^2*(a*f+c*d)^2*(2*c*d+5*a*f)+-2*A*b^4*f^2*(3*a*f+4*c*d)+3*B*d*b^5*f^2+4*B*b*c*(-5*a^3*f^3+2*c^3*d^3+4*c*d*a^2*f^2+11*a*f*c^2*d^2)+2*A*c*f*b^2*(15*c^2*d^2+19*a^2*f^2+22*a*c*d*f))+-8*A*b*c^2*(2*c^3*d^3+17*a^3*f^3+9*a*f*c^2*d^2+24*c*d*a^2*f^2)+-2*A*b^5*f^2*(6*a*f+7*c*d)+-2*B*f*b^4*(-3*a^2*f^2+7*c^2*d^2+14*a*c*d*f)+4*B*c*b^2*(-11*a^3*f^3+2*c^3*d^3+4*c*d*a^2*f^2+5*a*f*c^2*d^2)+6*B*d*b^6*f^2+2*A*c*f*b^3*(15*c^2*d^2+43*a^2*f^2+46*a*c*d*f)+48*B*f*a^2*c^2*(a*f+c*d)^2)+(1/2)*d^-1//2*f^3//2*(a*f+c*d+b*d^(1/2)*f^(1/2))^-5//2*(A*f^(1/2)+B*d^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(b*f^(1/2)+2*c*d^(1/2))+2*a*f^(1/2)))+-1//2*d^-1//2*f^3//2*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^-5//2*(B*d^(1/2)+-1*A*f^(1/2))*arctanh((1/2)*(a+b*x+c*x^2)^-1//2*(a*f+c*d+-1*b*d^(1/2)*f^(1/2))^-1//2*(b*d^(1/2)+x*(-1*b*f^(1/2)+2*c*d^(1/2))+-2*a*f^(1/2))))
	@test integrate((-1+x^2)^-1*(-1+x+x^2)^-1//2*(1+2x), x) == :(-1//2*arctan((1/2)*(-1+x+x^2)^-1//2*(3+x))+3//2*arctanh((1/2)*(-1+x+x^2)^-1//2*(1+-3x)))
end

@testset "1.2.1.9 P(x) (d+e x)^m (a+b x+c x^2)^p.jl" begin
	@test integrate((d+e*x)^2*(d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :(-1//6*C*x^3*(d^2+-1*e^2*x^2)^3//2+-1//5*e^-1*x^2*(d^2+-1*e^2*x^2)^3//2*(B*e+2*C*d)+-1//8*x*e^-2*(d^2+-1*e^2*x^2)^3//2*(2*e*(A*e+2*B*d)+3*C*d^2)+-1//15*d*e^-3*(d^2+-1*e^2*x^2)^3//2*(e*(7*B*d+10*A*e)+4*C*d^2)+1//16*d^4*e^-3*(3*C*d^2+10*A*e^2+4*B*d*e)*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+1//16*x*d^2*e^-2*(d^2+-1*e^2*x^2)^(1/2)*(3*C*d^2+10*A*e^2+4*B*d*e))
	@test integrate((d^2+-1*e^2*x^2)^(1/2)*(d+e*x)*(A+B*x+C*x^2), x) == :(-1//15*e^-3*(d^2+-1*e^2*x^2)^3//2*(2*C*d^2+5*e*(A*e+B*d))+-1//4*x*e^-2*(d^2+-1*e^2*x^2)^3//2*(B*e+C*d)+-1//5*C*e^-1*x^2*(d^2+-1*e^2*x^2)^3//2+1//8*d^3*e^-3*(C*d^2+e*(B*d+4*A*e))*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+1//8*d*x*e^-2*(d^2+-1*e^2*x^2)^(1/2)*(C*d^2+e*(B*d+4*A*e)))
	@test integrate((d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :(x*(d^2+-1*e^2*x^2)^(1/2)*((1/2)*A+1//8*C*d^2*e^-2)+-1//3*B*e^-2*(d^2+-1*e^2*x^2)^3//2+-1//4*C*x*e^-2*(d^2+-1*e^2*x^2)^3//2+1//8*d^2*e^-3*(C*d^2+4*A*e^2)*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2))
	@test integrate((d+e*x)^-1*(d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :((1/2)*e^-3*(d^2+-1*e^2*x^2)^(1/2)*(C*d^2+-1*e*(B*d+-2*A*e))+-1//3*C*e^-3*(d^2+-1*e^2*x^2)^3//2+(1/2)*d*e^-3*(C*d^2+-1*e*(B*d+-2*A*e))*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+(1/2)*e^-3*(d+e*x)^-1*(d^2+-1*e^2*x^2)^3//2*(C*d+-1*B*e))
	@test integrate((d+e*x)^-2*(d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :(-1//2*e^-3*(-2*e*(-1*A*e+2*B*d)+5*C*d^2)*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//2*C*e^-3*(d+e*x)^-1*(d^2+-1*e^2*x^2)^3//2+-1//2*d^-1*e^-3*(d^2+-1*e^2*x^2)^(1/2)*(-2*e*(-1*A*e+2*B*d)+5*C*d^2)+-1*d^-1*e^-3*(d+e*x)^-2*(d^2+-1*e^2*x^2)^3//2*(A*e^2+C*d^2+-1*B*d*e))
	@test integrate((d+e*x)^-3*(d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :(e^-3*(-1*B*e+3*C*d)*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+e^-3*(d+e*x)^-1*(d^2+-1*e^2*x^2)^(1/2)*(-2*B*e+6*C*d)+-1*C*e^-3*(d+e*x)^-2*(d^2+-1*e^2*x^2)^3//2+-1//3*d^-1*e^-3*(d+e*x)^-3*(d^2+-1*e^2*x^2)^3//2*(A*e^2+C*d^2+-1*B*d*e))
	@test integrate((d+e*x)^-4*(d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :(-1*C*e^-3*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-2*C*e^-3*(d+e*x)^-1*(d^2+-1*e^2*x^2)^(1/2)+-1//5*d^-1*e^-3*(d+e*x)^-4*(d^2+-1*e^2*x^2)^3//2*(A*e^2+C*d^2+-1*B*d*e)+-1//15*d^-2*e^-3*(d+e*x)^-3*(d^2+-1*e^2*x^2)^3//2*(A*e^2+C*d^2+-1*B*d*e)+1//3*d^-1*e^-3*(d+e*x)^-3*(d^2+-1*e^2*x^2)^3//2*(-1*B*e+2*C*d))
	@test integrate((d+e*x)^-5*(d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :(C*e^-3*(d+e*x)^-4*(d^2+-1*e^2*x^2)^3//2+-1//7*d^-1*e^-3*(d+e*x)^-5*(d^2+-1*e^2*x^2)^3//2*(A*e^2+C*d^2+-1*B*d*e)+-1//35*d^-2*e^-3*(d+e*x)^-4*(d^2+-1*e^2*x^2)^3//2*(e*(2*A*e+5*B*d)+23*C*d^2)+-1//105*d^-3*e^-3*(d+e*x)^-3*(d^2+-1*e^2*x^2)^3//2*(e*(2*A*e+5*B*d)+23*C*d^2))
	@test integrate((d+e*x)^-6*(d^2+-1*e^2*x^2)^(1/2)*(A+B*x+C*x^2), x) == :((1/2)*C*e^-3*(d+e*x)^-5*(d^2+-1*e^2*x^2)^3//2+-1//9*d^-1*e^-3*(d+e*x)^-6*(d^2+-1*e^2*x^2)^3//2*(A*e^2+C*d^2+-1*B*d*e)+-1//42*d^-2*e^-3*(d+e*x)^-5*(d^2+-1*e^2*x^2)^3//2*(2*e*(A*e+2*B*d)+11*C*d^2)+-1//105*d^-3*e^-3*(d+e*x)^-4*(d^2+-1*e^2*x^2)^3//2*(2*e*(A*e+2*B*d)+11*C*d^2)+-1//315*d^-4*e^-3*(d+e*x)^-3*(d^2+-1*e^2*x^2)^3//2*(2*e*(A*e+2*B*d)+11*C*d^2))
	@test integrate((d+e*x)^3*(d^2+-1*e^2*x^2)^-1//2*(A+B*x+C*x^2), x) == :(-1*x^3*(d^2+-1*e^2*x^2)^(1/2)*(1//4*B*e+3//4*C*d)+-1//5*C*e*x^4*(d^2+-1*e^2*x^2)^(1/2)+-1//15*d^2*e^-3*(d^2+-1*e^2*x^2)^(1/2)*(38*C*d^2+55*A*e^2+45*B*d*e)+-1//15*e^-1*x^2*(d^2+-1*e^2*x^2)^(1/2)*(5*e*(A*e+3*B*d)+19*C*d^2)+1//8*d^3*e^-3*(13*C*d^2+20*A*e^2+15*B*d*e)*arctan(e*x*(d^2+-1*e^2*x^2)^-1//2)+-1//8*d*x*e^-2*(d^2+-1*e^2*x^2)^(1/2)*(12*A*e^2+13*C*d^2+15*B*d*e))
end

@testset "1.2.2.2 (d x)^m (a+b x^2+c x^4)^p.jl" begin
	@test integrate((a^2+b^2*x^4+2*a*b*x^2)^3//4, x) == :(1//4*x*(a^2+b^2*x^4+2*a*b*x^2)^3//4+3*a*x*(8a+8*b*x^2)^-1*(a^2+b^2*x^4+2*a*b*x^2)^3//4+3//8*a^(1/2)*b^-1//2*(1+b*a^-1*x^2)^-3//2*(a^2+b^2*x^4+2*a*b*x^2)^3//4*arcsinh(x*a^-1//2*b^(1/2)))
	@test integrate((a^2+b^2*x^4+2*a*b*x^2)^1//4, x) == :((1/2)*x*(a^2+b^2*x^4+2*a*b*x^2)^1//4+(1/2)*a^(1/2)*b^-1//2*(1+b*a^-1*x^2)^-1//2*(a^2+b^2*x^4+2*a*b*x^2)^1//4*arcsinh(x*a^-1//2*b^(1/2)))
	@test integrate((a^2+b^2*x^4+2*a*b*x^2)^-1//4, x) == :(a^(1/2)*b^-1//2*(1+b*a^-1*x^2)^(1/2)*(a^2+b^2*x^4+2*a*b*x^2)^-1//4*arcsinh(x*a^-1//2*b^(1/2)))
	@test integrate((a^2+b^2*x^4+2*a*b*x^2)^-3//4, x) == :(x*a^-1*(a^2+b^2*x^4+2*a*b*x^2)^-3//4*(a+b*x^2))
	@test integrate((b+a^2+x^4+2*a*x^2)^-1, x) == :(-1//4*2^(1/2)*(a+(b+a^2)^(1/2))^-1//2*(b+a^2)^-1//2*arctan((a+(b+a^2)^(1/2))^-1//2*(((b+a^2)^(1/2)+-1a)^(1/2)+-1*x*2^(1/2)))+-1//8*2^(1/2)*(b+a^2)^-1//2*((b+a^2)^(1/2)+-1a)^-1//2*log(x^2+(b+a^2)^(1/2)+-1*x*2^(1/2)*((b+a^2)^(1/2)+-1a)^(1/2))+1//4*2^(1/2)*(a+(b+a^2)^(1/2))^-1//2*(b+a^2)^-1//2*arctan((a+(b+a^2)^(1/2))^-1//2*(((b+a^2)^(1/2)+-1a)^(1/2)+x*2^(1/2)))+1//8*2^(1/2)*(b+a^2)^-1//2*((b+a^2)^(1/2)+-1a)^-1//2*log(x^2+(b+a^2)^(1/2)+x*2^(1/2)*((b+a^2)^(1/2)+-1a)^(1/2)))
	@test integrate((-1+a^2+x^4+2*a*x^2)^-1, x) == :(-1//2*(1+a)^-1//2*arctan(x*(1+a)^-1//2)+-1//2*(1+-1a)^-1//2*arctanh(x*(1+-1a)^-1//2))
	@test integrate((1+a^2+x^4+2*a*x^2)^-1, x) == :(-1//4*2^(1/2)*(1+a^2)^-1//2*(a+(1+a^2)^(1/2))^-1//2*arctan((a+(1+a^2)^(1/2))^-1//2*(((1+a^2)^(1/2)+-1a)^(1/2)+-1*x*2^(1/2)))+-1//8*2^(1/2)*(1+a^2)^-1//2*((1+a^2)^(1/2)+-1a)^-1//2*log(x^2+(1+a^2)^(1/2)+-1*x*2^(1/2)*((1+a^2)^(1/2)+-1a)^(1/2))+1//4*2^(1/2)*(1+a^2)^-1//2*(a+(1+a^2)^(1/2))^-1//2*arctan((a+(1+a^2)^(1/2))^-1//2*(((1+a^2)^(1/2)+-1a)^(1/2)+x*2^(1/2)))+1//8*2^(1/2)*(1+a^2)^-1//2*((1+a^2)^(1/2)+-1a)^-1//2*log(x^2+(1+a^2)^(1/2)+x*2^(1/2)*((1+a^2)^(1/2)+-1a)^(1/2)))
	@test integrate((4+x^4+-5*x^2)^-1, x) == :(-1//6*arctanh((1/2)*x)+1//3*arctanh(x))
	@test integrate((3+x^4+4*x^2)^-1, x) == :((1/2)*arctan(x)+-1//6*3^(1/2)*arctan(1//3*x*3^(1/2)))
	@test integrate((9+x^4+5*x^2)^-1, x) == :(-1//12*log(3+x^2+-1x)+1//12*log(3+x+x^2)+-1//66*11^(1/2)*arctan(1//11*11^(1/2)*(1+-2x))+1//66*11^(1/2)*arctan(1//11*11^(1/2)*(1+2x)))
end

@testset "1.2.2.3 (d+e x^2)^m (a+b x^2+c x^4)^p.jl" begin
	@test integrate((a+b*x^4)^-1*(c+d*x^2), x) == :(-1//4*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+d*a^(1/2))*arctan(1+-1*x*2^(1/2)*a^-1//4*b^1//4)+-1//8*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+-1*d*a^(1/2))*log(a^(1/2)+b^(1/2)*x^2+-1*x*2^(1/2)*a^1//4*b^1//4)+1//4*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+d*a^(1/2))*arctan(1+x*2^(1/2)*a^-1//4*b^1//4)+1//8*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+-1*d*a^(1/2))*log(a^(1/2)+b^(1/2)*x^2+x*2^(1/2)*a^1//4*b^1//4))
	@test integrate((a+b*x^4)^-1*(c+-1*d*x^2), x) == :(-1//4*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+-1*d*a^(1/2))*arctan(1+-1*x*2^(1/2)*a^-1//4*b^1//4)+-1//8*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+d*a^(1/2))*log(a^(1/2)+b^(1/2)*x^2+-1*x*2^(1/2)*a^1//4*b^1//4)+1//4*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+-1*d*a^(1/2))*arctan(1+x*2^(1/2)*a^-1//4*b^1//4)+1//8*2^(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+d*a^(1/2))*log(a^(1/2)+b^(1/2)*x^2+x*2^(1/2)*a^1//4*b^1//4))
	@test integrate((a+-1*b*x^4)^-1*(c+d*x^2), x) == :((1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+d*a^(1/2))*arctanh(x*a^-1//4*b^1//4)+(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+-1*d*a^(1/2))*arctan(x*a^-1//4*b^1//4))
	@test integrate((a+-1*b*x^4)^-1*(c+-1*d*x^2), x) == :((1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+d*a^(1/2))*arctan(x*a^-1//4*b^1//4)+(1/2)*a^-3//4*b^-3//4*(c*b^(1/2)+-1*d*a^(1/2))*arctanh(x*a^-1//4*b^1//4))
	@test integrate((4+9*x^4)^-1*(2+3*x^2), x) == :(-1//6*3^(1/2)*arctan(1+-1*x*3^(1/2))+1//6*3^(1/2)*arctan(1+x*3^(1/2)))
	@test integrate((4+9*x^4)^-1*(2+-3*x^2), x) == :(-1//12*3^(1/2)*log(2+3*x^2+-2*x*3^(1/2))+1//12*3^(1/2)*log(2+3*x^2+2*x*3^(1/2)))
	@test integrate((4+-9*x^4)^-1*(2+3*x^2), x) == :(1//6*6^(1/2)*arctanh((1/2)*x*6^(1/2)))
	@test integrate((4+-9*x^4)^-1*(2+-3*x^2), x) == :(1//6*6^(1/2)*arctan((1/2)*x*6^(1/2)))
	@test integrate((a+b*x^4)^-1*(b*x^2+a^(1/2)*b^(1/2)), x) == :((1/2)*2^(1/2)*a^-1//4*b^1//4*arctan(1+x*2^(1/2)*a^-1//4*b^1//4)+-1//2*2^(1/2)*a^-1//4*b^1//4*arctan(1+-1*x*2^(1/2)*a^-1//4*b^1//4))
	@test integrate((a+b*x^4)^-1*(a^(1/2)*b^(1/2)+-1*b*x^2), x) == :(-1//4*2^(1/2)*a^-1//4*b^1//4*log(a^(1/2)+b^(1/2)*x^2+-1*x*2^(1/2)*a^1//4*b^1//4)+1//4*2^(1/2)*a^-1//4*b^1//4*log(a^(1/2)+b^(1/2)*x^2+x*2^(1/2)*a^1//4*b^1//4))
end

@testset "1.2.2.4 (f x)^m (d+e x^2)^q (a+b x^2+c x^4)^p.jl" begin
	@test integrate(x^3*(a+c*x^4)^5*(d+e*x^2), x) == :(1//4*d*a^5*x^4+1//6*e*a^5*x^6+1//24*d*c^5*x^24+1//26*e*c^5*x^26+(1/2)*c*e*a^4*x^10+1//4*a*d*c^4*x^20+5//6*d*a^3*c^2*x^12+5//7*e*a^3*c^2*x^14+5//8*c*d*a^4*x^8+5//8*d*a^2*c^3*x^16+5//9*e*a^2*c^3*x^18+5//22*a*e*c^4*x^22)
	@test integrate(x^2*(a+c*x^4)^5*(d+e*x^2), x) == :(1//3*d*a^5*x^3+1//5*e*a^5*x^5+1//23*d*c^5*x^23+1//25*e*c^5*x^25+2//3*d*a^2*c^3*x^15+5//7*c*d*a^4*x^7+5//9*c*e*a^4*x^9+5//19*a*d*c^4*x^19+5//21*a*e*c^4*x^21+10//11*d*a^3*c^2*x^11+10//13*e*a^3*c^2*x^13+10//17*e*a^2*c^3*x^17)
	@test integrate(x*(a+c*x^4)^5*(d+e*x^2), x) == :((1/2)*d*a^5*x^2+1//22*d*c^5*x^22+1//24*e*c^-1*(a+c*x^4)^6+d*a^3*c^2*x^10+5//6*c*d*a^4*x^6+5//7*d*a^2*c^3*x^14+5//18*a*d*c^4*x^18)
	@test integrate((a+c*x^4)^5*(d+e*x^2), x) == :(d*x*a^5+1//3*e*a^5*x^3+1//21*d*c^5*x^21+1//23*e*c^5*x^23+c*d*a^4*x^5+2//3*e*a^2*c^3*x^15+5//7*c*e*a^4*x^7+5//17*a*d*c^4*x^17+5//19*a*e*c^4*x^19+10//9*d*a^3*c^2*x^9+10//11*e*a^3*c^2*x^11+10//13*d*a^2*c^3*x^13)
	@test integrate(x^-1*(a+c*x^4)^5*(d+e*x^2), x) == :(d*a^5*log(x)+(1/2)*e*a^5*x^2+1//20*d*c^5*x^20+1//22*e*c^5*x^22+e*a^3*c^2*x^10+5//4*c*d*a^4*x^4+5//4*d*a^3*c^2*x^8+5//6*c*e*a^4*x^6+5//6*d*a^2*c^3*x^12+5//7*e*a^2*c^3*x^14+5//16*a*d*c^4*x^16+5//18*a*e*c^4*x^18)
	@test integrate(x^-2*(a+c*x^4)^5*(d+e*x^2), x) == :(e*x*a^5+-1*d*a^5*x^-1+1//19*d*c^5*x^19+1//21*e*c^5*x^21+c*e*a^4*x^5+1//3*a*d*c^4*x^15+5//3*c*d*a^4*x^3+5//17*a*e*c^4*x^17+10//7*d*a^3*c^2*x^7+10//9*e*a^3*c^2*x^9+10//11*d*a^2*c^3*x^11+10//13*e*a^2*c^3*x^13)
	@test integrate(x^-3*(a+c*x^4)^5*(d+e*x^2), x) == :(e*a^5*log(x)+-1//2*d*a^5*x^-2+1//18*d*c^5*x^18+1//20*e*c^5*x^20+d*a^2*c^3*x^10+5//2*c*d*a^4*x^2+5//3*d*a^3*c^2*x^6+5//4*c*e*a^4*x^4+5//4*e*a^3*c^2*x^8+5//6*e*a^2*c^3*x^12+5//14*a*d*c^4*x^14+5//16*a*e*c^4*x^16)
	@test integrate(x^5*(5+x^4)^(1/2)*(2+3*x^2), x) == :(-25//8*arcsinh(1//5*5^(1/2)*x^2)+-5//8*x^2*(5+x^4)^(1/2)+-1//4*(5+x^4)^3//2*(4+-1*x^2)+3//10*x^4*(5+x^4)^3//2)
	@test integrate(x^3*(5+x^4)^(1/2)*(2+3*x^2), x) == :(-75//16*arcsinh(1//5*5^(1/2)*x^2)+-15//16*x^2*(5+x^4)^(1/2)+1//24*(5+x^4)^3//2*(8+9*x^2))
	@test integrate(x*(5+x^4)^(1/2)*(2+3*x^2), x) == :((1/2)*(5+x^4)^3//2+5//2*arcsinh(1//5*5^(1/2)*x^2)+(1/2)*x^2*(5+x^4)^(1/2))
end

@testset "1.2.2.5 P(x) (a+b x^2+c x^4)^p.jl" begin
	@test integrate((d+e*x)*(a+b*x^2+c*x^4), x) == :(a*d*x+(1/2)*a*e*x^2+1//3*b*d*x^3+1//4*b*e*x^4+1//5*c*d*x^5+1//6*c*e*x^6)
	@test integrate((a+b*x^2+c*x^4)*(d+e*x+f*x^2), x) == :(x^3*(1//3*a*f+1//3*b*d)+x^5*(1//5*b*f+1//5*c*d)+a*d*x+(1/2)*a*e*x^2+1//4*b*e*x^4+1//6*c*e*x^6+1//7*c*f*x^7)
	@test integrate((a+b*x^2+c*x^4)*(d+e*x+f*x^2+g*x^3), x) == :(x^3*(1//3*a*f+1//3*b*d)+x^4*(1//4*a*g+1//4*b*e)+x^5*(1//5*b*f+1//5*c*d)+x^6*(1//6*b*g+1//6*c*e)+a*d*x+(1/2)*a*e*x^2+1//7*c*f*x^7+1//8*c*g*x^8)
	@test integrate((a+b*x^2+c*x^4)*(d+e*x+f*x^2+g*x^3+h*x^4), x) == :(x^3*(1//3*a*f+1//3*b*d)+x^4*(1//4*a*g+1//4*b*e)+x^5*(1//5*a*h+1//5*b*f+1//5*c*d)+x^6*(1//6*b*g+1//6*c*e)+x^7*(1//7*b*h+1//7*c*f)+a*d*x+(1/2)*a*e*x^2+1//8*c*g*x^8+1//9*c*h*x^9)
	@test integrate((a+b*x^2+c*x^4)*(d+e*x+f*x^2+g*x^3+h*x^4+i*x^5), x) == :(x^3*(1//3*a*f+1//3*b*d)+x^4*(1//4*a*g+1//4*b*e)+x^5*(1//5*a*h+1//5*b*f+1//5*c*d)+x^6*(1//6*a*i+1//6*b*g+1//6*c*e)+x^7*(1//7*b*h+1//7*c*f)+x^8*(1//8*b*i+1//8*c*g)+a*d*x+(1/2)*a*e*x^2+1//9*c*h*x^9+1//10*c*i*x^10)
	@test integrate((a+b*x^2+c*x^4)^2*(d+e*x), x) == :(d*x*a^2+d*x^5*(1//5*b^2+2//5*a*c)+e*x^6*(1//6*b^2+1//3*a*c)+(1/2)*e*a^2*x^2+1//9*d*c^2*x^9+1//10*e*c^2*x^10+(1/2)*a*b*e*x^4+1//4*b*c*e*x^8+2//3*a*b*d*x^3+2//7*b*c*d*x^7)
	@test integrate((a+b*x^2+c*x^4)^2*(d+e*x+f*x^2), x) == :(x^5*(1//5*d*b^2+2//5*a*b*f+2//5*a*c*d)+x^7*(1//7*f*b^2+2//7*a*c*f+2//7*b*c*d)+d*x*a^2+e*x^6*(1//6*b^2+1//3*a*c)+(1/2)*e*a^2*x^2+1//3*a*x^3*(a*f+2*b*d)+1//9*c*x^9*(c*d+2*b*f)+1//10*e*c^2*x^10+1//11*f*c^2*x^11+(1/2)*a*b*e*x^4+1//4*b*c*e*x^8)
	@test integrate((a+b*x^2+c*x^4)^2*(d+e*x+f*x^2+g*x^3), x) == :(x^5*(1//5*d*b^2+2//5*a*b*f+2//5*a*c*d)+x^6*(1//6*e*b^2+1//3*a*b*g+1//3*a*c*e)+x^7*(1//7*f*b^2+2//7*a*c*f+2//7*b*c*d)+x^8*(1//8*g*b^2+1//4*a*c*g+1//4*b*c*e)+d*x*a^2+(1/2)*e*a^2*x^2+1//3*a*x^3*(a*f+2*b*d)+1//4*a*x^4*(a*g+2*b*e)+1//9*c*x^9*(c*d+2*b*f)+1//10*c*x^10*(c*e+2*b*g)+1//11*f*c^2*x^11+1//12*g*c^2*x^12)
	@test integrate((a+b*x^2+c*x^4)^2*(d+e*x+f*x^2+g*x^3+h*x^4), x) == :(x^5*(1//5*a*(a*h+2*c*d)+1//5*d*b^2+2//5*a*b*f)+x^6*(1//6*e*b^2+1//3*a*b*g+1//3*a*c*e)+x^7*(1//7*f*b^2+2//7*b*(a*h+c*d)+2//7*a*c*f)+x^8*(1//8*g*b^2+1//4*a*c*g+1//4*b*c*e)+x^9*(1//9*d*c^2+1//9*h*b^2+2//9*c*(a*h+b*f))+d*x*a^2+(1/2)*e*a^2*x^2+1//3*a*x^3*(a*f+2*b*d)+1//4*a*x^4*(a*g+2*b*e)+1//10*c*x^10*(c*e+2*b*g)+1//11*c*x^11*(c*f+2*b*h)+1//12*g*c^2*x^12+1//13*h*c^2*x^13)
	@test integrate((4+x^4+-5*x^2)^-1*(d+e*x), x) == :(-1//6*d*arctanh((1/2)*x)+-1//6*e*log(1+-1*x^2)+1//3*d*arctanh(x)+1//6*e*log(4+-1*x^2))
end

@testset "1.2.2.6 P(x) (d x)^m (a+b x^2+c x^4)^p.jl" begin
	@test integrate(x^2*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(x^5*(1//5*A*b+1//5*C*a)+x^7*(1//7*A*c+1//7*C*b)+1//3*A*a*x^3+1//4*B*a*x^4+1//6*B*b*x^6+1//8*B*c*x^8+1//9*C*c*x^9)
	@test integrate(x*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(x^4*(1//4*A*b+1//4*C*a)+x^6*(1//6*A*c+1//6*C*b)+(1/2)*A*a*x^2+1//3*B*a*x^3+1//5*B*b*x^5+1//7*B*c*x^7+1//8*C*c*x^8)
	@test integrate((A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(x^3*(1//3*A*b+1//3*C*a)+x^5*(1//5*A*c+1//5*C*b)+A*a*x+(1/2)*B*a*x^2+1//4*B*b*x^4+1//6*B*c*x^6+1//7*C*c*x^7)
	@test integrate(x^-1*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(x^2*((1/2)*A*b+(1/2)*C*a)+x^4*(1//4*A*c+1//4*C*b)+A*a*log(x)+B*a*x+1//3*B*b*x^3+1//5*B*c*x^5+1//6*C*c*x^6)
	@test integrate(x^-2*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(x*(A*b+C*a)+x^3*(1//3*A*c+1//3*C*b)+B*a*log(x)+(1/2)*B*b*x^2+-1*A*a*x^-1+1//4*B*c*x^4+1//5*C*c*x^5)
	@test integrate(x^-3*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(x^2*((1/2)*A*c+(1/2)*C*b)+(A*b+C*a)*log(x)+B*b*x+-1*B*a*x^-1+-1//2*A*a*x^-2+1//3*B*c*x^3+1//4*C*c*x^4)
	@test integrate(x^-4*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(x*(A*c+C*b)+-1*x^-1*(A*b+C*a)+B*b*log(x)+(1/2)*B*c*x^2+-1//2*B*a*x^-2+-1//3*A*a*x^-3+1//3*C*c*x^3)
	@test integrate(x^-5*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :((A*c+C*b)*log(x)+-1//2*x^-2*(A*b+C*a)+B*c*x+(1/2)*C*c*x^2+-1*B*b*x^-1+-1//3*B*a*x^-3+-1//4*A*a*x^-4)
	@test integrate(x^-6*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(-1*x^-1*(A*c+C*b)+-1//3*x^-3*(A*b+C*a)+B*c*log(x)+C*c*x+-1//2*B*b*x^-2+-1//4*B*a*x^-4+-1//5*A*a*x^-5)
	@test integrate(x^-7*(A+B*x+C*x^2)*(a+b*x^2+c*x^4), x) == :(-1//2*x^-2*(A*c+C*b)+-1//4*x^-4*(A*b+C*a)+C*c*log(x)+-1*B*c*x^-1+-1//3*B*b*x^-3+-1//5*B*a*x^-5+-1//6*A*a*x^-6)
end

@testset "1.2.2.7 P(x) (d+e x^2)^q (a+b x^2+c x^4)^p.jl" begin
	@test integrate((a+c*x^4)^-1//2*(A+B*x^2), x) == :(B*x*c^-1//2*(a+c*x^4)^(1/2)*(a^(1/2)+c^(1/2)*x^2)^-1+(1/2)*a^1//4*c^-3//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(B+A*a^-1//2*c^(1/2))*(a^(1/2)+c^(1/2)*x^2)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+-1*B*a^1//4*c^-3//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2))
	@test integrate((a+c*x^4)^-3//2*(d+e*x^2)^3*(A+B*x^2), x) == :((1/2)*x*a^-1*c^-2*(a+c*x^4)^-1//2*(c*x^2*(B*c*d^3+-1*A*a*e^3+-3*B*a*d*e^2+3*A*c*e*d^2)+A*c*d*(c*d^2+-3*a*e^2)+-1*B*a*e*(-1*a*e^2+3*c*d^2))+1//3*B*x*c^-2*e^3*(a+c*x^4)^(1/2)+x*c^-3//2*e^2*(a+c*x^4)^(1/2)*(a^(1/2)+c^(1/2)*x^2)^-1*(A*e+3*B*d)+-1//2*x*a^-1*c^-3//2*(a+c*x^4)^(1/2)*(a^(1/2)+c^(1/2)*x^2)^-1*(B*c*d^3+-1*A*a*e^3+-3*B*a*d*e^2+3*A*c*e*d^2)+(1/2)*a^-3//4*c^-7//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*c*d^3+-1*A*a*e^3+-3*B*a*d*e^2+3*A*c*e*d^2)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2)+1//4*a^-5//4*c^-9//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(A*c^2*d^3+B*a^2*e^3+a^3//2*c^(1/2)*e^2*(A*e+3*B*d)+-1*a^(1/2)*c^3//2*d^2*(B*d+3*A*e)+-3*a*c*d*e*(A*e+B*d))*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+(1/2)*e*a^-1//4*c^-9//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(-1*B*a*e^2+3*B*c*d^2+3*A*c*d*e)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+(1/2)*a^1//4*c^-7//4*e^2*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(A*e+3*B*d)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+-1*a^1//4*c^-7//4*e^2*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(A*e+3*B*d)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2)+-1//6*B*a^3//4*c^-9//4*e^3*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2))
	@test integrate((a+c*x^4)^-3//2*(d+e*x^2)^2*(A+B*x^2), x) == :((1/2)*x*a^-1*c^-1*(a+c*x^4)^-1//2*(x^2*(B*c*d^2+-1*B*a*e^2+2*A*c*d*e)+A*c*d^2+-1*A*a*e^2+-2*B*a*d*e)+B*x*c^-3//2*e^2*(a+c*x^4)^(1/2)*(a^(1/2)+c^(1/2)*x^2)^-1+-1//2*x*a^-1*c^-3//2*(a+c*x^4)^(1/2)*(a^(1/2)+c^(1/2)*x^2)^-1*(B*c*d^2+-1*B*a*e^2+2*A*c*d*e)+(1/2)*a^-3//4*c^-7//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*c*d^2+-1*B*a*e^2+2*A*c*d*e)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2)+-1//4*a^-3//4*c^-7//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*c*d^2+-1*B*a*e^2+-1*a^-1//2*c^(1/2)*(A*c*d^2+-1*A*a*e^2+-2*B*a*d*e)+2*A*c*d*e)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+(1/2)*B*a^1//4*c^-7//4*e^2*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+(1/2)*e*a^-1//4*c^-5//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(A*e+2*B*d)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+-1*B*a^1//4*c^-7//4*e^2*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2))
	@test integrate((a+c*x^4)^-3//2*(A+B*x^2)*(d+e*x^2), x) == :((1/2)*x*a^-1*c^-1*(a+c*x^4)^-1//2*(A*c*d+c*x^2*(A*e+B*d)+-1*B*a*e)+-1//2*x*a^-1*c^-1//2*(a+c*x^4)^(1/2)*(a^(1/2)+c^(1/2)*x^2)^-1*(A*e+B*d)+(1/2)*a^-3//4*c^-3//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(A*e+B*d)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2)+1//4*a^-5//4*c^-5//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(A*c*d+-1*B*a*e+-1*a^(1/2)*c^(1/2)*(A*e+B*d))*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2)+(1/2)*B*e*a^-1//4*c^-5//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2))
	@test integrate((a+c*x^4)^-3//2*(A+B*x^2), x) == :((1/2)*x*a^-1*(a+c*x^4)^-1//2*(A+B*x^2)+-1//2*B*x*a^-1*c^-1//2*(a+c*x^4)^(1/2)*(a^(1/2)+c^(1/2)*x^2)^-1+(1/2)*B*a^-3//4*c^-3//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2)+-1//4*a^-5//4*c^-3//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+c*x^4))^(1/2)*(a+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*a^(1/2)+-1*A*c^(1/2))*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2))
	@test integrate((1+x^2)^-1*(2+x^4+3*x^2)^-1//2*(2+x^2), x) == :(2^(1/2)*((1+x^2)^-1*(2+x^2))^-1//2*(2+x^4+3*x^2)^-1//2*(2+x^2)*Elliptic.E(arctan(x),1/2))
	@test integrate((d+e*x^2)^3*(a+b*x^2+c*x^4)^-1//2*(A+B*x^2), x) == :(1//7*B*c^-1*e^3*x^5*(a+b*x^2+c*x^4)^(1/2)+1//35*c^-2*e^2*x^3*(a+b*x^2+c*x^4)^(1/2)*(-6*B*b*e+7*A*c*e+21*B*c*d)+1//105*e*x*c^-3*(a+b*x^2+c*x^4)^(1/2)*(B*(24*b^2*e^2+105*c^2*d^2+-1*c*e*(25*a*e+84*b*d))+7*A*c*e*(-4*b*e+15*c*d))+1//105*x*c^-7//2*(a^(1/2)+c^(1/2)*x^2)^-1*(a+b*x^2+c*x^4)^(1/2)*(B*(-48*b^3*e^3+105*c^3*d^3+-21*d*e*c^2*(9*a*e+10*b*d)+8*b*c*e^2*(13*a*e+21*b*d))+7*A*c*e*(8*b^2*e^2+45*c^2*d^2+-3*c*e*(3*a*e+10*b*d)))+-1//105*a^1//4*c^-15//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*(-48*b^3*e^3+105*c^3*d^3+-21*d*e*c^2*(9*a*e+10*b*d)+8*b*c*e^2*(13*a*e+21*b*d))+7*A*c*e*(8*b^2*e^2+45*c^2*d^2+-3*c*e*(3*a*e+10*b*d)))*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2)+1//210*a^1//4*c^-15//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*(-48*b^3*e^3+105*c^3*d^3+-21*d*e*c^2*(9*a*e+10*b*d)+8*b*c*e^2*(13*a*e+21*b*d))+a^-1//2*c^(1/2)*(7*A*c*(15*c^2*d^3+4*a*b*e^3+-15*a*c*d*e^2)+-1*B*a*e*(24*b^2*e^2+105*c^2*d^2+-1*c*e*(25*a*e+84*b*d)))+7*A*c*e*(8*b^2*e^2+45*c^2*d^2+-3*c*e*(3*a*e+10*b*d)))*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2))
	@test integrate((d+e*x^2)^2*(a+b*x^2+c*x^4)^-1//2*(A+B*x^2), x) == :(1//5*B*c^-1*e^2*x^3*(a+b*x^2+c*x^4)^(1/2)+1//15*e*x*c^-2*(a+b*x^2+c*x^4)^(1/2)*(-4*B*b*e+5*A*c*e+10*B*c*d)+1//15*x*c^-5//2*(a^(1/2)+c^(1/2)*x^2)^-1*(a+b*x^2+c*x^4)^(1/2)*(B*(8*b^2*e^2+15*c^2*d^2+-1*c*e*(9*a*e+20*b*d))+10*A*c*e*(-1*b*e+3*c*d))+-1//15*a^1//4*c^-11//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*(8*b^2*e^2+15*c^2*d^2+-1*c*e*(9*a*e+20*b*d))+10*A*c*e*(-1*b*e+3*c*d))*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2)+1//30*a^1//4*c^-11//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(B*(8*b^2*e^2+15*c^2*d^2+-1*c*e*(9*a*e+20*b*d))+-1*a^-1//2*c^(1/2)*(-5*A*c*(-1*a*e^2+3*c*d^2)+2*B*a*e*(-2*b*e+5*c*d))+10*A*c*e*(-1*b*e+3*c*d))*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2))
	@test integrate((a+b*x^2+c*x^4)^-1//2*(A+B*x^2)*(d+e*x^2), x) == :(1//3*B*e*x*c^-1*(a+b*x^2+c*x^4)^(1/2)+1//3*x*c^-3//2*(a^(1/2)+c^(1/2)*x^2)^-1*(a+b*x^2+c*x^4)^(1/2)*(-2*B*b*e+3*A*c*e+3*B*c*d)+-1//3*a^1//4*c^-7//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(-2*B*b*e+3*A*c*e+3*B*c*d)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2)+1//6*a^1//4*c^-7//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*(a^-1//2*c^(1/2)*(-1*B*a*e+3*A*c*d)+-2*B*b*e+3*A*c*e+3*B*c*d)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2))
	@test integrate((a+b*x^2+c*x^4)^-1//2*(A+B*x^2), x) == :(B*x*c^-1//2*(a^(1/2)+c^(1/2)*x^2)^-1*(a+b*x^2+c*x^4)^(1/2)+(1/2)*a^1//4*c^-3//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(B+A*a^-1//2*c^(1/2))*(a^(1/2)+c^(1/2)*x^2)*Elliptic.F(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2)+-1*B*a^1//4*c^-3//4*((a^(1/2)+c^(1/2)*x^2)^-2*(a+b*x^2+c*x^4))^(1/2)*(a+b*x^2+c*x^4)^-1//2*(a^(1/2)+c^(1/2)*x^2)*Elliptic.E(2*arctan(x*a^-1//4*c^1//4),1/2+-1//4*b*a^-1//2*c^-1//2))
end

@testset "1.2.3.2 (d x)^m (a+b x^n+c x^(2 n))^p.jl" begin
	@test integrate((a*x^3+b*x^6)^5//3, x) == :(1//11*b^-1*x^-5*(a*x^3+b*x^6)^8//3+-3//88*a*b^-2*x^-8*(a*x^3+b*x^6)^8//3)
	@test integrate((a*x^3+b*x^6)^2//3, x) == :(1//5*b^-1*x^-5*(a*x^3+b*x^6)^5//3)
	@test integrate((a*x^3+b*x^6)^-2//3, x) == :(-1*a^-1*x^-2*(a*x^3+b*x^6)^1//3)
	@test integrate((a*x^3+b*x^6)^-5//3, x) == :((1/2)*a^-1*x^-2*(a*x^3+b*x^6)^-2//3+-3//4*a^-2*x^-5*(a*x^3+b*x^6)^1//3+9//4*b*a^-3*x^-2*(a*x^3+b*x^6)^1//3)
	@test integrate((x^6+-1*x^3)^-1, x) == :((1/2)*x^-2+-1//6*log(1+x+x^2)+1//3*log(1+-1x)+-1//3*3^(1/2)*arctan(1//3*3^(1/2)*(1+2x)))
	@test integrate(x^5*(a^2+b^2*x^6+2*a*b*x^3)^(1/2), x) == :(a*x^6*(6a+6*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2)+b*x^9*(9a+9*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2))
	@test integrate(x^4*(a^2+b^2*x^6+2*a*b*x^3)^(1/2), x) == :(a*x^5*(5a+5*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2)+b*x^8*(8a+8*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2))
	@test integrate(x^3*(a^2+b^2*x^6+2*a*b*x^3)^(1/2), x) == :(a*x^4*(4a+4*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2)+b*x^7*(7a+7*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2))
	@test integrate(x^2*(a^2+b^2*x^6+2*a*b*x^3)^(1/2), x) == :(1//6*b^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2)*(a+b*x^3))
	@test integrate(x*(a^2+b^2*x^6+2*a*b*x^3)^(1/2), x) == :(a*x^2*(2a+2*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2)+b*x^5*(5a+5*b*x^3)^-1*(a^2+b^2*x^6+2*a*b*x^3)^(1/2))
end

@testset "1.2.3.3 (d+e x^n)^q (a+b x^n+c x^(2 n))^p.jl" begin
	@test integrate((a+c*x^6)^-1*(d+e*x^3), x) == :(-1//6*e*a^-1//3*c^-2//3*log(a^1//3+c^1//3*x^2)+-1//6*a^-5//6*c^-2//3*(d*c^(1/2)+e*3^(1/2)*a^(1/2))*arctan(3^(1/2)+-2*x*a^-1//6*c^1//6)+-1//12*a^-5//6*c^-2//3*(-1*e*a^(1/2)+d*3^(1/2)*c^(1/2))*log(a^1//3+c^1//3*x^2+-1*x*3^(1/2)*a^1//6*c^1//6)+1//3*d*a^-5//6*c^-1//6*arctan(x*a^-1//6*c^1//6)+1//6*a^-5//6*c^-2//3*(d*c^(1/2)+-1*e*3^(1/2)*a^(1/2))*arctan(3^(1/2)+2*x*a^-1//6*c^1//6)+1//12*a^-5//6*c^-2//3*(e*a^(1/2)+d*3^(1/2)*c^(1/2))*log(a^1//3+c^1//3*x^2+x*3^(1/2)*a^1//6*c^1//6))
	@test integrate((a+-1*c*x^6)^-1*(d+e*x^3), x) == :(-1//6*a^-5//6*c^-2//3*(d*c^(1/2)+e*a^(1/2))*log(a^1//6+-1*x*c^1//6)+-1//12*a^-5//6*c^-1//6*(d+-1*e*a^(1/2)*c^-1//2)*log(a^1//3+c^1//3*x^2+-1*x*a^1//6*c^1//6)+1//6*a^-5//6*c^-1//6*(d+-1*e*a^(1/2)*c^-1//2)*log(a^1//6+x*c^1//6)+1//12*a^-5//6*c^-2//3*(d*c^(1/2)+e*a^(1/2))*log(a^1//3+c^1//3*x^2+x*a^1//6*c^1//6)+-1//6*3^(1/2)*a^-5//6*c^-1//6*(d+-1*e*a^(1/2)*c^-1//2)*arctan(1//3*3^(1/2)*a^-1//6*(a^1//6+-2*x*c^1//6))+1//6*3^(1/2)*a^-5//6*c^-2//3*(d*c^(1/2)+e*a^(1/2))*arctan(1//3*3^(1/2)*a^-1//6*(a^1//6+2*x*c^1//6)))
	@test integrate((a+-1*c*x^8)^-1*(d+e*x^4), x) == :(1//4*a^-7//8*c^-5//8*(d*c^(1/2)+e*a^(1/2))*arctan(x*a^-1//8*c^1//8)+1//4*a^-7//8*c^-5//8*(d*c^(1/2)+e*a^(1/2))*arctanh(x*a^-1//8*c^1//8)+-1//8*2^(1/2)*a^-7//8*c^-1//8*(d+-1*e*a^(1/2)*c^-1//2)*arctan(1+-1*x*2^(1/2)*a^-1//8*c^1//8)+-1//16*2^(1/2)*a^-7//8*c^-1//8*(d+-1*e*a^(1/2)*c^-1//2)*log(a^1//4+c^1//4*x^2+-1*x*2^(1/2)*a^1//8*c^1//8)+1//8*2^(1/2)*a^-7//8*c^-1//8*(d+-1*e*a^(1/2)*c^-1//2)*arctan(1+x*2^(1/2)*a^-1//8*c^1//8)+1//16*2^(1/2)*a^-7//8*c^-1//8*(d+-1*e*a^(1/2)*c^-1//2)*log(a^1//4+c^1//4*x^2+x*2^(1/2)*a^1//8*c^1//8))
	@test integrate((d^2+b*x^4+e^2*x^8)^-1*(d+e*x^4), x) == :(-1//4*d^-1//2*((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan(((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*((-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+-2*x*e^(1/2)))+-1//4*d^-1//2*(-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan((-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*(((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+-2*x*e^(1/2)))+-1//8*d^-1//2*((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+e^(1/2)*x^2+-1*x*((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2))+-1//8*d^-1//2*(-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+e^(1/2)*x^2+-1*x*(-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2))+1//4*d^-1//2*((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan(((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*((-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+2*x*e^(1/2)))+1//4*d^-1//2*(-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan((-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*(((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+2*x*e^(1/2)))+1//8*d^-1//2*((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+x*((-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+e^(1/2)*x^2)+1//8*d^-1//2*(-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+x*(-1*(-1b+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+e^(1/2)*x^2))
	@test integrate((d^2+f*x^4+e^2*x^8)^-1*(d+e*x^4), x) == :(-1//4*d^-1//2*((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan(((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*((-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+-2*x*e^(1/2)))+-1//4*d^-1//2*(-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan((-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*(((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+-2*x*e^(1/2)))+-1//8*d^-1//2*((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+e^(1/2)*x^2+-1*x*((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2))+-1//8*d^-1//2*(-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+e^(1/2)*x^2+-1*x*(-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2))+1//4*d^-1//2*((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan(((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*((-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+2*x*e^(1/2)))+1//4*d^-1//2*(-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan((-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*(((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+2*x*e^(1/2)))+1//8*d^-1//2*((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+x*((-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+e^(1/2)*x^2)+1//8*d^-1//2*(-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+x*(-1*(-1*f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+e^(1/2)*x^2))
	@test integrate((d^2+e^2*x^8+-1*b*x^4)^-1*(d+e*x^4), x) == :(-1//2*2^(1/2)*e^(1/2)*(b+-2*d*e)^-1//2*((b+-2*d*e)^(1/2)+(b+2*d*e)^(1/2))^-1//2*arctan(x*2^(1/2)*e^(1/2)*((b+-2*d*e)^(1/2)+(b+2*d*e)^(1/2))^-1//2)+-1//2*2^(1/2)*e^(1/2)*(b+-2*d*e)^-1//2*((b+-2*d*e)^(1/2)+(b+2*d*e)^(1/2))^-1//2*arctanh(x*2^(1/2)*e^(1/2)*((b+-2*d*e)^(1/2)+(b+2*d*e)^(1/2))^-1//2)+-1//2*2^(1/2)*e^(1/2)*(b+-2*d*e)^-1//2*((b+-2*d*e)^(1/2)+-1*(b+2*d*e)^(1/2))^-1//2*arctan(x*2^(1/2)*e^(1/2)*((b+-2*d*e)^(1/2)+-1*(b+2*d*e)^(1/2))^-1//2)+-1//2*2^(1/2)*e^(1/2)*(b+-2*d*e)^-1//2*((b+-2*d*e)^(1/2)+-1*(b+2*d*e)^(1/2))^-1//2*arctanh(x*2^(1/2)*e^(1/2)*((b+-2*d*e)^(1/2)+-1*(b+2*d*e)^(1/2))^-1//2))
	@test integrate((d^2+e^2*x^8+-1*f*x^4)^-1*(d+e*x^4), x) == :(-1//4*d^-1//2*((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan(((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*((-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+-2*x*e^(1/2)))+-1//4*d^-1//2*(-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan((-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*(((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+-2*x*e^(1/2)))+-1//8*d^-1//2*((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+e^(1/2)*x^2+-1*x*((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2))+-1//8*d^-1//2*(-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+e^(1/2)*x^2+-1*x*(-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2))+1//4*d^-1//2*((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan(((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*((-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+2*x*e^(1/2)))+1//4*d^-1//2*(-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*arctan((-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*(((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+2*x*e^(1/2)))+1//8*d^-1//2*((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+x*((f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+e^(1/2)*x^2)+1//8*d^-1//2*(-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^-1//2*log(d^(1/2)+x*(-1*(f+2*d*e)^(1/2)+2*d^(1/2)*e^(1/2))^(1/2)+e^(1/2)*x^2))
	@test integrate((1+x^8+b*x^4)^-1*(1+x^4), x) == :(-1//4*(2+(2+-1b)^(1/2))^-1//2*arctan((2+(2+-1b)^(1/2))^-1//2*((2+-1*(2+-1b)^(1/2))^(1/2)+-2x))+-1//4*(2+-1*(2+-1b)^(1/2))^-1//2*arctan((2+-1*(2+-1b)^(1/2))^-1//2*((2+(2+-1b)^(1/2))^(1/2)+-2x))+-1//8*(2+(2+-1b)^(1/2))^-1//2*log(1+x^2+-1*x*(2+(2+-1b)^(1/2))^(1/2))+-1//8*(2+-1*(2+-1b)^(1/2))^-1//2*log(1+x^2+-1*x*(2+-1*(2+-1b)^(1/2))^(1/2))+1//4*(2+(2+-1b)^(1/2))^-1//2*arctan((2+(2+-1b)^(1/2))^-1//2*((2+-1*(2+-1b)^(1/2))^(1/2)+2x))+1//4*(2+-1*(2+-1b)^(1/2))^-1//2*arctan((2+-1*(2+-1b)^(1/2))^-1//2*((2+(2+-1b)^(1/2))^(1/2)+2x))+1//8*(2+(2+-1b)^(1/2))^-1//2*log(1+x^2+x*(2+(2+-1b)^(1/2))^(1/2))+1//8*(2+-1*(2+-1b)^(1/2))^-1//2*log(1+x^2+x*(2+-1*(2+-1b)^(1/2))^(1/2)))
	@test integrate((1+x^8+3*x^4)^-1*(1+x^4), x) == :(-1//20*2^1//4*5^(1/2)*(3+5^(1/2))^1//4*arctan(1+-1*x*2^3//4*(3+-1*5^(1/2))^-1//4)+-1//20*2^1//4*5^(1/2)*(3+-1*5^(1/2))^1//4*arctan(1+-1*x*2^3//4*(3+5^(1/2))^-1//4)+-1//40*2^1//4*5^(1/2)*(3+5^(1/2))^1//4*log((6+-2*5^(1/2))^(1/2)+2*x^2+-2*x*(6+-2*5^(1/2))^1//4)+-1//40*2^1//4*5^(1/2)*(3+-1*5^(1/2))^1//4*log((6+2*5^(1/2))^(1/2)+2*x^2+-2*x*(6+2*5^(1/2))^1//4)+1//20*2^1//4*5^(1/2)*(3+5^(1/2))^1//4*arctan(1+x*2^3//4*(3+-1*5^(1/2))^-1//4)+1//20*2^1//4*5^(1/2)*(3+-1*5^(1/2))^1//4*arctan(1+x*2^3//4*(3+5^(1/2))^-1//4)+1//40*2^1//4*5^(1/2)*(3+5^(1/2))^1//4*log((6+-2*5^(1/2))^(1/2)+2*x^2+2*x*(6+-2*5^(1/2))^1//4)+1//40*2^1//4*5^(1/2)*(3+-1*5^(1/2))^1//4*log((6+2*5^(1/2))^(1/2)+2*x^2+2*x*(6+2*5^(1/2))^1//4))
	@test integrate((1+x^8+2*x^4)^-1*(1+x^4), x) == :(-1//4*2^(1/2)*arctan(1+-1*x*2^(1/2))+-1//8*2^(1/2)*log(1+x^2+-1*x*2^(1/2))+1//4*2^(1/2)*arctan(1+x*2^(1/2))+1//8*2^(1/2)*log(1+x^2+x*2^(1/2)))
end

@testset "1.2.3.4 (f x)^m (d+e x^n)^q (a+b x^n+c x^(2 n))^p.jl" begin
	@test integrate((d+e*x^3)^5*(a+b*x^3+c*x^6), x) == :(a*x*d^5+1//4*d^4*x^4*(b*d+5*a*e)+1//7*d^3*x^7*(c*d^2+5*e*(b*d+2*a*e))+1//16*e^3*x^16*(e*(a*e+5*b*d)+10*c*d^2)+1//19*e^4*x^19*(b*e+5*c*d)+1//22*c*e^5*x^22+(1/2)*e*d^2*x^10*(c*d^2+2*e*(a*e+b*d))+5//13*d*e^2*x^13*(e*(a*e+2*b*d)+2*c*d^2))
	@test integrate((d+e*x^3)^4*(a+b*x^3+c*x^6), x) == :(a*x*d^4+1//4*d^3*x^4*(b*d+4*a*e)+1//7*d^2*x^7*(c*d^2+6*a*e^2+4*b*d*e)+1//13*e^2*x^13*(e*(a*e+4*b*d)+6*c*d^2)+1//16*e^3*x^16*(b*e+4*c*d)+1//19*c*e^4*x^19+1//5*d*e*x^10*(e*(2*a*e+3*b*d)+2*c*d^2))
	@test integrate((d+e*x^3)^3*(a+b*x^3+c*x^6), x) == :(a*x*d^3+1//4*d^2*x^4*(b*d+3*a*e)+1//7*d*x^7*(c*d^2+3*e*(a*e+b*d))+1//10*e*x^10*(e*(a*e+3*b*d)+3*c*d^2)+1//13*e^2*x^13*(b*e+3*c*d)+1//16*c*e^3*x^16)
	@test integrate((d+e*x^3)^2*(a+b*x^3+c*x^6), x) == :(1//7*x^7*(c*d^2+e*(a*e+2*b*d))+a*x*d^2+1//4*d*x^4*(b*d+2*a*e)+1//10*e*x^10*(b*e+2*c*d)+1//13*c*e^2*x^13)
	@test integrate((d+e*x^3)*(a+b*x^3+c*x^6), x) == :(1//4*x^4*(a*e+b*d)+1//7*x^7*(b*e+c*d)+a*d*x+1//10*c*e*x^10)
	@test integrate((d+e*x^3)^-1*(a+b*x^3+c*x^6), x) == :(-1*x*e^-2*(c*d+-1*b*e)+1//4*c*e^-1*x^4+-1//6*d^-2//3*e^-7//3*(a*e^2+c*d^2+-1*b*d*e)*log(d^2//3+e^2//3*x^2+-1*x*d^1//3*e^1//3)+1//3*d^-2//3*e^-7//3*(a*e^2+c*d^2+-1*b*d*e)*log(d^1//3+x*e^1//3)+-1//3*3^(1/2)*d^-2//3*e^-7//3*(a*e^2+c*d^2+-1*b*d*e)*arctan(1//3*3^(1/2)*d^-1//3*(d^1//3+-2*x*e^1//3)))
	@test integrate((d+e*x^3)^-2*(a+b*x^3+c*x^6), x) == :(c*x*e^-2+-1//9*d^-5//3*e^-7//3*(-1*e*(b*d+2*a*e)+4*c*d^2)*log(d^1//3+x*e^1//3)+1//18*d^-5//3*e^-7//3*(-1*e*(b*d+2*a*e)+4*c*d^2)*log(d^2//3+e^2//3*x^2+-1*x*d^1//3*e^1//3)+1//3*x*d^-1*e^-2*(d+e*x^3)^-1*(a*e^2+c*d^2+-1*b*d*e)+1//9*3^(1/2)*d^-5//3*e^-7//3*(-1*e*(b*d+2*a*e)+4*c*d^2)*arctan(1//3*3^(1/2)*d^-1//3*(d^1//3+-2*x*e^1//3)))
	@test integrate((d+e*x^3)^-3*(a+b*x^3+c*x^6), x) == :(-1//54*d^-8//3*e^-7//3*(e*(b*d+5*a*e)+2*c*d^2)*log(d^2//3+e^2//3*x^2+-1*x*d^1//3*e^1//3)+1//27*d^-8//3*e^-7//3*(e*(b*d+5*a*e)+2*c*d^2)*log(d^1//3+x*e^1//3)+-1//18*x*d^-2*e^-2*(d+e*x^3)^-1*(-1*e*(b*d+5*a*e)+7*c*d^2)+-1//27*3^(1/2)*d^-8//3*e^-7//3*(e*(b*d+5*a*e)+2*c*d^2)*arctan(1//3*3^(1/2)*d^-1//3*(d^1//3+-2*x*e^1//3))+1//6*x*d^-1*e^-2*(d+e*x^3)^-2*(a*e^2+c*d^2+-1*b*d*e))
	@test integrate(x^8*(a+b*x^3+c*x^6)^-1*(d+e*x^3), x) == :(-1//6*c^-3*(-1*e*b^2+a*c*e+b*c*d)*log(a+b*x^3+c*x^6)+1//3*c^-2*x^3*(c*d+-1*b*e)+1//6*e*c^-1*x^6+-1//3*c^-3*(b^2+-4*a*c)^-1//2*(-1*e*b^3+c*d*b^2+-2*a*d*c^2+3*a*b*c*e)*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*x^3)))
	@test integrate(x^5*(a+b*x^3+c*x^6)^-1*(d+e*x^3), x) == :(1//3*e*c^-1*x^3+1//6*c^-2*(c*d+-1*b*e)*log(a+b*x^3+c*x^6)+1//3*c^-2*(b^2+-4*a*c)^-1//2*(-1*e*b^2+b*c*d+2*a*c*e)*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*x^3)))
end

@testset "1.2.3.5 P(x) (d x)^m (a+b x^n+c x^(2 n))^p.jl" begin
	@test integrate((a+b*x^3+c*x^6)^-1*(d+e*x+f*x^2+g*x^3+h*x^4+j*x^5+k*x^6+l*x^7+m*x^8), x) == :(k*x*c^-1+(1/2)*l*c^-1*x^2+1//3*m*c^-1*x^3+1//6*c^-2*(c*j+-1*b*m)*log(a+b*x^3+c*x^6)+-1//3*c^-2*(b^2+-4*a*c)^-1//2*(m*b^2+2*f*c^2+-1*b*c*j+-2*a*c*m)*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*x^3))+-1//6*2^1//3*c^-2//3*(b+(b^2+-4*a*c)^(1/2))^-1//3*(h+-1*b*l*c^-1+-1*c^-1*(b^2+-4*a*c)^-1//2*(l*b^2+2*e*c^2+-1*b*c*h+-2*a*c*l))*log((b+(b^2+-4*a*c)^(1/2))^1//3+x*2^1//3*c^1//3)+-1//6*2^1//3*c^-2//3*(b+-1*(b^2+-4*a*c)^(1/2))^-1//3*(h+c^-1*(b^2+-4*a*c)^-1//2*(l*b^2+-1*c*(b*h+2*a*l)+2*e*c^2)+-1*b*l*c^-1)*log((b+-1*(b^2+-4*a*c)^(1/2))^1//3+x*2^1//3*c^1//3)+-1//12*2^2//3*c^-1//3*(b+(b^2+-4*a*c)^(1/2))^-2//3*(g+-1*b*k*c^-1+-1*c^-1*(b^2+-4*a*c)^-1//2*(k*b^2+2*d*c^2+-1*b*c*g+-2*a*c*k))*log((b+(b^2+-4*a*c)^(1/2))^2//3+2^2//3*c^2//3*x^2+-1*x*2^1//3*c^1//3*(b+(b^2+-4*a*c)^(1/2))^1//3)+-1//12*2^2//3*c^-1//3*(b+-1*(b^2+-4*a*c)^(1/2))^-2//3*(g+c^-1*(b^2+-4*a*c)^-1//2*(k*b^2+-1*c*(b*g+2*a*k)+2*d*c^2)+-1*b*k*c^-1)*log((b+-1*(b^2+-4*a*c)^(1/2))^2//3+2^2//3*c^2//3*x^2+-1*x*2^1//3*c^1//3*(b+-1*(b^2+-4*a*c)^(1/2))^1//3)+1//6*2^2//3*c^-1//3*(b+(b^2+-4*a*c)^(1/2))^-2//3*(g+-1*b*k*c^-1+-1*c^-1*(b^2+-4*a*c)^-1//2*(k*b^2+2*d*c^2+-1*b*c*g+-2*a*c*k))*log((b+(b^2+-4*a*c)^(1/2))^1//3+x*2^1//3*c^1//3)+1//6*2^2//3*c^-1//3*(b+-1*(b^2+-4*a*c)^(1/2))^-2//3*(g+c^-1*(b^2+-4*a*c)^-1//2*(k*b^2+-1*c*(b*g+2*a*k)+2*d*c^2)+-1*b*k*c^-1)*log((b+-1*(b^2+-4*a*c)^(1/2))^1//3+x*2^1//3*c^1//3)+1//12*2^1//3*c^-2//3*(b+(b^2+-4*a*c)^(1/2))^-1//3*(h+-1*b*l*c^-1+-1*c^-1*(b^2+-4*a*c)^-1//2*(l*b^2+2*e*c^2+-1*b*c*h+-2*a*c*l))*log((b+(b^2+-4*a*c)^(1/2))^2//3+2^2//3*c^2//3*x^2+-1*x*2^1//3*c^1//3*(b+(b^2+-4*a*c)^(1/2))^1//3)+1//12*2^1//3*c^-2//3*(b+-1*(b^2+-4*a*c)^(1/2))^-1//3*(h+c^-1*(b^2+-4*a*c)^-1//2*(l*b^2+-1*c*(b*h+2*a*l)+2*e*c^2)+-1*b*l*c^-1)*log((b+-1*(b^2+-4*a*c)^(1/2))^2//3+2^2//3*c^2//3*x^2+-1*x*2^1//3*c^1//3*(b+-1*(b^2+-4*a*c)^(1/2))^1//3)+-1//6*2^1//3*3^(1/2)*c^-2//3*(b+(b^2+-4*a*c)^(1/2))^-1//3*(h+-1*b*l*c^-1+-1*c^-1*(b^2+-4*a*c)^-1//2*(l*b^2+2*e*c^2+-1*b*c*h+-2*a*c*l))*arctan(1//3*3^(1/2)*(1+-2*x*2^1//3*c^1//3*(b+(b^2+-4*a*c)^(1/2))^-1//3))+-1//6*2^1//3*3^(1/2)*c^-2//3*(b+-1*(b^2+-4*a*c)^(1/2))^-1//3*(h+c^-1*(b^2+-4*a*c)^-1//2*(l*b^2+-1*c*(b*h+2*a*l)+2*e*c^2)+-1*b*l*c^-1)*arctan(1//3*3^(1/2)*(1+-2*x*2^1//3*c^1//3*(b+-1*(b^2+-4*a*c)^(1/2))^-1//3))+-1//6*2^2//3*3^(1/2)*c^-1//3*(b+(b^2+-4*a*c)^(1/2))^-2//3*(g+-1*b*k*c^-1+-1*c^-1*(b^2+-4*a*c)^-1//2*(k*b^2+2*d*c^2+-1*b*c*g+-2*a*c*k))*arctan(1//3*3^(1/2)*(1+-2*x*2^1//3*c^1//3*(b+(b^2+-4*a*c)^(1/2))^-1//3))+-1//6*2^2//3*3^(1/2)*c^-1//3*(b+-1*(b^2+-4*a*c)^(1/2))^-2//3*(g+c^-1*(b^2+-4*a*c)^-1//2*(k*b^2+-1*c*(b*g+2*a*k)+2*d*c^2)+-1*b*k*c^-1)*arctan(1//3*3^(1/2)*(1+-2*x*2^1//3*c^1//3*(b+-1*(b^2+-4*a*c)^(1/2))^-1//3)))
	@test integrate((a+b*x^n+c*x^(2n))^-3//2*(c*f*x^(-1+n)+c*g*x^(-1+2n)+c*h*x^(-1+5//2*n)+-1*a*h*x^(-1+(1/2)*n)), x) == :(-1*n^-1*(b^2+-4*a*c)^-1*(a+b*x^n+c*x^(2n))^-1//2*(2*c*(b*f+-2*a*g)+2*c*x^n*(-1*b*g+2*c*f)+2*h*x^((1/2)*n)*(b^2+-4*a*c)))
	@test integrate((a+b*x^n+c*x^(2n))^p*(a+b*x^n*(1+n+n*p)+c*x^(2n)*(1+2*n*(1+p))), x) == :(x*(a+b*x^n+c*x^(2n))^(1+p))
	@test integrate(x^(-1+1//4*n)*(a+c*x^n)^-3//2*(-1*a*h+c*f*x^(1//4*n)+c*g*x^(3//4*n)+c*h*x^n), x) == :(-1*a^-1*n^-1*(a+c*x^n)^-1//2*(2*a*g+-2*c*f*x^((1/2)*n)+4*a*h*x^(1//4*n)))
	@test integrate((d*x)^(-1+1//4*n)*(a+c*x^n)^-3//2*(-1*a*h+c*f*x^(1//4*n)+c*g*x^(3//4*n)+c*h*x^n), x) == :(-2*a^-1*n^-1*x^(1+-1//4*n)*(d*x)^(-1+1//4*n)*(a+c*x^n)^-1//2*(a*g+-1*c*f*x^((1/2)*n)+2*a*h*x^(1//4*n)))
	@test integrate(x^(-1+(1/2)*n)*(a+b*x^n+c*x^(2n))^-3//2*(-1*a*h+c*f*x^((1/2)*n)+c*g*x^(3//2*n)+c*h*x^(2n)), x) == :(-1*n^-1*(b^2+-4*a*c)^-1*(a+b*x^n+c*x^(2n))^-1//2*(2*c*(b*f+-2*a*g)+2*c*x^n*(-1*b*g+2*c*f)+2*h*x^((1/2)*n)*(b^2+-4*a*c)))
	@test integrate((d*x)^(-1+(1/2)*n)*(a+b*x^n+c*x^(2n))^-3//2*(-1*a*h+c*f*x^((1/2)*n)+c*g*x^(3//2*n)+c*h*x^(2n)), x) == :(-2*n^-1*x^(1+-1//2*n)*(d*x)^(-1+(1/2)*n)*(b^2+-4*a*c)^-1*(a+b*x^n+c*x^(2n))^-1//2*(c*(b*f+-2*a*g)+c*x^n*(-1*b*g+2*c*f)+h*x^((1/2)*n)*(b^2+-4*a*c)))
	@test integrate((g*x)^m*(a+b*x^n+c*x^(2n))^p*(a*(1+m)+b*x^n*(1+m+n+n*p)+c*x^(2n)*(1+m+2*n*(1+p))), x) == :(g^-1*(g*x)^(1+m)*(a+b*x^n+c*x^(2n))^(1+p))
end

@testset "1.2.4.2 (d x)^m (a x^q+b x^n+c x^(2 n-q))^p.jl" begin
	@test integrate(x^2*(a*x^2+b*x^3+c*x^4), x) == :(1//5*a*x^5+1//6*b*x^6+1//7*c*x^7)
	@test integrate(x*(a*x^2+b*x^3+c*x^4), x) == :(1//4*a*x^4+1//5*b*x^5+1//6*c*x^6)
	@test integrate(a*x^2+b*x^3+c*x^4, x) == :(1//3*a*x^3+1//4*b*x^4+1//5*c*x^5)
	@test integrate(x^-1*(a*x^2+b*x^3+c*x^4), x) == :((1/2)*a*x^2+1//3*b*x^3+1//4*c*x^4)
	@test integrate(x^-2*(a*x^2+b*x^3+c*x^4), x) == :(a*x+(1/2)*b*x^2+1//3*c*x^3)
	@test integrate(x^2*(a*x^2+b*x^3+c*x^4)^2, x) == :(1//7*a^2*x^7+1//9*x^9*(b^2+2*a*c)+1//11*c^2*x^11+1//4*a*b*x^8+1//5*b*c*x^10)
	@test integrate(x*(a*x^2+b*x^3+c*x^4)^2, x) == :(1//6*a^2*x^6+1//8*x^8*(b^2+2*a*c)+1//10*c^2*x^10+2//7*a*b*x^7+2//9*b*c*x^9)
	@test integrate((a*x^2+b*x^3+c*x^4)^2, x) == :(1//5*a^2*x^5+1//7*x^7*(b^2+2*a*c)+1//9*c^2*x^9+1//3*a*b*x^6+1//4*b*c*x^8)
	@test integrate(x^-1*(a*x^2+b*x^3+c*x^4)^2, x) == :(1//4*a^2*x^4+1//6*x^6*(b^2+2*a*c)+1//8*c^2*x^8+2//5*a*b*x^5+2//7*b*c*x^7)
	@test integrate(x^-2*(a*x^2+b*x^3+c*x^4)^2, x) == :(1//3*a^2*x^3+1//5*x^5*(b^2+2*a*c)+1//7*c^2*x^7+(1/2)*a*b*x^4+1//3*b*c*x^6)
end

@testset "1.3.1 Rational functions.jl" begin
	@test integrate((9*x^3+-9*b*x+2*3^(1/2)*b^3//2)^-1, x) == :(-1//27*b^-1*log(b^(1/2)+-1*x*3^(1/2))+1//27*b^-1*log(2*b^(1/2)+x*3^(1/2))+1//9*3^(1/2)*b^-1//2*(-3x+3^(1/2)*b^(1/2))^-1)
	@test integrate((a^3+b^3*x^3+3*a*b^2*x^2+3*b*x*a^2)^p, x) == :((b^3*(x+a*b^-1)^3)^p*(1+3p)^-1*(x+a*b^-1))
	@test integrate((a^3+b^3*x^3+3*a*b^2*x^2+3*b*x*a^2)^3, x) == :(1//10*b^-1*(a+b*x)^10)
	@test integrate((a^3+b^3*x^3+3*a*b^2*x^2+3*b*x*a^2)^2, x) == :(1//7*b^-1*(a+b*x)^7)
	@test integrate(a^3+b^3*x^3+3*a*b^2*x^2+3*b*x*a^2, x) == :(x*a^3+1//4*b^3*x^4+a*b^2*x^3+3//2*b*a^2*x^2)
	@test integrate((a^3+b^3*x^3+3*a*b^2*x^2+3*b*x*a^2)^-1, x) == :(-1//2*b^-1*(a+b*x)^-2)
	@test integrate((a^3+b^3*x^3+3*a*b^2*x^2+3*b*x*a^2)^-2, x) == :(-1//5*b^-1*(a+b*x)^-5)
	@test integrate((a^3+b^3*x^3+3*a*b^2*x^2+3*b*x*a^2)^-3, x) == :(-1//8*b^-1*(a+b*x)^-8)
	@test integrate((c^2*x^3+3*a*b+3*x*b^2+3*b*c*x^2)^3, x) == :(1//10*c^-4*(b+c*x)^10+-1*x*b^3*c^-3*(b^2+-3*a*c)^3+-3//7*b*c^-4*(b+c*x)^7*(b^2+-3*a*c)+3//4*b^2*c^-4*(b+c*x)^4*(b^2+-3*a*c)^2)
	@test integrate((c^2*x^3+3*a*b+3*x*b^2+3*b*c*x^2)^2, x) == :(1//7*c^-3*(b+c*x)^7+x*b^2*c^-2*(b^2+-3*a*c)^2+-1//2*b*c^-3*(b+c*x)^4*(b^2+-3*a*c))
end

@testset "1.3.2 Algebraic functions.jl" begin
	@test integrate((1+x^3)^-1//2*(x+2^2//3)^-1, x) == :(2//9*3^(1/2)*arctan(3^(1/2)*(1+x^3)^-1//2*(1+x*2^1//3))+2//9*2^1//3*3^3//4*((1+x+3^(1/2))^-2*(1+x))^-1//2*((1+x+3^(1/2))^-2*(1+x^2+-1x))^(1/2)*(1+x^3)^-1//2*(2+3^(1/2))^(1/2)*(1+x)*Elliptic.F(arcsin((1+x+3^(1/2))^-1*(1+x+-1*3^(1/2))),-7+-4*3^(1/2)))
	@test integrate((1+-1*x^3)^-1//2*(2^2//3+-1x)^-1, x) == :(-2//9*3^(1/2)*arctan(3^(1/2)*(1+-1*x^3)^-1//2*(1+-1*x*2^1//3))+-2//9*2^1//3*3^3//4*((1+3^(1/2)+-1x)^-2*(1+-1x))^-1//2*((1+3^(1/2)+-1x)^-2*(1+x+x^2))^(1/2)*(1+-1*x^3)^-1//2*(2+3^(1/2))^(1/2)*(1+-1x)*Elliptic.F(arcsin((1+3^(1/2)+-1x)^-1*(1+-1x+-1*3^(1/2))),-7+-4*3^(1/2)))
	@test integrate((-1+x^3)^-1//2*(2^2//3+-1x)^-1, x) == :(-2//9*3^(1/2)*arctanh(3^(1/2)*(-1+x^3)^-1//2*(1+-1*x*2^1//3))+-2//9*2^1//3*3^3//4*((1+-1x+-1*3^(1/2))^-2*(1+x+x^2))^(1/2)*(-1*(1+-1x+-1*3^(1/2))^-2*(1+-1x))^-1//2*(-1+x^3)^-1//2*(2+-1*3^(1/2))^(1/2)*(1+-1x)*Elliptic.F(arcsin((1+-1x+-1*3^(1/2))^-1*(1+3^(1/2)+-1x)),-7+4*3^(1/2)))
	@test integrate((-1+-1*x^3)^-1//2*(x+2^2//3)^-1, x) == :(2//9*3^(1/2)*arctanh(3^(1/2)*(-1+-1*x^3)^-1//2*(1+x*2^1//3))+2//9*2^1//3*3^3//4*((1+x+-1*3^(1/2))^-2*(1+x^2+-1x))^(1/2)*(-1*(1+x+-1*3^(1/2))^-2*(1+x))^-1//2*(-1+-1*x^3)^-1//2*(2+-1*3^(1/2))^(1/2)*(1+x)*Elliptic.F(arcsin((1+x+-1*3^(1/2))^-1*(1+x+3^(1/2))),-7+4*3^(1/2)))
	@test integrate((a+b*x^3)^-1//2*(x*b^1//3+2^2//3*a^1//3)^-1, x) == :(2//9*3^(1/2)*a^-1//2*b^-1//3*arctan(3^(1/2)*a^1//6*(a+b*x^3)^-1//2*(a^1//3+x*2^1//3*b^1//3))+2//9*2^1//3*3^3//4*a^-1//3*b^-1//3*((x*b^1//3+a^1//3*(1+3^(1/2)))^-2*(a^2//3+b^2//3*x^2+-1*x*a^1//3*b^1//3))^(1/2)*(a^1//3*(x*b^1//3+a^1//3*(1+3^(1/2)))^-2*(a^1//3+x*b^1//3))^-1//2*(2+3^(1/2))^(1/2)*(a+b*x^3)^-1//2*(a^1//3+x*b^1//3)*Elliptic.F(arcsin((x*b^1//3+a^1//3*(1+3^(1/2)))^-1*(x*b^1//3+a^1//3*(1+-1*3^(1/2)))),-7+-4*3^(1/2)))
	@test integrate((a+-1*b*x^3)^-1//2*(2^2//3*a^1//3+-1*x*b^1//3)^-1, x) == :(-2//9*3^(1/2)*a^-1//2*b^-1//3*arctan(3^(1/2)*a^1//6*(a+-1*b*x^3)^-1//2*(a^1//3+-1*x*2^1//3*b^1//3))+-2//9*2^1//3*3^3//4*a^-1//3*b^-1//3*((a^1//3*(1+3^(1/2))+-1*x*b^1//3)^-2*(a^2//3+b^2//3*x^2+x*a^1//3*b^1//3))^(1/2)*(a^1//3*(a^1//3*(1+3^(1/2))+-1*x*b^1//3)^-2*(a^1//3+-1*x*b^1//3))^-1//2*(2+3^(1/2))^(1/2)*(a+-1*b*x^3)^-1//2*(a^1//3+-1*x*b^1//3)*Elliptic.F(arcsin((a^1//3*(1+3^(1/2))+-1*x*b^1//3)^-1*(a^1//3*(1+-1*3^(1/2))+-1*x*b^1//3)),-7+-4*3^(1/2)))
	@test integrate((-1a+b*x^3)^-1//2*(2^2//3*a^1//3+-1*x*b^1//3)^-1, x) == :(-2//9*3^(1/2)*a^-1//2*b^-1//3*arctanh(3^(1/2)*a^1//6*(-1a+b*x^3)^-1//2*(a^1//3+-1*x*2^1//3*b^1//3))+-2//9*2^1//3*3^3//4*a^-1//3*b^-1//3*((a^1//3*(1+-1*3^(1/2))+-1*x*b^1//3)^-2*(a^2//3+b^2//3*x^2+x*a^1//3*b^1//3))^(1/2)*(-1*a^1//3*(a^1//3*(1+-1*3^(1/2))+-1*x*b^1//3)^-2*(a^1//3+-1*x*b^1//3))^-1//2*(2+-1*3^(1/2))^(1/2)*(-1a+b*x^3)^-1//2*(a^1//3+-1*x*b^1//3)*Elliptic.F(arcsin((a^1//3*(1+-1*3^(1/2))+-1*x*b^1//3)^-1*(a^1//3*(1+3^(1/2))+-1*x*b^1//3)),-7+4*3^(1/2)))
	@test integrate((-1a+-1*b*x^3)^-1//2*(x*b^1//3+2^2//3*a^1//3)^-1, x) == :(2//9*3^(1/2)*a^-1//2*b^-1//3*arctanh(3^(1/2)*a^1//6*(-1a+-1*b*x^3)^-1//2*(a^1//3+x*2^1//3*b^1//3))+2//9*2^1//3*3^3//4*a^-1//3*b^-1//3*((x*b^1//3+a^1//3*(1+-1*3^(1/2)))^-2*(a^2//3+b^2//3*x^2+-1*x*a^1//3*b^1//3))^(1/2)*(-1*a^1//3*(x*b^1//3+a^1//3*(1+-1*3^(1/2)))^-2*(a^1//3+x*b^1//3))^-1//2*(2+-1*3^(1/2))^(1/2)*(-1a+-1*b*x^3)^-1//2*(a^1//3+x*b^1//3)*Elliptic.F(arcsin((x*b^1//3+a^1//3*(1+-1*3^(1/2)))^-1*(x*b^1//3+a^1//3*(1+3^(1/2)))),-7+4*3^(1/2)))
	@test integrate((c+d*x)^-1*(c^3+4*d^3*x^3)^-1//2, x) == :(2//9*3^(1/2)*c^-3//2*d^-1*arctan(3^(1/2)*c^(1/2)*(c^3+4*d^3*x^3)^-1//2*(c+2*d*x))+2//9*2^1//3*3^3//4*c^-1*d^-1*((c*(1+3^(1/2))+d*x*2^2//3)^-2*(c^2+2*2^1//3*d^2*x^2+-1*c*d*x*2^2//3))^(1/2)*(c*(c*(1+3^(1/2))+d*x*2^2//3)^-2*(c+d*x*2^2//3))^-1//2*(2+3^(1/2))^(1/2)*(c^3+4*d^3*x^3)^-1//2*(c+d*x*2^2//3)*Elliptic.F(arcsin((c*(1+3^(1/2))+d*x*2^2//3)^-1*(c*(1+-1*3^(1/2))+d*x*2^2//3)),-7+-4*3^(1/2)))
	@test integrate((1+x^3)^-1//2*(1+x+3^(1/2))^-1, x) == :((9+6*3^(1/2))^-1//2*arctan((1+x^3)^-1//2*(3+2*3^(1/2))^(1/2)*(1+x))+1//3*3^1//4*((1+x+3^(1/2))^-2*(1+x))^-1//2*((1+x+3^(1/2))^-2*(1+x^2+-1x))^(1/2)*(1+x^3)^-1//2*(2+3^(1/2))^(1/2)*(1+x)*Elliptic.F(arcsin((1+x+3^(1/2))^-1*(1+x+-1*3^(1/2))),-7+-4*3^(1/2)))
end

@testset "2.1 u (F^(c (a+b x)))^n.jl" begin
	@test integrate(F^(c*(a+b*x))*(d+e*x)^m, x) == :(F^(c*(a+-1*b*d*e^-1))*b^-1*c^-1*(-1*b*c*e^-1*(d+e*x)*log(F))^(-1m)*(d+e*x)^m*log(F)^-1*SpecialFunctions.gamma(1+m,-1*b*c*e^-1*(d+e*x)*log(F)))
	@test integrate(F^(c*(a+b*x))*(d+e*x)^4, x) == :(F^(c*(a+b*x))*b^-1*c^-1*(d+e*x)^4*log(F)^-1+24*F^(c*(a+b*x))*b^-5*c^-5*e^4*log(F)^-5+-24*F^(c*(a+b*x))*b^-4*c^-4*e^3*log(F)^-4*(d+e*x)+-4*e*F^(c*(a+b*x))*b^-2*c^-2*(d+e*x)^3*log(F)^-2+12*F^(c*(a+b*x))*b^-3*c^-3*e^2*(d+e*x)^2*log(F)^-3)
	@test integrate(F^(c*(a+b*x))*(d+e*x)^3, x) == :(F^(c*(a+b*x))*b^-1*c^-1*(d+e*x)^3*log(F)^-1+-6*F^(c*(a+b*x))*b^-4*c^-4*e^3*log(F)^-4+-3*e*F^(c*(a+b*x))*b^-2*c^-2*(d+e*x)^2*log(F)^-2+6*F^(c*(a+b*x))*b^-3*c^-3*e^2*log(F)^-3*(d+e*x))
	@test integrate(F^(c*(a+b*x))*(d+e*x)^2, x) == :(F^(c*(a+b*x))*b^-1*c^-1*(d+e*x)^2*log(F)^-1+2*F^(c*(a+b*x))*b^-3*c^-3*e^2*log(F)^-3+-2*e*F^(c*(a+b*x))*b^-2*c^-2*log(F)^-2*(d+e*x))
	@test integrate(F^(c*(a+b*x))*(d+e*x), x) == :(F^(c*(a+b*x))*b^-1*c^-1*log(F)^-1*(d+e*x)+-1*e*F^(c*(a+b*x))*b^-2*c^-2*log(F)^-2)
	@test integrate(F^(c*(a+b*x)), x) == :(F^(c*(a+b*x))*b^-1*c^-1*log(F)^-1)
	@test integrate(F^(c*(a+b*x))*(d+e*x)^-1, x) == :(F^(c*(a+-1*b*d*e^-1))*e^-1*expintegralei(b*c*e^-1*(d+e*x)*log(F)))
	@test integrate(F^(c*(a+b*x))*(d+e*x)^-2, x) == :(-1*F^(c*(a+b*x))*e^-1*(d+e*x)^-1+b*c*F^(c*(a+-1*b*d*e^-1))*e^-2*expintegralei(b*c*e^-1*(d+e*x)*log(F))*log(F))
	@test integrate(F^(c*(a+b*x))*(d+e*x)^-3, x) == :(-1//2*F^(c*(a+b*x))*e^-1*(d+e*x)^-2+(1/2)*F^(c*(a+-1*b*d*e^-1))*b^2*c^2*e^-3*log(F)^2*expintegralei(b*c*e^-1*(d+e*x)*log(F))+-1//2*b*c*F^(c*(a+b*x))*e^-2*(d+e*x)^-1*log(F))
	@test integrate(F^(c*(a+b*x))*(d+e*x)^-4, x) == :(-1//3*F^(c*(a+b*x))*e^-1*(d+e*x)^-3+-1//6*b*c*F^(c*(a+b*x))*e^-2*(d+e*x)^-2*log(F)+-1//6*F^(c*(a+b*x))*b^2*c^2*e^-3*(d+e*x)^-1*log(F)^2+1//6*F^(c*(a+-1*b*d*e^-1))*b^3*c^3*e^-4*log(F)^3*expintegralei(b*c*e^-1*(d+e*x)*log(F)))
end

@testset "2.2 (c+d x)^m (F^(g (e+f x)))^n (a+b (F^(g (e+f x)))^n)^p.jl" begin
	@test integrate(x^3*(a+b*exp(c+d*x))^-1, x) == :(1//4*a^-1*x^4+-6*a^-1*d^-4*Polylogarithms.polylog(4,-1*b*a^-1*exp(c+d*x))+-1*a^-1*d^-1*x^3*log(1+b*a^-1*exp(c+d*x))+-3*a^-1*d^-2*x^2*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x))+6*x*a^-1*d^-3*Polylogarithms.polylog(3,-1*b*a^-1*exp(c+d*x)))
	@test integrate(x^2*(a+b*exp(c+d*x))^-1, x) == :(1//3*a^-1*x^3+2*a^-1*d^-3*Polylogarithms.polylog(3,-1*b*a^-1*exp(c+d*x))+-1*a^-1*d^-1*x^2*log(1+b*a^-1*exp(c+d*x))+-2*x*a^-1*d^-2*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x)))
	@test integrate(x*(a+b*exp(c+d*x))^-1, x) == :((1/2)*a^-1*x^2+-1*a^-1*d^-2*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x))+-1*x*a^-1*d^-1*log(1+b*a^-1*exp(c+d*x)))
	@test integrate((a+b*exp(c+d*x))^-1, x) == :(x*a^-1+-1*a^-1*d^-1*log(a+b*exp(c+d*x)))
	@test integrate((a+b*exp(c+-1*d*x))^-1, x) == :(x*a^-1+a^-1*d^-1*log(a+b*exp(c+-1*d*x)))
	@test integrate((a+b*exp(-1c+-1*d*x))^-1, x) == :(x*a^-1+a^-1*d^-1*log(a+b*exp(-1c+-1*d*x)))
	@test integrate(x^3*(a+b*exp(c+d*x))^-2, x) == :(1//4*a^-2*x^4+-1*a^-2*d^-1*x^3+-6*a^-2*d^-4*Polylogarithms.polylog(3,-1*b*a^-1*exp(c+d*x))+-6*a^-2*d^-4*Polylogarithms.polylog(4,-1*b*a^-1*exp(c+d*x))+a^-1*d^-1*x^3*(a+b*exp(c+d*x))^-1+-1*a^-2*d^-1*x^3*log(1+b*a^-1*exp(c+d*x))+-3*a^-2*d^-2*x^2*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x))+3*a^-2*d^-2*x^2*log(1+b*a^-1*exp(c+d*x))+6*x*a^-2*d^-3*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x))+6*x*a^-2*d^-3*Polylogarithms.polylog(3,-1*b*a^-1*exp(c+d*x)))
	@test integrate(x^2*(a+b*exp(c+d*x))^-2, x) == :(1//3*a^-2*x^3+-1*a^-2*d^-1*x^2+2*a^-2*d^-3*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x))+2*a^-2*d^-3*Polylogarithms.polylog(3,-1*b*a^-1*exp(c+d*x))+a^-1*d^-1*x^2*(a+b*exp(c+d*x))^-1+-1*a^-2*d^-1*x^2*log(1+b*a^-1*exp(c+d*x))+-2*x*a^-2*d^-2*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x))+2*x*a^-2*d^-2*log(1+b*a^-1*exp(c+d*x)))
	@test integrate(x*(a+b*exp(c+d*x))^-2, x) == :((1/2)*a^-2*x^2+a^-2*d^-2*log(a+b*exp(c+d*x))+-1*x*a^-2*d^-1+-1*a^-2*d^-2*Polylogarithms.polylog(2,-1*b*a^-1*exp(c+d*x))+x*a^-1*d^-1*(a+b*exp(c+d*x))^-1+-1*x*a^-2*d^-1*log(1+b*a^-1*exp(c+d*x)))
	@test integrate((a+b*exp(c+d*x))^-2, x) == :(x*a^-2+a^-1*d^-1*(a+b*exp(c+d*x))^-1+-1*a^-2*d^-1*log(a+b*exp(c+d*x)))
end

@testset "2.3 Exponential functions.jl" begin
	@test integrate((4+6*exp(x))^-1*exp(x), x) == :(1//6*log(2+3*exp(x)))
	@test integrate((a+b*exp(x))^-1*exp(x), x) == :(b^-1*log(a+b*exp(x)))
	@test integrate((a+b*exp(c+d*x))^-1*exp(d*x), x) == :(b^-1*d^-1*exp(-1c)*log(a+b*exp(c+d*x)))
	@test integrate((a+b*exp(c+d*x))^-1*exp(c+d*x), x) == :(b^-1*d^-1*log(a+b*exp(c+d*x)))
	@test integrate((a+b*exp(x))^n*exp(x), x) == :(b^-1*(1+n)^-1*(a+b*exp(x))^(1+n))
	@test integrate((a+b*exp(c+d*x))^n*exp(d*x), x) == :(b^-1*d^-1*(1+n)^-1*(a+b*exp(c+d*x))^(1+n)*exp(-1c))
	@test integrate((a+b*exp(c+d*x))^n*exp(c+d*x), x) == :(b^-1*d^-1*(1+n)^-1*(a+b*exp(c+d*x))^(1+n))
	@test integrate(F^x*(a+b*F^x)^-1, x) == :(b^-1*log(F)^-1*log(a+b*F^x))
	@test integrate(F^(d*x)*(a+b*F^(c+d*x))^-1, x) == :(F^(-1c)*b^-1*d^-1*log(F)^-1*log(a+b*F^(c+d*x)))
	@test integrate(F^(c+d*x)*(a+b*F^(c+d*x))^-1, x) == :(b^-1*d^-1*log(F)^-1*log(a+b*F^(c+d*x)))
end

@testset "3.1.2 (d x)^m (a+b log(c x^n))^p.jl" begin
	@test integrate(x^3*log(c*x), x) == :(-1//16*x^4+1//4*x^4*log(c*x))
	@test integrate(x^2*log(c*x), x) == :(-1//9*x^3+1//3*x^3*log(c*x))
	@test integrate(x*log(c*x), x) == :(-1//4*x^2+(1/2)*x^2*log(c*x))
	@test integrate(log(c*x), x) == :(-1x+x*log(c*x))
	@test integrate(x^-1*log(c*x), x) == :((1/2)*log(c*x)^2)
	@test integrate(x^-2*log(c*x), x) == :(-1*x^-1+-1*x^-1*log(c*x))
	@test integrate(x^-3*log(c*x), x) == :(-1//4*x^-2+-1//2*x^-2*log(c*x))
	@test integrate(x^3*log(c*x)^2, x) == :(1//32*x^4+-1//8*x^4*log(c*x)+1//4*x^4*log(c*x)^2)
	@test integrate(x^2*log(c*x)^2, x) == :(2//27*x^3+-2//9*x^3*log(c*x)+1//3*x^3*log(c*x)^2)
	@test integrate(x*log(c*x)^2, x) == :(1//4*x^2+(1/2)*x^2*log(c*x)^2+-1//2*x^2*log(c*x))
end

@testset "3.1.4 (f x)^m (d+e x^r)^q (a+b log(c x^n))^p.jl" begin
	@test integrate(x^3*(a+b*log(c*x^n))*(d+e*x), x) == :((a+b*log(c*x^n))*(1//4*d*x^4+1//5*e*x^5)+-1//16*b*d*n*x^4+-1//25*b*e*n*x^5)
	@test integrate(x^2*(a+b*log(c*x^n))*(d+e*x), x) == :((a+b*log(c*x^n))*(1//3*d*x^3+1//4*e*x^4)+-1//9*b*d*n*x^3+-1//16*b*e*n*x^4)
	@test integrate(x*(a+b*log(c*x^n))*(d+e*x), x) == :((a+b*log(c*x^n))*((1/2)*d*x^2+1//3*e*x^3)+-1//4*b*d*n*x^2+-1//9*b*e*n*x^3)
	@test integrate((a+b*log(c*x^n))*(d+e*x), x) == :(d*x*(a+b*log(c*x^n))+(1/2)*e*x^2*(a+b*log(c*x^n))+-1*b*d*n*x+-1//4*b*e*n*x^2)
	@test integrate(x^-1*(a+b*log(c*x^n))*(d+e*x), x) == :(a*e*x+b*e*x*log(c*x^n)+(1/2)*d*b^-1*n^-1*(a+b*log(c*x^n))^2+-1*b*e*n*x)
	@test integrate(x^-3*(a+b*log(c*x^n))*(d+e*x), x) == :(-1*b*e*n*x^-1+-1//2*d^-1*x^-2*(d+e*x)^2*(a+b*log(c*x^n))+-1//4*b*d*n*x^-2+(1/2)*b*n*d^-1*e^2*log(x))
	@test integrate(x^-4*(a+b*log(c*x^n))*(d+e*x), x) == :(-1//2*e*x^-2*(a+b*log(c*x^n))+-1//3*d*x^-3*(a+b*log(c*x^n))+-1//4*b*e*n*x^-2+-1//9*b*d*n*x^-3)
	@test integrate(x^3*(d+e*x)^2*(a+b*log(c*x^n)), x) == :((a+b*log(c*x^n))*(1//4*d^2*x^4+1//6*e^2*x^6+2//5*d*e*x^5)+-1//16*b*n*d^2*x^4+-1//36*b*n*e^2*x^6+-2//25*b*d*e*n*x^5)
	@test integrate(x^2*(d+e*x)^2*(a+b*log(c*x^n)), x) == :((a+b*log(c*x^n))*(1//3*d^2*x^3+1//5*e^2*x^5+(1/2)*d*e*x^4)+-1//9*b*n*d^2*x^3+-1//25*b*n*e^2*x^5+-1//8*b*d*e*n*x^4)
	@test integrate(x*(d+e*x)^2*(a+b*log(c*x^n)), x) == :((a+b*log(c*x^n))*((1/2)*d^2*x^2+1//4*e^2*x^4+2//3*d*e*x^3)+-1//4*b*n*d^2*x^2+-1//16*b*n*e^2*x^4+-2//9*b*d*e*n*x^3)
end

@testset "3.1.5 u (a+b log(c x^n))^p.jl" begin
	@test integrate((d+e*x+f*x^2)^-1*(a+b*log(c*x^n)), x) == :((e^2+-4*d*f)^-1//2*(a+b*log(c*x^n))*log(1+2*f*x*(e+-1*(e^2+-4*d*f)^(1/2))^-1)+-1*(e^2+-4*d*f)^-1//2*(a+b*log(c*x^n))*log(1+2*f*x*(e+(e^2+-4*d*f)^(1/2))^-1)+b*n*(e^2+-4*d*f)^-1//2*Polylogarithms.polylog(2,-2*f*x*(e+-1*(e^2+-4*d*f)^(1/2))^-1)+-1*b*n*(e^2+-4*d*f)^-1//2*Polylogarithms.polylog(2,-2*f*x*(e+(e^2+-4*d*f)^(1/2))^-1))
	@test integrate(x^3*(a+b*log(c*x^n))*log(1+e*x), x) == :(-1//16*x^4*(a+b*log(c*x^n))+-1//4*e^-4*(a+b*log(c*x^n))*log(1+e*x)+-1//8*e^-2*x^2*(a+b*log(c*x^n))+1//4*x*e^-3*(a+b*log(c*x^n))+1//4*x^4*(a+b*log(c*x^n))*log(1+e*x)+1//12*e^-1*x^3*(a+b*log(c*x^n))+1//32*b*n*x^4+-7//144*b*n*e^-1*x^3+-5//16*b*n*x*e^-3+-1//4*b*n*e^-4*Polylogarithms.polylog(2,-1*e*x)+-1//16*b*n*x^4*log(1+e*x)+1//16*b*n*e^-4*log(1+e*x)+3//32*b*n*e^-2*x^2)
	@test integrate(x^2*(a+b*log(c*x^n))*log(1+e*x), x) == :(-1//9*x^3*(a+b*log(c*x^n))+-1//3*x*e^-2*(a+b*log(c*x^n))+1//3*e^-3*(a+b*log(c*x^n))*log(1+e*x)+1//3*x^3*(a+b*log(c*x^n))*log(1+e*x)+1//6*e^-1*x^2*(a+b*log(c*x^n))+2//27*b*n*x^3+-5//36*b*n*e^-1*x^2+-1//9*b*n*e^-3*log(1+e*x)+-1//9*b*n*x^3*log(1+e*x)+1//3*b*n*e^-3*Polylogarithms.polylog(2,-1*e*x)+4//9*b*n*x*e^-2)
	@test integrate(x*(a+b*log(c*x^n))*log(1+e*x), x) == :(-1//4*x^2*(a+b*log(c*x^n))+(1/2)*x*e^-1*(a+b*log(c*x^n))+(1/2)*x^2*(a+b*log(c*x^n))*log(1+e*x)+-1//2*e^-2*(a+b*log(c*x^n))*log(1+e*x)+1//4*b*n*x^2+-3//4*b*n*x*e^-1+-1//2*b*n*e^-2*Polylogarithms.polylog(2,-1*e*x)+-1//4*b*n*x^2*log(1+e*x)+1//4*b*n*e^-2*log(1+e*x))
	@test integrate((a+b*log(c*x^n))*log(1+e*x), x) == :(-1*x*(a+b*log(c*x^n))+2*b*n*x+b*n*e^-1*Polylogarithms.polylog(2,-1*e*x)+e^-1*(1+e*x)*(a+b*log(c*x^n))*log(1+e*x)+-1*b*n*e^-1*(1+e*x)*log(1+e*x))
	@test integrate(x^-1*(a+b*log(c*x^n))*log(1+e*x), x) == :(-1*(a+b*log(c*x^n))*Polylogarithms.polylog(2,-1*e*x)+b*n*Polylogarithms.polylog(3,-1*e*x))
	@test integrate(x^-2*(a+b*log(c*x^n))*log(1+e*x), x) == :(e*(a+b*log(c*x^n))*log(x)+-1*e*(a+b*log(c*x^n))*log(1+e*x)+-1*x^-1*(a+b*log(c*x^n))*log(1+e*x)+b*e*n*log(x)+-1*b*e*n*Polylogarithms.polylog(2,-1*e*x)+-1*b*e*n*log(1+e*x)+-1*b*n*x^-1*log(1+e*x)+-1//2*b*e*n*log(x)^2)
	@test integrate(x^-3*(a+b*log(c*x^n))*log(1+e*x), x) == :((1/2)*e^2*(a+b*log(c*x^n))*log(1+e*x)+-1//2*e*x^-1*(a+b*log(c*x^n))+-1//2*e^2*(a+b*log(c*x^n))*log(x)+-1//2*x^-2*(a+b*log(c*x^n))*log(1+e*x)+(1/2)*b*n*e^2*Polylogarithms.polylog(2,-1*e*x)+-3//4*b*e*n*x^-1+-1//4*b*n*e^2*log(x)+-1//4*b*n*x^-2*log(1+e*x)+1//4*b*n*e^2*log(x)^2+1//4*b*n*e^2*log(1+e*x))
	@test integrate(x^-4*(a+b*log(c*x^n))*log(1+e*x), x) == :(-1//3*e^3*(a+b*log(c*x^n))*log(1+e*x)+-1//3*x^-3*(a+b*log(c*x^n))*log(1+e*x)+-1//6*e*x^-2*(a+b*log(c*x^n))+1//3*e^2*x^-1*(a+b*log(c*x^n))+1//3*e^3*(a+b*log(c*x^n))*log(x)+-5//36*b*e*n*x^-2+-1//3*b*n*e^3*Polylogarithms.polylog(2,-1*e*x)+-1//6*b*n*e^3*log(x)^2+-1//9*b*n*e^3*log(1+e*x)+-1//9*b*n*x^-3*log(1+e*x)+1//9*b*n*e^3*log(x)+4//9*b*n*e^2*x^-1)
	@test integrate(x^3*(a+b*log(c*x^n))^2*log(1+e*x), x) == :(-1//16*x^4*(a+b*log(c*x^n))^2+-3//128*b^2*n^2*x^4+-1//4*e^-4*(a+b*log(c*x^n))^2*log(1+e*x)+-1//8*e^-2*x^2*(a+b*log(c*x^n))^2+1//4*x*e^-3*(a+b*log(c*x^n))^2+1//4*x^4*(a+b*log(c*x^n))^2*log(1+e*x)+1//12*e^-1*x^3*(a+b*log(c*x^n))^2+(1/2)*b^2*e^-4*n^2*Polylogarithms.polylog(3,-1*e*x)+-7//64*b^2*e^-2*n^2*x^2+-1//32*b^2*e^-4*n^2*log(1+e*x)+1//8*b^2*e^-4*n^2*Polylogarithms.polylog(2,-1*e*x)+1//16*b*n*x^4*(a+b*log(c*x^n))+1//32*b^2*n^2*x^4*log(1+e*x)+21//32*x*b^2*e^-3*n^2+37//864*b^2*e^-1*n^2*x^3+-7//72*b*n*e^-1*x^3*(a+b*log(c*x^n))+-1//2*a*b*n*x*e^-3+-1//2*b*n*e^-4*(a+b*log(c*x^n))*Polylogarithms.polylog(2,-1*e*x)+-1//2*n*x*b^2*e^-3*log(c*x^n)+-1//8*b*n*x*e^-3*(a+b*log(c*x^n))+-1//8*b*n*x^4*(a+b*log(c*x^n))*log(1+e*x)+1//8*b*n*e^-4*(a+b*log(c*x^n))*log(1+e*x)+3//16*b*n*e^-2*x^2*(a+b*log(c*x^n)))
end

@testset "3.2.1 (f+g x)^m (A+B log(e ((a+b x) over (c+d x))^n))^p.jl" begin
	@test integrate((a*g+b*g*x)^4*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(1//5*b^-1*g^4*(a+b*x)^5*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+1//5*B*n*x*d^-4*g^4*(b*c+-1*a*d)^4+-1//5*B*n*b^-1*d^-5*g^4*(b*c+-1*a*d)^5*log(c+d*x)+-1//10*B*n*b^-1*d^-3*g^4*(a+b*x)^2*(b*c+-1*a*d)^3+-1//20*B*n*b^-1*d^-1*g^4*(a+b*x)^4*(b*c+-1*a*d)+1//15*B*n*b^-1*d^-2*g^4*(a+b*x)^3*(b*c+-1*a*d)^2)
	@test integrate((a*g+b*g*x)^3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(1//4*b^-1*g^3*(a+b*x)^4*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+-1//4*B*n*x*d^-3*g^3*(b*c+-1*a*d)^3+-1//12*B*n*b^-1*d^-1*g^3*(a+b*x)^3*(b*c+-1*a*d)+1//4*B*n*b^-1*d^-4*g^3*(b*c+-1*a*d)^4*log(c+d*x)+1//8*B*n*b^-1*d^-2*g^3*(a+b*x)^2*(b*c+-1*a*d)^2)
	@test integrate((a*g+b*g*x)^2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(1//3*b^-1*g^2*(a+b*x)^3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+1//3*B*n*x*d^-2*g^2*(b*c+-1*a*d)^2+-1//3*B*n*b^-1*d^-3*g^2*(b*c+-1*a*d)^3*log(c+d*x)+-1//6*B*n*b^-1*d^-1*g^2*(a+b*x)^2*(b*c+-1*a*d))
	@test integrate((A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(a*g+b*g*x), x) == :((1/2)*g*b^-1*(a+b*x)^2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+-1//2*B*g*n*x*d^-1*(b*c+-1*a*d)+(1/2)*B*g*n*b^-1*d^-2*(b*c+-1*a*d)^2*log(c+d*x))
	@test integrate((a*g+b*g*x)^-1*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(-1*b^-1*g^-1*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*log(-1*d^-1*(a+b*x)^-1*(b*c+-1*a*d))+B*n*b^-1*g^-1*Polylogarithms.polylog(2,1+d^-1*(a+b*x)^-1*(b*c+-1*a*d)))
	@test integrate((a*g+b*g*x)^-3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(-1//2*b^-1*g^-3*(a+b*x)^-2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+-1//4*B*n*b^-1*g^-3*(a+b*x)^-2+(1/2)*B*d*n*b^-1*g^-3*(a+b*x)^-1*(b*c+-1*a*d)^-1+(1/2)*B*n*b^-1*d^2*g^-3*(b*c+-1*a*d)^-2*log(a+b*x)+-1//2*B*n*b^-1*d^2*g^-3*(b*c+-1*a*d)^-2*log(c+d*x))
	@test integrate((a*g+b*g*x)^-4*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(-1//3*b^-1*g^-4*(a+b*x)^-3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+-1//9*B*n*b^-1*g^-4*(a+b*x)^-3+-1//3*B*n*b^-1*d^2*g^-4*(a+b*x)^-1*(b*c+-1*a*d)^-2+-1//3*B*n*b^-1*d^3*g^-4*(b*c+-1*a*d)^-3*log(a+b*x)+1//3*B*n*b^-1*d^3*g^-4*(b*c+-1*a*d)^-3*log(c+d*x)+1//6*B*d*n*b^-1*g^-4*(a+b*x)^-2*(b*c+-1*a*d)^-1)
	@test integrate((a*g+b*g*x)^-5*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(-1//4*b^-1*g^-5*(a+b*x)^-4*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+-1//16*B*n*b^-1*g^-5*(a+b*x)^-4+-1//4*B*n*b^-1*d^4*g^-5*(b*c+-1*a*d)^-4*log(c+d*x)+-1//8*B*n*b^-1*d^2*g^-5*(a+b*x)^-2*(b*c+-1*a*d)^-2+1//4*B*n*b^-1*d^3*g^-5*(a+b*x)^-1*(b*c+-1*a*d)^-3+1//4*B*n*b^-1*d^4*g^-5*(b*c+-1*a*d)^-4*log(a+b*x)+1//12*B*d*n*b^-1*g^-5*(a+b*x)^-3*(b*c+-1*a*d)^-1)
	@test integrate((A+B*log(e*((c+d*x)^-1*(a+b*x))^n))^2*(a*g+b*g*x)^4, x) == :(1//5*b^-1*g^4*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))^2*(a+b*x)^5+2//5*B^2*b^-1*d^-5*g^4*n^2*(b*c+-1*a*d)^5*Polylogarithms.polylog(2,d*b^-1*(c+d*x)^-1*(a+b*x))+-1//10*B*n*b^-1*d^-1*g^4*(a+b*x)^4*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(b*c+-1*a*d)+-1//60*B*n*b^-1*d^-3*g^4*(a+b*x)^2*(b*c+-1*a*d)^3*(12A+7*B*n+12*B*log(e*((c+d*x)^-1*(a+b*x))^n))+1//30*B*n*b^-1*d^-5*g^4*(b*c+-1*a*d)^5*(12A+12*B*log(e*((c+d*x)^-1*(a+b*x))^n)+25*B*n)*log(b^-1*(c+d*x)^-1*(b*c+-1*a*d))+1//30*B*n*b^-1*d^-4*g^4*(b*c+-1*a*d)^4*(a+b*x)*(12A+12*B*log(e*((c+d*x)^-1*(a+b*x))^n)+13*B*n)+1//30*B*n*b^-1*d^-2*g^4*(a+b*x)^3*(b*c+-1*a*d)^2*(4A+B*n+4*B*log(e*((c+d*x)^-1*(a+b*x))^n)))
	@test integrate((A+B*log(e*((c+d*x)^-1*(a+b*x))^n))^2*(a*g+b*g*x)^3, x) == :(1//4*b^-1*g^3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))^2*(a+b*x)^4+-1//2*B^2*b^-1*d^-4*g^3*n^2*(b*c+-1*a*d)^4*Polylogarithms.polylog(2,d*b^-1*(c+d*x)^-1*(a+b*x))+-1//6*B*n*b^-1*d^-1*g^3*(a+b*x)^3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(b*c+-1*a*d)+-1//12*B*n*b^-1*d^-4*g^3*(b*c+-1*a*d)^4*(6A+6*B*log(e*((c+d*x)^-1*(a+b*x))^n)+11*B*n)*log(b^-1*(c+d*x)^-1*(b*c+-1*a*d))+-1//12*B*n*b^-1*d^-3*g^3*(b*c+-1*a*d)^3*(a+b*x)*(6A+5*B*n+6*B*log(e*((c+d*x)^-1*(a+b*x))^n))+1//12*B*n*b^-1*d^-2*g^3*(a+b*x)^2*(b*c+-1*a*d)^2*(3A+B*n+3*B*log(e*((c+d*x)^-1*(a+b*x))^n)))
end

@testset "3.2.2 (f+g x)^m (h+i x)^q (A+B log(e ((a+b x) over (c+d x))^n))^p.jl" begin
	@test integrate((a*g+b*g*x)^3*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :(1//5*i*b^-1*g^3*(a+b*x)^4*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c+d*x)+1//20*i*b^-2*g^3*(a+b*x)^4*(b*c+-1*a*d)*(A+-1B+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//20*B*i*x*b^-1*d^-3*g^3*(b*c+-1*a*d)^4+-1//60*B*i*b^-2*d^-1*g^3*(a+b*x)^3*(b*c+-1*a*d)^2+1//20*B*i*b^-2*d^-4*g^3*(b*c+-1*a*d)^5*log(c+d*x)+1//40*B*i*b^-2*d^-2*g^3*(a+b*x)^2*(b*c+-1*a*d)^3)
	@test integrate((a*g+b*g*x)^2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :(1//4*i*b^-1*g^2*(a+b*x)^3*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c+d*x)+1//12*i*b^-2*g^2*(a+b*x)^3*(b*c+-1*a*d)*(A+-1B+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//12*B*i*b^-2*d^-3*g^2*(b*c+-1*a*d)^4*log(c+d*x)+-1//24*B*i*b^-2*d^-1*g^2*(a+b*x)^2*(b*c+-1*a*d)^2+1//12*B*i*x*b^-1*d^-2*g^2*(b*c+-1*a*d)^3)
	@test integrate((A+B*log(e*(c+d*x)^-1*(a+b*x)))*(a*g+b*g*x)*(c*i+d*i*x), x) == :(1//3*g*i*b^-1*(a+b*x)^2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c+d*x)+1//6*g*i*b^-2*(a+b*x)^2*(b*c+-1*a*d)*(A+-1B+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//6*B*g*i*x*b^-1*d^-1*(b*c+-1*a*d)^2+1//6*B*g*i*b^-2*d^-2*(b*c+-1*a*d)^3*log(c+d*x))
	@test integrate((A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :((1/2)*i*d^-1*(c+d*x)^2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//2*B*i*x*b^-1*(b*c+-1*a*d)+-1//2*B*i*b^-2*d^-1*(b*c+-1*a*d)^2*log(a+b*x))
	@test integrate((a*g+b*g*x)^-1*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :(i*b^-1*g^-1*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c+d*x)+B*i*b^-2*g^-1*(b*c+-1*a*d)*Polylogarithms.polylog(2,1+d^-1*(a+b*x)^-1*(b*c+-1*a*d))+-1*i*b^-2*g^-1*(b*c+-1*a*d)*(A+-1B+B*log(e*(c+d*x)^-1*(a+b*x)))*log(-1*d^-1*(a+b*x)^-1*(b*c+-1*a*d)))
	@test integrate((a*g+b*g*x)^-2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :(B*d*i*b^-2*g^-2*Polylogarithms.polylog(2,b*d^-1*(a+b*x)^-1*(c+d*x))+-1*B*i*b^-1*g^-2*(a+b*x)^-1*(c+d*x)+-1*d*i*b^-2*g^-2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*log(1+-1*b*d^-1*(a+b*x)^-1*(c+d*x))+-1*i*b^-1*g^-2*(a+b*x)^-1*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c+d*x))
	@test integrate((a*g+b*g*x)^-3*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :(-1*B*i*g^-3*(a+b*x)^-2*(c+d*x)^2*(-4*a*d+4*b*c)^-1+-1*i*g^-3*(a+b*x)^-2*(c+d*x)^2*(-2*a*d+2*b*c)^-1*(A+B*log(e*(c+d*x)^-1*(a+b*x))))
	@test integrate((a*g+b*g*x)^-4*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :((1/2)*d*i*g^-4*(a+b*x)^-2*(c+d*x)^2*(b*c+-1*a*d)^-2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//3*b*i*g^-4*(a+b*x)^-3*(c+d*x)^3*(b*c+-1*a*d)^-2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//9*B*b*i*g^-4*(a+b*x)^-3*(c+d*x)^3*(b*c+-1*a*d)^-2+1//4*B*d*i*g^-4*(a+b*x)^-2*(c+d*x)^2*(b*c+-1*a*d)^-2)
	@test integrate((a*g+b*g*x)^-5*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(c*i+d*i*x), x) == :(-1//2*i*d^2*g^-5*(a+b*x)^-2*(c+d*x)^2*(b*c+-1*a*d)^-3*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//4*B*i*d^2*g^-5*(a+b*x)^-2*(c+d*x)^2*(b*c+-1*a*d)^-3+-1//4*i*b^2*g^-5*(a+b*x)^-4*(c+d*x)^4*(b*c+-1*a*d)^-3*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+-1//16*B*i*b^2*g^-5*(a+b*x)^-4*(c+d*x)^4*(b*c+-1*a*d)^-3+2//3*b*d*i*g^-5*(a+b*x)^-3*(c+d*x)^3*(b*c+-1*a*d)^-3*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+2//9*B*b*d*i*g^-5*(a+b*x)^-3*(c+d*x)^3*(b*c+-1*a*d)^-3)
	@test integrate((a*g+b*g*x)^3*(c*i+d*i*x)^2*(A+B*log(e*(c+d*x)^-1*(a+b*x))), x) == :(-19//180*B*d^-4*g^3*i^2*(c+d*x)^3*(b*c+-1*a*d)^3+-1//3*d^-4*g^3*i^2*(c+d*x)^3*(b*c+-1*a*d)^3*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+1//6*b^3*d^-4*g^3*i^2*(c+d*x)^6*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+-3//5*b^2*d^-4*g^3*i^2*(c+d*x)^5*(A+B*log(e*(c+d*x)^-1*(a+b*x)))*(b*c+-1*a*d)+-1//30*B*b^2*d^-4*g^3*i^2*(c+d*x)^5*(b*c+-1*a*d)+1//60*B*x*b^-2*d^-3*g^3*i^2*(b*c+-1*a*d)^5+1//60*B*b^-3*d^-4*g^3*i^2*(b*c+-1*a*d)^6*log((c+d*x)^-1*(a+b*x))+1//60*B*b^-3*d^-4*g^3*i^2*(b*c+-1*a*d)^6*log(c+d*x)+1//120*B*b^-1*d^-4*g^3*i^2*(c+d*x)^2*(b*c+-1*a*d)^4+3//4*b*d^-4*g^3*i^2*(c+d*x)^4*(b*c+-1*a*d)^2*(A+B*log(e*(c+d*x)^-1*(a+b*x)))+13//120*B*b*d^-4*g^3*i^2*(c+d*x)^4*(b*c+-1*a*d)^2)
end

@testset "3.2.3 u log(e (f (a+b x)^p (c+d x)^q)^r)^s.jl" begin
	@test integrate((f+g*x^-1)^3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(A*x*f^3+-1//2*g^3*x^-2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+3*g*f^2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*log(x)+B*b^-1*f^3*(a+b*x)*log(e*((c+d*x)^-1*(a+b*x))^n)+-3*B*g*n*f^2*Polylogarithms.polylog(2,-1*b*x*a^-1)+3*B*g*n*f^2*Polylogarithms.polylog(2,-1*d*x*c^-1)+-1//2*B*n*g^3*(a^-2*b^2+-1*c^-2*d^2)*log(x)+(1/2)*B*n*a^-2*b^2*g^3*log(a+b*x)+-3*B*g*n*f^2*log(x)*log(1+b*x*a^-1)+3*B*g*n*f^2*log(x)*log(1+d*x*c^-1)+-1//2*B*n*c^-2*d^2*g^3*log(c+d*x)+-1*B*n*b^-1*d^-1*f^3*(b*c+-1*a*d)*log(c+d*x)+-1//2*B*n*a^-1*c^-1*g^3*x^-1*(b*c+-1*a*d)+f*a^-1*g^2*(a+-1*c*(c+d*x)^-1*(a+b*x))^-1*(c+d*x)^-1*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(a+b*x)*(-3*a*d+3*b*c)+3*B*f*n*a^-1*c^-1*g^2*(b*c+-1*a*d)*log(a+-1*c*(c+d*x)^-1*(a+b*x)))
	@test integrate((f+g*x^-1)^2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(A*x*f^2+2*f*g*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*log(x)+B*b^-1*f^2*(a+b*x)*log(e*((c+d*x)^-1*(a+b*x))^n)+-2*B*f*g*n*Polylogarithms.polylog(2,-1*b*x*a^-1)+2*B*f*g*n*Polylogarithms.polylog(2,-1*d*x*c^-1)+-2*B*f*g*n*log(x)*log(1+b*x*a^-1)+2*B*f*g*n*log(x)*log(1+d*x*c^-1)+B*n*a^-1*c^-1*g^2*(b*c+-1*a*d)*log(a+-1*c*(c+d*x)^-1*(a+b*x))+a^-1*g^2*(a+-1*c*(c+d*x)^-1*(a+b*x))^-1*(c+d*x)^-1*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(a+b*x)*(b*c+-1*a*d)+-1*B*n*b^-1*d^-1*f^2*(b*c+-1*a*d)*log(c+d*x))
	@test integrate((A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(f+g*x^-1), x) == :(A*f*x+g*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*log(x)+B*g*n*Polylogarithms.polylog(2,-1*d*x*c^-1)+-1*B*g*n*Polylogarithms.polylog(2,-1*b*x*a^-1)+B*f*b^-1*(a+b*x)*log(e*((c+d*x)^-1*(a+b*x))^n)+B*g*n*log(x)*log(1+d*x*c^-1)+-1*B*g*n*log(x)*log(1+b*x*a^-1)+-1*B*f*n*b^-1*d^-1*(b*c+-1*a*d)*log(c+d*x))
	@test integrate((f+g*x^-1)^-1*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(A*x*f^-1+-1*g*f^-2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*log(g+f*x)+B*g*n*f^-2*Polylogarithms.polylog(2,-1*b*(a*f+-1*b*g)^-1*(g+f*x))+B*b^-1*f^-1*(a+b*x)*log(e*((c+d*x)^-1*(a+b*x))^n)+-1*B*g*n*f^-2*Polylogarithms.polylog(2,-1*d*(c*f+-1*d*g)^-1*(g+f*x))+B*g*n*f^-2*log(f*(a*f+-1*b*g)^-1*(a+b*x))*log(g+f*x)+-1*B*g*n*f^-2*log(f*(c*f+-1*d*g)^-1*(c+d*x))*log(g+f*x)+-1*B*n*b^-1*d^-1*f^-1*(b*c+-1*a*d)*log(c+d*x))
	@test integrate((f+g*x^-1)^-2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(A*x*f^-2+-2*g*f^-3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*log(g+f*x)+B*b^-1*f^-2*(a+b*x)*log(e*((c+d*x)^-1*(a+b*x))^n)+-2*B*g*n*f^-3*Polylogarithms.polylog(2,-1*d*(c*f+-1*d*g)^-1*(g+f*x))+2*B*g*n*f^-3*Polylogarithms.polylog(2,-1*b*(a*f+-1*b*g)^-1*(g+f*x))+-1*f^-2*g^2*(g+f*x)^-1*(a*f+-1*b*g)^-1*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(a+b*x)+-2*B*g*n*f^-3*log(f*(c*f+-1*d*g)^-1*(c+d*x))*log(g+f*x)+2*B*g*n*f^-3*log(f*(a*f+-1*b*g)^-1*(a+b*x))*log(g+f*x)+-1*B*n*b^-1*d^-1*f^-2*(b*c+-1*a*d)*log(c+d*x)+B*n*f^-2*g^2*(a*f+-1*b*g)^-1*(c*f+-1*d*g)^-1*(b*c+-1*a*d)*log((c+d*x)^-1*(g+f*x)))
	@test integrate((f+g*x^-1)^-3*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n)), x) == :(A*x*f^-3+(1/2)*f^-4*g^3*(g+f*x)^-2*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))+-3*g*f^-4*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*log(g+f*x)+B*b^-1*f^-3*(a+b*x)*log(e*((c+d*x)^-1*(a+b*x))^n)+-3*B*g*n*f^-4*Polylogarithms.polylog(2,-1*d*(c*f+-1*d*g)^-1*(g+f*x))+3*B*g*n*f^-4*Polylogarithms.polylog(2,-1*b*(a*f+-1*b*g)^-1*(g+f*x))+-3*B*g*n*f^-4*log(f*(c*f+-1*d*g)^-1*(c+d*x))*log(g+f*x)+-3*f^-3*g^2*(g+f*x)^-1*(a*f+-1*b*g)^-1*(A+B*log(e*((c+d*x)^-1*(a+b*x))^n))*(a+b*x)+3*B*g*n*f^-4*log(f*(a*f+-1*b*g)^-1*(a+b*x))*log(g+f*x)+(1/2)*B*n*d^2*f^-4*g^3*(c*f+-1*d*g)^-2*log(c+d*x)+-1*B*n*b^-1*d^-1*f^-3*(b*c+-1*a*d)*log(c+d*x)+-1//2*B*n*b^2*f^-4*g^3*(a*f+-1*b*g)^-2*log(a+b*x)+(1/2)*B*n*f^-3*g^3*(g+f*x)^-1*(a*f+-1*b*g)^-1*(c*f+-1*d*g)^-1*(b*c+-1*a*d)+3*B*n*f^-3*g^2*(a*f+-1*b*g)^-1*(c*f+-1*d*g)^-1*(b*c+-1*a*d)*log((c+d*x)^-1*(g+f*x))+(1/2)*B*n*f^-3*g^3*(a*f+-1*b*g)^-2*(c*f+-1*d*g)^-2*(b*c+-1*a*d)*(a*d*f+b*c*f+-2*b*d*g)*log(g+f*x))
	@test integrate((a+b*x)^4*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r), x) == :(1//5*b^-1*(a+b*x)^5*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r)+-1//25*p*r*b^-1*(a+b*x)^5+-1//25*q*r*b^-1*(a+b*x)^5+-1//5*q*r*x*d^-4*(b*c+-1*a*d)^4+-1//15*q*r*b^-1*d^-2*(a+b*x)^3*(b*c+-1*a*d)^2+1//5*q*r*b^-1*d^-5*(b*c+-1*a*d)^5*log(c+d*x)+1//10*q*r*b^-1*d^-3*(a+b*x)^2*(b*c+-1*a*d)^3+1//20*q*r*b^-1*d^-1*(a+b*x)^4*(b*c+-1*a*d))
	@test integrate((a+b*x)^3*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r), x) == :(1//4*b^-1*(a+b*x)^4*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r)+-1//16*p*r*b^-1*(a+b*x)^4+-1//16*q*r*b^-1*(a+b*x)^4+1//4*q*r*x*d^-3*(b*c+-1*a*d)^3+-1//4*q*r*b^-1*d^-4*(b*c+-1*a*d)^4*log(c+d*x)+-1//8*q*r*b^-1*d^-2*(a+b*x)^2*(b*c+-1*a*d)^2+1//12*q*r*b^-1*d^-1*(a+b*x)^3*(b*c+-1*a*d))
	@test integrate((a+b*x)^2*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r), x) == :(1//3*b^-1*(a+b*x)^3*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r)+-1//9*p*r*b^-1*(a+b*x)^3+-1//9*q*r*b^-1*(a+b*x)^3+-1//3*q*r*x*d^-2*(b*c+-1*a*d)^2+1//3*q*r*b^-1*d^-3*(b*c+-1*a*d)^3*log(c+d*x)+1//6*q*r*b^-1*d^-1*(a+b*x)^2*(b*c+-1*a*d))
	@test integrate((a+b*x)*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r), x) == :((1/2)*b^-1*(a+b*x)^2*log(e*(f*(a+b*x)^p*(c+d*x)^q)^r)+-1//2*a*p*r*x+-1//4*b*p*r*x^2+-1//4*q*r*b^-1*(a+b*x)^2+(1/2)*q*r*x*d^-1*(b*c+-1*a*d)+-1//2*q*r*b^-1*d^-2*(b*c+-1*a*d)^2*log(c+d*x))
end

@testset "3.3 u (a+b log(c (d+e x)^n))^p.jl" begin
	@test integrate(log(c*(d+e*x))^4, x) == :(24x+e^-1*log(c*(d+e*x))^2*(12d+12*e*x)+e^-1*log(c*(d+e*x))^4*(d+e*x)+-1*e^-1*log(c*(d+e*x))^3*(4d+4*e*x)+-1*e^-1*(24d+24*e*x)*log(c*(d+e*x)))
	@test integrate(log(c*(d+e*x))^3, x) == :(-6x+e^-1*log(c*(d+e*x))^3*(d+e*x)+e^-1*(6d+6*e*x)*log(c*(d+e*x))+-1*e^-1*log(c*(d+e*x))^2*(3d+3*e*x))
	@test integrate(log(c*(d+e*x))^2, x) == :(2x+e^-1*log(c*(d+e*x))^2*(d+e*x)+-1*e^-1*(2d+2*e*x)*log(c*(d+e*x)))
	@test integrate(log(c*(d+e*x)), x) == :(-1x+e^-1*(d+e*x)*log(c*(d+e*x)))
	@test integrate(log(c*(d+e*x))^-1, x) == :(c^-1*e^-1*logintegral(c*(d+e*x)))
	@test integrate(log(c*(d+e*x))^-2, x) == :(c^-1*e^-1*logintegral(c*(d+e*x))+-1*e^-1*log(c*(d+e*x))^-1*(d+e*x))
	@test integrate(log(c*(d+e*x))^-3, x) == :((1/2)*c^-1*e^-1*logintegral(c*(d+e*x))+-1//2*e^-1*log(c*(d+e*x))^-1*(d+e*x)+-1//2*e^-1*log(c*(d+e*x))^-2*(d+e*x))
	@test integrate(log(c*(d+e*x))^-4, x) == :(-1//3*e^-1*log(c*(d+e*x))^-3*(d+e*x)+-1//6*e^-1*log(c*(d+e*x))^-1*(d+e*x)+-1//6*e^-1*log(c*(d+e*x))^-2*(d+e*x)+1//6*c^-1*e^-1*logintegral(c*(d+e*x)))
	@test integrate(log(c*(d+e*x))^5//2, x) == :(e^-1*log(c*(d+e*x))^5//2*(d+e*x)+-1//2*e^-1*log(c*(d+e*x))^3//2*(5d+5*e*x)+1//4*e^-1*log(c*(d+e*x))^(1/2)*(15d+15*e*x)+-15//8*pi^(1/2)*c^-1*e^-1*erfi(log(c*(d+e*x))^(1/2)))
	@test integrate(log(c*(d+e*x))^3//2, x) == :(e^-1*log(c*(d+e*x))^3//2*(d+e*x)+-1//2*e^-1*log(c*(d+e*x))^(1/2)*(3d+3*e*x)+3//4*pi^(1/2)*c^-1*e^-1*erfi(log(c*(d+e*x))^(1/2)))
end

@testset "3.4 u (a+b log(c (d+e x^m)^n))^p.jl" begin
	@test integrate(x^4*log(c*(a+b*x^2)^p), x) == :(-2//25*p*x^5+1//5*x^5*log(c*(a+b*x^2)^p)+-2//5*p*x*a^2*b^-2+2//5*p*a^5//2*b^-5//2*arctan(x*a^-1//2*b^(1/2))+2//15*a*p*b^-1*x^3)
	@test integrate(x^3*log(c*(a+b*x^2)^p), x) == :(-1//8*p*x^4+1//4*x^4*log(c*(a+b*x^2)^p)+-1//4*p*a^2*b^-2*log(a+b*x^2)+1//4*a*p*b^-1*x^2)
	@test integrate(x^2*log(c*(a+b*x^2)^p), x) == :(-2//9*p*x^3+1//3*x^3*log(c*(a+b*x^2)^p)+-2//3*p*a^3//2*b^-3//2*arctan(x*a^-1//2*b^(1/2))+2//3*a*p*x*b^-1)
	@test integrate(x*log(c*(a+b*x^2)^p), x) == :(-1//2*p*x^2+(1/2)*b^-1*(a+b*x^2)*log(c*(a+b*x^2)^p))
	@test integrate(log(c*(a+b*x^2)^p), x) == :(x*log(c*(a+b*x^2)^p)+-2*p*x+2*p*a^(1/2)*b^-1//2*arctan(x*a^-1//2*b^(1/2)))
	@test integrate(x^-1*log(c*(a+b*x^2)^p), x) == :((1/2)*p*Polylogarithms.polylog(2,1+b*a^-1*x^2)+(1/2)*log(c*(a+b*x^2)^p)*log(-1*b*a^-1*x^2))
	@test integrate(x^-2*log(c*(a+b*x^2)^p), x) == :(-1*x^-1*log(c*(a+b*x^2)^p)+2*p*a^-1//2*b^(1/2)*arctan(x*a^-1//2*b^(1/2)))
	@test integrate(x^-4*log(c*(a+b*x^2)^p), x) == :(-1//3*x^-3*log(c*(a+b*x^2)^p)+-2//3*b*p*a^-1*x^-1+-2//3*p*a^-3//2*b^3//2*arctan(x*a^-1//2*b^(1/2)))
	@test integrate(x^-5*log(c*(a+b*x^2)^p), x) == :(-1//4*x^-4*log(c*(a+b*x^2)^p)+-1//2*p*a^-2*b^2*log(x)+-1//4*b*p*a^-1*x^-2+1//4*p*a^-2*b^2*log(a+b*x^2))
	@test integrate(x^-6*log(c*(a+b*x^2)^p), x) == :(-1//5*x^-5*log(c*(a+b*x^2)^p)+-2//15*b*p*a^-1*x^-3+2//5*p*a^-2*b^2*x^-1+2//5*p*a^-5//2*b^5//2*arctan(x*a^-1//2*b^(1/2)))
end

@testset "3.5 Logarithm functions.jl" begin
	@test integrate(x^-1*(a*x^m+b*log(c*x^n)^q)^3*log(c*x^n)^(-1+q), x) == :(1//4*b^3*n^-1*q^-1*log(c*x^n)^(4q)+-1*3^(-1q)*a^3*n^-1*x^(3m)*(c*x^n)^(-3*m*n^-1)*(-1*m*n^-1*log(c*x^n))^(-1q)*log(c*x^n)^q*SpecialFunctions.gamma(q,-3*m*n^-1*log(c*x^n))+-3*a*b^2*n^-1*x^m*(c*x^n)^(-1*m*n^-1)*(-1*m*n^-1*log(c*x^n))^(-3q)*log(c*x^n)^(3q)*SpecialFunctions.gamma(3q,-1*m*n^-1*log(c*x^n))+-3*b*4^(-1q)*a^2*n^-1*x^(2m)*(c*x^n)^(-2*m*n^-1)*(-1*m*n^-1*log(c*x^n))^(-2q)*log(c*x^n)^(2q)*SpecialFunctions.gamma(2q,-2*m*n^-1*log(c*x^n)))
	@test integrate(x^-1*(a*x^m+b*log(c*x^n)^q)^2*log(c*x^n)^(-1+q), x) == :(1//3*b^2*n^-1*q^-1*log(c*x^n)^(3q)+-1*2^(-1q)*a^2*n^-1*x^(2m)*(c*x^n)^(-2*m*n^-1)*(-1*m*n^-1*log(c*x^n))^(-1q)*log(c*x^n)^q*SpecialFunctions.gamma(q,-2*m*n^-1*log(c*x^n))+-2*a*b*n^-1*x^m*(c*x^n)^(-1*m*n^-1)*(-1*m*n^-1*log(c*x^n))^(-2q)*log(c*x^n)^(2q)*SpecialFunctions.gamma(2q,-1*m*n^-1*log(c*x^n)))
	@test integrate(x^-1*log(c*x^n)^(-1+q)*(a*x^m+b*log(c*x^n)^q), x) == :((1/2)*b*n^-1*q^-1*log(c*x^n)^(2q)+-1*a*n^-1*x^m*(c*x^n)^(-1*m*n^-1)*(-1*m*n^-1*log(c*x^n))^(-1q)*log(c*x^n)^q*SpecialFunctions.gamma(q,-1*m*n^-1*log(c*x^n)))
	@test integrate(x^-1*log(c*x^n)^(-1+q), x) == :(n^-1*q^-1*log(c*x^n)^q)
	@test integrate(x^-1*(a*x^m+b*log(c*x^n)^2)^3*log(c*x^n), x) == :(1//8*b^3*n^-1*log(c*x^n)^8+-1//9*n*a^3*m^-2*x^(3m)+1//3*a^3*m^-1*x^(3m)*log(c*x^n)+-360*a*b^2*m^-6*n^5*x^m+3*a*b^2*m^-1*x^m*log(c*x^n)^5+-9//8*b*a^2*m^-4*n^3*x^(2m)+3//2*b*a^2*m^-1*x^(2m)*log(c*x^n)^3+-180*a*b^2*m^-4*n^3*x^m*log(c*x^n)^2+-15*a*n*b^2*m^-2*x^m*log(c*x^n)^4+60*a*b^2*m^-3*n^2*x^m*log(c*x^n)^3+360*a*b^2*m^-5*n^4*x^m*log(c*x^n)+-9//4*b*n*a^2*m^-2*x^(2m)*log(c*x^n)^2+9//4*b*a^2*m^-3*n^2*x^(2m)*log(c*x^n))
	@test integrate(x^-1*(a*x^m+b*log(c*x^n)^2)^2*log(c*x^n), x) == :(1//6*b^2*n^-1*log(c*x^n)^6+(1/2)*a^2*m^-1*x^(2m)*log(c*x^n)+-1//4*n*a^2*m^-2*x^(2m)+-12*a*b*m^-4*n^3*x^m+2*a*b*m^-1*x^m*log(c*x^n)^3+-6*a*b*n*m^-2*x^m*log(c*x^n)^2+12*a*b*m^-3*n^2*x^m*log(c*x^n))
	@test integrate(x^-1*(a*x^m+b*log(c*x^n)^2)*log(c*x^n), x) == :(1//4*b*n^-1*log(c*x^n)^4+a*m^-1*x^m*log(c*x^n)+-1*a*n*m^-2*x^m)
	@test integrate(x^-1*log(c*x^n), x) == :((1/2)*n^-1*log(c*x^n)^2)
	@test integrate(x^-1*(a*x^m+b*log(c*x^n)^q)^p*(a*m*x^m+b*n*q*log(c*x^n)^(-1+q)), x) == :((1+p)^-1*(a*x^m+b*log(c*x^n)^q)^(1+p))
	@test integrate(x^-1*(a*x^m+b*log(c*x^n)^q)^2*(a*m*x^m+b*n*q*log(c*x^n)^(-1+q)), x) == :(1//3*(a*x^m+b*log(c*x^n)^q)^3)
end

@testset "4.1.0 (a sin)^m (b trg)^n.jl" begin
	@test integrate(sin(a+b*x), x) == :(-1*b^-1*cos(a+b*x))
	@test integrate(sin(a+b*x)^2, x) == :((1/2)*x+-1//2*b^-1*cos(a+b*x)*sin(a+b*x))
	@test integrate(sin(a+b*x)^3, x) == :(-1*b^-1*cos(a+b*x)+1//3*b^-1*cos(a+b*x)^3)
	@test integrate(sin(a+b*x)^4, x) == :(3//8*x+-3//8*b^-1*cos(a+b*x)*sin(a+b*x)+-1//4*b^-1*sin(a+b*x)^3*cos(a+b*x))
	@test integrate(sin(a+b*x)^5, x) == :(-1*b^-1*cos(a+b*x)+-1//5*b^-1*cos(a+b*x)^5+2//3*b^-1*cos(a+b*x)^3)
	@test integrate(sin(a+b*x)^6, x) == :(5//16*x+-5//16*b^-1*cos(a+b*x)*sin(a+b*x)+-5//24*b^-1*sin(a+b*x)^3*cos(a+b*x)+-1//6*b^-1*sin(a+b*x)^5*cos(a+b*x))
	@test integrate(sin(a+b*x)^7, x) == :(b^-1*cos(a+b*x)^3+-1*b^-1*cos(a+b*x)+-3//5*b^-1*cos(a+b*x)^5+1//7*b^-1*cos(a+b*x)^7)
	@test integrate(sin(a+b*x)^8, x) == :(35//128*x+-35//128*b^-1*cos(a+b*x)*sin(a+b*x)+-35//192*b^-1*sin(a+b*x)^3*cos(a+b*x)+-7//48*b^-1*sin(a+b*x)^5*cos(a+b*x)+-1//8*b^-1*sin(a+b*x)^7*cos(a+b*x))
	@test integrate(sin(b*x)^7//2, x) == :(-10//21*b^-1*Elliptic.F(1//4*pi+-1//2*b*x,2)+-10//21*b^-1*sin(b*x)^(1/2)*cos(b*x)+-2//7*b^-1*sin(b*x)^5//2*cos(b*x))
	@test integrate(sin(b*x)^5//2, x) == :(-6//5*b^-1*Elliptic.E(1//4*pi+-1//2*b*x,2)+-2//5*b^-1*sin(b*x)^3//2*cos(b*x))
end

@testset "4.1.1.1 (a+b sin)^n.jl" begin
	@test integrate((a+a*sin(c+d*x))^7//2, x) == :(-256//35*a^4*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)+-64//35*a^3*d^-1*(a+a*sin(c+d*x))^(1/2)*cos(c+d*x)+-24//35*a^2*d^-1*(a+a*sin(c+d*x))^3//2*cos(c+d*x)+-2//7*a*d^-1*(a+a*sin(c+d*x))^5//2*cos(c+d*x))
	@test integrate((a+a*sin(c+d*x))^5//2, x) == :(-64//15*a^3*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)+-16//15*a^2*d^-1*(a+a*sin(c+d*x))^(1/2)*cos(c+d*x)+-2//5*a*d^-1*(a+a*sin(c+d*x))^3//2*cos(c+d*x))
	@test integrate((a+a*sin(c+d*x))^3//2, x) == :(-8//3*a^2*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)+-2//3*a*d^-1*(a+a*sin(c+d*x))^(1/2)*cos(c+d*x))
	@test integrate((a+a*sin(c+d*x))^(1/2), x) == :(-2*a*d^-1*(a+a*sin(c+d*x))^-1//2*cos(c+d*x))
	@test integrate((a+a*sin(c+d*x))^-1//2, x) == :(-1*2^(1/2)*a^-1//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)))
	@test integrate((a+a*sin(c+d*x))^-3//2, x) == :(-1//2*d^-1*(a+a*sin(c+d*x))^-3//2*cos(c+d*x)+-1//4*2^(1/2)*a^-3//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)))
	@test integrate((a+a*sin(c+d*x))^-5//2, x) == :(-1//4*d^-1*(a+a*sin(c+d*x))^-5//2*cos(c+d*x)+-3//16*a^-1*d^-1*(a+a*sin(c+d*x))^-3//2*cos(c+d*x)+-3//32*2^(1/2)*a^-5//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*sin(c+d*x))^-1//2*cos(c+d*x)))
	@test integrate((5+3*sin(c+d*x))^-1, x) == :(1//4*x+(1/2)*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x)))
	@test integrate((5+3*sin(c+d*x))^-2, x) == :(5//64*x+5//32*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+3//16*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x))
	@test integrate((5+3*sin(c+d*x))^-3, x) == :(59//2048*x+59//1024*d^-1*arctan((3+sin(c+d*x))^-1*cos(c+d*x))+3//32*d^-1*(5+3*sin(c+d*x))^-2*cos(c+d*x)+45//512*d^-1*(5+3*sin(c+d*x))^-1*cos(c+d*x))
end

@testset "4.1.1.2 (g cos)^p (a+b sin)^m.jl" begin
	@test integrate(cos(c+d*x)^7*(a+a*sin(c+d*x)), x) == :(-2*a^-5*d^-1*(a+a*sin(c+d*x))^6+-1//8*a^-7*d^-1*(a+a*sin(c+d*x))^8+6//7*a^-6*d^-1*(a+a*sin(c+d*x))^7+8//5*a^-4*d^-1*(a+a*sin(c+d*x))^5)
	@test integrate(cos(c+d*x)^6*(a+a*sin(c+d*x)), x) == :(5//16*a*x+-1//7*a*d^-1*cos(c+d*x)^7+1//6*a*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//16*a*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a*d^-1*cos(c+d*x)^3*sin(c+d*x))
	@test integrate(cos(c+d*x)^5*(a+a*sin(c+d*x)), x) == :(a^-3*d^-1*(a+a*sin(c+d*x))^4+-4//5*a^-4*d^-1*(a+a*sin(c+d*x))^5+1//6*a^-5*d^-1*(a+a*sin(c+d*x))^6)
	@test integrate(cos(c+d*x)^4*(a+a*sin(c+d*x)), x) == :(3//8*a*x+-1//5*a*d^-1*cos(c+d*x)^5+1//4*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^3*(a+a*sin(c+d*x)), x) == :(-1//4*a^-3*d^-1*(a+a*sin(c+d*x))^4+2//3*a^-2*d^-1*(a+a*sin(c+d*x))^3)
	@test integrate(cos(c+d*x)^2*(a+a*sin(c+d*x)), x) == :((1/2)*a*x+-1//3*a*d^-1*cos(c+d*x)^3+(1/2)*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate((a+a*sin(c+d*x))*sec(c+d*x), x) == :(-1*a*d^-1*log(1+-1*sin(c+d*x)))
	@test integrate(sec(c+d*x)^2*(a+a*sin(c+d*x)), x) == :(a*d^-1*sec(c+d*x)+a*d^-1*tan(c+d*x))
	@test integrate(sec(c+d*x)^3*(a+a*sin(c+d*x)), x) == :((1/2)*a*d^-1*arctanh(sin(c+d*x))+(1/2)*a^2*d^-1*(a+-1*a*sin(c+d*x))^-1)
	@test integrate(sec(c+d*x)^4*(a+a*sin(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+1//3*a*d^-1*sec(c+d*x)^3+1//3*a*d^-1*tan(c+d*x)^3)
end

@testset "4.1.1.3 (g tan)^p (a+b sin)^m.jl" begin
	@test integrate(tan(c+d*x)^5*(a+a*sin(c+d*x)), x) == :(-1*a*d^-1*sin(c+d*x)+-1*a^2*d^-1*(a+-1*a*sin(c+d*x))^-1+-23//16*a*d^-1*log(1+-1*sin(c+d*x))+1//8*a^2*d^-1*(a+a*sin(c+d*x))^-1+1//8*a^3*d^-1*(a+-1*a*sin(c+d*x))^-2+7//16*a*d^-1*log(1+sin(c+d*x)))
	@test integrate(tan(c+d*x)^3*(a+a*sin(c+d*x)), x) == :(a*d^-1*sin(c+d*x)+(1/2)*a^2*d^-1*(a+-1*a*sin(c+d*x))^-1+-1//4*a*d^-1*log(1+sin(c+d*x))+5//4*a*d^-1*log(1+-1*sin(c+d*x)))
	@test integrate((a+a*sin(c+d*x))*tan(c+d*x), x) == :(-1*a*d^-1*log(1+-1*sin(c+d*x))+-1*a*d^-1*sin(c+d*x))
	@test integrate((a+a*sin(c+d*x))*cot(c+d*x), x) == :(a*d^-1*log(sin(c+d*x))+a*d^-1*sin(c+d*x))
	@test integrate(cot(c+d*x)^3*(a+a*sin(c+d*x)), x) == :(-1*a*d^-1*csc(c+d*x)+-1*a*d^-1*log(sin(c+d*x))+-1*a*d^-1*sin(c+d*x)+-1//2*a*d^-1*csc(c+d*x)^2)
	@test integrate(cot(c+d*x)^5*(a+a*sin(c+d*x)), x) == :(a*d^-1*csc(c+d*x)^2+a*d^-1*log(sin(c+d*x))+a*d^-1*sin(c+d*x)+2*a*d^-1*csc(c+d*x)+-1//3*a*d^-1*csc(c+d*x)^3+-1//4*a*d^-1*csc(c+d*x)^4)
	@test integrate(cot(c+d*x)^7*(a+a*sin(c+d*x)), x) == :(a*d^-1*csc(c+d*x)^3+-1*a*d^-1*log(sin(c+d*x))+-1*a*d^-1*sin(c+d*x)+-3*a*d^-1*csc(c+d*x)+-3//2*a*d^-1*csc(c+d*x)^2+-1//5*a*d^-1*csc(c+d*x)^5+-1//6*a*d^-1*csc(c+d*x)^6+3//4*a*d^-1*csc(c+d*x)^4)
	@test integrate(tan(c+d*x)^6*(a+a*sin(c+d*x)), x) == :(-1*a*x+a*d^-1*cos(c+d*x)+a*d^-1*tan(c+d*x)+-1*a*d^-1*sec(c+d*x)^3+3*a*d^-1*sec(c+d*x)+-1//3*a*d^-1*tan(c+d*x)^3+1//5*a*d^-1*sec(c+d*x)^5+1//5*a*d^-1*tan(c+d*x)^5)
	@test integrate(tan(c+d*x)^4*(a+a*sin(c+d*x)), x) == :(a*x+-1*a*d^-1*cos(c+d*x)+-1*a*d^-1*tan(c+d*x)+-2*a*d^-1*sec(c+d*x)+1//3*a*d^-1*sec(c+d*x)^3+1//3*a*d^-1*tan(c+d*x)^3)
	@test integrate(tan(c+d*x)^2*(a+a*sin(c+d*x)), x) == :(-1*a*x+a*d^-1*cos(c+d*x)+a*d^-1*(1+-1*sin(c+d*x))^-1*cos(c+d*x))
end

@testset "4.1.10 (c+d x)^m (a+b sin)^n.jl" begin
	@test integrate((c+d*x)^4*sin(a+b*x), x) == :(-1*b^-1*(c+d*x)^4*cos(a+b*x)+-24*b^-5*d^4*cos(a+b*x)+-24*b^-4*d^3*(c+d*x)*sin(a+b*x)+4*d*b^-2*(c+d*x)^3*sin(a+b*x)+12*b^-3*d^2*(c+d*x)^2*cos(a+b*x))
	@test integrate((c+d*x)^3*sin(a+b*x), x) == :(-1*b^-1*(c+d*x)^3*cos(a+b*x)+-6*b^-4*d^3*sin(a+b*x)+3*d*b^-2*(c+d*x)^2*sin(a+b*x)+6*b^-3*d^2*(c+d*x)*cos(a+b*x))
	@test integrate((c+d*x)^2*sin(a+b*x), x) == :(-1*b^-1*(c+d*x)^2*cos(a+b*x)+2*b^-3*d^2*cos(a+b*x)+2*d*b^-2*(c+d*x)*sin(a+b*x))
	@test integrate((c+d*x)*sin(a+b*x), x) == :(d*b^-2*sin(a+b*x)+-1*b^-1*(c+d*x)*cos(a+b*x))
	@test integrate((c+d*x)^-1*sin(a+b*x), x) == :(d^-1*cos(a+-1*b*c*d^-1)*sinintegral(b*x+b*c*d^-1)+d^-1*cosintegral(b*x+b*c*d^-1)*sin(a+-1*b*c*d^-1))
	@test integrate((c+d*x)^-2*sin(a+b*x), x) == :(-1*d^-1*(c+d*x)^-1*sin(a+b*x)+b*d^-2*cos(a+-1*b*c*d^-1)*cosintegral(b*x+b*c*d^-1)+-1*b*d^-2*sin(a+-1*b*c*d^-1)*sinintegral(b*x+b*c*d^-1))
	@test integrate((c+d*x)^-3*sin(a+b*x), x) == :(-1//2*d^-1*(c+d*x)^-2*sin(a+b*x)+-1//2*b*d^-2*(c+d*x)^-1*cos(a+b*x)+-1//2*b^2*d^-3*cos(a+-1*b*c*d^-1)*sinintegral(b*x+b*c*d^-1)+-1//2*b^2*d^-3*cosintegral(b*x+b*c*d^-1)*sin(a+-1*b*c*d^-1))
	@test integrate((c+d*x)^4*sin(a+b*x)^2, x) == :(1//10*d^-1*(c+d*x)^5+-1//2*d*b^-2*(c+d*x)^3+3//4*x*b^-4*d^4+d*b^-2*(c+d*x)^3*sin(a+b*x)^2+-3//2*b^-4*d^3*sin(a+b*x)^2*(c+d*x)+-3//4*b^-5*d^4*cos(a+b*x)*sin(a+b*x)+-1//2*b^-1*(c+d*x)^4*cos(a+b*x)*sin(a+b*x)+3//2*b^-3*d^2*(c+d*x)^2*cos(a+b*x)*sin(a+b*x))
	@test integrate((c+d*x)^3*sin(a+b*x)^2, x) == :(1//8*d^-1*(c+d*x)^4+-3//8*b^-4*d^3*sin(a+b*x)^2+-3//8*b^-2*d^3*x^2+-3//4*c*x*b^-2*d^2+-1//2*b^-1*(c+d*x)^3*cos(a+b*x)*sin(a+b*x)+3//4*d*b^-2*(c+d*x)^2*sin(a+b*x)^2+3//4*b^-3*d^2*(c+d*x)*cos(a+b*x)*sin(a+b*x))
	@test integrate((c+d*x)^2*sin(a+b*x)^2, x) == :(1//6*d^-1*(c+d*x)^3+-1//4*x*b^-2*d^2+(1/2)*d*b^-2*sin(a+b*x)^2*(c+d*x)+-1//2*b^-1*(c+d*x)^2*cos(a+b*x)*sin(a+b*x)+1//4*b^-3*d^2*cos(a+b*x)*sin(a+b*x))
end

@testset "4.1.11 (e x)^m (a+b x^n)^p sin.jl" begin
	@test integrate(x^3*(a+b*x)*sin(c+d*x), x) == :(-24*b*d^-5*cos(c+d*x)+-6*a*d^-4*sin(c+d*x)+-1*a*d^-1*x^3*cos(c+d*x)+-1*b*d^-1*x^4*cos(c+d*x)+-24*b*x*d^-4*sin(c+d*x)+3*a*d^-2*x^2*sin(c+d*x)+4*b*d^-2*x^3*sin(c+d*x)+6*a*x*d^-3*cos(c+d*x)+12*b*d^-3*x^2*cos(c+d*x))
	@test integrate(x^2*(a+b*x)*sin(c+d*x), x) == :(-6*b*d^-4*sin(c+d*x)+2*a*d^-3*cos(c+d*x)+-1*a*d^-1*x^2*cos(c+d*x)+-1*b*d^-1*x^3*cos(c+d*x)+2*a*x*d^-2*sin(c+d*x)+3*b*d^-2*x^2*sin(c+d*x)+6*b*x*d^-3*cos(c+d*x))
	@test integrate(x*(a+b*x)*sin(c+d*x), x) == :(a*d^-2*sin(c+d*x)+2*b*d^-3*cos(c+d*x)+-1*a*x*d^-1*cos(c+d*x)+-1*b*d^-1*x^2*cos(c+d*x)+2*b*x*d^-2*sin(c+d*x))
	@test integrate((a+b*x)*sin(c+d*x), x) == :(b*d^-2*sin(c+d*x)+-1*d^-1*(a+b*x)*cos(c+d*x))
	@test integrate(x^-1*(a+b*x)*sin(c+d*x), x) == :(a*cos(c)*sinintegral(d*x)+a*cosintegral(d*x)*sin(c)+-1*b*d^-1*cos(c+d*x))
	@test integrate(x^-2*(a+b*x)*sin(c+d*x), x) == :(b*cos(c)*sinintegral(d*x)+b*cosintegral(d*x)*sin(c)+-1*a*x^-1*sin(c+d*x)+a*d*cos(c)*cosintegral(d*x)+-1*a*d*sin(c)*sinintegral(d*x))
	@test integrate(x^-3*(a+b*x)*sin(c+d*x), x) == :(-1*b*x^-1*sin(c+d*x)+-1//2*a*x^-2*sin(c+d*x)+b*d*cos(c)*cosintegral(d*x)+-1*b*d*sin(c)*sinintegral(d*x)+-1//2*a*d*x^-1*cos(c+d*x)+-1//2*a*d^2*cos(c)*sinintegral(d*x)+-1//2*a*d^2*cosintegral(d*x)*sin(c))
	@test integrate(x^-4*(a+b*x)*sin(c+d*x), x) == :(-1//2*b*x^-2*sin(c+d*x)+-1//3*a*x^-3*sin(c+d*x)+-1//2*b*d*x^-1*cos(c+d*x)+-1//2*b*d^2*cos(c)*sinintegral(d*x)+-1//2*b*d^2*cosintegral(d*x)*sin(c)+-1//6*a*d*x^-2*cos(c+d*x)+-1//6*a*d^3*cos(c)*cosintegral(d*x)+1//6*a*d^2*x^-1*sin(c+d*x)+1//6*a*d^3*sin(c)*sinintegral(d*x))
	@test integrate(x^-5*(a+b*x)*sin(c+d*x), x) == :(-1//3*b*x^-3*sin(c+d*x)+-1//4*a*x^-4*sin(c+d*x)+-1//6*b*d*x^-2*cos(c+d*x)+-1//6*b*d^3*cos(c)*cosintegral(d*x)+-1//12*a*d*x^-3*cos(c+d*x)+1//6*b*d^2*x^-1*sin(c+d*x)+1//6*b*d^3*sin(c)*sinintegral(d*x)+1//24*a*d^2*x^-2*sin(c+d*x)+1//24*a*d^3*x^-1*cos(c+d*x)+1//24*a*d^4*cos(c)*sinintegral(d*x)+1//24*a*d^4*cosintegral(d*x)*sin(c))
	@test integrate(x^2*(a+b*x)^2*sin(c+d*x), x) == :(-24*b^2*d^-5*cos(c+d*x)+2*a^2*d^-3*cos(c+d*x)+-1*a^2*d^-1*x^2*cos(c+d*x)+-1*b^2*d^-1*x^4*cos(c+d*x)+-24*x*b^2*d^-4*sin(c+d*x)+-12*a*b*d^-4*sin(c+d*x)+2*x*a^2*d^-2*sin(c+d*x)+4*b^2*d^-2*x^3*sin(c+d*x)+12*b^2*d^-3*x^2*cos(c+d*x)+-2*a*b*d^-1*x^3*cos(c+d*x)+6*a*b*d^-2*x^2*sin(c+d*x)+12*a*b*x*d^-3*cos(c+d*x))
end

@testset "4.1.12 (e x)^m (a+b sin(c+d x^n))^p.jl" begin
	@test integrate(x^5*(a+b*sin(c+d*x^2)), x) == :(1//6*a*x^6+b*d^-3*cos(c+d*x^2)+b*d^-2*x^2*sin(c+d*x^2)+-1//2*b*d^-1*x^4*cos(c+d*x^2))
	@test integrate(x^3*(a+b*sin(c+d*x^2)), x) == :(1//4*a*x^4+(1/2)*b*d^-2*sin(c+d*x^2)+-1//2*b*d^-1*x^2*cos(c+d*x^2))
	@test integrate(x*(a+b*sin(c+d*x^2)), x) == :((1/2)*a*x^2+-1//2*b*d^-1*cos(c+d*x^2))
	@test integrate(x^-1*(a+b*sin(c+d*x^2)), x) == :(a*log(x)+(1/2)*b*cos(c)*sinintegral(d*x^2)+(1/2)*b*cosintegral(d*x^2)*sin(c))
	@test integrate(x^-3*(a+b*sin(c+d*x^2)), x) == :(-1//2*a*x^-2+-1//2*b*x^-2*sin(c+d*x^2)+(1/2)*b*d*cos(c)*cosintegral(d*x^2)+-1//2*b*d*sin(c)*sinintegral(d*x^2))
	@test integrate(x^-5*(a+b*sin(c+d*x^2)), x) == :(-1//4*a*x^-4+-1//4*b*x^-4*sin(c+d*x^2)+-1//4*b*d*x^-2*cos(c+d*x^2)+-1//4*b*d^2*cos(c)*sinintegral(d*x^2)+-1//4*b*d^2*cosintegral(d*x^2)*sin(c))
	@test integrate(x^4*(a+b*sin(c+d*x^2)), x) == :(1//5*a*x^5+-1//2*b*d^-1*x^3*cos(c+d*x^2)+3//4*b*x*d^-2*sin(c+d*x^2)+-3//8*b*2^(1/2)*pi^(1/2)*d^-5//2*cos(c)*fresnels(x*2^(1/2)*pi^-1//2*d^(1/2))+-3//8*b*2^(1/2)*pi^(1/2)*d^-5//2*fresnelc(x*2^(1/2)*pi^-1//2*d^(1/2))*sin(c))
	@test integrate(x^2*(a+b*sin(c+d*x^2)), x) == :(1//3*a*x^3+-1//2*b*x*d^-1*cos(c+d*x^2)+-1//4*b*2^(1/2)*pi^(1/2)*d^-3//2*fresnels(x*2^(1/2)*pi^-1//2*d^(1/2))*sin(c)+1//4*b*2^(1/2)*pi^(1/2)*d^-3//2*cos(c)*fresnelc(x*2^(1/2)*pi^-1//2*d^(1/2)))
	@test integrate(a+b*sin(c+d*x^2), x) == :(a*x+(1/2)*b*2^(1/2)*pi^(1/2)*d^-1//2*cos(c)*fresnels(x*2^(1/2)*pi^-1//2*d^(1/2))+(1/2)*b*2^(1/2)*pi^(1/2)*d^-1//2*fresnelc(x*2^(1/2)*pi^-1//2*d^(1/2))*sin(c))
	@test integrate(x^-2*(a+b*sin(c+d*x^2)), x) == :(-1*a*x^-1+-1*b*x^-1*sin(c+d*x^2)+b*2^(1/2)*pi^(1/2)*d^(1/2)*cos(c)*fresnelc(x*2^(1/2)*pi^-1//2*d^(1/2))+-1*b*2^(1/2)*pi^(1/2)*d^(1/2)*fresnels(x*2^(1/2)*pi^-1//2*d^(1/2))*sin(c))
end

@testset "4.1.13 (d+e x)^m sin(a+b x+c x^2)^n.jl" begin
	@test integrate(x^2*sin(a+b*x+c*x^2), x) == :(-1//2*x*c^-1*cos(a+b*x+c*x^2)+1//4*b*c^-2*cos(a+b*x+c*x^2)+-1//4*2^(1/2)*pi^(1/2)*c^-3//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1)+1//4*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
	@test integrate(x*sin(a+b*x+c*x^2), x) == :(-1//2*c^-1*cos(a+b*x+c*x^2)+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
	@test integrate(sin(a+b*x+c*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*c^-1//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+(1/2)*2^(1/2)*pi^(1/2)*c^-1//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
	@test integrate(x^-2*sin(a+b*x+c*x^2)+-1*b*x^-1*cos(a+b*x+c*x^2), x) == :(-1*x^-1*sin(a+b*x+c*x^2)+2^(1/2)*pi^(1/2)*c^(1/2)*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+-1*2^(1/2)*pi^(1/2)*c^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
	@test integrate(x^2*sin(a+b*x+-1*c*x^2), x) == :((1/2)*x*c^-1*cos(a+b*x+-1*c*x^2)+1//4*b*c^-2*cos(a+b*x+-1*c*x^2)+1//4*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+1//4*2^(1/2)*pi^(1/2)*c^-3//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1)+-1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1)+1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x)))
	@test integrate(x*sin(a+b*x+-1*c*x^2), x) == :((1/2)*c^-1*cos(a+b*x+-1*c*x^2)+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1)+1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x)))
	@test integrate(sin(a+b*x+-1*c*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*c^-1//2*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+-1//2*2^(1/2)*pi^(1/2)*c^-1//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
	@test integrate(x^-2*sin(a+b*x+-1*c*x^2)+-1*b*x^-1*cos(a+b*x+-1*c*x^2), x) == :(-1*x^-1*sin(a+b*x+-1*c*x^2)+2^(1/2)*pi^(1/2)*c^(1/2)*cos(a+1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+2^(1/2)*pi^(1/2)*c^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
	@test integrate(x^2*sin(1//4+x+x^2), x) == :(1//4*cos(1//4+x+x^2)+-1//2*x*cos(1//4+x+x^2)+1//4*2^(1/2)*pi^(1/2)*fresnelc((1/2)*2^(1/2)*pi^-1//2*(1+2x))+1//8*2^(1/2)*pi^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*(1+2x)))
	@test integrate(x*sin(1//4+x+x^2), x) == :(-1//2*cos(1//4+x+x^2)+-1//4*2^(1/2)*pi^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*(1+2x)))
end

@testset "4.1.2.1 (a+b sin)^m (c+d sin)^n.jl" begin
	@test integrate((a+a*sin(e+f*x))^2*sin(e+f*x)^3, x) == :(3//4*x*a^2+a^2*f^-1*cos(e+f*x)^3+-2*a^2*f^-1*cos(e+f*x)+-1//5*a^2*f^-1*cos(e+f*x)^5+-3//4*a^2*f^-1*cos(e+f*x)*sin(e+f*x)+-1//2*a^2*f^-1*sin(e+f*x)^3*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^3*sin(e+f*x)^3, x) == :(23//16*x*a^3+-4*a^3*f^-1*cos(e+f*x)+-3//5*a^3*f^-1*cos(e+f*x)^5+7//3*a^3*f^-1*cos(e+f*x)^3+-23//16*a^3*f^-1*cos(e+f*x)*sin(e+f*x)+-23//24*a^3*f^-1*sin(e+f*x)^3*cos(e+f*x)+-1//6*a^3*f^-1*sin(e+f*x)^5*cos(e+f*x))
	@test integrate((a+a*sin(x))^-1*sin(x)^4, x) == :(-4*a^-1*cos(x)+-3//2*x*a^-1+4//3*a^-1*cos(x)^3+(a+a*sin(x))^-1*sin(x)^3*cos(x)+3//2*a^-1*cos(x)*sin(x))
	@test integrate((a+a*sin(x))^-1*sin(x)^3, x) == :(2*a^-1*cos(x)+3//2*x*a^-1+(a+a*sin(x))^-1*sin(x)^2*cos(x)+-3//2*a^-1*cos(x)*sin(x))
	@test integrate((a+a*sin(x))^-1*sin(x)^2, x) == :(-1*x*a^-1+-1*a^-1*cos(x)+-1*a^-1*(1+sin(x))^-1*cos(x))
	@test integrate((a+a*sin(x))^-1*sin(x), x) == :(x*a^-1+(a+a*sin(x))^-1*cos(x))
	@test integrate((a+a*sin(x))^-1, x) == :(-1*(a+a*sin(x))^-1*cos(x))
	@test integrate((a+a*sin(x))^-1*csc(x), x) == :((a+a*sin(x))^-1*cos(x)+-1*a^-1*arctanh(cos(x)))
	@test integrate((a+a*sin(x))^-1*csc(x)^2, x) == :(a^-1*arctanh(cos(x))+(a+a*sin(x))^-1*cot(x)+-2*a^-1*cot(x))
	@test integrate((a+a*sin(x))^-1*csc(x)^3, x) == :(2*a^-1*cot(x)+-3//2*a^-1*arctanh(cos(x))+(a+a*sin(x))^-1*cot(x)*csc(x)+-3//2*a^-1*cot(x)*csc(x))
end

@testset "4.1.2.2 (g cos)^p (a+b sin)^m (c+d sin)^n.jl" begin
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^7//2*cos(e+f*x)^2, x) == :(-1//6*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^9//2*cos(e+f*x)+-1//15*a*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^9//2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^5//2*cos(e+f*x)^2, x) == :(-1//5*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^7//2*cos(e+f*x)+-1//10*a*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^7//2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^3//2*cos(e+f*x)^2, x) == :(-1//4*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^5//2*cos(e+f*x)+-1//6*a*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^5//2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^(1/2)*cos(e+f*x)^2, x) == :(-1//3*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^3//2*cos(e+f*x)+-1//3*a*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^3//2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)^2, x) == :((1/2)*a^-1*f^-1*(a+a*sin(e+f*x))^3//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-3//2*cos(e+f*x)^2, x) == :(-1*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)+-2*a*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(1+-1*sin(e+f*x)))
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-5//2*cos(e+f*x)^2, x) == :(c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-3//2*cos(e+f*x)+a*c^-2*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(1+-1*sin(e+f*x)))
	@test integrate((a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-7//2*cos(e+f*x)^2, x) == :(1//4*a^-1*c^-1*f^-1*(a+a*sin(e+f*x))^3//2*(c+-1*c*sin(e+f*x))^-5//2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^3//2*(c+-1*c*sin(e+f*x))^7//2*cos(e+f*x)^2, x) == :(-1//7*c^-1*f^-1*(a+a*sin(e+f*x))^3//2*(c+-1*c*sin(e+f*x))^9//2*cos(e+f*x)+-4//105*a^2*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^9//2*cos(e+f*x)+-2//21*a*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^9//2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^3//2*(c+-1*c*sin(e+f*x))^5//2*cos(e+f*x)^2, x) == :(-1//6*c^-1*f^-1*(a+a*sin(e+f*x))^3//2*(c+-1*c*sin(e+f*x))^7//2*cos(e+f*x)+-2//15*a*c^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^7//2*cos(e+f*x)+-1//15*a^2*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^7//2*cos(e+f*x))
end

@testset "4.1.2.3 (g sin)^p (a+b sin)^m (c+d sin)^n.jl" begin
	@test integrate((a+a*sin(e+f*x))^2*sin(e+f*x)^3*(c+-1*c*sin(e+f*x)), x) == :(1//16*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+1//5*c*a^2*f^-1*cos(e+f*x)^5+-1//16*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x)+-1//24*c*a^2*f^-1*sin(e+f*x)^3*cos(e+f*x)+1//6*c*a^2*f^-1*sin(e+f*x)^5*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*sin(e+f*x)^2*(c+-1*c*sin(e+f*x)), x) == :(1//8*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+1//5*c*a^2*f^-1*cos(e+f*x)^5+-1//8*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x)+1//4*c*a^2*f^-1*sin(e+f*x)^3*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*(c+-1*c*sin(e+f*x))*sin(e+f*x), x) == :(1//8*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+-1//8*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x)+1//4*c*a^2*f^-1*sin(e+f*x)^3*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*(c+-1*c*sin(e+f*x)), x) == :((1/2)*c*x*a^2+-1//3*c*a^2*f^-1*cos(e+f*x)^3+(1/2)*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*(c+-1*c*sin(e+f*x))*csc(e+f*x), x) == :((1/2)*c*x*a^2+c*a^2*f^-1*cos(e+f*x)+-1*c*a^2*f^-1*arctanh(cos(e+f*x))+(1/2)*c*a^2*f^-1*cos(e+f*x)*sin(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^2*(c+-1*c*sin(e+f*x)), x) == :(-1*c*x*a^2+c*a^2*f^-1*cos(e+f*x)+-1*c*a^2*f^-1*arctanh(cos(e+f*x))+-1*c*a^2*f^-1*cot(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^3*(c+-1*c*sin(e+f*x)), x) == :(-1*c*x*a^2+(1/2)*c*a^2*f^-1*arctanh(cos(e+f*x))+-1*c*a^2*f^-1*cot(e+f*x)+-1//2*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^4*(c+-1*c*sin(e+f*x)), x) == :((1/2)*c*a^2*f^-1*arctanh(cos(e+f*x))+-1//3*c*a^2*f^-1*cot(e+f*x)^3+-1//2*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^5*(c+-1*c*sin(e+f*x)), x) == :(-1//3*c*a^2*f^-1*cot(e+f*x)^3+1//8*c*a^2*f^-1*arctanh(cos(e+f*x))+-1//4*c*a^2*f^-1*csc(e+f*x)^3*cot(e+f*x)+1//8*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
	@test integrate((a+a*sin(e+f*x))^2*csc(e+f*x)^6*(c+-1*c*sin(e+f*x)), x) == :(-1//3*c*a^2*f^-1*cot(e+f*x)^3+-1//5*c*a^2*f^-1*cot(e+f*x)^5+1//8*c*a^2*f^-1*arctanh(cos(e+f*x))+-1//4*c*a^2*f^-1*csc(e+f*x)^3*cot(e+f*x)+1//8*c*a^2*f^-1*cot(e+f*x)*csc(e+f*x))
end

@testset "4.1.3.1 (a+b sin)^m (c+d sin)^n (A+B sin).jl" begin
	@test integrate((a+a*sin(c+d*x))^(-2+-1n)*sin(c+d*x)^n*(-1+-1n+-1*(-2+-1n)*sin(c+d*x)), x) == :(-1*d^-1*(a+a*sin(c+d*x))^(-2+-1n)*sin(c+d*x)^(1+n)*cos(c+d*x))
	@test integrate((a+a*sin(c+d*x))^m*sin(c+d*x)^(-2+-1m)*(1+m+-1*m*sin(c+d*x)), x) == :(-1*d^-1*(a+a*sin(c+d*x))^m*sin(c+d*x)^(-1+-1m)*cos(c+d*x))
	@test integrate((a+b*sin(e+f*x))^-2*sin(e+f*x)^2*(A+B*sin(e+f*x)), x) == :(x*b^-3*(A*b+-2*B*a)+-1*B*b^-2*f^-1*cos(e+f*x)+-2*a*b^-3*f^-1*(a^2+-1*b^2)^-3//2*(-2*A*b^3+-2*B*a^3+A*b*a^2+3*B*a*b^2)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*e+(1/2)*f*x)))+a^2*b^-2*f^-1*(a+b*sin(e+f*x))^-1*(a^2+-1*b^2)^-1*(A*b+-1*B*a)*cos(e+f*x))
	@test integrate((c+-1*c*sin(e+f*x))^4*(A+B*sin(e+f*x))*(a+a*sin(e+f*x)), x) == :(7//16*a*x*c^4*(-1B+2A)+1//10*a*f^-1*(c^2+-1*c^2*sin(e+f*x))^2*cos(e+f*x)^3*(-1B+2A)+7//24*a*c^4*f^-1*cos(e+f*x)^3*(-1B+2A)+7//40*a*f^-1*cos(e+f*x)^3*(c^4+-1*c^4*sin(e+f*x))*(-1B+2A)+-1//6*B*a*c*f^-1*(c+-1*c*sin(e+f*x))^3*cos(e+f*x)^3+7//16*a*c^4*f^-1*(-1B+2A)*cos(e+f*x)*sin(e+f*x))
	@test integrate((c+-1*c*sin(e+f*x))^3*(A+B*sin(e+f*x))*(a+a*sin(e+f*x)), x) == :(1//8*a*x*c^3*(-2B+5A)+1//12*a*c^3*f^-1*cos(e+f*x)^3*(-2B+5A)+1//20*a*f^-1*cos(e+f*x)^3*(c^3+-1*c^3*sin(e+f*x))*(-2B+5A)+-1//5*B*a*c*f^-1*(c+-1*c*sin(e+f*x))^2*cos(e+f*x)^3+1//8*a*c^3*f^-1*(-2B+5A)*cos(e+f*x)*sin(e+f*x))
	@test integrate((A+B*sin(e+f*x))*(a+a*sin(e+f*x))*(c+-1*c*sin(e+f*x)), x) == :((1/2)*A*a*c*x+-1//3*B*a*c*f^-1*cos(e+f*x)^3+(1/2)*A*a*c*f^-1*cos(e+f*x)*sin(e+f*x))
	@test integrate((c+-1*c*sin(e+f*x))^-1*(A+B*sin(e+f*x))*(a+a*sin(e+f*x)), x) == :(-1*a*x*c^-1*(A+2B)+B*a*c^-1*f^-1*cos(e+f*x)+2*a*f^-1*(c+-1*c*sin(e+f*x))^-1*(A+B)*cos(e+f*x))
	@test integrate((c+-1*c*sin(e+f*x))^-2*(A+B*sin(e+f*x))*(a+a*sin(e+f*x)), x) == :(B*a*x*c^-2+2//3*a*f^-1*(c+-1*c*sin(e+f*x))^-2*(A+B)*cos(e+f*x)+-1//3*a*c^-2*f^-1*(1+-1*sin(e+f*x))^-1*(A+7B)*cos(e+f*x))
	@test integrate((c+-1*c*sin(e+f*x))^-3*(A+B*sin(e+f*x))*(a+a*sin(e+f*x)), x) == :(-1//15*a*f^-1*(c^3+-1*c^3*sin(e+f*x))^-1*(A+-4B)*cos(e+f*x)+2//5*a*f^-1*(c+-1*c*sin(e+f*x))^-3*(A+B)*cos(e+f*x)+-1//15*a*c*f^-1*(c^2+-1*c^2*sin(e+f*x))^-2*(A+11B)*cos(e+f*x))
	@test integrate((c+-1*c*sin(e+f*x))^-4*(A+B*sin(e+f*x))*(a+a*sin(e+f*x)), x) == :(-1//105*a*f^-1*(c^2+-1*c^2*sin(e+f*x))^-2*(-5B+2A)*cos(e+f*x)+-1//105*a*f^-1*(c^4+-1*c^4*sin(e+f*x))^-1*(-5B+2A)*cos(e+f*x)+2//7*a*f^-1*(c+-1*c*sin(e+f*x))^-4*(A+B)*cos(e+f*x)+-1//35*a*c^-1*f^-1*(c+-1*c*sin(e+f*x))^-3*(A+15B)*cos(e+f*x))
end

@testset "4.1.4.1 (a+b sin)^m (A+B sin+C sin^2).jl" begin
	@test integrate(sin(e+f*x)^m*(1+m+-1*sin(e+f*x)^2*(2+m)), x) == :(f^-1*sin(e+f*x)^(1+m)*cos(e+f*x))
	@test integrate(sin(e+f*x)^5*(6+-7*sin(e+f*x)^2), x) == :(f^-1*sin(e+f*x)^6*cos(e+f*x))
	@test integrate(sin(e+f*x)^4*(5+-6*sin(e+f*x)^2), x) == :(f^-1*sin(e+f*x)^5*cos(e+f*x))
	@test integrate(sin(e+f*x)^3*(4+-5*sin(e+f*x)^2), x) == :(f^-1*sin(e+f*x)^4*cos(e+f*x))
	@test integrate(sin(e+f*x)^2*(3+-4*sin(e+f*x)^2), x) == :(f^-1*sin(e+f*x)^3*cos(e+f*x))
	@test integrate((2+-3*sin(e+f*x)^2)*sin(e+f*x), x) == :(f^-1*sin(e+f*x)^2*cos(e+f*x))
	@test integrate(1+-2*sin(e+f*x)^2, x) == :(f^-1*cos(e+f*x)*sin(e+f*x))
	@test integrate(-1*sin(e+f*x)^2*csc(e+f*x), x) == :(f^-1*cos(e+f*x))
	@test integrate(-1*csc(e+f*x)^2, x) == :(f^-1*cot(e+f*x))
	@test integrate(csc(e+f*x)^3*(-2+sin(e+f*x)^2), x) == :(f^-1*cot(e+f*x)*csc(e+f*x))
end

@testset "4.1.4.2 (a+b sin)^m (c+d sin)^n (A+B sin+C sin^2).jl" begin
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-3//2*(A+C*sin(e+f*x)^2), x) == :(1//4*a^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-3//2*(A+C)*cos(e+f*x)+-1//4*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*(A+-3C)*cos(e+f*x)*log(1+-1*sin(e+f*x))+1//4*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*(A+C)*cos(e+f*x)*log(1+sin(e+f*x)))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-3//2*(A+B*sin(e+f*x)+C*sin(e+f*x)^2), x) == :(1//4*a^-1*f^-1*(a+a*sin(e+f*x))^(1/2)*(c+-1*c*sin(e+f*x))^-3//2*(A+B+C)*cos(e+f*x)+-1//4*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*(A+-1B+-3C)*cos(e+f*x)*log(1+-1*sin(e+f*x))+1//4*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*(A+C+-1B)*cos(e+f*x)*log(1+sin(e+f*x)))
	@test integrate(sin(e+f*x)^-3//2*(a+b*sin(e+f*x))*(A+B*sin(e+f*x)+C*sin(e+f*x)^2), x) == :(f^-1*(-2*a*(A+-1C)+2*B*b)*Elliptic.E((1/2)*e+-1//4*pi+(1/2)*f*x,2)+1//3*f^-1*(2*C*b+6*A*b+6*B*a)*Elliptic.F((1/2)*e+-1//4*pi+(1/2)*f*x,2)+-2*A*a*f^-1*sin(e+f*x)^-1//2*cos(e+f*x)+-2//3*C*b*f^-1*sin(e+f*x)^(1/2)*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*sin(e+f*x)^3, x) == :((1/2)*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)^3+-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(cos(e+f*x)))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*sin(e+f*x), x) == :(-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(cos(e+f*x)))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*csc(e+f*x), x) == :(f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(tan(e+f*x)))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*csc(e+f*x)^2, x) == :(-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cot(e+f*x)+f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*arctanh(sin(e+f*x))*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*csc(e+f*x)^3, x) == :(f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(tan(e+f*x))+-1//2*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cot(e+f*x)^2*cos(e+f*x))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*csc(e+f*x)^4, x) == :(-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cot(e+f*x)+f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*arctanh(sin(e+f*x))*cos(e+f*x)+-1//3*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*csc(e+f*x)^2*cot(e+f*x))
	@test integrate((a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-3//2*sin(e+f*x)^3, x) == :(c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*log(cos(e+f*x))+(1/2)*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*sin(e+f*x)^2*tan(e+f*x)+(1/2)*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*sin(e+f*x)*tan(e+f*x)+-3//2*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*arctanh(sin(e+f*x))*cos(e+f*x)+3//2*c^-1*f^-1*(a+a*sin(e+f*x))^-1//2*(c+-1*c*sin(e+f*x))^-1//2*cos(e+f*x)*sin(e+f*x))
end

@testset "4.1.7 (d trig)^m (a+b (c sin)^n)^p.jl" begin
	@test integrate((a*sin(x)^2)^5//2, x) == :(-1//5*(a*sin(x)^2)^5//2*cot(x)+-8//15*a^2*(a*sin(x)^2)^(1/2)*cot(x)+-4//15*a*(a*sin(x)^2)^3//2*cot(x))
	@test integrate((a*sin(x)^2)^3//2, x) == :(-1//3*(a*sin(x)^2)^3//2*cot(x)+-2//3*a*(a*sin(x)^2)^(1/2)*cot(x))
	@test integrate((a*sin(x)^2)^(1/2), x) == :(-1*(a*sin(x)^2)^(1/2)*cot(x))
	@test integrate((a*sin(x)^2)^-1//2, x) == :(-1*(a*sin(x)^2)^-1//2*arctanh(cos(x))*sin(x))
	@test integrate((a*sin(x)^2)^-3//2, x) == :(-1//2*a^-1*(a*sin(x)^2)^-1//2*cot(x)+-1//2*a^-1*(a*sin(x)^2)^-1//2*arctanh(cos(x))*sin(x))
	@test integrate((a*sin(x)^2)^-5//2, x) == :(-3//8*a^-2*(a*sin(x)^2)^-1//2*cot(x)+-1//4*a^-1*(a*sin(x)^2)^-3//2*cot(x)+-3//8*a^-2*(a*sin(x)^2)^-1//2*arctanh(cos(x))*sin(x))
	@test integrate((a*sin(x)^3)^5//2, x) == :(-26//77*a^2*(a*sin(x)^3)^(1/2)*cot(x)+-78//385*a^2*(a*sin(x)^3)^(1/2)*cos(x)*sin(x)+-26//77*a^2*(a*sin(x)^3)^(1/2)*sin(x)^-3//2*Elliptic.F(-1//2*x+1//4*pi,2)+-26//165*a^2*(a*sin(x)^3)^(1/2)*sin(x)^3*cos(x)+-2//15*a^2*(a*sin(x)^3)^(1/2)*sin(x)^5*cos(x))
	@test integrate((a*sin(x)^3)^3//2, x) == :(-14//45*a*(a*sin(x)^3)^(1/2)*cos(x)+-14//15*a*(a*sin(x)^3)^(1/2)*sin(x)^-3//2*Elliptic.E(-1//2*x+1//4*pi,2)+-2//9*a*(a*sin(x)^3)^(1/2)*sin(x)^2*cos(x))
	@test integrate((a*sin(x)^3)^(1/2), x) == :(-2//3*(a*sin(x)^3)^(1/2)*cot(x)+-2//3*(a*sin(x)^3)^(1/2)*sin(x)^-3//2*Elliptic.F(-1//2*x+1//4*pi,2))
	@test integrate((a*sin(x)^3)^-1//2, x) == :(-2*(a*sin(x)^3)^-1//2*cos(x)*sin(x)+2*(a*sin(x)^3)^-1//2*sin(x)^3//2*Elliptic.E(-1//2*x+1//4*pi,2))
end

@testset "4.1.8 (a+b sin)^m (c+d trig)^n.jl" begin
	@test integrate((a+b*sin(x))^-1*(A+B*cos(x)), x) == :(B*b^-1*log(a+b*sin(x))+2*A*(a^2+-1*b^2)^-1//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*x))))
	@test integrate((1+sin(x))^-1*(A+B*cos(x)), x) == :(B*log(1+sin(x))+-1*A*(1+sin(x))^-1*cos(x))
	@test integrate((1+-1*sin(x))^-1*(A+B*cos(x)), x) == :(-1*B*log(1+-1*sin(x))+A*(1+-1*sin(x))^-1*cos(x))
	@test integrate((a+b*sin(x))^-1*(b+c+cos(x)), x) == :(b^-1*log(a+b*sin(x))+(a^2+-1*b^2)^-1//2*(2b+2c)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*x))))
	@test integrate((a+-1*b*sin(x))^-1*(b+c+cos(x)), x) == :(-1*b^-1*log(a+-1*b*sin(x))+-1*(a^2+-1*b^2)^-1//2*(2b+2c)*arctan((a^2+-1*b^2)^-1//2*(b+-1*a*tan((1/2)*x))))
	@test integrate((a+b*sin(x))^-1*(A+B*tan(x)), x) == :(-1*B*(-2b+2a)^-1*log(1+sin(x))+-1*B*(2a+2b)^-1*log(1+-1*sin(x))+2*A*(a^2+-1*b^2)^-1//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*x)))+B*a*(a^2+-1*b^2)^-1*log(a+b*sin(x)))
	@test integrate((a+b*sin(x))^-1*(A+B*cot(x)), x) == :(B*a^-1*log(sin(x))+-1*B*a^-1*log(a+b*sin(x))+2*A*(a^2+-1*b^2)^-1//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*x))))
	@test integrate((a+b*sin(x))^-1*(A+B*sec(x)), x) == :(B*(-2b+2a)^-1*log(1+sin(x))+-1*B*(2a+2b)^-1*log(1+-1*sin(x))+2*A*(a^2+-1*b^2)^-1//2*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*x)))+-1*B*b*(a^2+-1*b^2)^-1*log(a+b*sin(x)))
	@test integrate((a+b*sin(x))^-1*(A+B*csc(x)), x) == :(-1*B*a^-1*arctanh(cos(x))+a^-1*(a^2+-1*b^2)^-1//2*(-2*B*b+2*A*a)*arctan((a^2+-1*b^2)^-1//2*(b+a*tan((1/2)*x))))
end

@testset "4.1.9 trig^m (a+b sin^n+c sin^(2 n))^p.jl" begin
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*sin(x)^4, x) == :((1/2)*x*c^-1+b*c^-2*cos(x)+x*c^-3*(b^2+-1*a*c)+-1//2*c^-1*cos(x)*sin(x)+-1*2^(1/2)*c^-3*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b^3+(b^2+-4*a*c)^-1//2*(b^4+2*a^2*c^2+-4*a*c*b^2)+-2*a*b*c)*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+-1*2^(1/2)*c^-3*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b^3+-1*(b^2+-4*a*c)^-1//2*(b^4+2*a^2*c^2+-4*a*c*b^2)+-2*a*b*c)*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*sin(x)^3, x) == :(-1*c^-1*cos(x)+-1*b*x*c^-2+b*2^(1/2)*c^-2*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b+b^2*(b^2+-4*a*c)^-1//2+-1*a*c*b^-1+-3*a*c*(b^2+-4*a*c)^-1//2)*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+b*2^(1/2)*c^-2*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b+-1*b^2*(b^2+-4*a*c)^-1//2+-1*a*c*b^-1+3*a*c*(b^2+-4*a*c)^-1//2)*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*sin(x)^2, x) == :(x*c^-1+-1*2^(1/2)*c^-1*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b+(b^2+-4*a*c)^-1//2*(b^2+-2*a*c))*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+-1*2^(1/2)*c^-1*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b+-1*(b^2+-4*a*c)^-1//2*(b^2+-2*a*c))*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*sin(x), x) == :(2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(1+b*(b^2+-4*a*c)^-1//2)*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(1+-1*b*(b^2+-4*a*c)^-1//2)*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1, x) == :(-2*c*2^(1/2)*(b^2+-4*a*c)^-1//2*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+2*c*2^(1/2)*(b^2+-4*a*c)^-1//2*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*csc(x), x) == :(-1*a^-1*arctanh(cos(x))+-1*c*2^(1/2)*a^-1*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(1+-1*b*(b^2+-4*a*c)^-1//2)*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+-1*c*2^(1/2)*a^-1*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(1+b*(b^2+-4*a*c)^-1//2)*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*csc(x)^2, x) == :(-1*a^-1*cot(x)+b*a^-2*arctanh(cos(x))+b*c*2^(1/2)*a^-2*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(1+-1*b^-1*(b^2+-4*a*c)^-1//2*(b^2+-2*a*c))*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+b*c*2^(1/2)*a^-2*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(1+b^-1*(b^2+-4*a*c)^-1//2*(b^2+-2*a*c))*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*csc(x)^3, x) == :(-1//2*a^-1*arctanh(cos(x))+b*a^-2*cot(x)+-1*a^-3*(b^2+-1*a*c)*arctanh(cos(x))+-1//2*a^-1*cot(x)*csc(x)+c*2^(1/2)*a^-3*(b^2+-4*a*c)^-1//2*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b^3+-1*(b^2+-4*a*c)^(1/2)*(b^2+-1*a*c)+-3*a*b*c)*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+-1*c*2^(1/2)*a^-3*(b^2+-4*a*c)^-1//2*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(b^3+(b^2+-4*a*c)^(1/2)*(b^2+-1*a*c)+-3*a*b*c)*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*cos(x)^3, x) == :(-1*c^-1*sin(x)+(1/2)*b*c^-2*log(a+b*sin(x)+c*sin(x)^2)+c^-2*(b^2+-4*a*c)^-1//2*(b^2+-2*c*(a+c))*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*sin(x))))
	@test integrate((a+b*sin(x)+c*sin(x)^2)^-1*cos(x)^2, x) == :(-1*x*c^-1+2^(1/2)*c^-1*(b^2+-4*a*c)^-1//2*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^(1/2)*arctan((1/2)*2^(1/2)*(b^2+b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+(b^2+-4*a*c)^(1/2))*tan((1/2)*x)))+-1*2^(1/2)*c^-1*(b^2+-4*a*c)^-1//2*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^(1/2)*arctan((1/2)*2^(1/2)*(b^2+-1*b*(b^2+-4*a*c)^(1/2)+-2*c*(a+c))^-1//2*(2c+(b+-1*(b^2+-4*a*c)^(1/2))*tan((1/2)*x))))
end

@testset "4.2.0 (a cos)^m (b trg)^n.jl" begin
	@test integrate(cos(a+b*x), x) == :(b^-1*sin(a+b*x))
	@test integrate(cos(a+b*x)^2, x) == :((1/2)*x+(1/2)*b^-1*cos(a+b*x)*sin(a+b*x))
	@test integrate(cos(a+b*x)^3, x) == :(b^-1*sin(a+b*x)+-1//3*b^-1*sin(a+b*x)^3)
	@test integrate(cos(a+b*x)^4, x) == :(3//8*x+1//4*b^-1*cos(a+b*x)^3*sin(a+b*x)+3//8*b^-1*cos(a+b*x)*sin(a+b*x))
	@test integrate(cos(a+b*x)^5, x) == :(b^-1*sin(a+b*x)+-2//3*b^-1*sin(a+b*x)^3+1//5*b^-1*sin(a+b*x)^5)
	@test integrate(cos(a+b*x)^6, x) == :(5//16*x+1//6*b^-1*cos(a+b*x)^5*sin(a+b*x)+5//16*b^-1*cos(a+b*x)*sin(a+b*x)+5//24*b^-1*cos(a+b*x)^3*sin(a+b*x))
	@test integrate(cos(a+b*x)^7, x) == :(b^-1*sin(a+b*x)+-1*b^-1*sin(a+b*x)^3+-1//7*b^-1*sin(a+b*x)^7+3//5*b^-1*sin(a+b*x)^5)
	@test integrate(cos(a+b*x)^8, x) == :(35//128*x+1//8*b^-1*cos(a+b*x)^7*sin(a+b*x)+7//48*b^-1*cos(a+b*x)^5*sin(a+b*x)+35//128*b^-1*cos(a+b*x)*sin(a+b*x)+35//192*b^-1*cos(a+b*x)^3*sin(a+b*x))
	@test integrate(cos(a+b*x)^7//2, x) == :(10//21*b^-1*Elliptic.F((1/2)*a+(1/2)*b*x,2)+2//7*b^-1*cos(a+b*x)^5//2*sin(a+b*x)+10//21*b^-1*cos(a+b*x)^(1/2)*sin(a+b*x))
	@test integrate(cos(a+b*x)^5//2, x) == :(6//5*b^-1*Elliptic.E((1/2)*a+(1/2)*b*x,2)+2//5*b^-1*cos(a+b*x)^3//2*sin(a+b*x))
end

@testset "4.2.1.1 (a+b cos)^n.jl" begin
	@test integrate((a+a*cos(c+d*x))^7//2, x) == :(2//7*a*d^-1*(a+a*cos(c+d*x))^5//2*sin(c+d*x)+24//35*a^2*d^-1*(a+a*cos(c+d*x))^3//2*sin(c+d*x)+64//35*a^3*d^-1*(a+a*cos(c+d*x))^(1/2)*sin(c+d*x)+256//35*a^4*d^-1*(a+a*cos(c+d*x))^-1//2*sin(c+d*x))
	@test integrate((a+a*cos(c+d*x))^5//2, x) == :(2//5*a*d^-1*(a+a*cos(c+d*x))^3//2*sin(c+d*x)+16//15*a^2*d^-1*(a+a*cos(c+d*x))^(1/2)*sin(c+d*x)+64//15*a^3*d^-1*(a+a*cos(c+d*x))^-1//2*sin(c+d*x))
	@test integrate((a+a*cos(c+d*x))^3//2, x) == :(2//3*a*d^-1*(a+a*cos(c+d*x))^(1/2)*sin(c+d*x)+8//3*a^2*d^-1*(a+a*cos(c+d*x))^-1//2*sin(c+d*x))
	@test integrate((a+a*cos(c+d*x))^(1/2), x) == :(2*a*d^-1*(a+a*cos(c+d*x))^-1//2*sin(c+d*x))
	@test integrate((a+a*cos(c+d*x))^-1//2, x) == :(2^(1/2)*a^-1//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*cos(c+d*x))^-1//2*sin(c+d*x)))
	@test integrate((a+a*cos(c+d*x))^-3//2, x) == :((1/2)*d^-1*(a+a*cos(c+d*x))^-3//2*sin(c+d*x)+1//4*2^(1/2)*a^-3//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*cos(c+d*x))^-1//2*sin(c+d*x)))
	@test integrate((a+a*cos(c+d*x))^-5//2, x) == :(1//4*d^-1*(a+a*cos(c+d*x))^-5//2*sin(c+d*x)+3//16*a^-1*d^-1*(a+a*cos(c+d*x))^-3//2*sin(c+d*x)+3//32*2^(1/2)*a^-5//2*d^-1*arctanh((1/2)*2^(1/2)*a^(1/2)*(a+a*cos(c+d*x))^-1//2*sin(c+d*x)))
	@test integrate((5+3*cos(c+d*x))^-1, x) == :(1//4*x+-1//2*d^-1*arctan((3+cos(c+d*x))^-1*sin(c+d*x)))
	@test integrate((5+3*cos(c+d*x))^-2, x) == :(5//64*x+-5//32*d^-1*arctan((3+cos(c+d*x))^-1*sin(c+d*x))+-3//16*d^-1*(5+3*cos(c+d*x))^-1*sin(c+d*x))
	@test integrate((5+3*cos(c+d*x))^-3, x) == :(59//2048*x+-59//1024*d^-1*arctan((3+cos(c+d*x))^-1*sin(c+d*x))+-45//512*d^-1*(5+3*cos(c+d*x))^-1*sin(c+d*x)+-3//32*d^-1*(5+3*cos(c+d*x))^-2*sin(c+d*x))
end

@testset "4.2.1.2 (g sin)^p (a+b cos)^m.jl" begin
	@test integrate((a+a*cos(x))^-1*sin(x)^4, x) == :((1/2)*x*a^-1+-1//3*a^-1*sin(x)^3+-1//2*a^-1*cos(x)*sin(x))
	@test integrate((a+a*cos(x))^-1*sin(x)^3, x) == :((1/2)*a^-1*cos(x)^2+-1*a^-1*cos(x))
	@test integrate((a+a*cos(x))^-1*sin(x)^2, x) == :(x*a^-1+-1*a^-1*sin(x))
	@test integrate((a+a*cos(x))^-1*sin(x), x) == :(-1*a^-1*log(1+cos(x)))
	@test integrate((a+a*cos(x))^-1, x) == :((a+a*cos(x))^-1*sin(x))
	@test integrate((a+a*cos(x))^-1*csc(x), x) == :((2a+2*a*cos(x))^-1+-1//2*a^-1*arctanh(cos(x)))
	@test integrate((a+a*cos(x))^-1*csc(x)^2, x) == :((3a+3*a*cos(x))^-1*csc(x)+-2//3*a^-1*cot(x))
	@test integrate((a+a*cos(x))^-1*csc(x)^3, x) == :((4a+4*a*cos(x))^-1+-1*(8a+-8*a*cos(x))^-1+-3//8*a^-1*arctanh(cos(x))+1//8*a*(a+a*cos(x))^-2)
	@test integrate((a+a*cos(x))^-1*csc(x)^4, x) == :((5a+5*a*cos(x))^-1*csc(x)^3+-4//5*a^-1*cot(x)+-4//15*a^-1*cot(x)^3)
	@test integrate((1+cos(x))^-2*sin(x), x) == :((1+cos(x))^-1)
end

@testset "4.2.1.3 (g tan)^p (a+b cos)^m.jl" begin
	@test integrate((a+a*cos(x))^-1*tan(x)^4, x) == :((1/2)*a^-1*arctanh(sin(x))+1//3*a^-1*tan(x)^3+-1//2*a^-1*sec(x)*tan(x))
	@test integrate((a+a*cos(x))^-1*tan(x)^3, x) == :((1/2)*a^-1*sec(x)^2+-1*a^-1*sec(x))
	@test integrate((a+a*cos(x))^-1*tan(x)^2, x) == :(a^-1*tan(x)+-1*a^-1*arctanh(sin(x)))
	@test integrate((a+a*cos(x))^-1*tan(x), x) == :(a^-1*log(1+cos(x))+-1*a^-1*log(cos(x)))
	@test integrate((a+a*cos(x))^-1*cot(x), x) == :(-1//2*a^-1*csc(x)^2+-1//2*a^-1*arctanh(cos(x))+(1/2)*a^-1*cot(x)*csc(x))
	@test integrate((a+a*cos(x))^-1*cot(x)^2, x) == :(-1*a^-1*csc(x)+-1//3*a^-1*cot(x)^3+1//3*a^-1*csc(x)^3)
	@test integrate((a+a*cos(x))^-1*cot(x)^3, x) == :(-1//4*a^-1*cot(x)^4+3//8*a^-1*arctanh(cos(x))+-3//8*a^-1*cot(x)*csc(x)+1//4*a^-1*cot(x)^3*csc(x))
	@test integrate((a+a*cos(x))^-1*cot(x)^4, x) == :(a^-1*csc(x)+-2//3*a^-1*csc(x)^3+-1//5*a^-1*cot(x)^5+1//5*a^-1*csc(x)^5)
	@test integrate((1+cos(3x))^-2*tan(3x), x) == :(-1*(3+3*cos(3x))^-1+-1//3*log(cos(3x))+1//3*log(1+cos(3x)))
	@test integrate((a+b*cos(x))^-1*tan(x)^4, x) == :(-1//3*a^-3*(-3*b^2+4*a^2)*tan(x)+1//3*a^-1*sec(x)^2*tan(x)+(1/2)*b*a^-4*(-2*b^2+3*a^2)*arctanh(sin(x))+2*a^-4*(a+b)^3//2*(a+-1b)^3//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x))+-1//2*b*a^-2*sec(x)*tan(x))
end

@testset "4.2.10 (c+d x)^m (a+b cos)^n.jl" begin
	@test integrate((c+d*x)^4*cos(a+b*x), x) == :(b^-1*(c+d*x)^4*sin(a+b*x)+24*b^-5*d^4*sin(a+b*x)+-24*b^-4*d^3*(c+d*x)*cos(a+b*x)+-12*b^-3*d^2*(c+d*x)^2*sin(a+b*x)+4*d*b^-2*(c+d*x)^3*cos(a+b*x))
	@test integrate((c+d*x)^3*cos(a+b*x), x) == :(b^-1*(c+d*x)^3*sin(a+b*x)+-6*b^-4*d^3*cos(a+b*x)+-6*b^-3*d^2*(c+d*x)*sin(a+b*x)+3*d*b^-2*(c+d*x)^2*cos(a+b*x))
	@test integrate((c+d*x)^2*cos(a+b*x), x) == :(b^-1*(c+d*x)^2*sin(a+b*x)+-2*b^-3*d^2*sin(a+b*x)+2*d*b^-2*(c+d*x)*cos(a+b*x))
	@test integrate((c+d*x)*cos(a+b*x), x) == :(d*b^-2*cos(a+b*x)+b^-1*(c+d*x)*sin(a+b*x))
	@test integrate((c+d*x)^-1*cos(a+b*x), x) == :(d^-1*cos(a+-1*b*c*d^-1)*cosintegral(b*x+b*c*d^-1)+-1*d^-1*sin(a+-1*b*c*d^-1)*sinintegral(b*x+b*c*d^-1))
	@test integrate((c+d*x)^-2*cos(a+b*x), x) == :(-1*d^-1*(c+d*x)^-1*cos(a+b*x)+-1*b*d^-2*cos(a+-1*b*c*d^-1)*sinintegral(b*x+b*c*d^-1)+-1*b*d^-2*cosintegral(b*x+b*c*d^-1)*sin(a+-1*b*c*d^-1))
	@test integrate((c+d*x)^-3*cos(a+b*x), x) == :(-1//2*d^-1*(c+d*x)^-2*cos(a+b*x)+(1/2)*b*d^-2*(c+d*x)^-1*sin(a+b*x)+(1/2)*b^2*d^-3*sin(a+-1*b*c*d^-1)*sinintegral(b*x+b*c*d^-1)+-1//2*b^2*d^-3*cos(a+-1*b*c*d^-1)*cosintegral(b*x+b*c*d^-1))
	@test integrate((c+d*x)^-4*cos(a+b*x), x) == :(-1//3*d^-1*(c+d*x)^-3*cos(a+b*x)+1//6*b*d^-2*(c+d*x)^-2*sin(a+b*x)+1//6*b^2*d^-3*(c+d*x)^-1*cos(a+b*x)+1//6*b^3*d^-4*cos(a+-1*b*c*d^-1)*sinintegral(b*x+b*c*d^-1)+1//6*b^3*d^-4*cosintegral(b*x+b*c*d^-1)*sin(a+-1*b*c*d^-1))
	@test integrate((c+d*x)^4*cos(a+b*x)^2, x) == :(1//10*d^-1*(c+d*x)^5+-1//2*d*b^-2*(c+d*x)^3+3//4*x*b^-4*d^4+d*b^-2*(c+d*x)^3*cos(a+b*x)^2+(1/2)*b^-1*(c+d*x)^4*cos(a+b*x)*sin(a+b*x)+-3//2*b^-4*d^3*cos(a+b*x)^2*(c+d*x)+3//4*b^-5*d^4*cos(a+b*x)*sin(a+b*x)+-3//2*b^-3*d^2*(c+d*x)^2*cos(a+b*x)*sin(a+b*x))
	@test integrate((c+d*x)^3*cos(a+b*x)^2, x) == :(1//8*d^-1*(c+d*x)^4+-3//8*b^-4*d^3*cos(a+b*x)^2+-3//8*b^-2*d^3*x^2+(1/2)*b^-1*(c+d*x)^3*cos(a+b*x)*sin(a+b*x)+-3//4*c*x*b^-2*d^2+3//4*d*b^-2*(c+d*x)^2*cos(a+b*x)^2+-3//4*b^-3*d^2*(c+d*x)*cos(a+b*x)*sin(a+b*x))
end

@testset "4.2.12 (e x)^m (a+b cos(c+d x^n))^p.jl" begin
	@test integrate(x^3*cos(a+b*x^2), x) == :((1/2)*b^-2*cos(a+b*x^2)+(1/2)*b^-1*x^2*sin(a+b*x^2))
	@test integrate(x^2*cos(a+b*x^2), x) == :((1/2)*x*b^-1*sin(a+b*x^2)+-1//4*2^(1/2)*pi^(1/2)*b^-3//2*cos(a)*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))+-1//4*2^(1/2)*pi^(1/2)*b^-3//2*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a))
	@test integrate(x*cos(a+b*x^2), x) == :((1/2)*b^-1*sin(a+b*x^2))
	@test integrate(cos(a+b*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*b^-1//2*cos(a)*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))+-1//2*2^(1/2)*pi^(1/2)*b^-1//2*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a))
	@test integrate(x^-1*cos(a+b*x^2), x) == :((1/2)*cos(a)*cosintegral(b*x^2)+-1//2*sin(a)*sinintegral(b*x^2))
	@test integrate(x^-2*cos(a+b*x^2), x) == :(-1*x^-1*cos(a+b*x^2)+-1*2^(1/2)*pi^(1/2)*b^(1/2)*cos(a)*fresnels(x*2^(1/2)*pi^-1//2*b^(1/2))+-1*2^(1/2)*pi^(1/2)*b^(1/2)*fresnelc(x*2^(1/2)*pi^-1//2*b^(1/2))*sin(a))
	@test integrate(x^-3*cos(a+b*x^2), x) == :(-1//2*x^-2*cos(a+b*x^2)+-1//2*b*cos(a)*sinintegral(b*x^2)+-1//2*b*cosintegral(b*x^2)*sin(a))
	@test integrate(x^3*cos(a+b*x^2)^2, x) == :(1//8*x^4+1//8*b^-2*cos(a+b*x^2)^2+1//4*b^-1*x^2*cos(a+b*x^2)*sin(a+b*x^2))
	@test integrate(x^2*cos(a+b*x^2)^2, x) == :(1//6*x^3+1//8*x*b^-1*sin(2a+2*b*x^2)+-1//16*pi^(1/2)*b^-3//2*cos(2a)*fresnels(2*x*pi^-1//2*b^(1/2))+-1//16*pi^(1/2)*b^-3//2*fresnelc(2*x*pi^-1//2*b^(1/2))*sin(2a))
	@test integrate(x*cos(a+b*x^2)^2, x) == :(1//4*x^2+1//4*b^-1*cos(a+b*x^2)*sin(a+b*x^2))
end

@testset "4.2.13 (d+e x)^m cos(a+b x+c x^2)^n.jl" begin
	@test integrate(x^2*cos(a+b*x+c*x^2), x) == :((1/2)*x*c^-1*sin(a+b*x+c*x^2)+-1//4*b*c^-2*sin(a+b*x+c*x^2)+-1//4*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+-1//4*2^(1/2)*pi^(1/2)*c^-3//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1)+-1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1)+1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x)))
	@test integrate(x*cos(a+b*x+c*x^2), x) == :((1/2)*c^-1*sin(a+b*x+c*x^2)+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
	@test integrate(cos(a+b*x+c*x^2), x) == :((1/2)*2^(1/2)*pi^(1/2)*c^-1//2*cos(a+-1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+-1//2*2^(1/2)*pi^(1/2)*c^-1//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
	@test integrate(x^-2*cos(a+b*x+c*x^2)+b*x^-1*sin(a+b*x+c*x^2), x) == :(-1*x^-1*cos(a+b*x+c*x^2)+-1*2^(1/2)*pi^(1/2)*c^(1/2)*cos(a+-1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))+-1*2^(1/2)*pi^(1/2)*c^(1/2)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+2*c*x))*sin(a+-1//4*b^2*c^-1))
	@test integrate(x^2*cos(a+b*x+-1*c*x^2), x) == :(-1//2*x*c^-1*sin(a+b*x+-1*c*x^2)+-1//4*b*c^-2*sin(a+b*x+-1*c*x^2)+-1//4*2^(1/2)*pi^(1/2)*c^-3//2*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1)+1//4*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+-1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*cos(a+1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+-1//8*2^(1/2)*pi^(1/2)*b^2*c^-5//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
	@test integrate(x*cos(a+b*x+-1*c*x^2), x) == :(-1//2*c^-1*sin(a+b*x+-1*c*x^2)+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*cos(a+1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+-1//4*b*2^(1/2)*pi^(1/2)*c^-3//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
	@test integrate(cos(a+b*x+-1*c*x^2), x) == :(-1//2*2^(1/2)*pi^(1/2)*c^-1//2*cos(a+1//4*b^2*c^-1)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+-1//2*2^(1/2)*pi^(1/2)*c^-1//2*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
	@test integrate(x^-2*cos(a+b*x+-1*c*x^2)+b*x^-1*sin(a+b*x+-1*c*x^2), x) == :(-1*x^-1*cos(a+b*x+-1*c*x^2)+2^(1/2)*pi^(1/2)*c^(1/2)*cos(a+1//4*b^2*c^-1)*fresnels((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))+-1*2^(1/2)*pi^(1/2)*c^(1/2)*fresnelc((1/2)*2^(1/2)*pi^-1//2*c^-1//2*(b+-2*c*x))*sin(a+1//4*b^2*c^-1))
	@test integrate(x^2*cos(1//4+x+x^2), x) == :(-1//4*sin(1//4+x+x^2)+(1/2)*x*sin(1//4+x+x^2)+-1//4*2^(1/2)*pi^(1/2)*fresnels((1/2)*2^(1/2)*pi^-1//2*(1+2x))+1//8*2^(1/2)*pi^(1/2)*fresnelc((1/2)*2^(1/2)*pi^-1//2*(1+2x)))
	@test integrate(x*cos(1//4+x+x^2), x) == :((1/2)*sin(1//4+x+x^2)+-1//4*2^(1/2)*pi^(1/2)*fresnelc((1/2)*2^(1/2)*pi^-1//2*(1+2x)))
end

@testset "4.2.2.1 (a+b cos)^m (c+d cos)^n.jl" begin
	@test integrate(cos(c+d*x)^5*(a+a*cos(c+d*x)), x) == :(5//16*a*x+a*d^-1*sin(c+d*x)+-2//3*a*d^-1*sin(c+d*x)^3+1//5*a*d^-1*sin(c+d*x)^5+1//6*a*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//16*a*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a*d^-1*cos(c+d*x)^3*sin(c+d*x))
	@test integrate(cos(c+d*x)^4*(a+a*cos(c+d*x)), x) == :(3//8*a*x+a*d^-1*sin(c+d*x)+-2//3*a*d^-1*sin(c+d*x)^3+1//5*a*d^-1*sin(c+d*x)^5+1//4*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^3*(a+a*cos(c+d*x)), x) == :(3//8*a*x+a*d^-1*sin(c+d*x)+-1//3*a*d^-1*sin(c+d*x)^3+1//4*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^2*(a+a*cos(c+d*x)), x) == :((1/2)*a*x+a*d^-1*sin(c+d*x)+-1//3*a*d^-1*sin(c+d*x)^3+(1/2)*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate((a+a*cos(c+d*x))*cos(c+d*x), x) == :((1/2)*a*x+a*d^-1*sin(c+d*x)+(1/2)*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(a+a*cos(c+d*x), x) == :(a*x+a*d^-1*sin(c+d*x))
	@test integrate((a+a*cos(c+d*x))*sec(c+d*x), x) == :(a*x+a*d^-1*arctanh(sin(c+d*x)))
	@test integrate(sec(c+d*x)^2*(a+a*cos(c+d*x)), x) == :(a*d^-1*arctanh(sin(c+d*x))+a*d^-1*tan(c+d*x))
	@test integrate(sec(c+d*x)^3*(a+a*cos(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+(1/2)*a*d^-1*arctanh(sin(c+d*x))+(1/2)*a*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^4*(a+a*cos(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+(1/2)*a*d^-1*arctanh(sin(c+d*x))+1//3*a*d^-1*tan(c+d*x)^3+(1/2)*a*d^-1*sec(c+d*x)*tan(c+d*x))
end

@testset "4.2.2.3 (g cos)^p (a+b cos)^m (c+d cos)^n.jl" begin
	@test integrate((a+a*cos(e+f*x))^2*(-1c+c*cos(e+f*x))^-1*sec(e+f*x)^2, x) == :(-1*a^2*c^-1*f^-1*tan(e+f*x)+-3*a^2*c^-1*f^-1*arctanh(sin(e+f*x))+4*a^2*c^-1*f^-1*(1+-1*cos(e+f*x))^-1*sin(e+f*x))
end

@testset "4.2.3.1 (a+b cos)^m (c+d cos)^n (A+B cos).jl" begin
	@test integrate(cos(c+d*x)^3*(A+B*cos(c+d*x))*(a+a*cos(c+d*x)), x) == :(3//8*a*x*(A+B)+-1//15*a*d^-1*sin(c+d*x)^3*(4B+5A)+1//5*a*d^-1*(4B+5A)*sin(c+d*x)+1//4*a*d^-1*cos(c+d*x)^3*(A+B)*sin(c+d*x)+1//5*B*a*d^-1*cos(c+d*x)^4*sin(c+d*x)+3//8*a*d^-1*(A+B)*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^2*(A+B*cos(c+d*x))*(a+a*cos(c+d*x)), x) == :(1//8*a*x*(3B+4A)+a*d^-1*(A+B)*sin(c+d*x)+-1//3*a*d^-1*sin(c+d*x)^3*(A+B)+1//4*B*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//8*a*d^-1*(3B+4A)*cos(c+d*x)*sin(c+d*x))
	@test integrate((A+B*cos(c+d*x))*(a+a*cos(c+d*x))*cos(c+d*x), x) == :((1/2)*a*x*(A+B)+1//3*a*d^-1*(2B+3A)*sin(c+d*x)+(1/2)*a*d^-1*(A+B)*cos(c+d*x)*sin(c+d*x)+1//3*B*a*d^-1*cos(c+d*x)^2*sin(c+d*x))
	@test integrate((A+B*cos(c+d*x))*(a+a*cos(c+d*x)), x) == :((1/2)*a*x*(B+2A)+a*d^-1*(A+B)*sin(c+d*x)+(1/2)*B*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate((A+B*cos(c+d*x))*(a+a*cos(c+d*x))*sec(c+d*x), x) == :(a*x*(A+B)+A*a*d^-1*arctanh(sin(c+d*x))+B*a*d^-1*sin(c+d*x))
	@test integrate(sec(c+d*x)^2*(A+B*cos(c+d*x))*(a+a*cos(c+d*x)), x) == :(B*a*x+A*a*d^-1*tan(c+d*x)+a*d^-1*(A+B)*arctanh(sin(c+d*x)))
	@test integrate(sec(c+d*x)^3*(A+B*cos(c+d*x))*(a+a*cos(c+d*x)), x) == :(a*d^-1*(A+B)*tan(c+d*x)+(1/2)*a*d^-1*(A+2B)*arctanh(sin(c+d*x))+(1/2)*A*a*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^4*(A+B*cos(c+d*x))*(a+a*cos(c+d*x)), x) == :((1/2)*a*d^-1*(A+B)*arctanh(sin(c+d*x))+1//3*a*d^-1*(2A+3B)*tan(c+d*x)+(1/2)*a*d^-1*(A+B)*sec(c+d*x)*tan(c+d*x)+1//3*A*a*d^-1*sec(c+d*x)^2*tan(c+d*x))
	@test integrate(sec(c+d*x)^5*(A+B*cos(c+d*x))*(a+a*cos(c+d*x)), x) == :(a*d^-1*(A+B)*tan(c+d*x)+1//3*a*d^-1*tan(c+d*x)^3*(A+B)+1//8*a*d^-1*(3A+4B)*arctanh(sin(c+d*x))+1//4*A*a*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//8*a*d^-1*(3A+4B)*sec(c+d*x)*tan(c+d*x))
	@test integrate((a+a*cos(c+d*x))^2*cos(c+d*x)^3*(A+B*cos(c+d*x)), x) == :(1//16*x*a^2*(11B+12A)+-1//15*a^2*d^-1*sin(c+d*x)^3*(8B+9A)+1//5*a^2*d^-1*(8B+9A)*sin(c+d*x)+1//6*B*d^-1*cos(c+d*x)^4*(a^2+a^2*cos(c+d*x))*sin(c+d*x)+1//16*a^2*d^-1*(11B+12A)*cos(c+d*x)*sin(c+d*x)+1//24*a^2*d^-1*cos(c+d*x)^3*(11B+12A)*sin(c+d*x)+1//30*a^2*d^-1*cos(c+d*x)^4*(6A+7B)*sin(c+d*x))
end

@testset "4.2.4.1 (a+b cos)^m (A+B cos+C cos^2).jl" begin
	@test integrate(cos(c+d*x)^7*(A+C*cos(c+d*x)^2), x) == :(d^-1*(A+C)*sin(c+d*x)+-1//3*d^-1*sin(c+d*x)^3*(3A+4C)+-1//7*d^-1*sin(c+d*x)^7*(A+4C)+1//5*d^-1*sin(c+d*x)^5*(3A+6C)+1//9*C*d^-1*sin(c+d*x)^9)
	@test integrate(cos(c+d*x)^5*(A+C*cos(c+d*x)^2), x) == :(d^-1*(A+C)*sin(c+d*x)+-1//3*d^-1*sin(c+d*x)^3*(2A+3C)+-1//7*C*d^-1*sin(c+d*x)^7+1//5*d^-1*sin(c+d*x)^5*(A+3C))
	@test integrate(cos(c+d*x)^3*(A+C*cos(c+d*x)^2), x) == :(d^-1*(A+C)*sin(c+d*x)+-1//3*d^-1*sin(c+d*x)^3*(A+2C)+1//5*C*d^-1*sin(c+d*x)^5)
	@test integrate((A+C*cos(c+d*x)^2)*cos(c+d*x), x) == :(d^-1*(A+C)*sin(c+d*x)+-1//3*C*d^-1*sin(c+d*x)^3)
	@test integrate((A+C*cos(c+d*x)^2)*sec(c+d*x), x) == :(A*d^-1*arctanh(sin(c+d*x))+C*d^-1*sin(c+d*x))
	@test integrate(sec(c+d*x)^3*(A+C*cos(c+d*x)^2), x) == :((1/2)*d^-1*(A+2C)*arctanh(sin(c+d*x))+(1/2)*A*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^5*(A+C*cos(c+d*x)^2), x) == :(1//8*d^-1*(3A+4C)*arctanh(sin(c+d*x))+1//4*A*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//8*d^-1*(3A+4C)*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^7*(A+C*cos(c+d*x)^2), x) == :(1//16*d^-1*(5A+6C)*arctanh(sin(c+d*x))+1//6*A*d^-1*sec(c+d*x)^5*tan(c+d*x)+1//16*d^-1*(5A+6C)*sec(c+d*x)*tan(c+d*x)+1//24*d^-1*sec(c+d*x)^3*(5A+6C)*tan(c+d*x))
	@test integrate(cos(c+d*x)^6*(A+C*cos(c+d*x)^2), x) == :(1//128*x*(35C+40A)+1//8*C*d^-1*cos(c+d*x)^7*sin(c+d*x)+1//48*d^-1*cos(c+d*x)^5*(7C+8A)*sin(c+d*x)+1//128*d^-1*(35C+40A)*cos(c+d*x)*sin(c+d*x)+1//192*d^-1*cos(c+d*x)^3*(35C+40A)*sin(c+d*x))
	@test integrate(cos(c+d*x)^4*(A+C*cos(c+d*x)^2), x) == :(1//16*x*(5C+6A)+1//6*C*d^-1*cos(c+d*x)^5*sin(c+d*x)+1//16*d^-1*(5C+6A)*cos(c+d*x)*sin(c+d*x)+1//24*d^-1*cos(c+d*x)^3*(5C+6A)*sin(c+d*x))
end

@testset "4.2.4.2 (a+b cos)^m (c+d cos)^n (A+B cos+C cos^2).jl" begin
	@test integrate(cos(c+d*x)^2*(A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x)), x) == :(1//8*a*x*(3C+4A)+-1//15*a*d^-1*sin(c+d*x)^3*(4C+5A)+1//5*a*d^-1*(4C+5A)*sin(c+d*x)+1//4*C*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//5*C*a*d^-1*cos(c+d*x)^4*sin(c+d*x)+1//8*a*d^-1*(3C+4A)*cos(c+d*x)*sin(c+d*x))
	@test integrate((A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x))*cos(c+d*x), x) == :(1//8*a*x*(3C+4A)+1//3*a*d^-1*(2C+3A)*sin(c+d*x)+1//3*C*a*d^-1*cos(c+d*x)^2*sin(c+d*x)+1//4*C*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//8*a*d^-1*(3C+4A)*cos(c+d*x)*sin(c+d*x))
	@test integrate((A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x)), x) == :((1/2)*a*x*(C+2A)+1//3*a*d^-1*(C+3A)*sin(c+d*x)+-1//6*C*a*d^-1*cos(c+d*x)*sin(c+d*x)+1//3*C*a^-1*d^-1*(a+a*cos(c+d*x))^2*sin(c+d*x))
	@test integrate((A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x))*sec(c+d*x), x) == :((1/2)*a*x*(C+2A)+A*a*d^-1*arctanh(sin(c+d*x))+C*a*d^-1*sin(c+d*x)+(1/2)*C*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(sec(c+d*x)^2*(A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x)), x) == :(C*a*x+A*a*d^-1*arctanh(sin(c+d*x))+A*a*d^-1*tan(c+d*x)+C*a*d^-1*sin(c+d*x))
	@test integrate(sec(c+d*x)^3*(A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x)), x) == :(C*a*x+A*a*d^-1*tan(c+d*x)+(1/2)*a*d^-1*(A+2C)*arctanh(sin(c+d*x))+(1/2)*A*a*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^4*(A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x)), x) == :((1/2)*a*d^-1*(A+2C)*arctanh(sin(c+d*x))+1//3*a*d^-1*(2A+3C)*tan(c+d*x)+(1/2)*A*a*d^-1*sec(c+d*x)*tan(c+d*x)+1//3*A*a*d^-1*sec(c+d*x)^2*tan(c+d*x))
	@test integrate(sec(c+d*x)^5*(A+C*cos(c+d*x)^2)*(a+a*cos(c+d*x)), x) == :(1//3*a*d^-1*(2A+3C)*tan(c+d*x)+1//8*a*d^-1*(3A+4C)*arctanh(sin(c+d*x))+1//3*A*a*d^-1*sec(c+d*x)^2*tan(c+d*x)+1//4*A*a*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//8*a*d^-1*(3A+4C)*sec(c+d*x)*tan(c+d*x))
	@test integrate((a+a*cos(c+d*x))^2*cos(c+d*x)^2*(A+C*cos(c+d*x)^2), x) == :(1//16*x*a^2*(11C+14A)+-2//15*a^2*d^-1*sin(c+d*x)^3*(4C+5A)+2//5*a^2*d^-1*(4C+5A)*sin(c+d*x)+1//6*C*d^-1*(a+a*cos(c+d*x))^2*cos(c+d*x)^3*sin(c+d*x)+1//15*C*d^-1*cos(c+d*x)^3*(a^2+a^2*cos(c+d*x))*sin(c+d*x)+1//16*a^2*d^-1*(11C+14A)*cos(c+d*x)*sin(c+d*x)+1//40*a^2*d^-1*cos(c+d*x)^3*(9C+10A)*sin(c+d*x))
	@test integrate((a+a*cos(c+d*x))^2*(A+C*cos(c+d*x)^2)*cos(c+d*x), x) == :(1//4*x*a^2*(3C+4A)+1//3*a^2*d^-1*(3C+4A)*sin(c+d*x)+1//30*d^-1*(a+a*cos(c+d*x))^2*(3C+10A)*sin(c+d*x)+1//5*C*d^-1*(a+a*cos(c+d*x))^2*cos(c+d*x)^2*sin(c+d*x)+1//10*C*a^-1*d^-1*(a+a*cos(c+d*x))^3*sin(c+d*x)+1//12*a^2*d^-1*(3C+4A)*cos(c+d*x)*sin(c+d*x))
end

@testset "4.2.7 (d trig)^m (a+b (c cos)^n)^p.jl" begin
	@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^6, x) == :(3//8*x*a^-1+-3//8*a^-1*cos(x)*sin(x)+-1//4*a^-1*sin(x)^3*cos(x))
	@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^5, x) == :(-1*a^-1*cos(x)+1//3*a^-1*cos(x)^3)
	@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^4, x) == :((1/2)*x*a^-1+-1//2*a^-1*cos(x)*sin(x))
	@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^3, x) == :(-1*a^-1*cos(x))
	@test integrate((a+-1*a*cos(x)^2)^-1*sin(x)^2, x) == :(x*a^-1)
	@test integrate((a+-1*a*cos(x)^2)^-1*sin(x), x) == :(-1*a^-1*arctanh(cos(x)))
	@test integrate((a+-1*a*cos(x)^2)^-1*csc(x), x) == :(-1//2*a^-1*arctanh(cos(x))+-1//2*a^-1*cot(x)*csc(x))
	@test integrate((a+-1*a*cos(x)^2)^-1*csc(x)^2, x) == :(-1*a^-1*cot(x)+-1//3*a^-1*cot(x)^3)
	@test integrate((a+-1*a*cos(x)^2)^-1*csc(x)^3, x) == :(-3//8*a^-1*arctanh(cos(x))+-3//8*a^-1*cot(x)*csc(x)+-1//4*a^-1*csc(x)^3*cot(x))
	@test integrate((a+b*cos(x)^2)^-1*sin(x)^7, x) == :(1//5*b^-1*cos(x)^5+b^-3*(a^2+3*b^2+3*a*b)*cos(x)+-1//3*b^-2*cos(x)^3*(a+3b)+-1*a^-1//2*b^-7//2*(a+b)^3*arctan(a^-1//2*b^(1/2)*cos(x)))
end

@testset "4.2.8 (a+b cos)^m (c+d trig)^n.jl" begin
	@test integrate((a+b*cos(x))^-1*(A+B*sin(x)), x) == :(-1*B*b^-1*log(a+b*cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
	@test integrate((1+cos(x))^-1*(A+B*sin(x)), x) == :(-1*B*log(1+cos(x))+A*(1+cos(x))^-1*sin(x))
	@test integrate((1+-1*cos(x))^-1*(A+B*sin(x)), x) == :(B*log(1+-1*cos(x))+-1*A*(1+-1*cos(x))^-1*sin(x))
	@test integrate((a+b*cos(x))^-1*(b+c+sin(x)), x) == :(-1*b^-1*log(a+b*cos(x))+(a+b)^-1//2*(a+-1b)^-1//2*(2b+2c)*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
	@test integrate((a+-1*b*cos(x))^-1*(b+c+sin(x)), x) == :(b^-1*log(a+-1*b*cos(x))+(a+b)^-1//2*(a+-1b)^-1//2*(2b+2c)*arctan((a+b)^(1/2)*(a+-1b)^-1//2*tan((1/2)*x)))
	@test integrate((a+b*cos(x))^-1*(A+B*tan(x)), x) == :(B*a^-1*log(a+b*cos(x))+-1*B*a^-1*log(cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
	@test integrate((a+b*cos(x))^-1*(A+B*cot(x)), x) == :(B*(-2b+2a)^-1*log(1+cos(x))+B*(2a+2b)^-1*log(1+-1*cos(x))+-1*B*a*(a^2+-1*b^2)^-1*log(a+b*cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
	@test integrate((a+b*cos(x))^-1*(A+B*csc(x)), x) == :(B*(2a+2b)^-1*log(1+-1*cos(x))+-1*B*(-2b+2a)^-1*log(1+cos(x))+B*b*(a^2+-1*b^2)^-1*log(a+b*cos(x))+2*A*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*x)))
	@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^4, x) == :(a^-1*d^4*f^-1*tan(e+f*x)+1//3*a^-1*d^4*f^-1*tan(e+f*x)^3+a^-3*d^2*f^-1*(b^2*d^2+6*a^2*c^2+-4*a*b*c*d)*tan(e+f*x)+(1/2)*a^-2*d^3*f^-1*(-1*b*d+4*a*c)*arctanh(sin(e+f*x))+d*a^-4*f^-1*(-1*b*d+2*a*c)*(b^2*d^2+2*a^2*c^2+-2*a*b*c*d)*arctanh(sin(e+f*x))+(1/2)*a^-2*d^3*f^-1*(-1*b*d+4*a*c)*sec(e+f*x)*tan(e+f*x)+2*a^-4*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^4*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
	@test integrate((a+b*cos(e+f*x))^-1*(c+d*sec(e+f*x))^3, x) == :((1/2)*a^-1*d^3*f^-1*arctanh(sin(e+f*x))+d*a^-3*f^-1*(b^2*d^2+3*a^2*c^2+-3*a*b*c*d)*arctanh(sin(e+f*x))+a^-2*d^2*f^-1*(-1*b*d+3*a*c)*tan(e+f*x)+(1/2)*a^-1*d^3*f^-1*sec(e+f*x)*tan(e+f*x)+2*a^-3*f^-1*(a+b)^-1//2*(a+-1b)^-1//2*(a*c+-1*b*d)^3*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*e+(1/2)*f*x)))
end

@testset "4.2.9 trig^m (a+b cos^n+c cos^(2 n))^p.jl" begin
	@test integrate((a+b*cos(x)+c*cos(x)^2)^-1*sin(x)^5, x) == :(-1//3*c^-1*cos(x)^3+(1/2)*b*c^-2*cos(x)^2+-1*c^-3*(b^2+-1*c*(a+2c))*cos(x)+c^-4*(b^2+-4*a*c)^-1//2*(b^4+2*c^2*(a+c)^2+-2*c*b^2*(c+2a))*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*cos(x)))+(1/2)*b*c^-4*(b^2+-2*c*(a+c))*log(a+b*cos(x)+c*cos(x)^2))
	@test integrate((a+b*cos(x)+c*cos(x)^2)^-1*sin(x)^3, x) == :(c^-1*cos(x)+-1//2*b*c^-2*log(a+b*cos(x)+c*cos(x)^2)+-1*c^-2*(b^2+-4*a*c)^-1//2*(b^2+-2*c*(a+c))*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*cos(x))))
	@test integrate((a+b*cos(x)+c*cos(x)^2)^-1*sin(x), x) == :(2*(b^2+-4*a*c)^-1//2*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*cos(x))))
	@test integrate((a+b*cos(x)+c*cos(x)^2)^-1*csc(x), x) == :((2a+2b+2c)^-1*log(1+-1*cos(x))+-1*(-2b+2a+2c)^-1*log(1+cos(x))+b*(a+b+c)^-1*(-2b+2a+2c)^-1*log(a+b*cos(x)+c*cos(x)^2)+-1*(b^2+-4*a*c)^-1//2*(a+b+c)^-1*(a+c+-1b)^-1*(b^2+-2*c^2+-2*a*c)*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*cos(x))))
	@test integrate((a+b*cos(x)+c*cos(x)^2)^-1*csc(x)^3, x) == :(-1//4*(a+c+-1b)^-2*(a+-2b+3c)*log(1+cos(x))+1//4*(a+b+c)^-2*(a+2b+3c)*log(1+-1*cos(x))+(b^2+-4*a*c)^-1//2*(a^2+c^2+-1*b^2+2*a*c)^-2*(b^4+2*c^2*(a+c)^2+-2*c*b^2*(c+2a))*arctanh((b^2+-4*a*c)^-1//2*(b+2*c*cos(x)))+(a+b+c)^-1*(-2b+2a+2c)^-1*csc(x)^2*(b+-1*(a+c)*cos(x))+-1//2*b*(a^2+c^2+-1*b^2+2*a*c)^-2*(b^2+-2*c*(a+c))*log(a+b*cos(x)+c*cos(x)^2))
	@test integrate((a+b*cos(x)+c*cos(x)^2)^-1*sin(x)^2, x) == :(-1*x*c^-1+c^-1*(b+(b^2+-4*a*c)^(1/2)+-2c)^-1//2*(b+(b^2+-4*a*c)^(1/2)+2c)^-1//2*(2b+2*(b^2+-4*a*c)^-1//2*(b^2+-2*c*(a+c)))*arctan((b+(b^2+-4*a*c)^(1/2)+-2c)^(1/2)*(b+(b^2+-4*a*c)^(1/2)+2c)^-1//2*tan((1/2)*x))+c^-1*(b+-1*(b^2+-4*a*c)^(1/2)+-2c)^-1//2*(b+-1*(b^2+-4*a*c)^(1/2)+2c)^-1//2*(2b+-2*(b^2+-4*a*c)^-1//2*(b^2+-2*c*(a+c)))*arctan((b+-1*(b^2+-4*a*c)^(1/2)+-2c)^(1/2)*(b+-1*(b^2+-4*a*c)^(1/2)+2c)^-1//2*tan((1/2)*x)))
	@test integrate((a+b*cos(x)+c*cos(x)^2)^-1*csc(x)^2, x) == :((1+cos(x))^-1*(-2b+2a+2c)^-1*sin(x)+-1*(1+-1*cos(x))^-1*(2a+2b+2c)^-1*sin(x)+-2*b*c*(a+b+c)^-1*(a+c+-1b)^-1*(b+(b^2+-4*a*c)^(1/2)+-2c)^-1//2*(b+(b^2+-4*a*c)^(1/2)+2c)^-1//2*(1+-1*b^-1*(b^2+-4*a*c)^-1//2*(b^2+-2*c*(a+c)))*arctan((b+(b^2+-4*a*c)^(1/2)+-2c)^(1/2)*(b+(b^2+-4*a*c)^(1/2)+2c)^-1//2*tan((1/2)*x))+-2*b*c*(a+b+c)^-1*(a+c+-1b)^-1*(b+-1*(b^2+-4*a*c)^(1/2)+-2c)^-1//2*(b+-1*(b^2+-4*a*c)^(1/2)+2c)^-1//2*(1+b^-1*(b^2+-4*a*c)^-1//2*(b^2+-2*c*(a+c)))*arctan((b+-1*(b^2+-4*a*c)^(1/2)+-2c)^(1/2)*(b+-1*(b^2+-4*a*c)^(1/2)+2c)^-1//2*tan((1/2)*x)))
	@test integrate((-2+cos(x)^2+cos(x))^-1*sin(x), x) == :(-1//3*log(1+-1*cos(x))+1//3*log(2+cos(x)))
	@test integrate((4+cos(x)^2+-5*cos(x))^-1*sin(x), x) == :(-1//3*log(4+-1*cos(x))+1//3*log(1+-1*cos(x)))
	@test integrate((3+cos(x)^2+-2*cos(x))^-1*sin(x), x) == :((1/2)*2^(1/2)*arctan((1/2)*2^(1/2)*(1+-1*cos(x))))
end

@testset "4.3.0 (a trg)^m (b tan)^n.jl" begin
	@test integrate(tan(c+d*x), x) == :(-1*d^-1*log(cos(c+d*x)))
	@test integrate(tan(c+d*x)^2, x) == :(-1x+d^-1*tan(c+d*x))
	@test integrate(tan(c+d*x)^3, x) == :(d^-1*log(cos(c+d*x))+(1/2)*d^-1*tan(c+d*x)^2)
	@test integrate(tan(c+d*x)^4, x) == :(x+-1*d^-1*tan(c+d*x)+1//3*d^-1*tan(c+d*x)^3)
	@test integrate(tan(c+d*x)^5, x) == :(-1*d^-1*log(cos(c+d*x))+-1//2*d^-1*tan(c+d*x)^2+1//4*d^-1*tan(c+d*x)^4)
	@test integrate(tan(c+d*x)^6, x) == :(-1x+d^-1*tan(c+d*x)+-1//3*d^-1*tan(c+d*x)^3+1//5*d^-1*tan(c+d*x)^5)
	@test integrate(tan(c+d*x)^7, x) == :(d^-1*log(cos(c+d*x))+(1/2)*d^-1*tan(c+d*x)^2+-1//4*d^-1*tan(c+d*x)^4+1//6*d^-1*tan(c+d*x)^6)
	@test integrate(tan(c+d*x)^8, x) == :(x+-1*d^-1*tan(c+d*x)+-1//5*d^-1*tan(c+d*x)^5+1//3*d^-1*tan(c+d*x)^3+1//7*d^-1*tan(c+d*x)^7)
	@test integrate((b*tan(c+d*x))^7//2, x) == :(-2*b^3*d^-1*(b*tan(c+d*x))^(1/2)+2//5*b*d^-1*(b*tan(c+d*x))^5//2+(1/2)*2^(1/2)*b^7//2*d^-1*arctan(1+2^(1/2)*b^-1//2*(b*tan(c+d*x))^(1/2))+-1//2*2^(1/2)*b^7//2*d^-1*arctan(1+-1*2^(1/2)*b^-1//2*(b*tan(c+d*x))^(1/2))+-1//4*2^(1/2)*b^7//2*d^-1*log(b^(1/2)+b^(1/2)*tan(c+d*x)+-1*2^(1/2)*(b*tan(c+d*x))^(1/2))+1//4*2^(1/2)*b^7//2*d^-1*log(b^(1/2)+2^(1/2)*(b*tan(c+d*x))^(1/2)+b^(1/2)*tan(c+d*x)))
	@test integrate((b*tan(c+d*x))^5//2, x) == :(2//3*b*d^-1*(b*tan(c+d*x))^3//2+(1/2)*2^(1/2)*b^5//2*d^-1*arctan(1+-1*2^(1/2)*b^-1//2*(b*tan(c+d*x))^(1/2))+-1//2*2^(1/2)*b^5//2*d^-1*arctan(1+2^(1/2)*b^-1//2*(b*tan(c+d*x))^(1/2))+-1//4*2^(1/2)*b^5//2*d^-1*log(b^(1/2)+b^(1/2)*tan(c+d*x)+-1*2^(1/2)*(b*tan(c+d*x))^(1/2))+1//4*2^(1/2)*b^5//2*d^-1*log(b^(1/2)+2^(1/2)*(b*tan(c+d*x))^(1/2)+b^(1/2)*tan(c+d*x)))
end

@testset "4.3.1.2 (d sec)^m (a+b tan)^n.jl" begin
	@test integrate(sec(c+d*x)^10*(a+im*a*tan(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+1//9*a*d^-1*tan(c+d*x)^9+4//3*a*d^-1*tan(c+d*x)^3+4//7*a*d^-1*tan(c+d*x)^7+6//5*a*d^-1*tan(c+d*x)^5+1//10*im*a*d^-1*sec(c+d*x)^10)
	@test integrate(sec(c+d*x)^8*(a+im*a*tan(c+d*x)), x) == :(a*d^-1*tan(c+d*x)^3+a*d^-1*tan(c+d*x)+1//7*a*d^-1*tan(c+d*x)^7+3//5*a*d^-1*tan(c+d*x)^5+1//8*im*a*d^-1*sec(c+d*x)^8)
	@test integrate(sec(c+d*x)^6*(a+im*a*tan(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+1//5*a*d^-1*tan(c+d*x)^5+2//3*a*d^-1*tan(c+d*x)^3+1//6*im*a*d^-1*sec(c+d*x)^6)
	@test integrate(sec(c+d*x)^4*(a+im*a*tan(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+1//3*a*d^-1*tan(c+d*x)^3+1//4*im*a*d^-1*sec(c+d*x)^4)
	@test integrate(a+im*a*tan(c+d*x), x) == :(a*x+-1*im*a*d^-1*log(cos(c+d*x)))
	@test integrate(cos(c+d*x)^2*(a+im*a*tan(c+d*x)), x) == :((1/2)*a*x+(1/2)*a*d^-1*cos(c+d*x)*sin(c+d*x)+-1//2*im*a*d^-1*cos(c+d*x)^2)
	@test integrate(cos(c+d*x)^4*(a+im*a*tan(c+d*x)), x) == :(3//8*a*x+-1//4*im*a*d^-1*cos(c+d*x)^4+1//4*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^6*(a+im*a*tan(c+d*x)), x) == :(5//16*a*x+-1//6*im*a*d^-1*cos(c+d*x)^6+1//6*a*d^-1*cos(c+d*x)^5*sin(c+d*x)+5//16*a*d^-1*cos(c+d*x)*sin(c+d*x)+5//24*a*d^-1*cos(c+d*x)^3*sin(c+d*x))
	@test integrate(cos(c+d*x)^8*(a+im*a*tan(c+d*x)), x) == :(35//128*a*x+-1//8*im*a*d^-1*cos(c+d*x)^8+1//8*a*d^-1*cos(c+d*x)^7*sin(c+d*x)+7//48*a*d^-1*cos(c+d*x)^5*sin(c+d*x)+35//128*a*d^-1*cos(c+d*x)*sin(c+d*x)+35//192*a*d^-1*cos(c+d*x)^3*sin(c+d*x))
	@test integrate(sec(c+d*x)^7*(a+im*a*tan(c+d*x)), x) == :(5//16*a*d^-1*arctanh(sin(c+d*x))+1//6*a*d^-1*sec(c+d*x)^5*tan(c+d*x)+1//7*im*a*d^-1*sec(c+d*x)^7+5//16*a*d^-1*sec(c+d*x)*tan(c+d*x)+5//24*a*d^-1*sec(c+d*x)^3*tan(c+d*x))
end

@testset "4.3.1.3 (d sin)^m (a+b tan)^n.jl" begin
	@test integrate((im+tan(x))^-1*sin(x)^4, x) == :(-5//32*(im+tan(x))^-2+-1//32*(im+-1*tan(x))^-2+-1*im*(-8*tan(x)+8im)^-1+-3*im*(16im+16*tan(x))^-1+-1//16*im*x+1//24*im*(im+tan(x))^-3)
	@test integrate((im+tan(x))^-1*sin(x)^3, x) == :(1//5*sin(x)^5+-1//5*im*cos(x)^5+1//3*im*cos(x)^3)
	@test integrate((im+tan(x))^-1*sin(x)^2, x) == :(-1//8*(im+tan(x))^-2+-1*im*(-8*tan(x)+8im)^-1+-1*im*(4im+4*tan(x))^-1+-1//8*im*x)
	@test integrate((im+tan(x))^-1*sin(x), x) == :(1//3*sin(x)^3+1//3*im*cos(x)^3)
	@test integrate((im+tan(x))^-1*csc(x), x) == :(im*arctanh(cos(x))+-1*im*cos(x)+sin(x))
	@test integrate((im+tan(x))^-1*csc(x)^2, x) == :(im*x+im*cot(x)+log(cos(x))+log(tan(x)))
	@test integrate((im+tan(x))^-1*csc(x)^3, x) == :(-1*csc(x)+-1//2*im*arctanh(cos(x))+(1/2)*im*cot(x)*csc(x))
	@test integrate((im+tan(x))^-1*csc(x)^4, x) == :(-1//2*cot(x)^2+1//3*im*cot(x)^3)
	@test integrate((im+tan(x))^-1*csc(x)^5, x) == :(-1//3*csc(x)^3+-1//8*im*arctanh(cos(x))+-1//8*im*cot(x)*csc(x)+1//4*im*csc(x)^3*cot(x))
	@test integrate((im+tan(x))^-1*csc(x)^6, x) == :(-1//2*cot(x)^2+-1//4*cot(x)^4+1//3*im*cot(x)^3+1//5*im*cot(x)^5)
end

@testset "4.3.10 (c+d x)^m (a+b tan)^n.jl" begin
	@test integrate(x^3*tan(a+b*x), x) == :(1//4*im*x^4+-1*b^-1*x^3*log(1+exp(2*im*(a+b*x)))+-3//2*x*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+-3//4*im*b^-4*Polylogarithms.polylog(4,-1*exp(2*im*(a+b*x)))+3//2*im*b^-2*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
	@test integrate(x^2*tan(a+b*x), x) == :(-1//2*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+1//3*im*x^3+-1*b^-1*x^2*log(1+exp(2*im*(a+b*x)))+im*x*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
	@test integrate(x*tan(a+b*x), x) == :((1/2)*im*x^2+(1/2)*im*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x)))+-1*x*b^-1*log(1+exp(2*im*(a+b*x))))
	@test integrate(x^3*tan(a+b*x)^2, x) == :(-1//4*x^4+3//2*b^-4*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+b^-1*x^3*tan(a+b*x)+-1*im*b^-1*x^3+3*b^-2*x^2*log(1+exp(2*im*(a+b*x)))+-3*im*x*b^-3*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
	@test integrate(x^2*tan(a+b*x)^2, x) == :(-1//3*x^3+b^-1*x^2*tan(a+b*x)+-1*im*b^-1*x^2+-1*im*b^-3*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x)))+2*x*b^-2*log(1+exp(2*im*(a+b*x))))
	@test integrate(x*tan(a+b*x)^2, x) == :(-1//2*x^2+b^-2*log(cos(a+b*x))+x*b^-1*tan(a+b*x))
	@test integrate(x^3*tan(a+b*x)^3, x) == :((1/2)*b^-1*x^3+-1//4*im*x^4+b^-1*x^3*log(1+exp(2*im*(a+b*x)))+(1/2)*b^-1*x^3*tan(a+b*x)^2+-3*x*b^-3*log(1+exp(2*im*(a+b*x)))+-3//2*b^-2*x^2*tan(a+b*x)+3//2*im*b^-4*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x)))+3//2*im*b^-2*x^2+3//2*x*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+3//4*im*b^-4*Polylogarithms.polylog(4,-1*exp(2*im*(a+b*x)))+-3//2*im*b^-2*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
	@test integrate(x^2*tan(a+b*x)^3, x) == :((1/2)*b^-1*x^2+(1/2)*b^-3*Polylogarithms.polylog(3,-1*exp(2*im*(a+b*x)))+-1*b^-3*log(cos(a+b*x))+-1//3*im*x^3+b^-1*x^2*log(1+exp(2*im*(a+b*x)))+(1/2)*b^-1*x^2*tan(a+b*x)^2+-1*x*b^-2*tan(a+b*x)+-1*im*x*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
	@test integrate(x*tan(a+b*x)^3, x) == :((1/2)*x*b^-1+-1//2*im*x^2+-1//2*b^-2*tan(a+b*x)+x*b^-1*log(1+exp(2*im*(a+b*x)))+(1/2)*x*b^-1*tan(a+b*x)^2+-1//2*im*b^-2*Polylogarithms.polylog(2,-1*exp(2*im*(a+b*x))))
	@test integrate(x^2*tan(a+b*x)^(1/2)+x^2*tan(a+b*x)^-3//2+-4*x*b^-1*tan(a+b*x)^-1//2, x) == :(-2*b^-1*x^2*tan(a+b*x)^-1//2)
end

@testset "4.3.11 (e x)^m (a+b tan(c+d x^n))^p.jl" begin
	@test integrate(x^3*(a+b*tan(c+d*x^2)), x) == :(1//4*a*x^4+1//4*im*b*x^4+-1//2*b*d^-1*x^2*log(1+exp(2*im*(c+d*x^2)))+1//4*im*b*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^2))))
	@test integrate(x*(a+b*tan(c+d*x^2)), x) == :((1/2)*a*x^2+-1//2*b*d^-1*log(cos(c+d*x^2)))
	@test integrate(x^3*(a+b*tan(c+d*x^2))^2, x) == :(-1//4*b^2*x^4+1//4*a^2*x^4+(1/2)*b^2*d^-2*log(cos(c+d*x^2))+(1/2)*im*a*b*x^4+(1/2)*b^2*d^-1*x^2*tan(c+d*x^2)+(1/2)*im*a*b*d^-2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^2)))+-1*a*b*d^-1*x^2*log(1+exp(2*im*(c+d*x^2))))
	@test integrate(x*(a+b*tan(c+d*x^2))^2, x) == :((1/2)*x^2*(a^2+-1*b^2)+(1/2)*b^2*d^-1*tan(c+d*x^2)+-1*a*b*d^-1*log(cos(c+d*x^2)))
	@test integrate(x^3*(a+b*tan(c+d*x^2))^-1, x) == :(x^4*(4a+4*im*b)^-1+b*d^-1*x^2*(2*a^2+2*b^2)^-1*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2)))+-1*im*b*d^-2*(4*a^2+4*b^2)^-1*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2))))
	@test integrate(x*(a+b*tan(c+d*x^2))^-1, x) == :(a*x^2*(2*a^2+2*b^2)^-1+b*d^-1*(2*a^2+2*b^2)^-1*log(a*cos(c+d*x^2)+b*sin(c+d*x^2)))
	@test integrate(x^3*(a+b*tan(c+d*x^2))^-2, x) == :(-1*x^4*(4*a^2+4*b^2)^-1+(1/2)*b*d^-2*(a^2+b^2)^-2*(b+2*a*d*x^2)*log(1+(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2)))+-1*b*d^-1*x^2*(a+b*tan(c+d*x^2))^-1*(2*a^2+2*b^2)^-1+1//8*a^-1*d^-2*(a+im*b)^-1*(b+2*a*d*x^2)^2*(a^2+b^2)^-1+-1//2*im*a*b*d^-2*(a^2+b^2)^-2*Polylogarithms.polylog(2,-1*(a+im*b)^-2*(a^2+b^2)*exp(2*im*(c+d*x^2))))
	@test integrate(x*(a+b*tan(c+d*x^2))^-2, x) == :((1/2)*x^2*(a^2+b^2)^-2*(a^2+-1*b^2)+-1*b*d^-1*(a+b*tan(c+d*x^2))^-1*(2*a^2+2*b^2)^-1+a*b*d^-1*(a^2+b^2)^-2*log(a*cos(c+d*x^2)+b*sin(c+d*x^2)))
	@test integrate(x^3*(a+b*tan(c+d*x^(1/2))), x) == :(1//4*a*x^4+1//4*im*b*x^4+-21*b*d^-3*x^5//2*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+-2*b*d^-1*x^7//2*log(1+exp(2*im*(c+d*x^(1/2))))+105*b*d^-5*x^3//2*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^(1/2))))+-315//2*b*d^-7*x^(1/2)*Polylogarithms.polylog(7,-1*exp(2*im*(c+d*x^(1/2))))+-315//4*im*b*d^-8*Polylogarithms.polylog(8,-1*exp(2*im*(c+d*x^(1/2))))+7*im*b*d^-2*x^3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2))))+-105//2*im*b*d^-4*x^2*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+315//2*im*b*x*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^(1/2)))))
	@test integrate(x^2*(a+b*tan(c+d*x^(1/2))), x) == :(1//3*a*x^3+1//3*im*b*x^3+-10*b*d^-3*x^3//2*Polylogarithms.polylog(3,-1*exp(2*im*(c+d*x^(1/2))))+-2*b*d^-1*x^5//2*log(1+exp(2*im*(c+d*x^(1/2))))+15*b*d^-5*x^(1/2)*Polylogarithms.polylog(5,-1*exp(2*im*(c+d*x^(1/2))))+15//2*im*b*d^-6*Polylogarithms.polylog(6,-1*exp(2*im*(c+d*x^(1/2))))+-15*im*b*x*d^-4*Polylogarithms.polylog(4,-1*exp(2*im*(c+d*x^(1/2))))+5*im*b*d^-2*x^2*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^(1/2)))))
end

@testset "4.3.2.1 (a+b tan)^m (c+d tan)^n.jl" begin
	@test integrate(tan(c+d*x)^5*(a+im*a*tan(c+d*x)), x) == :(-1*im*a*x+-1*a*d^-1*log(cos(c+d*x))+-1//2*a*d^-1*tan(c+d*x)^2+1//4*a*d^-1*tan(c+d*x)^4+im*a*d^-1*tan(c+d*x)+-1//3*im*a*d^-1*tan(c+d*x)^3+1//5*im*a*d^-1*tan(c+d*x)^5)
	@test integrate(tan(c+d*x)^4*(a+im*a*tan(c+d*x)), x) == :(a*x+-1*a*d^-1*tan(c+d*x)+1//3*a*d^-1*tan(c+d*x)^3+-1*im*a*d^-1*log(cos(c+d*x))+-1//2*im*a*d^-1*tan(c+d*x)^2+1//4*im*a*d^-1*tan(c+d*x)^4)
	@test integrate(tan(c+d*x)^3*(a+im*a*tan(c+d*x)), x) == :(im*a*x+a*d^-1*log(cos(c+d*x))+(1/2)*a*d^-1*tan(c+d*x)^2+-1*im*a*d^-1*tan(c+d*x)+1//3*im*a*d^-1*tan(c+d*x)^3)
	@test integrate(tan(c+d*x)^2*(a+im*a*tan(c+d*x)), x) == :(-1*a*x+a*d^-1*tan(c+d*x)+im*a*d^-1*log(cos(c+d*x))+(1/2)*im*a*d^-1*tan(c+d*x)^2)
	@test integrate((a+im*a*tan(c+d*x))*tan(c+d*x), x) == :(-1*im*a*x+-1*a*d^-1*log(cos(c+d*x))+im*a*d^-1*tan(c+d*x))
	@test integrate(a+im*a*tan(c+d*x), x) == :(a*x+-1*im*a*d^-1*log(cos(c+d*x)))
	@test integrate((a+im*a*tan(c+d*x))*cot(c+d*x), x) == :(im*a*x+a*d^-1*log(sin(c+d*x)))
	@test integrate(cot(c+d*x)^2*(a+im*a*tan(c+d*x)), x) == :(-1*a*x+-1*a*d^-1*cot(c+d*x)+im*a*d^-1*log(sin(c+d*x)))
	@test integrate(cot(c+d*x)^3*(a+im*a*tan(c+d*x)), x) == :(-1*im*a*x+-1*a*d^-1*log(sin(c+d*x))+-1//2*a*d^-1*cot(c+d*x)^2+-1*im*a*d^-1*cot(c+d*x))
	@test integrate(cot(c+d*x)^4*(a+im*a*tan(c+d*x)), x) == :(a*x+a*d^-1*cot(c+d*x)+-1//3*a*d^-1*cot(c+d*x)^3+-1*im*a*d^-1*log(sin(c+d*x))+-1//2*im*a*d^-1*cot(c+d*x)^2)
end

@testset "4.3.3.1 (a+b tan)^m (c+d tan)^n (A+B tan).jl" begin
	@test integrate(tan(c+d*x)^2*(A+B*tan(c+d*x))*(a+im*a*tan(c+d*x)), x) == :(-1*a*x*(A+-1*im*B)+a*d^-1*(A+-1*im*B)*tan(c+d*x)+a*d^-1*(B+im*A)*log(cos(c+d*x))+(1/2)*a*d^-1*tan(c+d*x)^2*(B+im*A)+1//3*im*B*a*d^-1*tan(c+d*x)^3)
	@test integrate((A+B*tan(c+d*x))*(a+im*a*tan(c+d*x))*tan(c+d*x), x) == :(-1*a*x*(B+im*A)+a*d^-1*(B+im*A)*tan(c+d*x)+-1*a*d^-1*(A+-1*im*B)*log(cos(c+d*x))+(1/2)*im*B*a*d^-1*tan(c+d*x)^2)
	@test integrate((A+B*tan(c+d*x))*(a+im*a*tan(c+d*x)), x) == :(a*x*(A+-1*im*B)+-1*a*d^-1*(B+im*A)*log(cos(c+d*x))+im*B*a*d^-1*tan(c+d*x))
	@test integrate((A+B*tan(c+d*x))*(a+im*a*tan(c+d*x))*cot(c+d*x), x) == :(a*x*(B+im*A)+A*a*d^-1*log(sin(c+d*x))+-1*im*B*a*d^-1*log(cos(c+d*x)))
	@test integrate(cot(c+d*x)^2*(A+B*tan(c+d*x))*(a+im*a*tan(c+d*x)), x) == :(-1*a*x*(A+-1*im*B)+a*d^-1*(B+im*A)*log(sin(c+d*x))+-1*A*a*d^-1*cot(c+d*x))
	@test integrate(cot(c+d*x)^3*(A+B*tan(c+d*x))*(a+im*a*tan(c+d*x)), x) == :(-1*a*x*(B+im*A)+-1*a*d^-1*(A+-1*im*B)*log(sin(c+d*x))+-1*a*d^-1*(B+im*A)*cot(c+d*x)+-1//2*A*a*d^-1*cot(c+d*x)^2)
	@test integrate(cot(c+d*x)^4*(A+B*tan(c+d*x))*(a+im*a*tan(c+d*x)), x) == :(a*x*(A+-1*im*B)+a*d^-1*(A+-1*im*B)*cot(c+d*x)+-1*a*d^-1*(B+im*A)*log(sin(c+d*x))+-1//2*a*d^-1*cot(c+d*x)^2*(B+im*A)+-1//3*A*a*d^-1*cot(c+d*x)^3)
	@test integrate(cot(c+d*x)^5*(A+B*tan(c+d*x))*(a+im*a*tan(c+d*x)), x) == :(a*x*(B+im*A)+a*d^-1*(A+-1*im*B)*log(sin(c+d*x))+a*d^-1*(B+im*A)*cot(c+d*x)+(1/2)*a*d^-1*cot(c+d*x)^2*(A+-1*im*B)+-1//3*a*d^-1*cot(c+d*x)^3*(B+im*A)+-1//4*A*a*d^-1*cot(c+d*x)^4)
	@test integrate((a+im*a*tan(c+d*x))^2*tan(c+d*x)^2*(A+B*tan(c+d*x)), x) == :(-2*x*a^2*(A+-1*im*B)+a^2*d^-1*tan(c+d*x)^2*(B+im*A)+2*a^2*d^-1*(A+-1*im*B)*tan(c+d*x)+2*a^2*d^-1*(B+im*A)*log(cos(c+d*x))+-1//12*a^2*d^-1*tan(c+d*x)^3*(4A+-5*im*B)+1//4*im*B*d^-1*tan(c+d*x)^3*(a^2+im*a^2*tan(c+d*x)))
	@test integrate((a+im*a*tan(c+d*x))^2*(A+B*tan(c+d*x))*tan(c+d*x), x) == :((1/2)*A*d^-1*(a+im*a*tan(c+d*x))^2+-2*x*a^2*(B+im*A)+a^2*d^-1*(B+im*A)*tan(c+d*x)+-2*a^2*d^-1*(A+-1*im*B)*log(cos(c+d*x))+-1//3*im*B*a^-1*d^-1*(a+im*a*tan(c+d*x))^3)
end

@testset "4.3.4.2 (a+b tan)^m (c+d tan)^n (A+B tan+C tan^2).jl" begin
	@test integrate((a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2)*tan(c+d*x), x) == :(-1*x*(B*a+-1*C*b)+d^-1*(B*a+-1*C*b)*tan(c+d*x)+d^-1*(B*b+C*a)*log(cos(c+d*x))+(1/2)*d^-1*tan(c+d*x)^2*(B*b+C*a)+1//3*C*b*d^-1*tan(c+d*x)^3)
	@test integrate((a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2), x) == :(-1*x*(B*b+C*a)+-1*d^-1*(B*a+-1*C*b)*log(cos(c+d*x))+B*b*d^-1*tan(c+d*x)+(1/2)*C*b^-1*d^-1*(a+b*tan(c+d*x))^2)
	@test integrate((a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2)*cot(c+d*x), x) == :(x*(B*a+-1*C*b)+-1*d^-1*(B*b+C*a)*log(cos(c+d*x))+C*b*d^-1*tan(c+d*x))
	@test integrate(cot(c+d*x)^2*(a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2), x) == :(x*(B*b+C*a)+B*a*d^-1*log(sin(c+d*x))+-1*C*b*d^-1*log(cos(c+d*x)))
	@test integrate(cot(c+d*x)^3*(a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2), x) == :(-1*x*(B*a+-1*C*b)+d^-1*(B*b+C*a)*log(sin(c+d*x))+-1*B*a*d^-1*cot(c+d*x))
	@test integrate(cot(c+d*x)^4*(a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2), x) == :(-1*x*(B*b+C*a)+-1*d^-1*(B*a+-1*C*b)*log(sin(c+d*x))+-1*d^-1*(B*b+C*a)*cot(c+d*x)+-1//2*B*a*d^-1*cot(c+d*x)^2)
	@test integrate(cot(c+d*x)^5*(a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2), x) == :(x*(B*a+-1*C*b)+d^-1*(B*a+-1*C*b)*cot(c+d*x)+-1*d^-1*(B*b+C*a)*log(sin(c+d*x))+-1//2*d^-1*cot(c+d*x)^2*(B*b+C*a)+-1//3*B*a*d^-1*cot(c+d*x)^3)
	@test integrate(cot(c+d*x)^6*(a+b*tan(c+d*x))*(B*tan(c+d*x)+C*tan(c+d*x)^2), x) == :(x*(B*b+C*a)+d^-1*(B*a+-1*C*b)*log(sin(c+d*x))+d^-1*(B*b+C*a)*cot(c+d*x)+(1/2)*d^-1*cot(c+d*x)^2*(B*a+-1*C*b)+-1//3*d^-1*cot(c+d*x)^3*(B*b+C*a)+-1//4*B*a*d^-1*cot(c+d*x)^4)
	@test integrate((a+b*tan(c+d*x))^2*(B*tan(c+d*x)+C*tan(c+d*x)^2)*tan(c+d*x), x) == :(-1*x*(B*a^2+-1*B*b^2+-2*C*a*b)+d^-1*(C*a^2+-1*C*b^2+2*B*a*b)*log(cos(c+d*x))+-1//2*C*d^-1*(a+b*tan(c+d*x))^2+-1*b*d^-1*(B*b+C*a)*tan(c+d*x)+1//12*b^-2*d^-1*(a+b*tan(c+d*x))^3*(-1*C*a+4*B*b)+1//4*C*b^-1*d^-1*(a+b*tan(c+d*x))^3*tan(c+d*x))
	@test integrate((a+b*tan(c+d*x))^2*(B*tan(c+d*x)+C*tan(c+d*x)^2), x) == :(-1*x*(C*a^2+-1*C*b^2+2*B*a*b)+(1/2)*B*d^-1*(a+b*tan(c+d*x))^2+-1*d^-1*(B*a^2+-1*B*b^2+-2*C*a*b)*log(cos(c+d*x))+b*d^-1*(B*a+-1*C*b)*tan(c+d*x)+1//3*C*b^-1*d^-1*(a+b*tan(c+d*x))^3)
end

@testset "4.3.7 (d trig)^m (a+b (c tan)^n)^p.jl" begin
	@test integrate((b*tan(e+f*x)^2)^5//2, x) == :(-1//2*b^2*f^-1*(b*tan(e+f*x)^2)^(1/2)*tan(e+f*x)+1//4*b^2*f^-1*(b*tan(e+f*x)^2)^(1/2)*tan(e+f*x)^3+-1*b^2*f^-1*(b*tan(e+f*x)^2)^(1/2)*cot(e+f*x)*log(cos(e+f*x)))
	@test integrate((b*tan(e+f*x)^2)^3//2, x) == :((1/2)*b*f^-1*(b*tan(e+f*x)^2)^(1/2)*tan(e+f*x)+b*f^-1*(b*tan(e+f*x)^2)^(1/2)*cot(e+f*x)*log(cos(e+f*x)))
	@test integrate((b*tan(e+f*x)^2)^(1/2), x) == :(-1*f^-1*(b*tan(e+f*x)^2)^(1/2)*cot(e+f*x)*log(cos(e+f*x)))
	@test integrate((b*tan(e+f*x)^2)^-1//2, x) == :(f^-1*(b*tan(e+f*x)^2)^-1//2*log(sin(e+f*x))*tan(e+f*x))
	@test integrate((b*tan(e+f*x)^2)^-3//2, x) == :(-1//2*b^-1*f^-1*(b*tan(e+f*x)^2)^-1//2*cot(e+f*x)+-1*b^-1*f^-1*(b*tan(e+f*x)^2)^-1//2*log(sin(e+f*x))*tan(e+f*x))
	@test integrate((b*tan(e+f*x)^2)^-5//2, x) == :((1/2)*b^-2*f^-1*(b*tan(e+f*x)^2)^-1//2*cot(e+f*x)+-1//4*b^-2*f^-1*(b*tan(e+f*x)^2)^-1//2*cot(e+f*x)^3+b^-2*f^-1*(b*tan(e+f*x)^2)^-1//2*log(sin(e+f*x))*tan(e+f*x))
	@test integrate((b*tan(e+f*x)^3)^5//2, x) == :(-2*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*cot(e+f*x)+-2//9*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^3+2//5*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)+2//13*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^5+(1/2)*2^(1/2)*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*arctan(1+2^(1/2)*tan(e+f*x)^(1/2))+-1//2*2^(1/2)*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*arctan(1+-1*2^(1/2)*tan(e+f*x)^(1/2))+-1//4*2^(1/2)*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*log(1+-1*2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x))+1//4*2^(1/2)*b^2*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*log(1+2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x)))
	@test integrate((b*tan(e+f*x)^3)^3//2, x) == :(-2//3*b*f^-1*(b*tan(e+f*x)^3)^(1/2)+2//7*b*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^2+(1/2)*b*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*arctan(1+2^(1/2)*tan(e+f*x)^(1/2))+-1//2*b*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*arctan(1+-1*2^(1/2)*tan(e+f*x)^(1/2))+-1//4*b*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*log(1+2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x))+1//4*b*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*log(1+-1*2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x)))
	@test integrate((b*tan(e+f*x)^3)^(1/2), x) == :(2*f^-1*(b*tan(e+f*x)^3)^(1/2)*cot(e+f*x)+(1/2)*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*arctan(1+-1*2^(1/2)*tan(e+f*x)^(1/2))+-1//2*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*arctan(1+2^(1/2)*tan(e+f*x)^(1/2))+-1//4*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*log(1+2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x))+1//4*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^(1/2)*tan(e+f*x)^-3//2*log(1+-1*2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x)))
	@test integrate((b*tan(e+f*x)^3)^-1//2, x) == :(-2*f^-1*(b*tan(e+f*x)^3)^-1//2*tan(e+f*x)+(1/2)*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^-1//2*tan(e+f*x)^3//2*arctan(1+-1*2^(1/2)*tan(e+f*x)^(1/2))+-1//2*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^-1//2*tan(e+f*x)^3//2*arctan(1+2^(1/2)*tan(e+f*x)^(1/2))+-1//4*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^-1//2*tan(e+f*x)^3//2*log(1+-1*2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x))+1//4*2^(1/2)*f^-1*(b*tan(e+f*x)^3)^-1//2*tan(e+f*x)^3//2*log(1+2^(1/2)*tan(e+f*x)^(1/2)+tan(e+f*x)))
end

@testset "4.3.9 trig^m (a+b tan^n+c tan^(2 n))^p.jl" begin
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*tan(d+e*x)^5, x) == :(e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)+-1//3*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^3//2+(1/2)*b*c^-1//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+1//5*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^3//2*tan(d+e*x)^2+1//240*c^-3*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^3//2*(35*b^2+-32*a*c+-42*b*c*tan(d+e*x))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//16*b*c^-5//2*e^-1*(b^2+-4*a*c)*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+1//8*b*c^-2*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*(b+2*c*tan(d+e*x))+-1//128*b*c^-4*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*(b+2*c*tan(d+e*x))*(7*b^2+-12*a*c)+1//256*b*c^-9//2*e^-1*(b^2+-4*a*c)*(7*b^2+-12*a*c)*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x))))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*tan(d+e*x)^4, x) == :(c^(1/2)*e^-1*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+-5//24*b*c^-2*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^3//2+-1//4*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*(b+2*c*tan(d+e*x))+1//4*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^3//2*tan(d+e*x)+1//8*c^-3//2*e^-1*(b^2+-4*a*c)*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)))*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+-1*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c))*tan(d+e*x)))+-1//128*c^-7//2*e^-1*(b^2+-4*a*c)*(5*b^2+-4*a*c)*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+1//64*c^-3*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*(b+2*c*tan(d+e*x))*(5*b^2+-4*a*c))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*tan(d+e*x)^3, x) == :(-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)+1//3*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^3//2+-1//2*b*c^-1//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//8*b*c^-2*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*(b+2*c*tan(d+e*x))+1//16*b*c^-5//2*e^-1*(b^2+-4*a*c)*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x))))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*tan(d+e*x)^2, x) == :(-1//8*c^-3//2*e^-1*(b^2+-1*c*(-8c+4a))*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+1//4*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*(b+2*c*tan(d+e*x))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))*tan(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+-1*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))*tan(d+e*x))))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*tan(d+e*x), x) == :(e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)+(1/2)*b*c^-1//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x))))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2), x) == :(c^(1/2)*e^-1*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)))*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+-1*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c))*tan(d+e*x))))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*cot(d+e*x), x) == :(-1*a^(1/2)*e^-1*arctanh((1/2)*a^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(2a+b*tan(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x))))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*cot(d+e*x)^2, x) == :(-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*cot(d+e*x)+-1//2*b*a^-1//2*e^-1*arctanh((1/2)*a^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(2a+b*tan(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)))*tan(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b*(a^2+b^2+c^2+-2*a*c)^(1/2)+-1*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c))*tan(d+e*x))))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*cot(d+e*x)^3, x) == :(a^(1/2)*e^-1*arctanh((1/2)*a^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(2a+b*tan(d+e*x)))+1//8*a^-3//2*e^-1*(b^2+-4*a*c)*arctanh((1/2)*a^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(2a+b*tan(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*tan(d+e*x)))+-1//4*a^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*cot(d+e*x)^2*(2a+b*tan(d+e*x)))
	@test integrate((a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*tan(d+e*x)^5, x) == :(-1*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)+(1/2)*b*c^-3//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x)))+1//3*c^-1*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*tan(d+e*x)^2+1//24*c^-3*e^-1*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^(1/2)*(15*b^2+-16*a*c+-10*b*c*tan(d+e*x))+(1/2)*2^(1/2)*e^-1*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+b*tan(d+e*x)))+-1//2*2^(1/2)*e^-1*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c+b*tan(d+e*x)))+-1//16*b*c^-7//2*e^-1*(5*b^2+-12*a*c)*arctanh((1/2)*c^-1//2*(a+b*tan(d+e*x)+c*tan(d+e*x)^2)^-1//2*(b+2*c*tan(d+e*x))))
end

@testset "4.4.0 (a trg)^m (b cot)^n.jl" begin
	@test integrate(cot(a+b*x), x) == :(b^-1*log(sin(a+b*x)))
	@test integrate(cot(a+b*x)^2, x) == :(-1x+-1*b^-1*cot(a+b*x))
	@test integrate(cot(a+b*x)^3, x) == :(-1*b^-1*log(sin(a+b*x))+-1//2*b^-1*cot(a+b*x)^2)
	@test integrate(cot(a+b*x)^4, x) == :(x+b^-1*cot(a+b*x)+-1//3*b^-1*cot(a+b*x)^3)
	@test integrate(cot(a+b*x)^5, x) == :(b^-1*log(sin(a+b*x))+(1/2)*b^-1*cot(a+b*x)^2+-1//4*b^-1*cot(a+b*x)^4)
	@test integrate(cot(a+b*x)^6, x) == :(-1x+-1*b^-1*cot(a+b*x)+-1//5*b^-1*cot(a+b*x)^5+1//3*b^-1*cot(a+b*x)^3)
	@test integrate(cot(a+b*x)^7, x) == :(-1*b^-1*log(sin(a+b*x))+-1//2*b^-1*cot(a+b*x)^2+-1//6*b^-1*cot(a+b*x)^6+1//4*b^-1*cot(a+b*x)^4)
	@test integrate(cot(a+b*x)^8, x) == :(x+b^-1*cot(a+b*x)+-1//3*b^-1*cot(a+b*x)^3+-1//7*b^-1*cot(a+b*x)^7+1//5*b^-1*cot(a+b*x)^5)
	@test integrate((c*cot(a+b*x))^7//2, x) == :(2*b^-1*c^3*(c*cot(a+b*x))^(1/2)+-2//5*c*b^-1*(c*cot(a+b*x))^5//2+(1/2)*2^(1/2)*b^-1*c^7//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^7//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^7//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x))+1//4*2^(1/2)*b^-1*c^7//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2)))
	@test integrate((c*cot(a+b*x))^5//2, x) == :(-2//3*c*b^-1*(c*cot(a+b*x))^3//2+(1/2)*2^(1/2)*b^-1*c^5//2*arctan(1+2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//2*2^(1/2)*b^-1*c^5//2*arctan(1+-1*2^(1/2)*c^-1//2*(c*cot(a+b*x))^(1/2))+-1//4*2^(1/2)*b^-1*c^5//2*log(c^(1/2)+2^(1/2)*(c*cot(a+b*x))^(1/2)+c^(1/2)*cot(a+b*x))+1//4*2^(1/2)*b^-1*c^5//2*log(c^(1/2)+c^(1/2)*cot(a+b*x)+-1*2^(1/2)*(c*cot(a+b*x))^(1/2)))
end

@testset "4.4.1.2 (d csc)^m (a+b cot)^n.jl" begin
	@test integrate((im+cot(x))^-1*sin(x)^4, x) == :(-3//32*(im+cot(x))^-2+1//32*(im+-1*cot(x))^-2+-1*im*(-8*cot(x)+8im)^-1+3*im*(16im+16*cot(x))^-1+-5//16*im*x+-1//24*im*(im+cot(x))^-3)
	@test integrate((im+cot(x))^-1*sin(x)^3, x) == :(-4//15*im*cos(x)^3+4//5*im*cos(x)+im*(5im+5*cot(x))^-1*sin(x)^3)
	@test integrate((im+cot(x))^-1*sin(x)^2, x) == :(-1//8*(im+cot(x))^-2+im*(4im+4*cot(x))^-1+-1*im*(-8*cot(x)+8im)^-1+-3//8*im*x)
	@test integrate((im+cot(x))^-1*sin(x), x) == :(2//3*im*cos(x)+im*(3im+3*cot(x))^-1*sin(x))
	@test integrate((im+cot(x))^-1*csc(x), x) == :(im*(im+cot(x))^-1*csc(x))
	@test integrate((im+cot(x))^-1*csc(x)^2, x) == :(-1*im*x+log(sin(x)))
	@test integrate((im+cot(x))^-1*csc(x)^3, x) == :(-1*csc(x)+im*arctanh(cos(x)))
	@test integrate((im+cot(x))^-1*csc(x)^4, x) == :(-1//2*cot(x)^2+im*cot(x))
	@test integrate((im+cot(x))^-1*csc(x)^5, x) == :(-1//3*csc(x)^3+(1/2)*im*arctanh(cos(x))+(1/2)*im*cot(x)*csc(x))
	@test integrate((im+cot(x))^-1*csc(x)^6, x) == :(-1//2*cot(x)^2+-1//4*cot(x)^4+im*cot(x)+1//3*im*cot(x)^3)
end

@testset "4.4.1.3 (d cos)^m (a+b cot)^n.jl" begin
	@test integrate((im+cot(x))^-1*cos(x)^4, x) == :(1//32*(im+-1*cot(x))^-2+5//32*(im+cot(x))^-2+im*(-8*cot(x)+8im)^-1+3*im*(16im+16*cot(x))^-1+-1//16*im*x+-1//24*im*(im+cot(x))^-3)
	@test integrate((im+cot(x))^-1*cos(x)^3, x) == :(-1//5*cos(x)^5+-1//3*im*sin(x)^3+1//5*im*sin(x)^5)
	@test integrate((im+cot(x))^-1*cos(x)^2, x) == :(1//8*(im+cot(x))^-2+im*(-8*cot(x)+8im)^-1+im*(4im+4*cot(x))^-1+-1//8*im*x)
	@test integrate((im+cot(x))^-1*cos(x), x) == :(-1//3*cos(x)^3+-1//3*im*sin(x)^3)
	@test integrate((im+cot(x))^-1*sec(x), x) == :(-1*cos(x)+im*sin(x)+-1*im*arctanh(sin(x)))
	@test integrate((im+cot(x))^-1*sec(x)^2, x) == :(-1*log(sin(x))+im*x+-1*im*tan(x)+log(tan(x)))
	@test integrate((im+cot(x))^-1*sec(x)^3, x) == :((1/2)*im*arctanh(sin(x))+-1//2*im*sec(x)*tan(x)+sec(x))
	@test integrate((im+cot(x))^-1*sec(x)^4, x) == :((1/2)*tan(x)^2+-1//3*im*tan(x)^3)
	@test integrate((im+cot(x))^-1*sec(x)^5, x) == :(1//3*sec(x)^3+1//8*im*arctanh(sin(x))+-1//4*im*sec(x)^3*tan(x)+1//8*im*sec(x)*tan(x))
	@test integrate((im+cot(x))^-1*sec(x)^6, x) == :((1/2)*tan(x)^2+1//4*tan(x)^4+-1//3*im*tan(x)^3+-1//5*im*tan(x)^5)
end

@testset "4.4.10 (c+d x)^m (a+b cot)^n.jl" begin
	@test integrate(x^3*cot(a+b*x), x) == :(-1//4*im*x^4+b^-1*x^3*log(1+-1*exp(2*im*(a+b*x)))+3//2*x*b^-3*Polylogarithms.polylog(3,exp(2*im*(a+b*x)))+3//4*im*b^-4*Polylogarithms.polylog(4,exp(2*im*(a+b*x)))+-3//2*im*b^-2*x^2*Polylogarithms.polylog(2,exp(2*im*(a+b*x))))
	@test integrate(x^2*cot(a+b*x), x) == :((1/2)*b^-3*Polylogarithms.polylog(3,exp(2*im*(a+b*x)))+-1//3*im*x^3+b^-1*x^2*log(1+-1*exp(2*im*(a+b*x)))+-1*im*x*b^-2*Polylogarithms.polylog(2,exp(2*im*(a+b*x))))
	@test integrate(x*cot(a+b*x), x) == :(-1//2*im*x^2+x*b^-1*log(1+-1*exp(2*im*(a+b*x)))+-1//2*im*b^-2*Polylogarithms.polylog(2,exp(2*im*(a+b*x))))
	@test integrate(x^3*cot(a+b*x)^2, x) == :(-1//4*x^4+3//2*b^-4*Polylogarithms.polylog(3,exp(2*im*(a+b*x)))+-1*im*b^-1*x^3+-1*b^-1*x^3*cot(a+b*x)+3*b^-2*x^2*log(1+-1*exp(2*im*(a+b*x)))+-3*im*x*b^-3*Polylogarithms.polylog(2,exp(2*im*(a+b*x))))
	@test integrate(x^2*cot(a+b*x)^2, x) == :(-1//3*x^3+-1*im*b^-1*x^2+-1*im*b^-3*Polylogarithms.polylog(2,exp(2*im*(a+b*x)))+-1*b^-1*x^2*cot(a+b*x)+2*x*b^-2*log(1+-1*exp(2*im*(a+b*x))))
	@test integrate(x*cot(a+b*x)^2, x) == :(-1//2*x^2+b^-2*log(sin(a+b*x))+-1*x*b^-1*cot(a+b*x))
	@test integrate(x^3*cot(a+b*x)^3, x) == :(-1//2*b^-1*x^3+1//4*im*x^4+-1*b^-1*x^3*log(1+-1*exp(2*im*(a+b*x)))+3*x*b^-3*log(1+-1*exp(2*im*(a+b*x)))+-3//2*im*b^-4*Polylogarithms.polylog(2,exp(2*im*(a+b*x)))+-3//2*im*b^-2*x^2+-3//2*x*b^-3*Polylogarithms.polylog(3,exp(2*im*(a+b*x)))+-3//2*b^-2*x^2*cot(a+b*x)+-3//4*im*b^-4*Polylogarithms.polylog(4,exp(2*im*(a+b*x)))+-1//2*b^-1*x^3*cot(a+b*x)^2+3//2*im*b^-2*x^2*Polylogarithms.polylog(2,exp(2*im*(a+b*x))))
	@test integrate(x^2*cot(a+b*x)^3, x) == :(b^-3*log(sin(a+b*x))+-1//2*b^-1*x^2+-1//2*b^-3*Polylogarithms.polylog(3,exp(2*im*(a+b*x)))+1//3*im*x^3+-1*x*b^-2*cot(a+b*x)+-1*b^-1*x^2*log(1+-1*exp(2*im*(a+b*x)))+-1//2*b^-1*x^2*cot(a+b*x)^2+im*x*b^-2*Polylogarithms.polylog(2,exp(2*im*(a+b*x))))
	@test integrate(x*cot(a+b*x)^3, x) == :((1/2)*im*x^2+-1//2*x*b^-1+-1//2*b^-2*cot(a+b*x)+(1/2)*im*b^-2*Polylogarithms.polylog(2,exp(2*im*(a+b*x)))+-1*x*b^-1*log(1+-1*exp(2*im*(a+b*x)))+-1//2*x*b^-1*cot(a+b*x)^2)
	@test integrate((a+im*a*cot(e+f*x))^-1*(c+d*x)^3, x) == :(-3//8*d^3*f^-4*(a+im*a*cot(e+f*x))^-1+1//8*a^-1*d^-1*(c+d*x)^4+-3//8*d*a^-1*f^-2*(c+d*x)^2+-1//2*im*f^-1*(a+im*a*cot(e+f*x))^-1*(c+d*x)^3+1//4*im*a^-1*f^-1*(c+d*x)^3+3//4*d*f^-2*(a+im*a*cot(e+f*x))^-1*(c+d*x)^2+-3//8*im*x*a^-1*d^3*f^-3+3//4*im*d^2*f^-3*(a+im*a*cot(e+f*x))^-1*(c+d*x))
end

@testset "4.4.2.1 (a+b cot)^m (c+d cot)^n.jl" begin
	@test integrate((e*cot(c+d*x))^5//2*(a+a*cot(c+d*x)), x) == :(-2//5*a*d^-1*(e*cot(c+d*x))^5//2+2*a*d^-1*e^2*(e*cot(c+d*x))^(1/2)+-2//3*a*e*d^-1*(e*cot(c+d*x))^3//2+-1*a*2^(1/2)*d^-1*e^5//2*arctanh((1/2)*2^(1/2)*(e*cot(c+d*x))^-1//2*(e^(1/2)+e^(1/2)*cot(c+d*x))))
	@test integrate((e*cot(c+d*x))^3//2*(a+a*cot(c+d*x)), x) == :(-2//3*a*d^-1*(e*cot(c+d*x))^3//2+-2*a*e*d^-1*(e*cot(c+d*x))^(1/2)+-1*a*2^(1/2)*d^-1*e^3//2*arctan((1/2)*2^(1/2)*(e*cot(c+d*x))^-1//2*(e^(1/2)+-1*e^(1/2)*cot(c+d*x))))
	@test integrate((e*cot(c+d*x))^(1/2)*(a+a*cot(c+d*x)), x) == :(-2*a*d^-1*(e*cot(c+d*x))^(1/2)+a*2^(1/2)*d^-1*e^(1/2)*arctanh((1/2)*2^(1/2)*(e*cot(c+d*x))^-1//2*(e^(1/2)+e^(1/2)*cot(c+d*x))))
	@test integrate((e*cot(c+d*x))^-1//2*(a+a*cot(c+d*x)), x) == :(a*2^(1/2)*d^-1*e^-1//2*arctan((1/2)*2^(1/2)*e^(1/2)*(e*cot(c+d*x))^-1//2*(1+-1*cot(c+d*x))))
	@test integrate((e*cot(c+d*x))^-3//2*(a+a*cot(c+d*x)), x) == :(2*a*d^-1*e^-1*(e*cot(c+d*x))^-1//2+-1*a*2^(1/2)*d^-1*e^-3//2*arctanh((1/2)*2^(1/2)*(e*cot(c+d*x))^-1//2*(e^(1/2)+e^(1/2)*cot(c+d*x))))
	@test integrate((e*cot(c+d*x))^-5//2*(a+a*cot(c+d*x)), x) == :(2*a*d^-1*e^-2*(e*cot(c+d*x))^-1//2+2//3*a*d^-1*e^-1*(e*cot(c+d*x))^-3//2+-1*a*2^(1/2)*d^-1*e^-5//2*arctan((1/2)*2^(1/2)*(e*cot(c+d*x))^-1//2*(e^(1/2)+-1*e^(1/2)*cot(c+d*x))))
	@test integrate((e*cot(c+d*x))^5//2*(a+a*cot(c+d*x))^2, x) == :(-4//5*a^2*d^-1*(e*cot(c+d*x))^5//2+4*a^2*d^-1*e^2*(e*cot(c+d*x))^(1/2)+-2//7*a^2*d^-1*e^-1*(e*cot(c+d*x))^7//2+2^(1/2)*a^2*d^-1*e^5//2*arctan(1+-1*2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+(1/2)*2^(1/2)*a^2*d^-1*e^5//2*log(e^(1/2)+e^(1/2)*cot(c+d*x)+-1*2^(1/2)*(e*cot(c+d*x))^(1/2))+-1*2^(1/2)*a^2*d^-1*e^5//2*arctan(1+2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+-1//2*2^(1/2)*a^2*d^-1*e^5//2*log(e^(1/2)+2^(1/2)*(e*cot(c+d*x))^(1/2)+e^(1/2)*cot(c+d*x)))
	@test integrate((e*cot(c+d*x))^3//2*(a+a*cot(c+d*x))^2, x) == :(-4//3*a^2*d^-1*(e*cot(c+d*x))^3//2+-2//5*a^2*d^-1*e^-1*(e*cot(c+d*x))^5//2+2^(1/2)*a^2*d^-1*e^3//2*arctan(1+2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+(1/2)*2^(1/2)*a^2*d^-1*e^3//2*log(e^(1/2)+e^(1/2)*cot(c+d*x)+-1*2^(1/2)*(e*cot(c+d*x))^(1/2))+-1*2^(1/2)*a^2*d^-1*e^3//2*arctan(1+-1*2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+-1//2*2^(1/2)*a^2*d^-1*e^3//2*log(e^(1/2)+2^(1/2)*(e*cot(c+d*x))^(1/2)+e^(1/2)*cot(c+d*x)))
	@test integrate((e*cot(c+d*x))^(1/2)*(a+a*cot(c+d*x))^2, x) == :(-4*a^2*d^-1*(e*cot(c+d*x))^(1/2)+-2//3*a^2*d^-1*e^-1*(e*cot(c+d*x))^3//2+2^(1/2)*a^2*d^-1*e^(1/2)*arctan(1+2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+(1/2)*2^(1/2)*a^2*d^-1*e^(1/2)*log(e^(1/2)+2^(1/2)*(e*cot(c+d*x))^(1/2)+e^(1/2)*cot(c+d*x))+-1*2^(1/2)*a^2*d^-1*e^(1/2)*arctan(1+-1*2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+-1//2*2^(1/2)*a^2*d^-1*e^(1/2)*log(e^(1/2)+e^(1/2)*cot(c+d*x)+-1*2^(1/2)*(e*cot(c+d*x))^(1/2)))
	@test integrate((e*cot(c+d*x))^-1//2*(a+a*cot(c+d*x))^2, x) == :(-2*a^2*d^-1*e^-1*(e*cot(c+d*x))^(1/2)+2^(1/2)*a^2*d^-1*e^-1//2*arctan(1+-1*2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+(1/2)*2^(1/2)*a^2*d^-1*e^-1//2*log(e^(1/2)+2^(1/2)*(e*cot(c+d*x))^(1/2)+e^(1/2)*cot(c+d*x))+-1*2^(1/2)*a^2*d^-1*e^-1//2*arctan(1+2^(1/2)*e^-1//2*(e*cot(c+d*x))^(1/2))+-1//2*2^(1/2)*a^2*d^-1*e^-1//2*log(e^(1/2)+e^(1/2)*cot(c+d*x)+-1*2^(1/2)*(e*cot(c+d*x))^(1/2)))
end

@testset "4.4.7 (d trig)^m (a+b (c cot)^n)^p.jl" begin
	@test integrate((b*tan(c+d*x))^-1//2*(A+C*cot(c+d*x)^2), x) == :(-2//3*C*b*d^-1*(b*tan(c+d*x))^-3//2+(1/2)*2^(1/2)*b^-1//2*d^-1*(A+-1C)*arctan(1+2^(1/2)*b^-1//2*(b*tan(c+d*x))^(1/2))+-1//2*2^(1/2)*b^-1//2*d^-1*(A+-1C)*arctan(1+-1*2^(1/2)*b^-1//2*(b*tan(c+d*x))^(1/2))+-1//4*2^(1/2)*b^-1//2*d^-1*(A+-1C)*log(b^(1/2)+b^(1/2)*tan(c+d*x)+-1*2^(1/2)*(b*tan(c+d*x))^(1/2))+1//4*2^(1/2)*b^-1//2*d^-1*(A+-1C)*log(b^(1/2)+2^(1/2)*(b*tan(c+d*x))^(1/2)+b^(1/2)*tan(c+d*x)))
	@test integrate(a+b*cot(c+d*x)^2, x) == :(a*x+-1*b*x+-1*b*d^-1*cot(c+d*x))
	@test integrate((a+b*cot(c+d*x)^2)^2, x) == :(x*(a+-1b)^2+-1//3*b^2*d^-1*cot(c+d*x)^3+-1*b*d^-1*(-1b+2a)*cot(c+d*x))
	@test integrate((a+b*cot(c+d*x)^2)^3, x) == :(x*(a+-1b)^3+-1//5*b^3*d^-1*cot(c+d*x)^5+-1*b*d^-1*(b^2+3*a^2+-3*a*b)*cot(c+d*x)+-1//3*b^2*d^-1*cot(c+d*x)^3*(-1b+3a))
	@test integrate((a+b*cot(c+d*x)^2)^-1, x) == :(x*(a+-1b)^-1+a^-1//2*b^(1/2)*d^-1*(a+-1b)^-1*arctan(a^-1//2*b^(1/2)*cot(c+d*x)))
	@test integrate((a+b*cot(c+d*x)^2)^-2, x) == :(x*(a+-1b)^-2+(1/2)*b*a^-1*d^-1*(a+-1b)^-1*(a+b*cot(c+d*x)^2)^-1*cot(c+d*x)+(1/2)*a^-3//2*b^(1/2)*d^-1*(a+-1b)^-2*(-1b+3a)*arctan(a^-1//2*b^(1/2)*cot(c+d*x)))
	@test integrate((a+b*cot(c+d*x)^2)^-3, x) == :(x*(a+-1b)^-3+1//4*b*a^-1*d^-1*(a+-1b)^-1*(a+b*cot(c+d*x)^2)^-2*cot(c+d*x)+1//8*a^-5//2*b^(1/2)*d^-1*(a+-1b)^-3*(3*b^2+15*a^2+-10*a*b)*arctan(a^-1//2*b^(1/2)*cot(c+d*x))+1//8*b*a^-2*d^-1*(a+-1b)^-2*(a+b*cot(c+d*x)^2)^-1*(-3b+7a)*cot(c+d*x))
	@test integrate((1+cot(x)^2)^3//2, x) == :(-1//2*arcsinh(cot(x))+-1//2*(csc(x)^2)^(1/2)*cot(x))
	@test integrate((1+cot(x)^2)^(1/2), x) == :(-1*arcsinh(cot(x)))
	@test integrate((1+cot(x)^2)^-1//2, x) == :(-1*(csc(x)^2)^-1//2*cot(x))
end

@testset "4.4.9 trig^m (a+b cot^n+c cot^(2 n))^p.jl" begin
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*cot(d+e*x)^5, x) == :(c^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)+-1//2*b*c^-3//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+-1//3*c^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*cot(d+e*x)^2+-1//24*c^-3*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*(15*b^2+-16*a*c+-10*b*c*cot(d+e*x))+(1/2)*2^(1/2)*e^-1*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c+b*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+b*cot(d+e*x)))+1//16*b*c^-7//2*e^-1*(5*b^2+-12*a*c)*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x))))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*cot(d+e*x)^3, x) == :(-1*c^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)+(1/2)*b*c^-3//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+b*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c+b*cot(d+e*x))))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*cot(d+e*x), x) == :((1/2)*2^(1/2)*e^-1*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c+b*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+b*cot(d+e*x))))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*tan(d+e*x), x) == :(a^-1//2*e^-1*arctanh((1/2)*a^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(2a+b*cot(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+b*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c+b*cot(d+e*x))))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*tan(d+e*x)^3, x) == :(-1*a^-1//2*e^-1*arctanh((1/2)*a^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(2a+b*cot(d+e*x)))+(1/2)*a^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*tan(d+e*x)^2+1//8*a^-5//2*e^-1*(3*b^2+-4*a*c)*arctanh((1/2)*a^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(2a+b*cot(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c+b*cot(d+e*x)))+-3//4*b*a^-2*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*tan(d+e*x)+-1//2*2^(1/2)*e^-1*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^(1/2)*(a^2+b^2+c^2+-2*a*c)^-1//2*arctanh((1/2)*2^(1/2)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+b*cot(d+e*x))))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*cot(d+e*x)^5, x) == :(-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)+1//3*c^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^3//2+-1//2*b*c^-1//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+-1//5*c^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^3//2*cot(d+e*x)^2+-1//240*c^-3*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^3//2*(35*b^2+-32*a*c+-42*b*c*cot(d+e*x))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+-1//8*b*c^-2*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*(b+2*c*cot(d+e*x))+1//16*b*c^-5//2*e^-1*(b^2+-4*a*c)*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+-1//256*b*c^-9//2*e^-1*(b^2+-4*a*c)*(7*b^2+-12*a*c)*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+1//128*b*c^-4*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*(b+2*c*cot(d+e*x))*(7*b^2+-12*a*c))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*cot(d+e*x)^3, x) == :(e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)+-1//3*c^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^3//2+(1/2)*b*c^-1//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+-1//16*b*c^-5//2*e^-1*(b^2+-4*a*c)*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+1//8*b*c^-2*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*(b+2*c*cot(d+e*x)))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*cot(d+e*x), x) == :(-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)+-1//2*b*c^-1//2*e^-1*arctanh((1/2)*c^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(b+2*c*cot(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x))))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*tan(d+e*x), x) == :(a^(1/2)*e^-1*arctanh((1/2)*a^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(2a+b*cot(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x))))
	@test integrate((a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*tan(d+e*x)^3, x) == :(-1*a^(1/2)*e^-1*arctanh((1/2)*a^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(2a+b*cot(d+e*x)))+-1//8*a^-3//2*e^-1*(b^2+-4*a*c)*arctanh((1/2)*a^-1//2*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(2a+b*cot(d+e*x)))+(1/2)*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctanh((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*(-1*(a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+(a^2+b^2+c^2+-2*a*c)^(1/2)+-1c)+b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+-1//2*2^(1/2)*e^-1*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^(1/2)*arctan((1/2)*2^(1/2)*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^-1//2*(a^2+b^2+c^2+-2*a*c)^-1//4*(a^2+b^2+c*(c+(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*a*((a^2+b^2+c^2+-2*a*c)^(1/2)+2c))^-1//2*(b^2+(a+-1c)*(a+-1c+-1*(a^2+b^2+c^2+-2*a*c)^(1/2))+-1*b*(a^2+b^2+c^2+-2*a*c)^(1/2)*cot(d+e*x)))+1//4*a^-1*e^-1*(a+b*cot(d+e*x)+c*cot(d+e*x)^2)^(1/2)*tan(d+e*x)^2*(2a+b*cot(d+e*x)))
end

@testset "4.5.0 (a sec)^m (b trg)^n.jl" begin
	@test integrate(sec(a+b*x), x) == :(b^-1*arctanh(sin(a+b*x)))
	@test integrate(sec(a+b*x)^2, x) == :(b^-1*tan(a+b*x))
	@test integrate(sec(a+b*x)^3, x) == :((1/2)*b^-1*arctanh(sin(a+b*x))+(1/2)*b^-1*sec(a+b*x)*tan(a+b*x))
	@test integrate(sec(a+b*x)^4, x) == :(b^-1*tan(a+b*x)+1//3*b^-1*tan(a+b*x)^3)
	@test integrate(sec(a+b*x)^5, x) == :(3//8*b^-1*arctanh(sin(a+b*x))+1//4*b^-1*sec(a+b*x)^3*tan(a+b*x)+3//8*b^-1*sec(a+b*x)*tan(a+b*x))
	@test integrate(sec(a+b*x)^6, x) == :(b^-1*tan(a+b*x)+1//5*b^-1*tan(a+b*x)^5+2//3*b^-1*tan(a+b*x)^3)
	@test integrate(sec(a+b*x)^7, x) == :(5//16*b^-1*arctanh(sin(a+b*x))+1//6*b^-1*sec(a+b*x)^5*tan(a+b*x)+5//16*b^-1*sec(a+b*x)*tan(a+b*x)+5//24*b^-1*sec(a+b*x)^3*tan(a+b*x))
	@test integrate(sec(a+b*x)^8, x) == :(b^-1*tan(a+b*x)^3+b^-1*tan(a+b*x)+1//7*b^-1*tan(a+b*x)^7+3//5*b^-1*tan(a+b*x)^5)
	@test integrate(sec(a+b*x)^7//2, x) == :(2//5*b^-1*sec(a+b*x)^5//2*sin(a+b*x)+6//5*b^-1*sec(a+b*x)^(1/2)*sin(a+b*x)+-6//5*b^-1*cos(a+b*x)^(1/2)*sec(a+b*x)^(1/2)*Elliptic.E((1/2)*a+(1/2)*b*x,2))
	@test integrate(sec(a+b*x)^5//2, x) == :(2//3*b^-1*sec(a+b*x)^3//2*sin(a+b*x)+2//3*b^-1*cos(a+b*x)^(1/2)*sec(a+b*x)^(1/2)*Elliptic.F((1/2)*a+(1/2)*b*x,2))
end

@testset "4.5.1.2 (d sec)^n (a+b sec)^m.jl" begin
	@test integrate(sec(c+d*x)^4*(a+a*sec(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+1//3*a*d^-1*tan(c+d*x)^3+3//8*a*d^-1*arctanh(sin(c+d*x))+1//4*a*d^-1*sec(c+d*x)^3*tan(c+d*x)+3//8*a*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^3*(a+a*sec(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+(1/2)*a*d^-1*arctanh(sin(c+d*x))+1//3*a*d^-1*tan(c+d*x)^3+(1/2)*a*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^2*(a+a*sec(c+d*x)), x) == :(a*d^-1*tan(c+d*x)+(1/2)*a*d^-1*arctanh(sin(c+d*x))+(1/2)*a*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate((a+a*sec(c+d*x))*sec(c+d*x), x) == :(a*d^-1*arctanh(sin(c+d*x))+a*d^-1*tan(c+d*x))
	@test integrate(a+a*sec(c+d*x), x) == :(a*x+a*d^-1*arctanh(sin(c+d*x)))
	@test integrate((a+a*sec(c+d*x))*cos(c+d*x), x) == :(a*x+a*d^-1*sin(c+d*x))
	@test integrate(cos(c+d*x)^2*(a+a*sec(c+d*x)), x) == :((1/2)*a*x+a*d^-1*sin(c+d*x)+(1/2)*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^3*(a+a*sec(c+d*x)), x) == :((1/2)*a*x+a*d^-1*sin(c+d*x)+-1//3*a*d^-1*sin(c+d*x)^3+(1/2)*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^4*(a+a*sec(c+d*x)), x) == :(3//8*a*x+a*d^-1*sin(c+d*x)+-1//3*a*d^-1*sin(c+d*x)^3+1//4*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+3//8*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate((a+a*sec(c+d*x))^2*sec(c+d*x)^4, x) == :(3//4*a^2*d^-1*arctanh(sin(c+d*x))+3//5*a^2*d^-1*tan(c+d*x)^3+9//5*a^2*d^-1*tan(c+d*x)+(1/2)*a^2*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//5*a^2*d^-1*sec(c+d*x)^4*tan(c+d*x)+3//4*a^2*d^-1*sec(c+d*x)*tan(c+d*x))
end

@testset "4.5.1.3 (d sin)^n (a+b sec)^m.jl" begin
	@test integrate(sin(c+d*x)^9*(a+a*sec(c+d*x)), x) == :(-1*a*d^-1*cos(c+d*x)+-1*a*d^-1*log(cos(c+d*x))+2*a*d^-1*cos(c+d*x)^2+-6//5*a*d^-1*cos(c+d*x)^5+-3//2*a*d^-1*cos(c+d*x)^4+-1//8*a*d^-1*cos(c+d*x)^8+-1//9*a*d^-1*cos(c+d*x)^9+2//3*a*d^-1*cos(c+d*x)^6+4//3*a*d^-1*cos(c+d*x)^3+4//7*a*d^-1*cos(c+d*x)^7)
	@test integrate(sin(c+d*x)^7*(a+a*sec(c+d*x)), x) == :(a*d^-1*cos(c+d*x)^3+-1*a*d^-1*cos(c+d*x)+-1*a*d^-1*log(cos(c+d*x))+-3//4*a*d^-1*cos(c+d*x)^4+-3//5*a*d^-1*cos(c+d*x)^5+1//6*a*d^-1*cos(c+d*x)^6+1//7*a*d^-1*cos(c+d*x)^7+3//2*a*d^-1*cos(c+d*x)^2)
	@test integrate(sin(c+d*x)^5*(a+a*sec(c+d*x)), x) == :(a*d^-1*cos(c+d*x)^2+-1*a*d^-1*cos(c+d*x)+-1*a*d^-1*log(cos(c+d*x))+-1//4*a*d^-1*cos(c+d*x)^4+-1//5*a*d^-1*cos(c+d*x)^5+2//3*a*d^-1*cos(c+d*x)^3)
	@test integrate(sin(c+d*x)^3*(a+a*sec(c+d*x)), x) == :((1/2)*a*d^-1*cos(c+d*x)^2+-1*a*d^-1*cos(c+d*x)+-1*a*d^-1*log(cos(c+d*x))+1//3*a*d^-1*cos(c+d*x)^3)
	@test integrate((a+a*sec(c+d*x))*sin(c+d*x), x) == :(-1*a*d^-1*cos(c+d*x)+-1*a*d^-1*log(cos(c+d*x)))
	@test integrate((a+a*sec(c+d*x))*csc(c+d*x), x) == :(a*d^-1*log(1+-1*cos(c+d*x))+-1*a*d^-1*log(cos(c+d*x)))
	@test integrate(csc(c+d*x)^3*(a+a*sec(c+d*x)), x) == :(-1*a*d^-1*log(cos(c+d*x))+-1//2*a^2*d^-1*(a+-1*a*cos(c+d*x))^-1+1//4*a*d^-1*log(1+cos(c+d*x))+3//4*a*d^-1*log(1+-1*cos(c+d*x)))
	@test integrate(csc(c+d*x)^5*(a+a*sec(c+d*x)), x) == :(-1*a*d^-1*log(cos(c+d*x))+-1//2*a^2*d^-1*(a+-1*a*cos(c+d*x))^-1+-1//8*a^2*d^-1*(a+a*cos(c+d*x))^-1+-1//8*a^3*d^-1*(a+-1*a*cos(c+d*x))^-2+5//16*a*d^-1*log(1+cos(c+d*x))+11//16*a*d^-1*log(1+-1*cos(c+d*x)))
	@test integrate(csc(c+d*x)^7*(a+a*sec(c+d*x)), x) == :(-1*a*d^-1*log(cos(c+d*x))+-5//32*a^3*d^-1*(a+-1*a*cos(c+d*x))^-2+-3//16*a^2*d^-1*(a+a*cos(c+d*x))^-1+-1//2*a^2*d^-1*(a+-1*a*cos(c+d*x))^-1+-1//24*a^4*d^-1*(a+-1*a*cos(c+d*x))^-3+-1//32*a^3*d^-1*(a+a*cos(c+d*x))^-2+11//32*a*d^-1*log(1+cos(c+d*x))+21//32*a*d^-1*log(1+-1*cos(c+d*x)))
	@test integrate(sin(c+d*x)^8*(a+a*sec(c+d*x)), x) == :(35//128*a*x+a*d^-1*arctanh(sin(c+d*x))+-1*a*d^-1*sin(c+d*x)+-1//3*a*d^-1*sin(c+d*x)^3+-1//5*a*d^-1*sin(c+d*x)^5+-1//7*a*d^-1*sin(c+d*x)^7+-35//128*a*d^-1*cos(c+d*x)*sin(c+d*x)+-35//192*a*d^-1*sin(c+d*x)^3*cos(c+d*x)+-7//48*a*d^-1*sin(c+d*x)^5*cos(c+d*x)+-1//8*a*d^-1*sin(c+d*x)^7*cos(c+d*x))
end

@testset "4.5.1.4 (d tan)^n (a+b sec)^m.jl" begin
	@test integrate(tan(c+d*x)^9*(a+a*sec(c+d*x)), x) == :(a*d^-1*sec(c+d*x)+-1*a*d^-1*log(cos(c+d*x))+-2*a*d^-1*sec(c+d*x)^2+-4//3*a*d^-1*sec(c+d*x)^3+-4//7*a*d^-1*sec(c+d*x)^7+-2//3*a*d^-1*sec(c+d*x)^6+1//8*a*d^-1*sec(c+d*x)^8+1//9*a*d^-1*sec(c+d*x)^9+3//2*a*d^-1*sec(c+d*x)^4+6//5*a*d^-1*sec(c+d*x)^5)
	@test integrate(tan(c+d*x)^7*(a+a*sec(c+d*x)), x) == :(a*d^-1*sec(c+d*x)^3+a*d^-1*log(cos(c+d*x))+-1*a*d^-1*sec(c+d*x)+-3//4*a*d^-1*sec(c+d*x)^4+-3//5*a*d^-1*sec(c+d*x)^5+1//6*a*d^-1*sec(c+d*x)^6+1//7*a*d^-1*sec(c+d*x)^7+3//2*a*d^-1*sec(c+d*x)^2)
	@test integrate(tan(c+d*x)^5*(a+a*sec(c+d*x)), x) == :(a*d^-1*sec(c+d*x)+-1*a*d^-1*sec(c+d*x)^2+-1*a*d^-1*log(cos(c+d*x))+-2//3*a*d^-1*sec(c+d*x)^3+1//4*a*d^-1*sec(c+d*x)^4+1//5*a*d^-1*sec(c+d*x)^5)
	@test integrate(tan(c+d*x)^3*(a+a*sec(c+d*x)), x) == :(a*d^-1*log(cos(c+d*x))+(1/2)*a*d^-1*sec(c+d*x)^2+-1*a*d^-1*sec(c+d*x)+1//3*a*d^-1*sec(c+d*x)^3)
	@test integrate((a+a*sec(c+d*x))*tan(c+d*x), x) == :(a*d^-1*sec(c+d*x)+-1*a*d^-1*log(cos(c+d*x)))
	@test integrate((a+a*sec(c+d*x))*cot(c+d*x), x) == :(a*d^-1*log(1+-1*cos(c+d*x)))
	@test integrate(cot(c+d*x)^3*(a+a*sec(c+d*x)), x) == :(-3//4*a*d^-1*log(1+-1*cos(c+d*x))+-1//2*a*d^-1*(1+-1*cos(c+d*x))^-1+-1//4*a*d^-1*log(1+cos(c+d*x)))
	@test integrate(cot(c+d*x)^5*(a+a*sec(c+d*x)), x) == :(-1//8*a*d^-1*(1+-1*cos(c+d*x))^-2+1//8*a*d^-1*(1+cos(c+d*x))^-1+3//4*a*d^-1*(1+-1*cos(c+d*x))^-1+5//16*a*d^-1*log(1+cos(c+d*x))+11//16*a*d^-1*log(1+-1*cos(c+d*x)))
	@test integrate(cot(c+d*x)^7*(a+a*sec(c+d*x)), x) == :(-21//32*a*d^-1*log(1+-1*cos(c+d*x))+-15//16*a*d^-1*(1+-1*cos(c+d*x))^-1+-11//32*a*d^-1*log(1+cos(c+d*x))+-1//4*a*d^-1*(1+cos(c+d*x))^-1+-1//24*a*d^-1*(1+-1*cos(c+d*x))^-3+1//32*a*d^-1*(1+cos(c+d*x))^-2+9//32*a*d^-1*(1+-1*cos(c+d*x))^-2)
	@test integrate(tan(c+d*x)^8*(a+a*sec(c+d*x)), x) == :(a*x+-1//128*d^-1*(128a+35*a*sec(c+d*x))*tan(c+d*x)+-1//240*d^-1*tan(c+d*x)^5*(48a+35*a*sec(c+d*x))+1//56*d^-1*tan(c+d*x)^7*(8a+7*a*sec(c+d*x))+1//192*d^-1*tan(c+d*x)^3*(64a+35*a*sec(c+d*x))+35//128*a*d^-1*arctanh(sin(c+d*x)))
end

@testset "4.5.10 (c+d x)^m (a+b sec)^n.jl" begin
	@test integrate((c+d*x)^3*(a+a*sec(e+f*x)), x) == :(1//4*a*d^-1*(c+d*x)^4+-6*im*a*d^3*f^-4*Polylogarithms.polylog(4,-1*im*exp(im*(e+f*x)))+-6*a*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*im*exp(im*(e+f*x)))+-2*im*a*f^-1*(c+d*x)^3*arctan(exp(im*(e+f*x)))+6*im*a*d^3*f^-4*Polylogarithms.polylog(4,im*exp(im*(e+f*x)))+6*a*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,im*exp(im*(e+f*x)))+-3*im*a*d*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,im*exp(im*(e+f*x)))+3*im*a*d*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*im*exp(im*(e+f*x))))
	@test integrate((c+d*x)^2*(a+a*sec(e+f*x)), x) == :(1//3*a*d^-1*(c+d*x)^3+-2*a*d^2*f^-3*Polylogarithms.polylog(3,-1*im*exp(im*(e+f*x)))+2*a*d^2*f^-3*Polylogarithms.polylog(3,im*exp(im*(e+f*x)))+-2*im*a*f^-1*(c+d*x)^2*arctan(exp(im*(e+f*x)))+-2*im*a*d*f^-2*(c+d*x)*Polylogarithms.polylog(2,im*exp(im*(e+f*x)))+2*im*a*d*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*im*exp(im*(e+f*x))))
	@test integrate((a+a*sec(e+f*x))*(c+d*x), x) == :((1/2)*a*d^-1*(c+d*x)^2+im*a*d*f^-2*Polylogarithms.polylog(2,-1*im*exp(im*(e+f*x)))+-1*im*a*d*f^-2*Polylogarithms.polylog(2,im*exp(im*(e+f*x)))+-2*im*a*f^-1*(c+d*x)*arctan(exp(im*(e+f*x))))
	@test integrate((a+a*sec(e+f*x))^2*(c+d*x)^3, x) == :(1//4*a^2*d^-1*(c+d*x)^4+a^2*f^-1*(c+d*x)^3*tan(e+f*x)+-1*im*a^2*f^-1*(c+d*x)^3+3//2*a^2*d^3*f^-4*Polylogarithms.polylog(3,-1*exp(2*im*(e+f*x)))+-12*im*a^2*d^3*f^-4*Polylogarithms.polylog(4,-1*im*exp(im*(e+f*x)))+-12*a^2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*im*exp(im*(e+f*x)))+-4*im*a^2*f^-1*(c+d*x)^3*arctan(exp(im*(e+f*x)))+3*d*a^2*f^-2*(c+d*x)^2*log(1+exp(2*im*(e+f*x)))+12*im*a^2*d^3*f^-4*Polylogarithms.polylog(4,im*exp(im*(e+f*x)))+12*a^2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,im*exp(im*(e+f*x)))+-6*im*d*a^2*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,im*exp(im*(e+f*x)))+-3*im*a^2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+6*im*d*a^2*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*im*exp(im*(e+f*x))))
	@test integrate((a+a*sec(e+f*x))^2*(c+d*x)^2, x) == :(1//3*a^2*d^-1*(c+d*x)^3+a^2*f^-1*(c+d*x)^2*tan(e+f*x)+-1*im*a^2*f^-1*(c+d*x)^2+-4*a^2*d^2*f^-3*Polylogarithms.polylog(3,-1*im*exp(im*(e+f*x)))+4*a^2*d^2*f^-3*Polylogarithms.polylog(3,im*exp(im*(e+f*x)))+-1*im*a^2*d^2*f^-3*Polylogarithms.polylog(2,-1*exp(2*im*(e+f*x)))+-4*im*a^2*f^-1*(c+d*x)^2*arctan(exp(im*(e+f*x)))+2*d*a^2*f^-2*(c+d*x)*log(1+exp(2*im*(e+f*x)))+-4*im*d*a^2*f^-2*(c+d*x)*Polylogarithms.polylog(2,im*exp(im*(e+f*x)))+4*im*d*a^2*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*im*exp(im*(e+f*x))))
	@test integrate((a+a*sec(e+f*x))^2*(c+d*x), x) == :((1/2)*a^2*d^-1*(c+d*x)^2+d*a^2*f^-2*log(cos(e+f*x))+a^2*f^-1*(c+d*x)*tan(e+f*x)+-4*im*a^2*f^-1*(c+d*x)*arctan(exp(im*(e+f*x)))+-2*im*d*a^2*f^-2*Polylogarithms.polylog(2,im*exp(im*(e+f*x)))+2*im*d*a^2*f^-2*Polylogarithms.polylog(2,-1*im*exp(im*(e+f*x))))
	@test integrate((a+a*sec(e+f*x))^-1*(c+d*x)^3, x) == :(1//4*a^-1*d^-1*(c+d*x)^4+im*a^-1*f^-1*(c+d*x)^3+-1*a^-1*f^-1*(c+d*x)^3*tan((1/2)*e+(1/2)*f*x)+-12*a^-1*d^3*f^-4*Polylogarithms.polylog(3,-1*exp(im*(e+f*x)))+-6*d*a^-1*f^-2*(c+d*x)^2*log(1+exp(im*(e+f*x)))+12*im*a^-1*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(2,-1*exp(im*(e+f*x))))
	@test integrate((a+a*sec(e+f*x))^-1*(c+d*x)^2, x) == :(1//3*a^-1*d^-1*(c+d*x)^3+im*a^-1*f^-1*(c+d*x)^2+-1*a^-1*f^-1*(c+d*x)^2*tan((1/2)*e+(1/2)*f*x)+-4*d*a^-1*f^-2*(c+d*x)*log(1+exp(im*(e+f*x)))+4*im*a^-1*d^2*f^-3*Polylogarithms.polylog(2,-1*exp(im*(e+f*x))))
	@test integrate((a+a*sec(e+f*x))^-1*(c+d*x), x) == :((1/2)*a^-1*d^-1*(c+d*x)^2+-1*a^-1*f^-1*(c+d*x)*tan((1/2)*e+(1/2)*f*x)+-2*d*a^-1*f^-2*log(cos((1/2)*e+(1/2)*f*x)))
	@test integrate((a+a*sec(e+f*x))^-2*(c+d*x)^3, x) == :(1//4*a^-2*d^-1*(c+d*x)^4+-20*a^-2*d^3*f^-4*Polylogarithms.polylog(3,-1*exp(im*(e+f*x)))+4*a^-2*d^3*f^-4*log(cos((1/2)*e+(1/2)*f*x))+-5//3*a^-2*f^-1*(c+d*x)^3*tan((1/2)*e+(1/2)*f*x)+5//3*im*a^-2*f^-1*(c+d*x)^3+-10*d*a^-2*f^-2*(c+d*x)^2*log(1+exp(im*(e+f*x)))+2*a^-2*d^2*f^-3*(c+d*x)*tan((1/2)*e+(1/2)*f*x)+-1//2*d*a^-2*f^-2*(c+d*x)^2*sec((1/2)*e+(1/2)*f*x)^2+1//6*a^-2*f^-1*(c+d*x)^3*sec((1/2)*e+(1/2)*f*x)^2*tan((1/2)*e+(1/2)*f*x)+20*im*a^-2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(2,-1*exp(im*(e+f*x))))
end

@testset "4.5.11 (e x)^m (a+b sec(c+d x^n))^p.jl" begin
	@test integrate(x^5*(a+b*sec(c+d*x^2)), x) == :(1//6*a*x^6+b*d^-3*Polylogarithms.polylog(3,im*exp(im*(c+d*x^2)))+-1*b*d^-3*Polylogarithms.polylog(3,-1*im*exp(im*(c+d*x^2)))+im*b*d^-2*x^2*Polylogarithms.polylog(2,-1*im*exp(im*(c+d*x^2)))+-1*im*b*d^-1*x^4*arctan(exp(im*(c+d*x^2)))+-1*im*b*d^-2*x^2*Polylogarithms.polylog(2,im*exp(im*(c+d*x^2))))
	@test integrate(x^3*(a+b*sec(c+d*x^2)), x) == :(1//4*a*x^4+(1/2)*im*b*d^-2*Polylogarithms.polylog(2,-1*im*exp(im*(c+d*x^2)))+-1//2*im*b*d^-2*Polylogarithms.polylog(2,im*exp(im*(c+d*x^2)))+-1*im*b*d^-1*x^2*arctan(exp(im*(c+d*x^2))))
	@test integrate(x*(a+b*sec(c+d*x^2)), x) == :((1/2)*a*x^2+(1/2)*b*d^-1*arctanh(sin(c+d*x^2)))
	@test integrate(x^5*(a+b*sec(c+d*x^2))^2, x) == :(1//6*a^2*x^6+b^2*d^-2*x^2*log(1+exp(2*im*(c+d*x^2)))+(1/2)*b^2*d^-1*x^4*tan(c+d*x^2)+-2*a*b*d^-3*Polylogarithms.polylog(3,-1*im*exp(im*(c+d*x^2)))+2*a*b*d^-3*Polylogarithms.polylog(3,im*exp(im*(c+d*x^2)))+-1//2*im*b^2*d^-1*x^4+-1//2*im*b^2*d^-3*Polylogarithms.polylog(2,-1*exp(2*im*(c+d*x^2)))+-2*im*a*b*d^-1*x^4*arctan(exp(im*(c+d*x^2)))+-2*im*a*b*d^-2*x^2*Polylogarithms.polylog(2,im*exp(im*(c+d*x^2)))+2*im*a*b*d^-2*x^2*Polylogarithms.polylog(2,-1*im*exp(im*(c+d*x^2))))
	@test integrate(x^3*(a+b*sec(c+d*x^2))^2, x) == :(1//4*a^2*x^4+(1/2)*b^2*d^-2*log(cos(c+d*x^2))+(1/2)*b^2*d^-1*x^2*tan(c+d*x^2)+im*a*b*d^-2*Polylogarithms.polylog(2,-1*im*exp(im*(c+d*x^2)))+-1*im*a*b*d^-2*Polylogarithms.polylog(2,im*exp(im*(c+d*x^2)))+-2*im*a*b*d^-1*x^2*arctan(exp(im*(c+d*x^2))))
	@test integrate(x*(a+b*sec(c+d*x^2))^2, x) == :((1/2)*a^2*x^2+(1/2)*b^2*d^-1*tan(c+d*x^2)+a*b*d^-1*arctanh(sin(c+d*x^2)))
	@test integrate(x*sec(a+b*x^2)^7, x) == :(5//32*b^-1*arctanh(sin(a+b*x^2))+1//12*b^-1*sec(a+b*x^2)^5*tan(a+b*x^2)+5//32*b^-1*sec(a+b*x^2)*tan(a+b*x^2)+5//48*b^-1*sec(a+b*x^2)^3*tan(a+b*x^2))
	@test integrate(x^5*(a+b*sec(c+d*x^2))^-1, x) == :(1//6*a^-1*x^6+im*b*a^-1*d^-3*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(3,-1*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+b*a^-1*d^-2*x^2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1*im*b*a^-1*d^-3*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(3,-1*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1*b*a^-1*d^-2*x^2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+(1/2)*im*b*a^-1*d^-1*x^4*(b^2+-1*a^2)^-1//2*log(1+a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1//2*im*b*a^-1*d^-1*x^4*(b^2+-1*a^2)^-1//2*log(1+a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2))))
	@test integrate(x^3*(a+b*sec(c+d*x^2))^-1, x) == :(1//4*a^-1*x^4+(1/2)*b*a^-1*d^-2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1//2*b*a^-1*d^-2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+(1/2)*im*b*a^-1*d^-1*x^2*(b^2+-1*a^2)^-1//2*log(1+a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1//2*im*b*a^-1*d^-1*x^2*(b^2+-1*a^2)^-1//2*log(1+a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2))))
	@test integrate(x*(a+b*sec(c+d*x^2))^-1, x) == :((1/2)*a^-1*x^2+-1*b*a^-1*d^-1*(a+b)^-1//2*(a+-1b)^-1//2*arctanh((a+b)^-1//2*(a+-1b)^(1/2)*tan((1/2)*c+(1/2)*d*x^2)))
end

@testset "4.5.2.1 (a+b sec)^m (c+d sec)^n.jl" begin
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^5, x) == :(x*a^2*c^5+-1*a^2*c^5*f^-1*tan(e+f*x)+-19//16*a^2*c^5*f^-1*arctanh(sin(e+f*x))+1//3*a^2*c^5*f^-1*tan(e+f*x)^3+3//5*a^2*c^5*f^-1*tan(e+f*x)^5+-3//4*a^2*c^5*f^-1*tan(e+f*x)^3*sec(e+f*x)+-1//6*a^2*c^5*f^-1*sec(e+f*x)^3*tan(e+f*x)^3+1//8*a^2*c^5*f^-1*sec(e+f*x)^3*tan(e+f*x)+17//16*a^2*c^5*f^-1*sec(e+f*x)*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^4, x) == :(x*a^2*c^4+-1*a^2*c^4*f^-1*tan(e+f*x)+-3//4*a^2*c^4*f^-1*arctanh(sin(e+f*x))+1//3*a^2*c^4*f^-1*tan(e+f*x)^3+1//5*a^2*c^4*f^-1*tan(e+f*x)^5+-1//2*a^2*c^4*f^-1*tan(e+f*x)^3*sec(e+f*x)+3//4*a^2*c^4*f^-1*sec(e+f*x)*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^3, x) == :(x*a^2*c^3+-3//8*a^2*c^3*f^-1*arctanh(sin(e+f*x))+-1//8*a^2*f^-1*(8*c^3+-3*c^3*sec(e+f*x))*tan(e+f*x)+1//12*a^2*f^-1*tan(e+f*x)^3*(4*c^3+-3*c^3*sec(e+f*x)))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^2, x) == :(x*a^2*c^2+-1*a^2*c^2*f^-1*tan(e+f*x)+1//3*a^2*c^2*f^-1*tan(e+f*x)^3)
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x)), x) == :(c*x*a^2+(1/2)*c*a^2*f^-1*arctanh(sin(e+f*x))+-1//2*c*f^-1*(2*a^2+a^2*sec(e+f*x))*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^-1, x) == :(x*a^2*c^-1+-1*a^2*c^-1*f^-1*arctanh(sin(e+f*x))+-4*a^2*c^-1*f^-1*(1+-1*sec(e+f*x))^-1*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^-2, x) == :(x*a^2*c^-2+-4//3*a^2*c^-2*f^-1*(1+-1*sec(e+f*x))^-1*tan(e+f*x)+-4//3*a^2*c^-2*f^-1*(1+-1*sec(e+f*x))^-2*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^-3, x) == :(x*a^2*c^-3+-23//15*a^2*c^-3*f^-1*(1+-1*sec(e+f*x))^-1*tan(e+f*x)+-8//15*a^2*c^-3*f^-1*(1+-1*sec(e+f*x))^-2*tan(e+f*x)+-4//5*a^2*c^-3*f^-1*(1+-1*sec(e+f*x))^-3*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^-4, x) == :(x*a^2*c^-4+-164//105*a^2*c^-4*f^-1*(1+-1*sec(e+f*x))^-1*tan(e+f*x)+-59//105*a^2*c^-4*f^-1*(1+-1*sec(e+f*x))^-2*tan(e+f*x)+-12//35*a^2*c^-4*f^-1*(1+-1*sec(e+f*x))^-3*tan(e+f*x)+-4//7*a^2*c^-4*f^-1*(1+-1*sec(e+f*x))^-4*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^-5, x) == :(x*a^2*c^-5+-494//315*a^2*c^-5*f^-1*(1+-1*sec(e+f*x))^-1*tan(e+f*x)+-179//315*a^2*c^-5*f^-1*(1+-1*sec(e+f*x))^-2*tan(e+f*x)+-37//105*a^2*c^-5*f^-1*(1+-1*sec(e+f*x))^-3*tan(e+f*x)+-16//63*a^2*c^-5*f^-1*(1+-1*sec(e+f*x))^-4*tan(e+f*x)+-4//9*a^2*c^-5*f^-1*(1+-1*sec(e+f*x))^-5*tan(e+f*x))
end

@testset "4.5.2.3 (g sec)^p (a+b sec)^m (c+d sec)^n.jl" begin
	@test integrate((c+-1*c*sec(e+f*x))^4*(a+a*sec(e+f*x))*sec(e+f*x), x) == :(1//5*a*c^4*f^-1*tan(e+f*x)^5+4//3*a*c^4*f^-1*tan(e+f*x)^3+7//8*a*c^4*f^-1*arctanh(sin(e+f*x))+-3//4*a*c^4*f^-1*sec(e+f*x)^3*tan(e+f*x)+-1//8*a*c^4*f^-1*sec(e+f*x)*tan(e+f*x))
	@test integrate((c+-1*c*sec(e+f*x))^3*(a+a*sec(e+f*x))*sec(e+f*x), x) == :(2//3*a*c^3*f^-1*tan(e+f*x)^3+5//8*a*c^3*f^-1*arctanh(sin(e+f*x))+-3//8*a*c^3*f^-1*sec(e+f*x)*tan(e+f*x)+-1//4*a*c^3*f^-1*sec(e+f*x)^3*tan(e+f*x))
	@test integrate((c+-1*c*sec(e+f*x))^2*(a+a*sec(e+f*x))*sec(e+f*x), x) == :((1/2)*a*c^2*f^-1*arctanh(sin(e+f*x))+1//3*a*c^2*f^-1*tan(e+f*x)^3+-1//2*a*c^2*f^-1*sec(e+f*x)*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))*(c+-1*c*sec(e+f*x))*sec(e+f*x), x) == :((1/2)*a*c*f^-1*arctanh(sin(e+f*x))+-1//2*a*c*f^-1*sec(e+f*x)*tan(e+f*x))
	@test integrate((c+-1*c*sec(e+f*x))^-1*(a+a*sec(e+f*x))*sec(e+f*x), x) == :(-1*a*c^-1*f^-1*arctanh(sin(e+f*x))+-2*a*f^-1*(c+-1*c*sec(e+f*x))^-1*tan(e+f*x))
	@test integrate((c+-1*c*sec(e+f*x))^-2*(a+a*sec(e+f*x))*sec(e+f*x), x) == :(-1//3*f^-1*(c+-1*c*sec(e+f*x))^-2*(a+a*sec(e+f*x))*tan(e+f*x))
	@test integrate((c+-1*c*sec(e+f*x))^-3*(a+a*sec(e+f*x))*sec(e+f*x), x) == :(-1//5*f^-1*(c+-1*c*sec(e+f*x))^-3*(a+a*sec(e+f*x))*tan(e+f*x)+-1//15*c^-1*f^-1*(c+-1*c*sec(e+f*x))^-2*(a+a*sec(e+f*x))*tan(e+f*x))
	@test integrate((c+-1*c*sec(e+f*x))^-4*(a+a*sec(e+f*x))*sec(e+f*x), x) == :(-1//7*f^-1*(c+-1*c*sec(e+f*x))^-4*(a+a*sec(e+f*x))*tan(e+f*x)+-1//105*f^-1*(c^2+-1*c^2*sec(e+f*x))^-2*(2a+2*a*sec(e+f*x))*tan(e+f*x)+-1//35*c^-1*f^-1*(c+-1*c*sec(e+f*x))^-3*(2a+2*a*sec(e+f*x))*tan(e+f*x))
	@test integrate((c+-1*c*sec(e+f*x))^-5*(a+a*sec(e+f*x))*sec(e+f*x), x) == :(-1//9*f^-1*(c+-1*c*sec(e+f*x))^-5*(a+a*sec(e+f*x))*tan(e+f*x)+-1//21*c^-1*f^-1*(c+-1*c*sec(e+f*x))^-4*(a+a*sec(e+f*x))*tan(e+f*x)+-1//105*c^-2*f^-1*(c+-1*c*sec(e+f*x))^-3*(2a+2*a*sec(e+f*x))*tan(e+f*x)+-1//315*c^-1*f^-1*(c^2+-1*c^2*sec(e+f*x))^-2*(2a+2*a*sec(e+f*x))*tan(e+f*x))
	@test integrate((a+a*sec(e+f*x))^2*(c+-1*c*sec(e+f*x))^5*sec(e+f*x), x) == :(-4//5*a^2*c^5*f^-1*tan(e+f*x)^5+-1//7*a^2*c^5*f^-1*tan(e+f*x)^7+9//16*a^2*c^5*f^-1*arctanh(sin(e+f*x))+(1/2)*a^2*c^5*f^-1*sec(e+f*x)^3*tan(e+f*x)^3+-3//8*a^2*c^5*f^-1*sec(e+f*x)^3*tan(e+f*x)+-3//16*a^2*c^5*f^-1*sec(e+f*x)*tan(e+f*x)+1//4*a^2*c^5*f^-1*tan(e+f*x)^3*sec(e+f*x))
end

@testset "4.5.3.1 (a+b sec)^m (d sec)^n (A+B sec).jl" begin
	@test integrate((b*sec(c+d*x))^5//2*(A+B*sec(c+d*x)), x) == :(2//5*B*d^-1*(b*sec(c+d*x))^5//2*sin(c+d*x)+2//3*A*b*d^-1*(b*sec(c+d*x))^3//2*sin(c+d*x)+6//5*B*b^2*d^-1*(b*sec(c+d*x))^(1/2)*sin(c+d*x)+-6//5*B*b^3*d^-1*(b*sec(c+d*x))^-1//2*cos(c+d*x)^-1//2*Elliptic.E((1/2)*c+(1/2)*d*x,2)+2//3*A*b^2*d^-1*(b*sec(c+d*x))^(1/2)*cos(c+d*x)^(1/2)*Elliptic.F((1/2)*c+(1/2)*d*x,2))
	@test integrate((b*sec(c+d*x))^3//2*(A+B*sec(c+d*x)), x) == :(2//3*B*d^-1*(b*sec(c+d*x))^3//2*sin(c+d*x)+2*A*b*d^-1*(b*sec(c+d*x))^(1/2)*sin(c+d*x)+-2*A*b^2*d^-1*(b*sec(c+d*x))^-1//2*cos(c+d*x)^-1//2*Elliptic.E((1/2)*c+(1/2)*d*x,2)+2//3*B*b*d^-1*(b*sec(c+d*x))^(1/2)*cos(c+d*x)^(1/2)*Elliptic.F((1/2)*c+(1/2)*d*x,2))
	@test integrate((b*sec(c+d*x))^(1/2)*(A+B*sec(c+d*x)), x) == :(2*B*d^-1*(b*sec(c+d*x))^(1/2)*sin(c+d*x)+2*A*d^-1*(b*sec(c+d*x))^(1/2)*cos(c+d*x)^(1/2)*Elliptic.F((1/2)*c+(1/2)*d*x,2)+-2*B*b*d^-1*(b*sec(c+d*x))^-1//2*cos(c+d*x)^-1//2*Elliptic.E((1/2)*c+(1/2)*d*x,2))
	@test integrate((b*sec(c+d*x))^-1//2*(A+B*sec(c+d*x)), x) == :(2*A*d^-1*(b*sec(c+d*x))^-1//2*cos(c+d*x)^-1//2*Elliptic.E((1/2)*c+(1/2)*d*x,2)+2*B*b^-1*d^-1*(b*sec(c+d*x))^(1/2)*cos(c+d*x)^(1/2)*Elliptic.F((1/2)*c+(1/2)*d*x,2))
	@test integrate((b*sec(c+d*x))^-3//2*(A+B*sec(c+d*x)), x) == :(2//3*A*b^-1*d^-1*(b*sec(c+d*x))^-1//2*sin(c+d*x)+2*B*b^-1*d^-1*(b*sec(c+d*x))^-1//2*cos(c+d*x)^-1//2*Elliptic.E((1/2)*c+(1/2)*d*x,2)+2//3*A*b^-2*d^-1*(b*sec(c+d*x))^(1/2)*cos(c+d*x)^(1/2)*Elliptic.F((1/2)*c+(1/2)*d*x,2))
	@test integrate((b*sec(c+d*x))^-5//2*(A+B*sec(c+d*x)), x) == :(2//3*B*b^-2*d^-1*(b*sec(c+d*x))^-1//2*sin(c+d*x)+2//5*A*b^-1*d^-1*(b*sec(c+d*x))^-3//2*sin(c+d*x)+2//3*B*b^-3*d^-1*(b*sec(c+d*x))^(1/2)*cos(c+d*x)^(1/2)*Elliptic.F((1/2)*c+(1/2)*d*x,2)+6//5*A*b^-2*d^-1*(b*sec(c+d*x))^-1//2*cos(c+d*x)^-1//2*Elliptic.E((1/2)*c+(1/2)*d*x,2))
	@test integrate(sec(c+d*x)^4*(A+B*sec(c+d*x))*(a+a*sec(c+d*x)), x) == :(1//5*a*d^-1*(4B+5A)*tan(c+d*x)+1//15*a*d^-1*tan(c+d*x)^3*(4B+5A)+3//8*a*d^-1*(A+B)*arctanh(sin(c+d*x))+1//4*a*d^-1*sec(c+d*x)^3*(A+B)*tan(c+d*x)+1//5*B*a*d^-1*sec(c+d*x)^4*tan(c+d*x)+3//8*a*d^-1*(A+B)*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^3*(A+B*sec(c+d*x))*(a+a*sec(c+d*x)), x) == :(a*d^-1*(A+B)*tan(c+d*x)+1//3*a*d^-1*tan(c+d*x)^3*(A+B)+1//8*a*d^-1*(3B+4A)*arctanh(sin(c+d*x))+1//4*B*a*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//8*a*d^-1*(3B+4A)*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^2*(A+B*sec(c+d*x))*(a+a*sec(c+d*x)), x) == :((1/2)*a*d^-1*(A+B)*arctanh(sin(c+d*x))+1//3*a*d^-1*(2B+3A)*tan(c+d*x)+(1/2)*a*d^-1*(A+B)*sec(c+d*x)*tan(c+d*x)+1//3*B*a*d^-1*sec(c+d*x)^2*tan(c+d*x))
	@test integrate((A+B*sec(c+d*x))*(a+a*sec(c+d*x))*sec(c+d*x), x) == :(a*d^-1*(A+B)*tan(c+d*x)+(1/2)*a*d^-1*(B+2A)*arctanh(sin(c+d*x))+(1/2)*B*a*d^-1*sec(c+d*x)*tan(c+d*x))
end

@testset "4.5.4.1 (a+b sec)^m (A+B sec+C sec^2).jl" begin
	@test integrate(sec(c+d*x)^6*(A+C*sec(c+d*x)^2), x) == :(1//7*d^-1*(6C+7A)*tan(c+d*x)+1//21*d^-1*tan(c+d*x)^3*(12C+14A)+1//35*d^-1*tan(c+d*x)^5*(6C+7A)+1//7*C*d^-1*sec(c+d*x)^6*tan(c+d*x))
	@test integrate(sec(c+d*x)^5*(A+C*sec(c+d*x)^2), x) == :(1//16*d^-1*(5C+6A)*arctanh(sin(c+d*x))+1//6*C*d^-1*sec(c+d*x)^5*tan(c+d*x)+1//16*d^-1*(5C+6A)*sec(c+d*x)*tan(c+d*x)+1//24*d^-1*sec(c+d*x)^3*(5C+6A)*tan(c+d*x))
	@test integrate(sec(c+d*x)^4*(A+C*sec(c+d*x)^2), x) == :(1//5*d^-1*(4C+5A)*tan(c+d*x)+1//15*d^-1*tan(c+d*x)^3*(4C+5A)+1//5*C*d^-1*sec(c+d*x)^4*tan(c+d*x))
	@test integrate(sec(c+d*x)^3*(A+C*sec(c+d*x)^2), x) == :(1//8*d^-1*(3C+4A)*arctanh(sin(c+d*x))+1//4*C*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//8*d^-1*(3C+4A)*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^2*(A+C*sec(c+d*x)^2), x) == :(1//3*d^-1*(2C+3A)*tan(c+d*x)+1//3*C*d^-1*sec(c+d*x)^2*tan(c+d*x))
	@test integrate((A+C*sec(c+d*x)^2)*sec(c+d*x), x) == :((1/2)*d^-1*(C+2A)*arctanh(sin(c+d*x))+(1/2)*C*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate(A+C*sec(c+d*x)^2, x) == :(A*x+C*d^-1*tan(c+d*x))
	@test integrate((A+C*sec(c+d*x)^2)*cos(c+d*x), x) == :(A*d^-1*sin(c+d*x)+C*d^-1*arctanh(sin(c+d*x)))
	@test integrate(cos(c+d*x)^2*(A+C*sec(c+d*x)^2), x) == :(x*(C+(1/2)*A)+(1/2)*A*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^3*(A+C*sec(c+d*x)^2), x) == :(d^-1*(A+C)*sin(c+d*x)+-1//3*A*d^-1*sin(c+d*x)^3)
end

@testset "4.5.4.2 (a+b sec)^m (d sec)^n (A+B sec+C sec^2).jl" begin
	@test integrate(sec(c+d*x)^3*(A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x)), x) == :(1//5*a*d^-1*(4C+5A)*tan(c+d*x)+1//8*a*d^-1*(3C+4A)*arctanh(sin(c+d*x))+1//15*a*d^-1*tan(c+d*x)^3*(4C+5A)+1//4*C*a*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//5*C*a*d^-1*sec(c+d*x)^4*tan(c+d*x)+1//8*a*d^-1*(3C+4A)*sec(c+d*x)*tan(c+d*x))
	@test integrate(sec(c+d*x)^2*(A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x)), x) == :(1//3*a*d^-1*(2C+3A)*tan(c+d*x)+1//8*a*d^-1*(3C+4A)*arctanh(sin(c+d*x))+1//3*C*a*d^-1*sec(c+d*x)^2*tan(c+d*x)+1//4*C*a*d^-1*sec(c+d*x)^3*tan(c+d*x)+1//8*a*d^-1*(3C+4A)*sec(c+d*x)*tan(c+d*x))
	@test integrate((A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x))*sec(c+d*x), x) == :((1/2)*a*d^-1*(C+2A)*arctanh(sin(c+d*x))+1//3*a*d^-1*(2C+3A)*tan(c+d*x)+(1/2)*C*a*d^-1*sec(c+d*x)*tan(c+d*x)+1//3*C*a*d^-1*sec(c+d*x)^2*tan(c+d*x))
	@test integrate((A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x)), x) == :(A*a*x+C*a*d^-1*tan(c+d*x)+(1/2)*a*d^-1*(C+2A)*arctanh(sin(c+d*x))+(1/2)*C*a*d^-1*sec(c+d*x)*tan(c+d*x))
	@test integrate((A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x))*cos(c+d*x), x) == :(A*a*x+A*a*d^-1*sin(c+d*x)+C*a*d^-1*arctanh(sin(c+d*x))+C*a*d^-1*tan(c+d*x))
	@test integrate(cos(c+d*x)^2*(A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x)), x) == :((1/2)*a*x*(A+2C)+A*a*d^-1*sin(c+d*x)+C*a*d^-1*arctanh(sin(c+d*x))+(1/2)*A*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^3*(A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x)), x) == :((1/2)*a*x*(A+2C)+1//3*a*d^-1*(2A+3C)*sin(c+d*x)+(1/2)*A*a*d^-1*cos(c+d*x)*sin(c+d*x)+1//3*A*a*d^-1*cos(c+d*x)^2*sin(c+d*x))
	@test integrate(cos(c+d*x)^4*(A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x)), x) == :(1//8*a*x*(3A+4C)+a*d^-1*(A+C)*sin(c+d*x)+-1//3*A*a*d^-1*sin(c+d*x)^3+1//4*A*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//8*a*d^-1*(3A+4C)*cos(c+d*x)*sin(c+d*x))
	@test integrate(cos(c+d*x)^5*(A+C*sec(c+d*x)^2)*(a+a*sec(c+d*x)), x) == :(1//8*a*x*(3A+4C)+-1//15*a*d^-1*sin(c+d*x)^3*(4A+5C)+1//5*a*d^-1*(4A+5C)*sin(c+d*x)+1//4*A*a*d^-1*cos(c+d*x)^3*sin(c+d*x)+1//5*A*a*d^-1*cos(c+d*x)^4*sin(c+d*x)+1//8*a*d^-1*(3A+4C)*cos(c+d*x)*sin(c+d*x))
	@test integrate((a+a*sec(c+d*x))^2*sec(c+d*x)^2*(A+C*sec(c+d*x)^2), x) == :(1//3*a^2*d^-1*(3C+4A)*tan(c+d*x)+1//4*a^2*d^-1*(3C+4A)*arctanh(sin(c+d*x))+1//30*d^-1*(a+a*sec(c+d*x))^2*(3C+10A)*tan(c+d*x)+1//5*C*d^-1*(a+a*sec(c+d*x))^2*sec(c+d*x)^2*tan(c+d*x)+1//10*C*a^-1*d^-1*(a+a*sec(c+d*x))^3*tan(c+d*x)+1//12*a^2*d^-1*(3C+4A)*sec(c+d*x)*tan(c+d*x))
end

@testset "4.5.7 (d trig)^m (a+b (c sec)^n)^p.jl" begin
	@test integrate(sin(e+f*x)^7*(a+b*sec(e+f*x)^2), x) == :(b*f^-1*sec(e+f*x)+f^-1*cos(e+f*x)^3*(a+-1b)+-1*f^-1*(a+-3b)*cos(e+f*x)+-1//5*f^-1*cos(e+f*x)^5*(-1b+3a)+1//7*a*f^-1*cos(e+f*x)^7)
	@test integrate(sin(e+f*x)^5*(a+b*sec(e+f*x)^2), x) == :(b*f^-1*sec(e+f*x)+-1*f^-1*(a+-2b)*cos(e+f*x)+-1//5*a*f^-1*cos(e+f*x)^5+1//3*f^-1*cos(e+f*x)^3*(-1b+2a))
	@test integrate(sin(e+f*x)^3*(a+b*sec(e+f*x)^2), x) == :(b*f^-1*sec(e+f*x)+-1*f^-1*(a+-1b)*cos(e+f*x)+1//3*a*f^-1*cos(e+f*x)^3)
	@test integrate((a+b*sec(e+f*x)^2)*sin(e+f*x), x) == :(b*f^-1*sec(e+f*x)+-1*a*f^-1*cos(e+f*x))
	@test integrate((a+b*sec(e+f*x)^2)*csc(e+f*x), x) == :(b*f^-1*sec(e+f*x)+-1*f^-1*(a+b)*arctanh(cos(e+f*x)))
	@test integrate(csc(e+f*x)^3*(a+b*sec(e+f*x)^2), x) == :(b*f^-1*sec(e+f*x)+-1//2*f^-1*(a+3b)*arctanh(cos(e+f*x))+-1//2*f^-1*(a+b)*cot(e+f*x)*csc(e+f*x))
	@test integrate(csc(e+f*x)^5*(a+b*sec(e+f*x)^2), x) == :(b*f^-1*sec(e+f*x)+1//8*f^-1*(-15b+-3a)*arctanh(cos(e+f*x))+-1//4*f^-1*csc(e+f*x)^3*(a+b)*cot(e+f*x)+-1//8*f^-1*(3a+7b)*cot(e+f*x)*csc(e+f*x))
	@test integrate(sin(e+f*x)^6*(a+b*sec(e+f*x)^2), x) == :(1//16*x*(-30b+5a)+b*f^-1*tan(e+f*x)+-1//6*a*f^-1*cos(e+f*x)^5*sin(e+f*x)+-1//16*f^-1*(-18b+11a)*cos(e+f*x)*sin(e+f*x)+1//24*f^-1*cos(e+f*x)^3*(-6b+13a)*sin(e+f*x))
	@test integrate(sin(e+f*x)^4*(a+b*sec(e+f*x)^2), x) == :(1//8*x*(-12b+3a)+b*f^-1*tan(e+f*x)+-1//8*f^-1*(-4b+5a)*cos(e+f*x)*sin(e+f*x)+1//4*a*f^-1*cos(e+f*x)^3*sin(e+f*x))
	@test integrate(sin(e+f*x)^2*(a+b*sec(e+f*x)^2), x) == :((1/2)*x*(a+-2b)+b*f^-1*tan(e+f*x)+-1//2*a*f^-1*cos(e+f*x)*sin(e+f*x))
end

@testset "4.6.0 (a csc)^m (b trg)^n.jl" begin
	@test integrate(csc(a+b*x), x) == :(-1*b^-1*arctanh(cos(a+b*x)))
	@test integrate(csc(a+b*x)^2, x) == :(-1*b^-1*cot(a+b*x))
	@test integrate(csc(a+b*x)^3, x) == :(-1//2*b^-1*arctanh(cos(a+b*x))+-1//2*b^-1*cot(a+b*x)*csc(a+b*x))
	@test integrate(csc(a+b*x)^4, x) == :(-1*b^-1*cot(a+b*x)+-1//3*b^-1*cot(a+b*x)^3)
	@test integrate(csc(a+b*x)^5, x) == :(-3//8*b^-1*arctanh(cos(a+b*x))+-3//8*b^-1*cot(a+b*x)*csc(a+b*x)+-1//4*b^-1*csc(a+b*x)^3*cot(a+b*x))
	@test integrate(csc(a+b*x)^6, x) == :(-1*b^-1*cot(a+b*x)+-2//3*b^-1*cot(a+b*x)^3+-1//5*b^-1*cot(a+b*x)^5)
	@test integrate(csc(a+b*x)^7, x) == :(-5//16*b^-1*arctanh(cos(a+b*x))+-5//16*b^-1*cot(a+b*x)*csc(a+b*x)+-5//24*b^-1*csc(a+b*x)^3*cot(a+b*x)+-1//6*b^-1*csc(a+b*x)^5*cot(a+b*x))
	@test integrate(csc(a+b*x)^8, x) == :(-1*b^-1*cot(a+b*x)^3+-1*b^-1*cot(a+b*x)+-3//5*b^-1*cot(a+b*x)^5+-1//7*b^-1*cot(a+b*x)^7)
	@test integrate(csc(a+b*x)^7//2, x) == :(-6//5*b^-1*csc(a+b*x)^(1/2)*cos(a+b*x)+-2//5*b^-1*csc(a+b*x)^5//2*cos(a+b*x)+-6//5*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.E((1/2)*a+-1//4*pi+(1/2)*b*x,2))
	@test integrate(csc(a+b*x)^5//2, x) == :(-2//3*b^-1*csc(a+b*x)^3//2*cos(a+b*x)+2//3*b^-1*csc(a+b*x)^(1/2)*sin(a+b*x)^(1/2)*Elliptic.F((1/2)*a+-1//4*pi+(1/2)*b*x,2))
end

@testset "4.6.1.2 (d csc)^n (a+b csc)^m.jl" begin
	@test integrate((a+a*csc(x))^-1*csc(x)^5, x) == :(-4*a^-1*cot(x)+-4//3*a^-1*cot(x)^3+3//2*a^-1*arctanh(cos(x))+(a+a*csc(x))^-1*csc(x)^3*cot(x)+3//2*a^-1*cot(x)*csc(x))
	@test integrate((a+a*csc(x))^-1*csc(x)^4, x) == :(2*a^-1*cot(x)+-3//2*a^-1*arctanh(cos(x))+(a+a*csc(x))^-1*csc(x)^2*cot(x)+-3//2*a^-1*cot(x)*csc(x))
	@test integrate((a+a*csc(x))^-1*csc(x)^3, x) == :(a^-1*arctanh(cos(x))+-1*a^-1*cot(x)+-1*(a+a*csc(x))^-1*cot(x))
	@test integrate((a+a*csc(x))^-1*csc(x)^2, x) == :((a+a*csc(x))^-1*cot(x)+-1*a^-1*arctanh(cos(x)))
	@test integrate((a+a*csc(x))^-1*csc(x), x) == :(-1*(a+a*csc(x))^-1*cot(x))
	@test integrate((a+a*csc(c+d*x))^-1, x) == :(x*a^-1+d^-1*(a+a*csc(c+d*x))^-1*cot(c+d*x))
	@test integrate((a+a*csc(x))^-1*sin(x), x) == :((a+a*csc(x))^-1*cos(x)+-1*x*a^-1+-2*a^-1*cos(x))
	@test integrate((a+a*csc(x))^-1*sin(x)^2, x) == :(2*a^-1*cos(x)+3//2*x*a^-1+(a+a*csc(x))^-1*cos(x)*sin(x)+-3//2*a^-1*cos(x)*sin(x))
	@test integrate((a+a*csc(x))^-1*sin(x)^3, x) == :(-4*a^-1*cos(x)+-3//2*x*a^-1+4//3*a^-1*cos(x)^3+(a+a*csc(x))^-1*sin(x)^2*cos(x)+3//2*a^-1*cos(x)*sin(x))
	@test integrate((a+a*csc(x))^-1*sin(x)^4, x) == :(4*a^-1*cos(x)+-4//3*a^-1*cos(x)^3+15//8*x*a^-1+(a+a*csc(x))^-1*sin(x)^3*cos(x)+-15//8*a^-1*cos(x)*sin(x)+-5//4*a^-1*sin(x)^3*cos(x))
end

@testset "4.6.1.3 (d cos)^n (a+b csc)^m.jl" begin
	@test integrate((a+a*csc(x))^-1*cos(x)^4, x) == :(-1//3*a^-1*cos(x)^3+-1//8*x*a^-1+-1//8*a^-1*cos(x)*sin(x)+1//4*a^-1*cos(x)^3*sin(x))
	@test integrate((a+a*csc(x))^-1*cos(x)^3, x) == :((1/2)*a^-1*sin(x)^2+-1//3*a^-1*sin(x)^3)
	@test integrate((a+a*csc(x))^-1*cos(x)^2, x) == :(-1*a^-1*cos(x)+-1//2*x*a^-1+(1/2)*a^-1*cos(x)*sin(x))
	@test integrate((a+a*csc(x))^-1*cos(x), x) == :(a^-1*sin(x)+-1*a^-1*log(1+sin(x)))
	@test integrate((a+a*csc(x))^-1*sec(x), x) == :((1/2)*a^-1*sec(x)^2+(1/2)*a^-1*arctanh(sin(x))+-1//2*a^-1*sec(x)*tan(x))
	@test integrate((a+a*csc(x))^-1*sec(x)^2, x) == :(-1//3*a^-1*tan(x)^3+1//3*a^-1*sec(x)^3)
	@test integrate((a+a*csc(x))^-1*sec(x)^3, x) == :(1//4*a^-1*sec(x)^4+1//8*a^-1*arctanh(sin(x))+-1//4*a^-1*sec(x)^3*tan(x)+1//8*a^-1*sec(x)*tan(x))
	@test integrate((a+a*csc(x))^-1*sec(x)^4, x) == :(-1//3*a^-1*tan(x)^3+-1//5*a^-1*tan(x)^5+1//5*a^-1*sec(x)^5)
	@test integrate((a+b*csc(x))^-1*cos(x)^4, x) == :(-1//8*a^-4*(8*b*(a^2+-1*b^2)+-1*a*(-4*b^2+3*a^2)*sin(x))*cos(x)+-1//12*a^-2*cos(x)^3*(4b+-3*a*sin(x))+1//8*x*a^-5*(3*a^4+8*b^4+-12*a^2*b^2)+2*b*a^-5*(a^2+-1*b^2)^3//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*x))))
	@test integrate((a+b*csc(x))^-1*cos(x)^3, x) == :(-1//3*a^-1*sin(x)^3+a^-3*(a^2+-1*b^2)*sin(x)+(1/2)*b*a^-2*sin(x)^2+-1*b*a^-4*(a^2+-1*b^2)*log(b+a*sin(x)))
end

@testset "4.6.1.4 (d cot)^n (a+b csc)^m.jl" begin
	@test integrate((a+a*csc(x))^-1*tan(x)^4, x) == :(x*a^-1+-1//5*a^-1*tan(x)^5*(1+-1*csc(x))+-1//15*a^-1*(15+-8*csc(x))*tan(x)+1//15*a^-1*tan(x)^3*(5+-4*csc(x)))
	@test integrate((a+a*csc(x))^-1*tan(x)^3, x) == :(-1//8*a^-1*(1+sin(x))^-2+1//8*a^-1*(1+-1*sin(x))^-1+3//4*a^-1*(1+sin(x))^-1+5//16*a^-1*log(1+-1*sin(x))+11//16*a^-1*log(1+sin(x)))
	@test integrate((a+a*csc(x))^-1*tan(x)^2, x) == :(-1*x*a^-1+-1//3*a^-1*tan(x)^3*(1+-1*csc(x))+1//3*a^-1*(3+-2*csc(x))*tan(x))
	@test integrate((a+a*csc(x))^-1*tan(x), x) == :(-3//4*a^-1*log(1+sin(x))+-1//2*a^-1*(1+sin(x))^-1+-1//4*a^-1*log(1+-1*sin(x)))
	@test integrate((a+a*csc(x))^-1*cot(x), x) == :(a^-1*log(1+sin(x)))
	@test integrate((a+a*csc(x))^-1*cot(x)^2, x) == :(-1*x*a^-1+-1*a^-1*arctanh(cos(x)))
	@test integrate((a+a*csc(x))^-1*cot(x)^3, x) == :(-1*a^-1*csc(x)+-1*a^-1*log(sin(x)))
	@test integrate((a+a*csc(x))^-1*cot(x)^4, x) == :(x*a^-1+(1/2)*a^-1*arctanh(cos(x))+(1/2)*a^-1*(2+-1*csc(x))*cot(x))
	@test integrate((a+a*csc(x))^-1*cot(x)^5, x) == :(a^-1*csc(x)+a^-1*log(sin(x))+(1/2)*a^-1*csc(x)^2+-1//3*a^-1*csc(x)^3)
	@test integrate((a+a*csc(x))^-1*cot(x)^6, x) == :(-1*x*a^-1+-3//8*a^-1*arctanh(cos(x))+-1//8*a^-1*(8+-3*csc(x))*cot(x)+1//12*a^-1*cot(x)^3*(4+-3*csc(x)))
end

@testset "4.6.11 (e x)^m (a+b csc(c+d x^n))^p.jl" begin
	@test integrate(x^5*(a+b*csc(c+d*x^2)), x) == :(1//6*a*x^6+b*d^-3*Polylogarithms.polylog(3,exp(im*(c+d*x^2)))+-1*b*d^-3*Polylogarithms.polylog(3,-1*exp(im*(c+d*x^2)))+-1*b*d^-1*x^4*arctanh(exp(im*(c+d*x^2)))+im*b*d^-2*x^2*Polylogarithms.polylog(2,-1*exp(im*(c+d*x^2)))+-1*im*b*d^-2*x^2*Polylogarithms.polylog(2,exp(im*(c+d*x^2))))
	@test integrate(x^3*(a+b*csc(c+d*x^2)), x) == :(1//4*a*x^4+(1/2)*im*b*d^-2*Polylogarithms.polylog(2,-1*exp(im*(c+d*x^2)))+-1*b*d^-1*x^2*arctanh(exp(im*(c+d*x^2)))+-1//2*im*b*d^-2*Polylogarithms.polylog(2,exp(im*(c+d*x^2))))
	@test integrate(x*(a+b*csc(c+d*x^2)), x) == :((1/2)*a*x^2+-1//2*b*d^-1*arctanh(cos(c+d*x^2)))
	@test integrate(x^5*(a+b*csc(c+d*x^2))^2, x) == :(1//6*a^2*x^6+b^2*d^-2*x^2*log(1+-1*exp(2*im*(c+d*x^2)))+-2*a*b*d^-3*Polylogarithms.polylog(3,-1*exp(im*(c+d*x^2)))+2*a*b*d^-3*Polylogarithms.polylog(3,exp(im*(c+d*x^2)))+-1//2*im*b^2*d^-1*x^4+-1//2*im*b^2*d^-3*Polylogarithms.polylog(2,exp(2*im*(c+d*x^2)))+-1//2*b^2*d^-1*x^4*cot(c+d*x^2)+-2*a*b*d^-1*x^4*arctanh(exp(im*(c+d*x^2)))+-2*im*a*b*d^-2*x^2*Polylogarithms.polylog(2,exp(im*(c+d*x^2)))+2*im*a*b*d^-2*x^2*Polylogarithms.polylog(2,-1*exp(im*(c+d*x^2))))
	@test integrate(x^3*(a+b*csc(c+d*x^2))^2, x) == :(1//4*a^2*x^4+(1/2)*b^2*d^-2*log(sin(c+d*x^2))+-1//2*b^2*d^-1*x^2*cot(c+d*x^2)+im*a*b*d^-2*Polylogarithms.polylog(2,-1*exp(im*(c+d*x^2)))+-1*im*a*b*d^-2*Polylogarithms.polylog(2,exp(im*(c+d*x^2)))+-2*a*b*d^-1*x^2*arctanh(exp(im*(c+d*x^2))))
	@test integrate(x*(a+b*csc(c+d*x^2))^2, x) == :((1/2)*a^2*x^2+-1//2*b^2*d^-1*cot(c+d*x^2)+-1*a*b*d^-1*arctanh(cos(c+d*x^2)))
	@test integrate(x*csc(a+b*x^2)^7, x) == :(-5//32*b^-1*arctanh(cos(a+b*x^2))+-5//32*b^-1*cot(a+b*x^2)*csc(a+b*x^2)+-5//48*b^-1*csc(a+b*x^2)^3*cot(a+b*x^2)+-1//12*b^-1*csc(a+b*x^2)^5*cot(a+b*x^2))
	@test integrate(x^5*(a+b*csc(c+d*x^2))^-1, x) == :(1//6*a^-1*x^6+im*b*a^-1*d^-3*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(3,im*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+b*a^-1*d^-2*x^2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,im*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1*im*b*a^-1*d^-3*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(3,im*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1*b*a^-1*d^-2*x^2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,im*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+(1/2)*im*b*a^-1*d^-1*x^4*(b^2+-1*a^2)^-1//2*log(1+-1*im*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1//2*im*b*a^-1*d^-1*x^4*(b^2+-1*a^2)^-1//2*log(1+-1*im*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2))))
	@test integrate(x^3*(a+b*csc(c+d*x^2))^-1, x) == :(1//4*a^-1*x^4+(1/2)*b*a^-1*d^-2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,im*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1//2*b*a^-1*d^-2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,im*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+(1/2)*im*b*a^-1*d^-1*x^2*(b^2+-1*a^2)^-1//2*log(1+-1*im*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2)))+-1//2*im*b*a^-1*d^-1*x^2*(b^2+-1*a^2)^-1//2*log(1+-1*im*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(im*(c+d*x^2))))
	@test integrate(x*(a+b*csc(c+d*x^2))^-1, x) == :((1/2)*a^-1*x^2+b*a^-1*d^-1*(a^2+-1*b^2)^-1//2*arctanh((a^2+-1*b^2)^-1//2*(a+b*tan((1/2)*c+(1/2)*d*x^2))))
end

@testset "4.6.3.1 (a+b csc)^m (d csc)^n (A+B csc).jl" begin
	@test integrate(csc(c+d*x)^3*(A+A*csc(c+d*x))*(a+a*csc(c+d*x)), x) == :(-2*A*a*d^-1*cot(c+d*x)+-7//8*A*a*d^-1*arctanh(cos(c+d*x))+-2//3*A*a*d^-1*cot(c+d*x)^3+-7//8*A*a*d^-1*cot(c+d*x)*csc(c+d*x)+-1//4*A*a*d^-1*csc(c+d*x)^3*cot(c+d*x))
	@test integrate(csc(c+d*x)^2*(A+A*csc(c+d*x))*(a+a*csc(c+d*x)), x) == :(-1*A*a*d^-1*arctanh(cos(c+d*x))+-5//3*A*a*d^-1*cot(c+d*x)+-1*A*a*d^-1*cot(c+d*x)*csc(c+d*x)+-1//3*A*a*d^-1*csc(c+d*x)^2*cot(c+d*x))
	@test integrate((A+A*csc(c+d*x))*(a+a*csc(c+d*x))*csc(c+d*x), x) == :(-2*A*a*d^-1*cot(c+d*x)+-3//2*A*a*d^-1*arctanh(cos(c+d*x))+-1//2*A*a*d^-1*cot(c+d*x)*csc(c+d*x))
	@test integrate((A+A*csc(c+d*x))*(a+a*csc(c+d*x))*sin(c+d*x), x) == :(2*A*a*x+-1*A*a*d^-1*arctanh(cos(c+d*x))+-1*A*a*d^-1*cos(c+d*x))
	@test integrate(sin(c+d*x)^2*(A+A*csc(c+d*x))*(a+a*csc(c+d*x)), x) == :(3//2*A*a*x+-2*A*a*d^-1*cos(c+d*x)+-1//2*A*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(sin(c+d*x)^3*(A+A*csc(c+d*x))*(a+a*csc(c+d*x)), x) == :(A*a*x+-2*A*a*d^-1*cos(c+d*x)+1//3*A*a*d^-1*cos(c+d*x)^3+-1*A*a*d^-1*cos(c+d*x)*sin(c+d*x))
	@test integrate(csc(c+d*x)^3*(A+A*csc(c+d*x))*(a+-1*a*csc(c+d*x)), x) == :(-1//8*A*a*d^-1*arctanh(cos(c+d*x))+-1//8*A*a*d^-1*cot(c+d*x)*csc(c+d*x)+1//4*A*a*d^-1*csc(c+d*x)^3*cot(c+d*x))
	@test integrate(csc(c+d*x)^2*(A+A*csc(c+d*x))*(a+-1*a*csc(c+d*x)), x) == :(1//3*A*a*d^-1*cot(c+d*x)^3)
	@test integrate((A+A*csc(c+d*x))*(a+-1*a*csc(c+d*x))*csc(c+d*x), x) == :(-1//2*A*a*d^-1*arctanh(cos(c+d*x))+(1/2)*A*a*d^-1*cot(c+d*x)*csc(c+d*x))
	@test integrate((A+A*csc(c+d*x))*(a+-1*a*csc(c+d*x))*sin(c+d*x), x) == :(A*a*d^-1*arctanh(cos(c+d*x))+-1*A*a*d^-1*cos(c+d*x))
end

@testset "4.6.4.2 (a+b csc)^m (d csc)^n (A+B csc+C csc^2).jl" begin
	@test integrate(csc(x)^-1//2*(a+b*csc(x))*(A+B*csc(x)+C*csc(x)^2), x) == :(csc(x)^(1/2)*(-2*B*b+-2*C*a)*cos(x)+csc(x)^(1/2)*sin(x)^(1/2)*(-2*a*(A+-1C)+2*B*b)*Elliptic.E(-1//2*x+1//4*pi,2)+-1*csc(x)^(1/2)*sin(x)^(1/2)*(2*A*b+2*B*a+2//3*C*b)*Elliptic.F(-1//2*x+1//4*pi,2)+-2//3*C*b*csc(x)^3//2*cos(x))
end

@testset "4.6.7 (d trig)^m (a+b (c csc)^n)^p.jl" begin
	@test integrate((a+b*csc(c+d*x)^2)^4, x) == :(x*a^4+-1//7*b^4*d^-1*cot(c+d*x)^7+-1//3*b^2*d^-1*cot(c+d*x)^3*(3*b^2+6*a^2+8*a*b)+-1//5*b^3*d^-1*cot(c+d*x)^5*(3b+4a)+-1*b*d^-1*(b+2a)*(b^2+2*a^2+2*a*b)*cot(c+d*x))
	@test integrate((a+b*csc(c+d*x)^2)^3, x) == :(x*a^3+-1//5*b^3*d^-1*cot(c+d*x)^5+-1*b*d^-1*(b^2+3*a^2+3*a*b)*cot(c+d*x)+-1//3*b^2*d^-1*cot(c+d*x)^3*(2b+3a))
	@test integrate((a+b*csc(c+d*x)^2)^2, x) == :(x*a^2+-1//3*b^2*d^-1*cot(c+d*x)^3+-1*b*d^-1*(b+2a)*cot(c+d*x))
	@test integrate(a+b*csc(c+d*x)^2, x) == :(a*x+-1*b*d^-1*cot(c+d*x))
	@test integrate((a+b*csc(c+d*x)^2)^-1, x) == :(x*a^-1+-1*a^-1*b^(1/2)*d^-1*(a+b)^-1//2*arctan(b^-1//2*(a+b)^(1/2)*tan(c+d*x)))
	@test integrate((a+b*csc(c+d*x)^2)^-2, x) == :(x*a^-2+(1/2)*b*a^-1*d^-1*(a+b)^-1*(a+b+b*cot(c+d*x)^2)^-1*cot(c+d*x)+(1/2)*a^-2*b^(1/2)*d^-1*(a+b)^-3//2*(2b+3a)*arctan(b^(1/2)*(a+b)^-1//2*cot(c+d*x)))
	@test integrate((a+b*csc(c+d*x)^2)^-3, x) == :(x*a^-3+1//4*b*a^-1*d^-1*(a+b)^-1*(a+b+b*cot(c+d*x)^2)^-2*cot(c+d*x)+1//8*a^-3*b^(1/2)*d^-1*(a+b)^-5//2*(8*b^2+15*a^2+20*a*b)*arctan(b^(1/2)*(a+b)^-1//2*cot(c+d*x))+1//8*b*a^-2*d^-1*(a+b)^-2*(a+b+b*cot(c+d*x)^2)^-1*(4b+7a)*cot(c+d*x))
	@test integrate((a+b*csc(c+d*x)^2)^-4, x) == :(x*a^-4+1//6*b*a^-1*d^-1*(a+b)^-1*(a+b+b*cot(c+d*x)^2)^-3*cot(c+d*x)+1//16*a^-4*b^(1/2)*d^-1*(a+b)^-7//2*(16*b^3+35*a^3+56*a*b^2+70*b*a^2)*arctan(b^(1/2)*(a+b)^-1//2*cot(c+d*x))+1//16*b*a^-3*d^-1*(a+b)^-3*(a+b+b*cot(c+d*x)^2)^-1*(8*b^2+19*a^2+22*a*b)*cot(c+d*x)+1//24*b*a^-2*d^-1*(a+b)^-2*(a+b+b*cot(c+d*x)^2)^-2*(6b+11a)*cot(c+d*x))
	@test integrate((a+b*csc(c+d*x)^2)^5//2, x) == :(-1*a^5//2*d^-1*arctan(a^(1/2)*(a+b+b*cot(c+d*x)^2)^-1//2*cot(c+d*x))+-1//4*b*d^-1*(a+b+b*cot(c+d*x)^2)^3//2*cot(c+d*x)+-1//8*b^(1/2)*d^-1*(3*b^2+15*a^2+10*a*b)*arctanh(b^(1/2)*(a+b+b*cot(c+d*x)^2)^-1//2*cot(c+d*x))+-1//8*b*d^-1*(a+b+b*cot(c+d*x)^2)^(1/2)*(3b+7a)*cot(c+d*x))
	@test integrate((a+b*csc(c+d*x)^2)^3//2, x) == :(-1*a^3//2*d^-1*arctan(a^(1/2)*(a+b+b*cot(c+d*x)^2)^-1//2*cot(c+d*x))+-1//2*b*d^-1*(a+b+b*cot(c+d*x)^2)^(1/2)*cot(c+d*x)+-1//2*b^(1/2)*d^-1*(b+3a)*arctanh(b^(1/2)*(a+b+b*cot(c+d*x)^2)^-1//2*cot(c+d*x)))
end

@testset "4.7.1 (c trig)^m (d trig)^n.jl" begin
	@test integrate(sin(2a+2*b*x)^7*sin(a+b*x), x) == :(-384//11*b^-1*sin(a+b*x)^11+-128//15*b^-1*sin(a+b*x)^15+128//9*b^-1*sin(a+b*x)^9+384//13*b^-1*sin(a+b*x)^13)
	@test integrate(sin(2a+2*b*x)^6*sin(a+b*x), x) == :(-192//11*b^-1*cos(a+b*x)^11+-64//7*b^-1*cos(a+b*x)^7+64//3*b^-1*cos(a+b*x)^9+64//13*b^-1*cos(a+b*x)^13)
	@test integrate(sin(2a+2*b*x)^5*sin(a+b*x), x) == :(-64//9*b^-1*sin(a+b*x)^9+32//7*b^-1*sin(a+b*x)^7+32//11*b^-1*sin(a+b*x)^11)
	@test integrate(sin(2a+2*b*x)^4*sin(a+b*x), x) == :(-16//5*b^-1*cos(a+b*x)^5+-16//9*b^-1*cos(a+b*x)^9+32//7*b^-1*cos(a+b*x)^7)
	@test integrate(sin(2a+2*b*x)^3*sin(a+b*x), x) == :(-8//7*b^-1*sin(a+b*x)^7+8//5*b^-1*sin(a+b*x)^5)
	@test integrate(sin(2a+2*b*x)^2*sin(a+b*x), x) == :(-4//3*b^-1*cos(a+b*x)^3+4//5*b^-1*cos(a+b*x)^5)
	@test integrate(sin(a+b*x)*sin(2a+2*b*x), x) == :((1/2)*b^-1*sin(a+b*x)+-1//6*b^-1*sin(3a+3*b*x))
	@test integrate(csc(2a+2*b*x)*sin(a+b*x), x) == :((1/2)*b^-1*arctanh(sin(a+b*x)))
	@test integrate(csc(2a+2*b*x)^2*sin(a+b*x), x) == :(-1//4*b^-1*arctanh(cos(a+b*x))+1//4*b^-1*sec(a+b*x))
	@test integrate(csc(2a+2*b*x)^3*sin(a+b*x), x) == :(-3//16*b^-1*csc(a+b*x)+3//16*b^-1*arctanh(sin(a+b*x))+1//16*b^-1*sec(a+b*x)^2*csc(a+b*x))
end

@testset "4.7.2 trig^m (a trig+b trig)^n.jl" begin
	@test integrate(sin(x)^3*(a*cos(x)+b*sin(x)), x) == :(1//4*a*sin(x)^4+3//8*b*x+-3//8*b*cos(x)*sin(x)+-1//4*b*sin(x)^3*cos(x))
	@test integrate(sin(x)^2*(a*cos(x)+b*sin(x)), x) == :(-1*b*cos(x)+1//3*a*sin(x)^3+1//3*b*cos(x)^3)
	@test integrate((a*cos(x)+b*sin(x))*sin(x), x) == :((1/2)*a*sin(x)^2+(1/2)*b*x+-1//2*b*cos(x)*sin(x))
	@test integrate(a*cos(x)+b*sin(x), x) == :(a*sin(x)+-1*b*cos(x))
	@test integrate((a*cos(x)+b*sin(x))*csc(x), x) == :(a*log(sin(x))+b*x)
	@test integrate(csc(x)^2*(a*cos(x)+b*sin(x)), x) == :(-1*a*csc(x)+-1*b*arctanh(cos(x)))
	@test integrate(csc(x)^3*(a*cos(x)+b*sin(x)), x) == :(-1*b*cot(x)+-1//2*a*csc(x)^2)
	@test integrate((a*cos(x)+b*sin(x))^-1*sin(x)^3, x) == :(b*x*(2*a^2+2*b^2)^-1+-1*a*(2*a^2+2*b^2)^-1*sin(x)^2+-1*a^3*(a^2+b^2)^-2*log(a*cos(x)+b*sin(x))+b*x*a^2*(a^2+b^2)^-2+-1*b*(2*a^2+2*b^2)^-1*cos(x)*sin(x))
	@test integrate((a*cos(x)+b*sin(x))^-1*sin(x)^2, x) == :(-1*a*(a^2+b^2)^-1*sin(x)+-1*b*(a^2+b^2)^-1*cos(x)+-1*a^2*(a^2+b^2)^-3//2*arctanh((a^2+b^2)^-1//2*(b*cos(x)+-1*a*sin(x))))
	@test integrate((a*cos(x)+b*sin(x))^-1*sin(x), x) == :(b*x*(a^2+b^2)^-1+-1*a*(a^2+b^2)^-1*log(a*cos(x)+b*sin(x)))
end

@testset "4.7.3 (c+d x)^m trig^n trig^p.jl" begin
	@test integrate((c+d*x)^m*cos(a+b*x)*sin(a+b*x), x) == :(-1*2^(-3+-1m)*b^-1*(im*b*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,2*im*b*d^-1*(c+d*x))*exp(-2*im*(a+-1*b*c*d^-1))+-1*2^(-3+-1m)*b^-1*(-1*im*b*d^-1*(c+d*x))^(-1m)*(c+d*x)^m*SpecialFunctions.gamma(1+m,-2*im*b*d^-1*(c+d*x))*exp(2*im*(a+-1*b*c*d^-1)))
	@test integrate((c+d*x)^4*cos(a+b*x)*sin(a+b*x), x) == :(-1//4*b^-1*(c+d*x)^4+(1/2)*b^-1*(c+d*x)^4*sin(a+b*x)^2+3//4*b^-5*d^4*sin(a+b*x)^2+3//4*b^-3*d^4*x^2+-3//2*b^-3*d^2*(c+d*x)^2*sin(a+b*x)^2+3//2*c*x*b^-3*d^3+d*b^-2*(c+d*x)^3*cos(a+b*x)*sin(a+b*x)+-3//2*b^-4*d^3*(c+d*x)*cos(a+b*x)*sin(a+b*x))
	@test integrate((c+d*x)^3*cos(a+b*x)*sin(a+b*x), x) == :(-1//4*b^-1*(c+d*x)^3+(1/2)*b^-1*(c+d*x)^3*sin(a+b*x)^2+3//8*x*b^-3*d^3+-3//4*b^-3*d^2*sin(a+b*x)^2*(c+d*x)+-3//8*b^-4*d^3*cos(a+b*x)*sin(a+b*x)+3//4*d*b^-2*(c+d*x)^2*cos(a+b*x)*sin(a+b*x))
	@test integrate((c+d*x)^2*cos(a+b*x)*sin(a+b*x), x) == :((1/2)*b^-1*(c+d*x)^2*sin(a+b*x)^2+-1//4*b^-1*d^2*x^2+-1//4*b^-3*d^2*sin(a+b*x)^2+-1//2*c*d*x*b^-1+(1/2)*d*b^-2*(c+d*x)*cos(a+b*x)*sin(a+b*x))
	@test integrate((c+d*x)*cos(a+b*x)*sin(a+b*x), x) == :((1/2)*b^-1*sin(a+b*x)^2*(c+d*x)+-1//4*d*x*b^-1+1//4*d*b^-2*cos(a+b*x)*sin(a+b*x))
	@test integrate((c+d*x)^-1*cos(a+b*x)*sin(a+b*x), x) == :((1/2)*d^-1*cos(2a+-2*b*c*d^-1)*sinintegral(2*b*x+2*b*c*d^-1)+(1/2)*d^-1*cosintegral(2*b*x+2*b*c*d^-1)*sin(2a+-2*b*c*d^-1))
	@test integrate((c+d*x)^-2*cos(a+b*x)*sin(a+b*x), x) == :(-1//2*d^-1*(c+d*x)^-1*sin(2a+2*b*x)+b*d^-2*cos(2a+-2*b*c*d^-1)*cosintegral(2*b*x+2*b*c*d^-1)+-1*b*d^-2*sin(2a+-2*b*c*d^-1)*sinintegral(2*b*x+2*b*c*d^-1))
	@test integrate((c+d*x)^-3*cos(a+b*x)*sin(a+b*x), x) == :(-1//4*d^-1*(c+d*x)^-2*sin(2a+2*b*x)+-1*b^2*d^-3*cos(2a+-2*b*c*d^-1)*sinintegral(2*b*x+2*b*c*d^-1)+-1*b^2*d^-3*cosintegral(2*b*x+2*b*c*d^-1)*sin(2a+-2*b*c*d^-1)+-1//2*b*d^-2*(c+d*x)^-1*cos(2a+2*b*x))
	@test integrate((c+d*x)^-4*cos(a+b*x)*sin(a+b*x), x) == :(-1//6*d^-1*(c+d*x)^-3*sin(2a+2*b*x)+-2//3*b^3*d^-4*cos(2a+-2*b*c*d^-1)*cosintegral(2*b*x+2*b*c*d^-1)+-1//6*b*d^-2*(c+d*x)^-2*cos(2a+2*b*x)+1//3*b^2*d^-3*(c+d*x)^-1*sin(2a+2*b*x)+2//3*b^3*d^-4*sin(2a+-2*b*c*d^-1)*sinintegral(2*b*x+2*b*c*d^-1))
	@test integrate(x^-1*cos(x)*sin(x), x) == :((1/2)*sinintegral(2x))
end

@testset "4.7.4 x^m (a+b trig^n)^p.jl" begin
	@test integrate(x*(a+b*sin(x)^2)^-1, x) == :(-1//4*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+1//4*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+(1/2)*im*x*a^-1//2*(a+b)^-1//2*log(1+-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*im*x*a^-1//2*(a+b)^-1//2*log(1+-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x)))
	@test integrate(x^2*(a+b*sin(x)^2)^-1, x) == :((1/2)*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//4*im*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+1//4*im*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+(1/2)*im*a^-1//2*x^2*(a+b)^-1//2*log(1+-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*im*a^-1//2*x^2*(a+b)^-1//2*log(1+-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x)))
	@test integrate(x^3*(a+b*sin(x)^2)^-1, x) == :(-3//8*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(4,b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+3//8*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(4,b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-3//4*a^-1//2*x^2*(a+b)^-1//2*Polylogarithms.polylog(2,b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+3//4*a^-1//2*x^2*(a+b)^-1//2*Polylogarithms.polylog(2,b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+(1/2)*im*a^-1//2*x^3*(a+b)^-1//2*log(1+-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-3//4*im*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*im*a^-1//2*x^3*(a+b)^-1//2*log(1+-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+3//4*im*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x)))
	@test integrate(x*(a+b*sin(c+d*x)^2)^-2, x) == :(-1//4*a^-1*d^-2*(a+b)^-1*log(b+2a+-1*b*cos(2c+2*d*x))+-1//8*a^-3//2*d^-2*(a+b)^-3//2*(b+2a)*Polylogarithms.polylog(2,b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x)))+1//8*a^-3//2*d^-2*(a+b)^-3//2*(b+2a)*Polylogarithms.polylog(2,b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x)))+(1/2)*b*x*a^-1*d^-1*(a+b)^-1*(b+2a+-1*b*cos(2c+2*d*x))^-1*sin(2c+2*d*x)+-1//4*im*x*a^-3//2*d^-1*(a+b)^-3//2*(b+2a)*log(1+-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x)))+1//4*im*x*a^-3//2*d^-1*(a+b)^-3//2*(b+2a)*log(1+-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x))))
	@test integrate(x*(sin(x)^2)^(1/2), x) == :((sin(x)^2)^(1/2)+-1*x*(sin(x)^2)^(1/2)*cot(x))
	@test integrate(x*(a+b*cos(x)^2)^-1, x) == :(-1//4*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+1//4*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+(1/2)*im*x*a^-1//2*(a+b)^-1//2*log(1+b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*im*x*a^-1//2*(a+b)^-1//2*log(1+b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x)))
	@test integrate(x^2*(a+b*cos(x)^2)^-1, x) == :((1/2)*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(2,-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//4*im*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+1//4*im*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+(1/2)*im*a^-1//2*x^2*(a+b)^-1//2*log(1+b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*im*a^-1//2*x^2*(a+b)^-1//2*log(1+b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x)))
	@test integrate(x^3*(a+b*cos(x)^2)^-1, x) == :(-3//8*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(4,-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+3//8*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(4,-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-3//4*a^-1//2*x^2*(a+b)^-1//2*Polylogarithms.polylog(2,-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+3//4*a^-1//2*x^2*(a+b)^-1//2*Polylogarithms.polylog(2,-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+(1/2)*im*a^-1//2*x^3*(a+b)^-1//2*log(1+b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-3//4*im*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+-1//2*im*a^-1//2*x^3*(a+b)^-1//2*log(1+b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x))+3//4*im*x*a^-1//2*(a+b)^-1//2*Polylogarithms.polylog(3,-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*x)))
	@test integrate(x*(a+b*cos(c+d*x)^2)^-2, x) == :(-1//4*a^-1*d^-2*(a+b)^-1*log(b+2a+b*cos(2c+2*d*x))+-1//8*a^-3//2*d^-2*(a+b)^-3//2*(b+2a)*Polylogarithms.polylog(2,-1*b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x)))+1//8*a^-3//2*d^-2*(a+b)^-3//2*(b+2a)*Polylogarithms.polylog(2,-1*b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x)))+-1//2*b*x*a^-1*d^-1*(a+b)^-1*(b+2a+b*cos(2c+2*d*x))^-1*sin(2c+2*d*x)+-1//4*im*x*a^-3//2*d^-1*(a+b)^-3//2*(b+2a)*log(1+b*(b+2a+-2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x)))+1//4*im*x*a^-3//2*d^-1*(a+b)^-3//2*(b+2a)*log(1+b*(b+2a+2*a^(1/2)*(a+b)^(1/2))^-1*exp(2*im*(c+d*x))))
end

@testset "4.7.5 x^m trig(a+b log(c x^n))^p.jl" begin
	@test integrate(x^2*sin(a+b*log(c*x^n)), x) == :(3*x^3*(9+b^2*n^2)^-1*sin(a+b*log(c*x^n))+-1*b*n*x^3*(9+b^2*n^2)^-1*cos(a+b*log(c*x^n)))
	@test integrate(x*sin(a+b*log(c*x^n)), x) == :(2*x^2*(4+b^2*n^2)^-1*sin(a+b*log(c*x^n))+-1*b*n*x^2*(4+b^2*n^2)^-1*cos(a+b*log(c*x^n)))
	@test integrate(sin(a+b*log(c*x^n)), x) == :(x*(1+b^2*n^2)^-1*sin(a+b*log(c*x^n))+-1*b*n*x*(1+b^2*n^2)^-1*cos(a+b*log(c*x^n)))
	@test integrate(x^-1*sin(a+b*log(c*x^n)), x) == :(-1*b^-1*n^-1*cos(a+b*log(c*x^n)))
	@test integrate(x^-2*sin(a+b*log(c*x^n)), x) == :(-1*x^-1*(1+b^2*n^2)^-1*sin(a+b*log(c*x^n))+-1*b*n*x^-1*(1+b^2*n^2)^-1*cos(a+b*log(c*x^n)))
	@test integrate(x^-3*sin(a+b*log(c*x^n)), x) == :(-2*x^-2*(4+b^2*n^2)^-1*sin(a+b*log(c*x^n))+-1*b*n*x^-2*(4+b^2*n^2)^-1*cos(a+b*log(c*x^n)))
	@test integrate(x^2*sin(a+b*log(c*x^n))^2, x) == :(3*x^3*(9+4*b^2*n^2)^-1*sin(a+b*log(c*x^n))^2+2*b^2*n^2*x^3*(27+12*b^2*n^2)^-1+-2*b*n*x^3*(9+4*b^2*n^2)^-1*cos(a+b*log(c*x^n))*sin(a+b*log(c*x^n)))
	@test integrate(x*sin(a+b*log(c*x^n))^2, x) == :(x^2*(2+2*b^2*n^2)^-1*sin(a+b*log(c*x^n))^2+b^2*n^2*x^2*(4+4*b^2*n^2)^-1+-1*b*n*x^2*(2+2*b^2*n^2)^-1*cos(a+b*log(c*x^n))*sin(a+b*log(c*x^n)))
	@test integrate(sin(a+b*log(c*x^n))^2, x) == :(x*(1+4*b^2*n^2)^-1*sin(a+b*log(c*x^n))^2+2*x*b^2*n^2*(1+4*b^2*n^2)^-1+-2*b*n*x*(1+4*b^2*n^2)^-1*cos(a+b*log(c*x^n))*sin(a+b*log(c*x^n)))
	@test integrate(x^-1*sin(a+b*log(c*x^n))^2, x) == :((1/2)*log(x)+-1//2*b^-1*n^-1*cos(a+b*log(c*x^n))*sin(a+b*log(c*x^n)))
end

@testset "4.7.6 f^(a+b x+c x^2) trig(d+e x+f x^2)^n.jl" begin
	@test integrate(F^(c*(a+b*x))*sin(d+e*x)^3, x) == :(-6*F^(c*(a+b*x))*e^3*(9*e^4+b^4*c^4*log(F)^4+10*b^2*c^2*e^2*log(F)^2)^-1*cos(d+e*x)+-3*e*F^(c*(a+b*x))*(9*e^2+b^2*c^2*log(F)^2)^-1*sin(d+e*x)^2*cos(d+e*x)+b*c*F^(c*(a+b*x))*(9*e^2+b^2*c^2*log(F)^2)^-1*sin(d+e*x)^3*log(F)+6*b*c*F^(c*(a+b*x))*e^2*(9*e^4+b^4*c^4*log(F)^4+10*b^2*c^2*e^2*log(F)^2)^-1*log(F)*sin(d+e*x))
	@test integrate(F^(c*(a+b*x))*sin(d+e*x)^2, x) == :(-2*e*F^(c*(a+b*x))*(4*e^2+b^2*c^2*log(F)^2)^-1*cos(d+e*x)*sin(d+e*x)+b*c*F^(c*(a+b*x))*(4*e^2+b^2*c^2*log(F)^2)^-1*sin(d+e*x)^2*log(F)+2*F^(c*(a+b*x))*b^-1*c^-1*e^2*(4*e^2+b^2*c^2*log(F)^2)^-1*log(F)^-1)
	@test integrate(F^(c*(a+b*x))*sin(d+e*x), x) == :(-1*e*F^(c*(a+b*x))*(e^2+b^2*c^2*log(F)^2)^-1*cos(d+e*x)+b*c*F^(c*(a+b*x))*(e^2+b^2*c^2*log(F)^2)^-1*log(F)*sin(d+e*x))
	@test integrate(sin(x)^4*exp(x), x) == :(24//85*exp(x)+1//17*sin(x)^4*exp(x)+12//85*sin(x)^2*exp(x)+-24//85*cos(x)*exp(x)*sin(x)+-4//17*sin(x)^3*cos(x)*exp(x))
	@test integrate(F^(c*(a+b*x))*cos(d+e*x)^3, x) == :(6*F^(c*(a+b*x))*e^3*(9*e^4+b^4*c^4*log(F)^4+10*b^2*c^2*e^2*log(F)^2)^-1*sin(d+e*x)+3*e*F^(c*(a+b*x))*(9*e^2+b^2*c^2*log(F)^2)^-1*cos(d+e*x)^2*sin(d+e*x)+b*c*F^(c*(a+b*x))*(9*e^2+b^2*c^2*log(F)^2)^-1*cos(d+e*x)^3*log(F)+6*b*c*F^(c*(a+b*x))*e^2*(9*e^4+b^4*c^4*log(F)^4+10*b^2*c^2*e^2*log(F)^2)^-1*cos(d+e*x)*log(F))
	@test integrate(F^(c*(a+b*x))*cos(d+e*x)^2, x) == :(2*e*F^(c*(a+b*x))*(4*e^2+b^2*c^2*log(F)^2)^-1*cos(d+e*x)*sin(d+e*x)+b*c*F^(c*(a+b*x))*(4*e^2+b^2*c^2*log(F)^2)^-1*cos(d+e*x)^2*log(F)+2*F^(c*(a+b*x))*b^-1*c^-1*e^2*(4*e^2+b^2*c^2*log(F)^2)^-1*log(F)^-1)
	@test integrate(F^(c*(a+b*x))*cos(d+e*x), x) == :(e*F^(c*(a+b*x))*(e^2+b^2*c^2*log(F)^2)^-1*sin(d+e*x)+b*c*F^(c*(a+b*x))*(e^2+b^2*c^2*log(F)^2)^-1*cos(d+e*x)*log(F))
	@test integrate(cos(x)^4*exp(x), x) == :(24//85*exp(x)+1//17*cos(x)^4*exp(x)+12//85*cos(x)^2*exp(x)+4//17*cos(x)^3*exp(x)*sin(x)+24//85*cos(x)*exp(x)*sin(x))
	@test integrate(F^(c*(a+b*x))*(f*x)^m*sin(d+e*x)^2, x) == :(F^(a*c)*(f*x)^m*(x*(2*im*e+-1*b*c*log(F)))^(-1m)*(8*im*e+-4*b*c*log(F))^-1*SpecialFunctions.gamma(1+m,x*(2*im*e+-1*b*c*log(F)))*exp(-2*im*d)+-1*F^(a*c)*(f*x)^m*(-1*x*(2*im*e+b*c*log(F)))^(-1m)*(8*im*e+4*b*c*log(F))^-1*SpecialFunctions.gamma(1+m,-1*x*(2*im*e+b*c*log(F)))*exp(2*im*d)+(1/2)*F^(a*c)*b^-1*c^-1*(f*x)^m*(-1*b*c*x*log(F))^(-1m)*log(F)^-1*SpecialFunctions.gamma(1+m,-1*b*c*x*log(F)))
	@test integrate(F^(c*(a+b*x))*(f*x)^m*sin(d+e*x), x) == :(-1*F^(a*c)*(f*x)^m*(x*(im*e+-1*b*c*log(F)))^(-1m)*(2*e+2*im*b*c*log(F))^-1*SpecialFunctions.gamma(1+m,x*(im*e+-1*b*c*log(F)))*exp(-1*im*d)+-1*F^(a*c)*(f*x)^m*(-1*x*(im*e+b*c*log(F)))^(-1m)*(2*e+-2*im*b*c*log(F))^-1*SpecialFunctions.gamma(1+m,-1*x*(im*e+b*c*log(F)))*exp(im*d))
end

@testset "4.7.7 Trig functions.jl" begin
	@test integrate(2*(3+-1*cos(4+6x))^-1, x) == :((1/2)*x*2^(1/2)+1//6*2^(1/2)*arctan((3+-1*cos(4+6x)+2*2^(1/2))^-1*sin(4+6x)))
	@test integrate(2*(-1*cot(4+6x)+3*csc(4+6x))^-1*csc(4+6x), x) == :((1/2)*x*2^(1/2)+1//6*2^(1/2)*arctan((3+-1*cos(4+6x)+2*2^(1/2))^-1*sin(4+6x)))
	@test integrate((1+sin(2+3x)^2)^-1, x) == :((1/2)*x*2^(1/2)+1//6*2^(1/2)*arctan((1+2^(1/2)+sin(2+3x)^2)^-1*cos(2+3x)*sin(2+3x)))
	@test integrate((2+-1*cos(2+3x)^2)^-1, x) == :((1/2)*x*2^(1/2)+1//6*2^(1/2)*arctan((1+2^(1/2)+sin(2+3x)^2)^-1*cos(2+3x)*sin(2+3x)))
	@test integrate((cos(2+3x)^2+2*sin(2+3x)^2)^-1, x) == :((1/2)*x*2^(1/2)+1//6*2^(1/2)*arctan((1+2^(1/2)+sin(2+3x)^2)^-1*cos(2+3x)*sin(2+3x)))
	@test integrate((1+2*tan(2+3x)^2)^-1*sec(2+3x)^2, x) == :((1/2)*x*2^(1/2)+1//6*2^(1/2)*arctan((1+2^(1/2)+sin(2+3x)^2)^-1*cos(2+3x)*sin(2+3x)))
	@test integrate((2+cot(2+3x)^2)^-1*csc(2+3x)^2, x) == :((1/2)*x*2^(1/2)+1//6*2^(1/2)*arctan((1+2^(1/2)+sin(2+3x)^2)^-1*cos(2+3x)*sin(2+3x)))
	@test integrate(2*(1+-3*cos(4+6x))^-1, x) == :(-1//12*2^(1/2)*log(2^(1/2)*sin(2+3x)+cos(2+3x))+1//12*2^(1/2)*log(-1*2^(1/2)*sin(2+3x)+cos(2+3x)))
	@test integrate(2*(-3*cot(4+6x)+csc(4+6x))^-1*csc(4+6x), x) == :(-1//12*2^(1/2)*log(2^(1/2)*sin(2+3x)+cos(2+3x))+1//12*2^(1/2)*log(-1*2^(1/2)*sin(2+3x)+cos(2+3x)))
	@test integrate((-1+3*sin(2+3x)^2)^-1, x) == :(-1//12*2^(1/2)*log(2^(1/2)*sin(2+3x)+cos(2+3x))+1//12*2^(1/2)*log(-1*2^(1/2)*sin(2+3x)+cos(2+3x)))
end

@testset "5.1.2 (d x)^m (a+b arcsin(c x))^n.jl" begin
	@test integrate(x^4*arcsin(a*x), x) == :(-2//15*a^-5*(1+-1*a^2*x^2)^3//2+1//5*a^-5*(1+-1*a^2*x^2)^(1/2)+1//5*x^5*arcsin(a*x)+1//25*a^-5*(1+-1*a^2*x^2)^5//2)
	@test integrate(x^3*arcsin(a*x), x) == :(-3//32*a^-4*arcsin(a*x)+1//4*x^4*arcsin(a*x)+1//16*a^-1*x^3*(1+-1*a^2*x^2)^(1/2)+3//32*x*a^-3*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^2*arcsin(a*x), x) == :(-1//9*a^-3*(1+-1*a^2*x^2)^3//2+1//3*a^-3*(1+-1*a^2*x^2)^(1/2)+1//3*x^3*arcsin(a*x))
	@test integrate(x*arcsin(a*x), x) == :((1/2)*x^2*arcsin(a*x)+-1//4*a^-2*arcsin(a*x)+1//4*x*a^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(arcsin(a*x), x) == :(x*arcsin(a*x)+a^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-1*arcsin(a*x), x) == :(arcsin(a*x)*log(1+-1*exp(2*im*arcsin(a*x)))+-1//2*im*arcsin(a*x)^2+-1//2*im*Polylogarithms.polylog(2,exp(2*im*arcsin(a*x))))
	@test integrate(x^-2*arcsin(a*x), x) == :(-1*a*arctanh((1+-1*a^2*x^2)^(1/2))+-1*x^-1*arcsin(a*x))
	@test integrate(x^-3*arcsin(a*x), x) == :(-1//2*x^-2*arcsin(a*x)+-1//2*a*x^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-4*arcsin(a*x), x) == :(-1//3*x^-3*arcsin(a*x)+-1//6*a^3*arctanh((1+-1*a^2*x^2)^(1/2))+-1//6*a*x^-2*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-5*arcsin(a*x), x) == :(-1//4*x^-4*arcsin(a*x)+-1//6*a^3*x^-1*(1+-1*a^2*x^2)^(1/2)+-1//12*a*x^-3*(1+-1*a^2*x^2)^(1/2))
end

@testset "5.1.4a (f x)^m (d-c^2 d x^2)^p (a+b arcsin(c x))^n.jl" begin
	@test integrate(x^4*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(1//5*d*x^5*(a+b*arcsin(c*x))+-8//175*b*d*c^-5*(1+-1*c^2*x^2)^5//2+-1//7*d*c^2*x^7*(a+b*arcsin(c*x))+1//49*b*d*c^-5*(1+-1*c^2*x^2)^7//2+1//105*b*d*c^-5*(1+-1*c^2*x^2)^3//2+2//35*b*d*c^-5*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^3*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(1//4*d*x^4*(a+b*arcsin(c*x))+-1//6*d*c^2*x^6*(a+b*arcsin(c*x))+-1//24*b*d*c^-4*arcsin(c*x)+-1//36*b*c*d*x^5*(1+-1*c^2*x^2)^(1/2)+1//24*b*d*x*c^-3*(1+-1*c^2*x^2)^(1/2)+1//36*b*d*c^-1*x^3*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^2*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(1//3*d*x^3*(a+b*arcsin(c*x))+-1//5*d*c^2*x^5*(a+b*arcsin(c*x))+-1//25*b*d*c^-3*(1+-1*c^2*x^2)^5//2+1//45*b*d*c^-3*(1+-1*c^2*x^2)^3//2+2//15*b*d*c^-3*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(-1//4*d*c^-2*(1+-1*c^2*x^2)^2*(a+b*arcsin(c*x))+3//32*b*d*c^-2*arcsin(c*x)+1//16*b*d*x*c^-1*(1+-1*c^2*x^2)^3//2+3//32*b*d*x*c^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate((a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(d*x*(a+b*arcsin(c*x))+-1//3*d*c^2*x^3*(a+b*arcsin(c*x))+1//9*b*d*c^-1*(1+-1*c^2*x^2)^3//2+2//3*b*d*c^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^-1*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(d*(a+b*arcsin(c*x))*log(1+-1*exp(2*im*arcsin(c*x)))+(1/2)*d*(1+-1*c^2*x^2)*(a+b*arcsin(c*x))+-1//4*b*d*arcsin(c*x)+-1//2*im*b*d*Polylogarithms.polylog(2,exp(2*im*arcsin(c*x)))+-1//2*im*d*b^-1*(a+b*arcsin(c*x))^2+-1//4*b*c*d*x*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^-2*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(-1*d*x^-1*(a+b*arcsin(c*x))+-1*b*c*d*(1+-1*c^2*x^2)^(1/2)+-1*b*c*d*arctanh((1+-1*c^2*x^2)^(1/2))+-1*d*x*c^2*(a+b*arcsin(c*x)))
	@test integrate(x^-3*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(-1*d*c^2*(a+b*arcsin(c*x))*log(1+-1*exp(2*im*arcsin(c*x)))+-1//2*b*d*c^2*arcsin(c*x)+-1//2*d*x^-2*(1+-1*c^2*x^2)*(a+b*arcsin(c*x))+(1/2)*im*b*d*c^2*Polylogarithms.polylog(2,exp(2*im*arcsin(c*x)))+(1/2)*im*d*b^-1*c^2*(a+b*arcsin(c*x))^2+-1//2*b*c*d*x^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^-4*(a+b*arcsin(c*x))*(d+-1*d*c^2*x^2), x) == :(-1//3*d*x^-3*(a+b*arcsin(c*x))+d*c^2*x^-1*(a+b*arcsin(c*x))+5//6*b*d*c^3*arctanh((1+-1*c^2*x^2)^(1/2))+-1//6*b*c*d*x^-2*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^4*(d+-1*d*c^2*x^2)^2*(a+b*arcsin(c*x)), x) == :(1//5*d^2*x^5*(a+b*arcsin(c*x))+-10//441*b*c^-5*d^2*(1+-1*c^2*x^2)^7//2+-2//7*c^2*d^2*x^7*(a+b*arcsin(c*x))+1//9*c^4*d^2*x^9*(a+b*arcsin(c*x))+1//81*b*c^-5*d^2*(1+-1*c^2*x^2)^9//2+1//525*b*c^-5*d^2*(1+-1*c^2*x^2)^5//2+4//945*b*c^-5*d^2*(1+-1*c^2*x^2)^3//2+8//315*b*c^-5*d^2*(1+-1*c^2*x^2)^(1/2))
end

@testset "5.1.4b (f x)^m (d+e x^2)^p (a+b arcsin(c x))^n.jl" begin
	@test integrate(x^4*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(1//5*d*x^5*(a+b*arcsin(c*x))+1//7*e*x^7*(a+b*arcsin(c*x))+-1//49*b*e*c^-7*(1+-1*c^2*x^2)^7//2+-1//105*b*c^-7*(1+-1*c^2*x^2)^3//2*(15*e+14*d*c^2)+1//35*b*c^-7*(1+-1*c^2*x^2)^(1/2)*(5*e+7*d*c^2)+1//175*b*c^-7*(1+-1*c^2*x^2)^5//2*(15*e+7*d*c^2))
	@test integrate(x^3*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(1//4*d*x^4*(a+b*arcsin(c*x))+1//6*e*x^6*(a+b*arcsin(c*x))+-1//96*b*c^-6*(5*e+9*d*c^2)*arcsin(c*x)+1//36*b*e*c^-1*x^5*(1+-1*c^2*x^2)^(1/2)+1//96*b*x*c^-5*(1+-1*c^2*x^2)^(1/2)*(5*e+9*d*c^2)+1//144*b*c^-3*x^3*(1+-1*c^2*x^2)^(1/2)*(5*e+9*d*c^2))
	@test integrate(x^2*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(1//3*d*x^3*(a+b*arcsin(c*x))+1//5*e*x^5*(a+b*arcsin(c*x))+-1//45*b*c^-5*(1+-1*c^2*x^2)^3//2*(6*e+5*d*c^2)+1//15*b*c^-5*(1+-1*c^2*x^2)^(1/2)*(3*e+5*d*c^2)+1//25*b*e*c^-5*(1+-1*c^2*x^2)^5//2)
	@test integrate(x*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(1//4*e^-1*(d+e*x^2)^2*(a+b*arcsin(c*x))+-1//32*b*c^-4*e^-1*(3*e^2+8*c^4*d^2+8*d*e*c^2)*arcsin(c*x)+1//16*b*x*c^-1*(1+-1*c^2*x^2)^(1/2)*(d+e*x^2)+3//32*b*x*c^-3*(1+-1*c^2*x^2)^(1/2)*(e+2*d*c^2))
	@test integrate((a+b*arcsin(c*x))*(d+e*x^2), x) == :(d*x*(a+b*arcsin(c*x))+1//3*e*x^3*(a+b*arcsin(c*x))+-1//9*b*e*c^-3*(1+-1*c^2*x^2)^3//2+1//3*b*c^-3*(1+-1*c^2*x^2)^(1/2)*(e+3*d*c^2))
	@test integrate(x^-1*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(d*(a+b*arcsin(c*x))*log(x)+(1/2)*e*x^2*(a+b*arcsin(c*x))+b*d*arcsin(c*x)*log(1+-1*exp(2*im*arcsin(c*x)))+-1*b*d*arcsin(c*x)*log(x)+-1//2*im*b*d*arcsin(c*x)^2+-1//2*im*b*d*Polylogarithms.polylog(2,exp(2*im*arcsin(c*x)))+-1//4*b*e*c^-2*arcsin(c*x)+1//4*b*e*x*c^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^-2*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(e*x*(a+b*arcsin(c*x))+-1*d*x^-1*(a+b*arcsin(c*x))+b*e*c^-1*(1+-1*c^2*x^2)^(1/2)+-1*b*c*d*arctanh((1+-1*c^2*x^2)^(1/2)))
	@test integrate(x^-3*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(e*(a+b*arcsin(c*x))*log(x)+-1//2*d*x^-2*(a+b*arcsin(c*x))+b*e*arcsin(c*x)*log(1+-1*exp(2*im*arcsin(c*x)))+-1*b*e*arcsin(c*x)*log(x)+-1//2*im*b*e*arcsin(c*x)^2+-1//2*im*b*e*Polylogarithms.polylog(2,exp(2*im*arcsin(c*x)))+-1//2*b*c*d*x^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^-4*(a+b*arcsin(c*x))*(d+e*x^2), x) == :(-1*e*x^-1*(a+b*arcsin(c*x))+-1//3*d*x^-3*(a+b*arcsin(c*x))+-1//6*b*c*(6*e+d*c^2)*arctanh((1+-1*c^2*x^2)^(1/2))+-1//6*b*c*d*x^-2*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^4*(d+e*x^2)^2*(a+b*arcsin(c*x)), x) == :(1//5*d^2*x^5*(a+b*arcsin(c*x))+1//9*e^2*x^9*(a+b*arcsin(c*x))+-2//945*b*c^-9*(1+-1*c^2*x^2)^3//2*(70*e^2+63*c^4*d^2+135*d*e*c^2)+1//81*b*c^-9*e^2*(1+-1*c^2*x^2)^9//2+1//315*b*c^-9*(1+-1*c^2*x^2)^(1/2)*(35*e^2+63*c^4*d^2+90*d*e*c^2)+1//525*b*c^-9*(1+-1*c^2*x^2)^5//2*(70*e^2+21*c^4*d^2+90*d*e*c^2)+2//7*d*e*x^7*(a+b*arcsin(c*x))+-2//441*b*e*c^-9*(1+-1*c^2*x^2)^7//2*(14*e+9*d*c^2))
end

@testset "5.1.5 Inverse sine functions.jl" begin
	@test integrate((d+e*x)^3*(a+b*arcsin(c*x)), x) == :(1//4*e^-1*(d+e*x)^4*(a+b*arcsin(c*x))+1//16*b*c^-1*(1+-1*c^2*x^2)^(1/2)*(d+e*x)^3+1//96*b*c^-3*(1+-1*c^2*x^2)^(1/2)*(4*d*(16*e^2+19*c^2*d^2)+e*x*(9*e^2+26*c^2*d^2))+-1//32*b*c^-4*e^-1*(3*e^4+8*c^4*d^4+24*c^2*d^2*e^2)*arcsin(c*x)+7//48*b*d*c^-1*(1+-1*c^2*x^2)^(1/2)*(d+e*x)^2)
	@test integrate((d+e*x)^2*(a+b*arcsin(c*x)), x) == :(1//3*e^-1*(d+e*x)^3*(a+b*arcsin(c*x))+1//9*b*c^-1*(1+-1*c^2*x^2)^(1/2)*(d+e*x)^2+1//18*b*c^-3*(1+-1*c^2*x^2)^(1/2)*(4*e^2+16*c^2*d^2+5*d*e*x*c^2)+-1//6*b*d*e^-1*(2*d^2+3*c^-2*e^2)*arcsin(c*x))
	@test integrate((a+b*arcsin(c*x))*(d+e*x), x) == :((1/2)*e^-1*(d+e*x)^2*(a+b*arcsin(c*x))+-1//4*b*e^-1*(2*d^2+c^-2*e^2)*arcsin(c*x)+1//4*b*c^-1*(1+-1*c^2*x^2)^(1/2)*(d+e*x)+3//4*b*d*c^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate(a+b*arcsin(c*x), x) == :(a*x+b*x*arcsin(c*x)+b*c^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate((d+e*x)^-1*(a+b*arcsin(c*x)), x) == :(e^-1*(a+b*arcsin(c*x))*log(1+-1*im*e*((-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(im*arcsin(c*x)))+e^-1*(a+b*arcsin(c*x))*log(1+-1*im*e*(-1*(-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(im*arcsin(c*x)))+-1*im*b*e^-1*Polylogarithms.polylog(2,im*e*((-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(im*arcsin(c*x)))+-1*im*b*e^-1*Polylogarithms.polylog(2,im*e*(-1*(-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(im*arcsin(c*x)))+-1//2*im*b^-1*e^-1*(a+b*arcsin(c*x))^2)
	@test integrate((d+e*x)^-2*(a+b*arcsin(c*x)), x) == :(-1*e^-1*(d+e*x)^-1*(a+b*arcsin(c*x))+b*c*e^-1*(-1*e^2+c^2*d^2)^-1//2*arctan((1+-1*c^2*x^2)^-1//2*(-1*e^2+c^2*d^2)^-1//2*(e+d*x*c^2)))
	@test integrate((d+e*x)^-3*(a+b*arcsin(c*x)), x) == :(-1//2*e^-1*(d+e*x)^-2*(a+b*arcsin(c*x))+b*c*(1+-1*c^2*x^2)^(1/2)*(d+e*x)^-1*(-2*e^2+2*c^2*d^2)^-1+(1/2)*b*d*c^3*e^-1*(-1*e^2+c^2*d^2)^-3//2*arctan((1+-1*c^2*x^2)^-1//2*(-1*e^2+c^2*d^2)^-1//2*(e+d*x*c^2)))
	@test integrate((d+e*x)^-4*(a+b*arcsin(c*x)), x) == :(-1//3*e^-1*(d+e*x)^-3*(a+b*arcsin(c*x))+b*c*(1+-1*c^2*x^2)^(1/2)*(d+e*x)^-2*(-6*e^2+6*c^2*d^2)^-1+(1/2)*b*d*c^3*(1+-1*c^2*x^2)^(1/2)*(d+e*x)^-1*(-1*e^2+c^2*d^2)^-2+1//6*b*c^3*e^-1*(-1*e^2+c^2*d^2)^-5//2*(e^2+2*c^2*d^2)*arctan((1+-1*c^2*x^2)^-1//2*(-1*e^2+c^2*d^2)^-1//2*(e+d*x*c^2)))
	@test integrate((a+b*arcsin(c*x))^2*(d+e*x)^3, x) == :(-2*x*b^2*d^3+-3//32*c^-4*e^3*(a+b*arcsin(c*x))^2+-1//4*d^4*e^-1*(a+b*arcsin(c*x))^2+-1//32*b^2*e^3*x^4+1//4*e^-1*(a+b*arcsin(c*x))^2*(d+e*x)^4+-3//4*e*b^2*d^2*x^2+-3//4*e*c^-2*d^2*(a+b*arcsin(c*x))^2+-3//32*b^2*c^-2*e^3*x^2+-2//9*d*b^2*e^2*x^3+2*b*c^-1*d^3*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+-4//3*d*x*b^2*c^-2*e^2+1//8*b*c^-1*e^3*x^3*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+3//16*b*x*c^-3*e^3*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+4//3*b*d*c^-3*e^2*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+2//3*b*d*c^-1*e^2*x^2*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+3//2*b*e*x*c^-1*d^2*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x)))
	@test integrate((a+b*arcsin(c*x))^2*(d+e*x)^2, x) == :(-2*x*b^2*d^2+-2//27*b^2*e^2*x^3+-1//3*d^3*e^-1*(a+b*arcsin(c*x))^2+1//3*e^-1*(a+b*arcsin(c*x))^2*(d+e*x)^3+-4//9*x*b^2*c^-2*e^2+-1//2*d*e*b^2*x^2+-1//2*d*e*c^-2*(a+b*arcsin(c*x))^2+2*b*c^-1*d^2*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+4//9*b*c^-3*e^2*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+2//9*b*c^-1*e^2*x^2*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x))+b*d*e*x*c^-1*(1+-1*c^2*x^2)^(1/2)*(a+b*arcsin(c*x)))
end

@testset "5.2.2 (d x)^m (a+b arccos(c x))^n.jl" begin
	@test integrate(x^4*arccos(a*x), x) == :(-1//5*a^-5*(1+-1*a^2*x^2)^(1/2)+-1//25*a^-5*(1+-1*a^2*x^2)^5//2+1//5*x^5*arccos(a*x)+2//15*a^-5*(1+-1*a^2*x^2)^3//2)
	@test integrate(x^3*arccos(a*x), x) == :(1//4*x^4*arccos(a*x)+3//32*a^-4*arcsin(a*x)+-3//32*x*a^-3*(1+-1*a^2*x^2)^(1/2)+-1//16*a^-1*x^3*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^2*arccos(a*x), x) == :(-1//3*a^-3*(1+-1*a^2*x^2)^(1/2)+1//3*x^3*arccos(a*x)+1//9*a^-3*(1+-1*a^2*x^2)^3//2)
	@test integrate(x*arccos(a*x), x) == :((1/2)*x^2*arccos(a*x)+1//4*a^-2*arcsin(a*x)+-1//4*x*a^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(arccos(a*x), x) == :(x*arccos(a*x)+-1*a^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-1*arccos(a*x), x) == :(arccos(a*x)*log(1+exp(2*im*arccos(a*x)))+-1//2*im*arccos(a*x)^2+-1//2*im*Polylogarithms.polylog(2,-1*exp(2*im*arccos(a*x))))
	@test integrate(x^-2*arccos(a*x), x) == :(a*arctanh((1+-1*a^2*x^2)^(1/2))+-1*x^-1*arccos(a*x))
	@test integrate(x^-3*arccos(a*x), x) == :(-1//2*x^-2*arccos(a*x)+(1/2)*a*x^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-4*arccos(a*x), x) == :(-1//3*x^-3*arccos(a*x)+1//6*a^3*arctanh((1+-1*a^2*x^2)^(1/2))+1//6*a*x^-2*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-5*arccos(a*x), x) == :(-1//4*x^-4*arccos(a*x)+1//6*a^3*x^-1*(1+-1*a^2*x^2)^(1/2)+1//12*a*x^-3*(1+-1*a^2*x^2)^(1/2))
end

@testset "5.2.5 Inverse cosine functions.jl" begin
	@test integrate(x^3*(d+-1*d*c^2*x^2)^-1*(a+b*arccos(c*x)), x) == :(-1*c^-4*d^-1*(a+b*arccos(c*x))*log(1+-1*exp(2*im*arccos(c*x)))+-1//2*c^-2*d^-1*x^2*(a+b*arccos(c*x))+-1//4*b*c^-4*d^-1*arcsin(c*x)+(1/2)*im*b*c^-4*d^-1*Polylogarithms.polylog(2,exp(2*im*arccos(c*x)))+(1/2)*im*b^-1*c^-4*d^-1*(a+b*arccos(c*x))^2+1//4*b*x*c^-3*d^-1*(1+-1*c^2*x^2)^(1/2))
	@test integrate(x^2*(d+-1*d*c^2*x^2)^-1*(a+b*arccos(c*x)), x) == :(b*c^-3*d^-1*(1+-1*c^2*x^2)^(1/2)+c^-3*d^-1*(2a+2*b*arccos(c*x))*arctanh(exp(im*arccos(c*x)))+-1*x*c^-2*d^-1*(a+b*arccos(c*x))+im*b*c^-3*d^-1*Polylogarithms.polylog(2,exp(im*arccos(c*x)))+-1*im*b*c^-3*d^-1*Polylogarithms.polylog(2,-1*exp(im*arccos(c*x))))
	@test integrate(x*(d+-1*d*c^2*x^2)^-1*(a+b*arccos(c*x)), x) == :(-1*c^-2*d^-1*(a+b*arccos(c*x))*log(1+-1*exp(2*im*arccos(c*x)))+(1/2)*im*b*c^-2*d^-1*Polylogarithms.polylog(2,exp(2*im*arccos(c*x)))+(1/2)*im*b^-1*c^-2*d^-1*(a+b*arccos(c*x))^2)
	@test integrate((d+-1*d*c^2*x^2)^-1*(a+b*arccos(c*x)), x) == :(c^-1*d^-1*(2a+2*b*arccos(c*x))*arctanh(exp(im*arccos(c*x)))+im*b*c^-1*d^-1*Polylogarithms.polylog(2,exp(im*arccos(c*x)))+-1*im*b*c^-1*d^-1*Polylogarithms.polylog(2,-1*exp(im*arccos(c*x))))
	@test integrate(x^-1*(d+-1*d*c^2*x^2)^-1*(a+b*arccos(c*x)), x) == :(d^-1*(2a+2*b*arccos(c*x))*arctanh(exp(2*im*arccos(c*x)))+(1/2)*im*b*d^-1*Polylogarithms.polylog(2,exp(2*im*arccos(c*x)))+-1//2*im*b*d^-1*Polylogarithms.polylog(2,-1*exp(2*im*arccos(c*x))))
	@test integrate(x^-2*(d+-1*d*c^2*x^2)^-1*(a+b*arccos(c*x)), x) == :(-1*d^-1*x^-1*(a+b*arccos(c*x))+b*c*d^-1*arctanh((1+-1*c^2*x^2)^(1/2))+2*c*d^-1*(a+b*arccos(c*x))*arctanh(exp(im*arccos(c*x)))+im*b*c*d^-1*Polylogarithms.polylog(2,exp(im*arccos(c*x)))+-1*im*b*c*d^-1*Polylogarithms.polylog(2,-1*exp(im*arccos(c*x))))
	@test integrate(x^-3*(d+-1*d*c^2*x^2)^-1*(a+b*arccos(c*x)), x) == :(-1//2*d^-1*x^-2*(a+b*arccos(c*x))+2*c^2*d^-1*(a+b*arccos(c*x))*arctanh(exp(2*im*arccos(c*x)))+(1/2)*im*b*c^2*d^-1*Polylogarithms.polylog(2,exp(2*im*arccos(c*x)))+(1/2)*b*c*d^-1*x^-1*(1+-1*c^2*x^2)^(1/2)+-1//2*im*b*c^2*d^-1*Polylogarithms.polylog(2,-1*exp(2*im*arccos(c*x))))
	@test integrate(x^4*(d+-1*d*c^2*x^2)^-2*(a+b*arccos(c*x)), x) == :((1/2)*b*c^-5*d^-2*(1+-1*c^2*x^2)^-1//2+-1*b*c^-5*d^-2*(1+-1*c^2*x^2)^(1/2)+-1*c^-5*d^-2*(3a+3*b*arccos(c*x))*arctanh(exp(im*arccos(c*x)))+3//2*x*c^-4*d^-2*(a+b*arccos(c*x))+(1/2)*c^-2*d^-2*x^3*(1+-1*c^2*x^2)^-1*(a+b*arccos(c*x))+-3//2*im*b*c^-5*d^-2*Polylogarithms.polylog(2,exp(im*arccos(c*x)))+3//2*im*b*c^-5*d^-2*Polylogarithms.polylog(2,-1*exp(im*arccos(c*x))))
	@test integrate(x^3*(d+-1*d*c^2*x^2)^-2*(a+b*arccos(c*x)), x) == :(c^-4*d^-2*(a+b*arccos(c*x))*log(1+-1*exp(2*im*arccos(c*x)))+-1//2*b*c^-4*d^-2*arcsin(c*x)+(1/2)*b*x*c^-3*d^-2*(1+-1*c^2*x^2)^-1//2+(1/2)*c^-2*d^-2*x^2*(1+-1*c^2*x^2)^-1*(a+b*arccos(c*x))+-1//2*im*b*c^-4*d^-2*Polylogarithms.polylog(2,exp(2*im*arccos(c*x)))+-1//2*im*b^-1*c^-4*d^-2*(a+b*arccos(c*x))^2)
	@test integrate(x^2*(d+-1*d*c^2*x^2)^-2*(a+b*arccos(c*x)), x) == :((1/2)*b*c^-3*d^-2*(1+-1*c^2*x^2)^-1//2+-1*c^-3*d^-2*(a+b*arccos(c*x))*arctanh(exp(im*arccos(c*x)))+(1/2)*im*b*c^-3*d^-2*Polylogarithms.polylog(2,-1*exp(im*arccos(c*x)))+(1/2)*x*c^-2*d^-2*(1+-1*c^2*x^2)^-1*(a+b*arccos(c*x))+-1//2*im*b*c^-3*d^-2*Polylogarithms.polylog(2,exp(im*arccos(c*x))))
end

@testset "5.3.2 (d x)^m (a+b arctan(c x^n))^p.jl" begin
	@test integrate(x^5*(a+b*arctan(c*x)), x) == :(1//6*x^6*(a+b*arctan(c*x))+-1//6*b*x*c^-5+-1//30*b*c^-1*x^5+1//6*b*c^-6*arctan(c*x)+1//18*b*c^-3*x^3)
	@test integrate(x^4*(a+b*arctan(c*x)), x) == :(1//5*x^5*(a+b*arctan(c*x))+-1//10*b*c^-5*log(1+c^2*x^2)+-1//20*b*c^-1*x^4+1//10*b*c^-3*x^2)
	@test integrate(x^3*(a+b*arctan(c*x)), x) == :(1//4*x^4*(a+b*arctan(c*x))+-1//4*b*c^-4*arctan(c*x)+-1//12*b*c^-1*x^3+1//4*b*x*c^-3)
	@test integrate(x^2*(a+b*arctan(c*x)), x) == :(1//3*x^3*(a+b*arctan(c*x))+-1//6*b*c^-1*x^2+1//6*b*c^-3*log(1+c^2*x^2))
	@test integrate(x*(a+b*arctan(c*x)), x) == :((1/2)*x^2*(a+b*arctan(c*x))+(1/2)*b*c^-2*arctan(c*x)+-1//2*b*x*c^-1)
	@test integrate(a+b*arctan(c*x), x) == :(a*x+b*x*arctan(c*x)+-1//2*b*c^-1*log(1+c^2*x^2))
	@test integrate(x^-1*(a+b*arctan(c*x)), x) == :(a*log(x)+(1/2)*im*b*Polylogarithms.polylog(2,-1*im*c*x)+-1//2*im*b*Polylogarithms.polylog(2,im*c*x))
	@test integrate(x^-2*(a+b*arctan(c*x)), x) == :(-1*x^-1*(a+b*arctan(c*x))+b*c*log(x)+-1//2*b*c*log(1+c^2*x^2))
	@test integrate(x^-3*(a+b*arctan(c*x)), x) == :(-1//2*x^-2*(a+b*arctan(c*x))+-1//2*b*c*x^-1+-1//2*b*c^2*arctan(c*x))
	@test integrate(x^-4*(a+b*arctan(c*x)), x) == :(-1//3*x^-3*(a+b*arctan(c*x))+-1//3*b*c^3*log(x)+-1//6*b*c*x^-2+1//6*b*c^3*log(1+c^2*x^2))
end

@testset "5.3.3 (d+e x)^m (a+b arctan(c x^n))^p.jl" begin
	@test integrate((d+e*x)^4*(a+b*arctan(c*x)), x) == :(1//5*e^-1*(d+e*x)^5*(a+b*arctan(c*x))+-1//10*b*c^-5*(e^4+5*c^4*d^4+-10*c^2*d^2*e^2)*log(1+c^2*x^2)+-1//20*b*c^-1*e^4*x^4+-1//3*b*d*c^-1*e^3*x^3+-1//10*b*c^-3*e^2*x^2*(-1*e^2+10*c^2*d^2)+-1*b*d*e*x*c^-3*(-1*e^2+2*c^2*d^2)+-1//5*b*d*c^-4*e^-1*(5*e^4+c^4*d^4+-10*c^2*d^2*e^2)*arctan(c*x))
	@test integrate((d+e*x)^3*(a+b*arctan(c*x)), x) == :(1//4*e^-1*(d+e*x)^4*(a+b*arctan(c*x))+-1//12*b*c^-1*e^3*x^3+-1//2*b*d*c^-1*e^2*x^2+-1//4*b*e*x*c^-3*(-1*e^2+6*c^2*d^2)+-1//4*b*c^-4*e^-1*(e^4+c^4*d^4+-6*c^2*d^2*e^2)*arctan(c*x)+-1//2*b*d*c^-3*(e+c*d)*(-1*e+c*d)*log(1+c^2*x^2))
	@test integrate((d+e*x)^2*(a+b*arctan(c*x)), x) == :(1//3*e^-1*(d+e*x)^3*(a+b*arctan(c*x))+-1//6*b*c^-1*e^2*x^2+-1//6*b*c^-3*(-1*e^2+3*c^2*d^2)*log(1+c^2*x^2)+-1*b*d*e*x*c^-1+-1//3*b*d*e^-1*(d^2+-3*c^-2*e^2)*arctan(c*x))
	@test integrate((a+b*arctan(c*x))*(d+e*x), x) == :((1/2)*e^-1*(d+e*x)^2*(a+b*arctan(c*x))+-1//2*b*d*c^-1*log(1+c^2*x^2)+-1//2*b*e*x*c^-1+-1//2*b*e^-1*(d^2+-1*c^-2*e^2)*arctan(c*x))
	@test integrate((d+e*x)^-1*(a+b*arctan(c*x)), x) == :(e^-1*(a+b*arctan(c*x))*log(2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x))+-1*e^-1*(a+b*arctan(c*x))*log(2*(1+-1*im*c*x)^-1)+(1/2)*im*b*e^-1*Polylogarithms.polylog(2,1+-2*(1+-1*im*c*x)^-1)+-1//2*im*b*e^-1*Polylogarithms.polylog(2,1+-2*c*(1+-1*im*c*x)^-1*(im*e+c*d)^-1*(d+e*x)))
	@test integrate((d+e*x)^-2*(a+b*arctan(c*x)), x) == :(-1*e^-1*(d+e*x)^-1*(a+b*arctan(c*x))+b*c*(e^2+c^2*d^2)^-1*log(d+e*x)+-1*b*c*(2*e^2+2*c^2*d^2)^-1*log(1+c^2*x^2)+b*d*c^2*e^-1*(e^2+c^2*d^2)^-1*arctan(c*x))
	@test integrate((d+e*x)^-3*(a+b*arctan(c*x)), x) == :(-1//2*e^-1*(d+e*x)^-2*(a+b*arctan(c*x))+-1*b*c*(d+e*x)^-1*(2*e^2+2*c^2*d^2)^-1+b*d*c^3*(e^2+c^2*d^2)^-2*log(d+e*x)+-1//2*b*d*c^3*(e^2+c^2*d^2)^-2*log(1+c^2*x^2)+(1/2)*b*c^2*e^-1*(e^2+c^2*d^2)^-2*(e+c*d)*(-1*e+c*d)*arctan(c*x))
	@test integrate((d+e*x)^-4*(a+b*arctan(c*x)), x) == :(-1//3*e^-1*(d+e*x)^-3*(a+b*arctan(c*x))+-1*b*c*(d+e*x)^-2*(6*e^2+6*c^2*d^2)^-1+-2//3*b*d*c^3*(d+e*x)^-1*(e^2+c^2*d^2)^-2+-1//6*b*c^3*(e^2+c^2*d^2)^-3*(-1*e^2+3*c^2*d^2)*log(1+c^2*x^2)+1//3*b*c^3*(e^2+c^2*d^2)^-3*(-1*e^2+3*c^2*d^2)*log(d+e*x)+1//3*b*d*c^4*e^-1*(e^2+c^2*d^2)^-3*(-3*e^2+c^2*d^2)*arctan(c*x))
	@test integrate((a+b*arctan(c*x))^2*(d+e*x)^3, x) == :(1//4*e^-1*(a+b*arctan(c*x))^2*(d+e*x)^4+-1//4*c^-4*e^-1*(a+b*arctan(c*x))^2*(e^4+c^4*d^4+-6*c^2*d^2*e^2)+-1//12*b^2*c^-4*e^3*log(1+c^2*x^2)+1//12*b^2*c^-2*e^3*x^2+d*x*b^2*c^-2*e^2+-1*d*b^2*c^-3*e^2*arctan(c*x)+-1//6*b*c^-1*e^3*x^3*(a+b*arctan(c*x))+1//4*e*b^2*c^-4*(-1*e^2+6*c^2*d^2)*log(1+c^2*x^2)+im*d*c^-3*(a+b*arctan(c*x))^2*(e+c*d)*(-1*e+c*d)+-1*b*d*c^-1*e^2*x^2*(a+b*arctan(c*x))+-1//2*a*b*e*x*c^-3*(-1*e^2+6*c^2*d^2)+-1//2*e*x*b^2*c^-3*(-1*e^2+6*c^2*d^2)*arctan(c*x)+im*d*b^2*c^-3*(e+c*d)*(-1*e+c*d)*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+2*b*d*c^-3*(a+b*arctan(c*x))*(e+c*d)*(-1*e+c*d)*log(2*(1+im*c*x)^-1))
	@test integrate((a+b*arctan(c*x))^2*(d+e*x)^2, x) == :(1//3*e^-1*(a+b*arctan(c*x))^2*(d+e*x)^3+-1//3*d*e^-1*(a+b*arctan(c*x))^2*(d^2+-3*c^-2*e^2)+-1//3*b^2*c^-3*e^2*arctan(c*x)+1//3*im*c^-3*(a+b*arctan(c*x))^2*(-1*e^2+3*c^2*d^2)+1//3*x*b^2*c^-2*e^2+d*e*b^2*c^-2*log(1+c^2*x^2)+-1//3*b*c^-1*e^2*x^2*(a+b*arctan(c*x))+1//3*im*b^2*c^-3*(-1*e^2+3*c^2*d^2)*Polylogarithms.polylog(2,1+-2*(1+im*c*x)^-1)+2//3*b*c^-3*(a+b*arctan(c*x))*(-1*e^2+3*c^2*d^2)*log(2*(1+im*c*x)^-1)+-2*a*b*d*e*x*c^-1+-2*d*e*x*b^2*c^-1*arctan(c*x))
end

@testset "5.3.4 u (a+b arctan(c x))^p.jl" begin
	@test integrate(x^3*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :(1//4*d*x^4*(a+b*arctan(c*x))+-1//4*b*d*c^-4*arctan(c*x)+-1//12*b*d*c^-1*x^3+-1//20*im*b*d*x^4+1//4*b*d*x*c^-3+-1//10*im*b*d*c^-4*log(1+c^2*x^2)+1//5*im*c*d*x^5*(a+b*arctan(c*x))+1//10*im*b*d*c^-2*x^2)
	@test integrate(x^2*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :(1//3*d*x^3*(a+b*arctan(c*x))+-1//6*b*d*c^-1*x^2+-1//12*im*b*d*x^3+1//6*b*d*c^-3*log(1+c^2*x^2)+-1//4*im*b*d*c^-3*arctan(c*x)+1//4*im*b*d*x*c^-2+1//4*im*c*d*x^4*(a+b*arctan(c*x)))
	@test integrate(x*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :((1/2)*d*x^2*(a+b*arctan(c*x))+(1/2)*b*d*c^-2*arctan(c*x)+-1//2*b*d*x*c^-1+-1//6*im*b*d*x^2+1//3*im*c*d*x^3*(a+b*arctan(c*x))+1//6*im*b*d*c^-2*log(1+c^2*x^2))
	@test integrate((a+b*arctan(c*x))*(d+im*c*d*x), x) == :(-1*b*d*c^-1*log(im+c*x)+-1//2*im*b*d*x+-1//2*im*d*c^-1*(1+im*c*x)^2*(a+b*arctan(c*x)))
	@test integrate(x^-1*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :(a*d*log(x)+(1/2)*im*b*d*Polylogarithms.polylog(2,-1*im*c*x)+-1//2*im*b*d*Polylogarithms.polylog(2,im*c*x)+-1//2*im*b*d*log(1+c^2*x^2)+im*a*c*d*x+im*b*c*d*x*arctan(c*x))
	@test integrate(x^-2*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :(-1*d*x^-1*(a+b*arctan(c*x))+b*c*d*log(x)+(1/2)*b*c*d*Polylogarithms.polylog(2,im*c*x)+-1//2*b*c*d*Polylogarithms.polylog(2,-1*im*c*x)+-1//2*b*c*d*log(1+c^2*x^2)+im*a*c*d*log(x))
	@test integrate(x^-3*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :(-1//2*b*c*d*x^-1+-1//2*d*x^-2*(1+im*c*x)^2*(a+b*arctan(c*x))+im*b*d*c^2*log(x)+-1*im*b*d*c^2*log(im+c*x))
	@test integrate(x^-4*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :(-1//3*d*x^-3*(a+b*arctan(c*x))+-1//3*b*d*c^3*log(x)+-1//6*b*c*d*x^-2+-1//12*b*d*c^3*log(im+-1*c*x)+5//12*b*d*c^3*log(im+c*x)+-1//2*im*b*d*c^2*x^-1+-1//2*im*c*d*x^-2*(a+b*arctan(c*x)))
	@test integrate(x^-5*(a+b*arctan(c*x))*(d+im*c*d*x), x) == :(-1//4*d*x^-4*(a+b*arctan(c*x))+-1//12*b*c*d*x^-3+1//4*b*d*c^3*x^-1+-1//3*im*b*d*c^4*log(x)+-1//3*im*c*d*x^-3*(a+b*arctan(c*x))+-1//6*im*b*d*c^2*x^-2+1//24*im*b*d*c^4*log(im+-1*c*x)+7//24*im*b*d*c^4*log(im+c*x))
	@test integrate(x^3*(d+im*c*d*x)^2*(a+b*arctan(c*x)), x) == :(1//4*d^2*x^4*(a+b*arctan(c*x))+-5//12*b*c^-4*d^2*arctan(c*x)+-5//36*b*c^-1*d^2*x^3+-1//6*c^2*d^2*x^6*(a+b*arctan(c*x))+-1//10*im*b*d^2*x^4+1//30*b*c*d^2*x^5+5//12*b*x*c^-3*d^2+-1//5*im*b*c^-4*d^2*log(1+c^2*x^2)+1//5*im*b*c^-2*d^2*x^2+2//5*im*c*d^2*x^5*(a+b*arctan(c*x)))
end

@testset "5.3.5 u (a+b arctan(c+d x))^p.jl" begin
	@test integrate((c*e+d*e*x)^3*(a+b*arctan(c+d*x)), x) == :(1//4*b*x*e^3+-1//4*b*d^-1*e^3*arctan(c+d*x)+-1//12*b*d^-1*e^3*(c+d*x)^3+1//4*d^-1*e^3*(c+d*x)^4*(a+b*arctan(c+d*x)))
	@test integrate((c*e+d*e*x)^2*(a+b*arctan(c+d*x)), x) == :(-1//6*b*d^-1*e^2*(c+d*x)^2+1//3*d^-1*e^2*(c+d*x)^3*(a+b*arctan(c+d*x))+1//6*b*d^-1*e^2*log(1+(c+d*x)^2))
	@test integrate((a+b*arctan(c+d*x))*(c*e+d*e*x), x) == :(-1//2*b*e*x+(1/2)*b*e*d^-1*arctan(c+d*x)+(1/2)*e*d^-1*(c+d*x)^2*(a+b*arctan(c+d*x)))
	@test integrate((c*e+d*e*x)^-1*(a+b*arctan(c+d*x)), x) == :(a*d^-1*e^-1*log(c+d*x)+(1/2)*im*b*d^-1*e^-1*Polylogarithms.polylog(2,-1*im*(c+d*x))+-1//2*im*b*d^-1*e^-1*Polylogarithms.polylog(2,im*(c+d*x)))
	@test integrate((c*e+d*e*x)^-2*(a+b*arctan(c+d*x)), x) == :(b*d^-1*e^-2*log(c+d*x)+-1*d^-1*e^-2*(c+d*x)^-1*(a+b*arctan(c+d*x))+-1//2*b*d^-1*e^-2*log(1+(c+d*x)^2))
	@test integrate((c*e+d*e*x)^-3*(a+b*arctan(c+d*x)), x) == :(-1//2*b*d^-1*e^-3*(c+d*x)^-1+-1//2*b*d^-1*e^-3*arctan(c+d*x)+-1//2*d^-1*e^-3*(c+d*x)^-2*(a+b*arctan(c+d*x)))
	@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^3, x) == :(-1//4*d^-1*e^3*(a+b*arctan(c+d*x))^2+(1/2)*a*b*x*e^3+-1//3*b^2*d^-1*e^3*log(1+(c+d*x)^2)+1//4*d^-1*e^3*(a+b*arctan(c+d*x))^2*(c+d*x)^4+1//12*b^2*d^-1*e^3*(c+d*x)^2+(1/2)*b^2*d^-1*e^3*(c+d*x)*arctan(c+d*x)+-1//6*b*d^-1*e^3*(c+d*x)^3*(a+b*arctan(c+d*x)))
	@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^2, x) == :(1//3*x*b^2*e^2+-1//3*im*d^-1*e^2*(a+b*arctan(c+d*x))^2+-1//3*b^2*d^-1*e^2*arctan(c+d*x)+1//3*d^-1*e^2*(a+b*arctan(c+d*x))^2*(c+d*x)^3+-2//3*b*d^-1*e^2*(a+b*arctan(c+d*x))*log(2*(1+im*(c+d*x))^-1)+-1//3*im*b^2*d^-1*e^2*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1)+-1//3*b*d^-1*e^2*(c+d*x)^2*(a+b*arctan(c+d*x)))
	@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x), x) == :((1/2)*e*d^-1*(a+b*arctan(c+d*x))^2+(1/2)*e*b^2*d^-1*log(1+(c+d*x)^2)+(1/2)*e*d^-1*(a+b*arctan(c+d*x))^2*(c+d*x)^2+-1*a*b*e*x+-1*e*b^2*d^-1*(c+d*x)*arctan(c+d*x))
	@test integrate((a+b*arctan(c+d*x))^2*(c*e+d*e*x)^-1, x) == :((1/2)*b^2*d^-1*e^-1*Polylogarithms.polylog(3,-1+2*(1+im*(c+d*x))^-1)+2*d^-1*e^-1*(a+b*arctan(c+d*x))^2*arctanh(1+-2*(1+im*(c+d*x))^-1)+-1//2*b^2*d^-1*e^-1*Polylogarithms.polylog(3,1+-2*(1+im*(c+d*x))^-1)+im*b*d^-1*e^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,-1+2*(1+im*(c+d*x))^-1)+-1*im*b*d^-1*e^-1*(a+b*arctan(c+d*x))*Polylogarithms.polylog(2,1+-2*(1+im*(c+d*x))^-1))
end

@testset "5.3.6 Exponentials of inverse tangent.jl" begin
	@test integrate(x^4*exp(im*arctan(a*x)), x) == :(3//8*a^-5*arcsinh(a*x)+1//4*a^-2*x^3*(1+a^2*x^2)^(1/2)+1//120*a^-5*(1+a^2*x^2)^(1/2)*(64im+-45*a*x)+-4//15*im*a^-3*x^2*(1+a^2*x^2)^(1/2)+1//5*im*a^-1*x^4*(1+a^2*x^2)^(1/2))
	@test integrate(x^3*exp(im*arctan(a*x)), x) == :(-1//24*a^-4*(1+a^2*x^2)^(1/2)*(16+9*im*a*x)+1//3*a^-2*x^2*(1+a^2*x^2)^(1/2)+3//8*im*a^-4*arcsinh(a*x)+1//4*im*a^-1*x^3*(1+a^2*x^2)^(1/2))
	@test integrate(x^2*exp(im*arctan(a*x)), x) == :(-1//2*a^-3*arcsinh(a*x)+(1/2)*x*a^-2*(1+a^2*x^2)^(1/2)+-1*im*a^-3*(1+a^2*x^2)^(1/2)+1//3*im*a^-3*(1+a^2*x^2)^3//2)
	@test integrate(x*exp(im*arctan(a*x)), x) == :((1/2)*a^-2*(1+a^2*x^2)^(1/2)*(2+im*a*x)+-1//2*im*a^-2*arcsinh(a*x))
	@test integrate(exp(im*arctan(a*x)), x) == :(a^-1*arcsinh(a*x)+im*a^-1*(1+a^2*x^2)^(1/2))
	@test integrate(x^-1*exp(im*arctan(a*x)), x) == :(-1*arctanh((1+a^2*x^2)^(1/2))+im*arcsinh(a*x))
	@test integrate(x^-2*exp(im*arctan(a*x)), x) == :(-1*x^-1*(1+a^2*x^2)^(1/2)+-1*im*a*arctanh((1+a^2*x^2)^(1/2)))
	@test integrate(x^-3*exp(im*arctan(a*x)), x) == :((1/2)*a^2*arctanh((1+a^2*x^2)^(1/2))+-1//2*x^-2*(1+a^2*x^2)^(1/2)+-1*im*a*x^-1*(1+a^2*x^2)^(1/2))
	@test integrate(x^-4*exp(im*arctan(a*x)), x) == :(-1//3*x^-3*(1+a^2*x^2)^(1/2)+(1/2)*im*a^3*arctanh((1+a^2*x^2)^(1/2))+2//3*a^2*x^-1*(1+a^2*x^2)^(1/2)+-1//2*im*a*x^-2*(1+a^2*x^2)^(1/2))
	@test integrate(x^-5*exp(im*arctan(a*x)), x) == :(-3//8*a^4*arctanh((1+a^2*x^2)^(1/2))+-1//4*x^-4*(1+a^2*x^2)^(1/2)+3//8*a^2*x^-2*(1+a^2*x^2)^(1/2)+-1//3*im*a*x^-3*(1+a^2*x^2)^(1/2)+2//3*im*a^3*x^-1*(1+a^2*x^2)^(1/2))
end

@testset "5.3.7 Inverse tangent functions.jl" begin
	@test integrate(x^3*arctan(a+b*x^4), x) == :(-1//8*b^-1*log(1+(a+b*x^4)^2)+1//4*b^-1*(a+b*x^4)*arctan(a+b*x^4))
	@test integrate(x^(-1+n)*arctan(a+b*x^n), x) == :(-1//2*b^-1*n^-1*log(1+(a+b*x^n)^2)+b^-1*n^-1*(a+b*x^n)*arctan(a+b*x^n))
	@test integrate(x^5*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :(1//6*x^6*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)+1//36*x^5*(-1*e)^-1//2*(d+e*x^2)^(1/2)+5//96*x*d^2*(-1*e)^-5//2*(d+e*x^2)^(1/2)+5//96*d^3*e^-7//2*(-1*e)^(1/2)*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+5//144*d*x^3*(-1*e)^-3//2*(d+e*x^2)^(1/2))
	@test integrate(x^3*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :(1//4*x^4*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)+1//16*x^3*(-1*e)^-1//2*(d+e*x^2)^(1/2)+-3//32*d^2*e^-5//2*(-1*e)^(1/2)*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+3//32*d*x*(-1*e)^-3//2*(d+e*x^2)^(1/2))
	@test integrate(x*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :((1/2)*x^2*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)+1//4*x*(-1*e)^-1//2*(d+e*x^2)^(1/2)+1//4*d*e^-3//2*(-1*e)^(1/2)*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2))
	@test integrate(x^-1*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :(arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)*log(x)+(1/2)*d^(1/2)*e^-1//2*(-1*e)^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*Polylogarithms.polylog(2,exp(2*arcsinh(x*d^-1//2*e^(1/2))))+-1//2*d^(1/2)*e^-1//2*(-1*e)^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*arcsinh(x*d^-1//2*e^(1/2))^2+d^(1/2)*e^-1//2*(-1*e)^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*arcsinh(x*d^-1//2*e^(1/2))*log(1+-1*exp(2*arcsinh(x*d^-1//2*e^(1/2))))+-1*d^(1/2)*e^-1//2*(-1*e)^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*arcsinh(x*d^-1//2*e^(1/2))*log(x))
	@test integrate(x^-3*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//2*x^-2*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)+-1//2*d^-1*x^-1*(-1*e)^(1/2)*(d+e*x^2)^(1/2))
	@test integrate(x^-5*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//4*x^-4*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)+-1//6*d^-2*x^-1*(-1*e)^3//2*(d+e*x^2)^(1/2)+-1//12*d^-1*x^-3*(-1*e)^(1/2)*(d+e*x^2)^(1/2))
	@test integrate(x^-7*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//6*x^-6*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)+-4//45*d^-3*x^-1*(-1*e)^5//2*(d+e*x^2)^(1/2)+-2//45*d^-2*x^-3*(-1*e)^3//2*(d+e*x^2)^(1/2)+-1//30*d^-1*x^-5*(-1*e)^(1/2)*(d+e*x^2)^(1/2))
	@test integrate(x^-9*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//8*x^-8*arctan(x*(-1*e)^(1/2)*(d+e*x^2)^-1//2)+-3//140*d^-2*x^-5*(-1*e)^3//2*(d+e*x^2)^(1/2)+-2//35*d^-4*x^-1*(-1*e)^7//2*(d+e*x^2)^(1/2)+-1//35*d^-3*x^-3*(-1*e)^5//2*(d+e*x^2)^(1/2)+-1//56*d^-1*x^-7*(-1*e)^(1/2)*(d+e*x^2)^(1/2))
end

@testset "5.4.1 Inverse cotangent functions.jl" begin
	@test integrate(x^5*arccot(a*x), x) == :(-1//6*a^-6*arctan(a*x)+-1//18*a^-3*x^3+1//6*x*a^-5+1//6*x^6*arccot(a*x)+1//30*a^-1*x^5)
	@test integrate(x^4*arccot(a*x), x) == :(-1//10*a^-3*x^2+1//5*x^5*arccot(a*x)+1//10*a^-5*log(1+a^2*x^2)+1//20*a^-1*x^4)
	@test integrate(x^3*arccot(a*x), x) == :(-1//4*x*a^-3+1//4*a^-4*arctan(a*x)+1//4*x^4*arccot(a*x)+1//12*a^-1*x^3)
	@test integrate(x^2*arccot(a*x), x) == :(-1//6*a^-3*log(1+a^2*x^2)+1//3*x^3*arccot(a*x)+1//6*a^-1*x^2)
	@test integrate(x*arccot(a*x), x) == :((1/2)*x*a^-1+(1/2)*x^2*arccot(a*x)+-1//2*a^-2*arctan(a*x))
	@test integrate(arccot(a*x), x) == :(x*arccot(a*x)+(1/2)*a^-1*log(1+a^2*x^2))
	@test integrate(x^-1*arccot(a*x), x) == :((1/2)*im*Polylogarithms.polylog(2,im*a^-1*x^-1)+-1//2*im*Polylogarithms.polylog(2,-1*im*a^-1*x^-1))
	@test integrate(x^-2*arccot(a*x), x) == :((1/2)*a*log(1+a^2*x^2)+-1*a*log(x)+-1*x^-1*arccot(a*x))
	@test integrate(x^-3*arccot(a*x), x) == :((1/2)*a*x^-1+(1/2)*a^2*arctan(a*x)+-1//2*x^-2*arccot(a*x))
	@test integrate(x^-4*arccot(a*x), x) == :(-1//3*x^-3*arccot(a*x)+-1//6*a^3*log(1+a^2*x^2)+1//3*a^3*log(x)+1//6*a*x^-2)
end

@testset "5.4.2 Exponentials of inverse cotangent.jl" begin
	@test integrate((a+a*x^2)^-1*exp(arccot(x)), x) == :(-1*a^-1*exp(arccot(x)))
	@test integrate((a+a*x^2)^-2*exp(arccot(x)), x) == :(-2//5*a^-2*exp(arccot(x))+-1//5*a^-2*(1+x^2)^-1*(1+-2x)*exp(arccot(x)))
	@test integrate((a+a*x^2)^-3*exp(arccot(x)), x) == :(-24//85*a^-3*exp(arccot(x))+-12//85*a^-3*(1+x^2)^-1*(1+-2x)*exp(arccot(x))+-1//17*a^-3*(1+x^2)^-2*(1+-4x)*exp(arccot(x)))
	@test integrate((a+a*x^2)^-3//2*exp(arccot(x)), x) == :(-1//2*a^-1*(a+a*x^2)^-1//2*(1+-1x)*exp(arccot(x)))
	@test integrate((a+a*x^2)^-5//2*exp(arccot(x)), x) == :(-3//10*a^-2*(a+a*x^2)^-1//2*(1+-1x)*exp(arccot(x))+-1//10*a^-1*(a+a*x^2)^-3//2*(1+-3x)*exp(arccot(x)))
	@test integrate((a+a*x^2)^-7//2*exp(arccot(x)), x) == :(-3//13*a^-3*(a+a*x^2)^-1//2*(1+-1x)*exp(arccot(x))+-1//13*a^-2*(a+a*x^2)^-3//2*(1+-3x)*exp(arccot(x))+-1//26*a^-1*(a+a*x^2)^-5//2*(1+-5x)*exp(arccot(x)))
end

@testset "5.5.1 u (a+b arcsec(c x))^n.jl" begin
	@test integrate(x^6*(a+b*arcsec(c*x)), x) == :(1//7*x^7*(a+b*arcsec(c*x))+-5//112*b*c^-7*arctanh((1+-1*c^-2*x^-2)^(1/2))+-5//112*b*c^-5*x^2*(1+-1*c^-2*x^-2)^(1/2)+-5//168*b*c^-3*x^4*(1+-1*c^-2*x^-2)^(1/2)+-1//42*b*c^-1*x^6*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^5*(a+b*arcsec(c*x)), x) == :(1//6*x^6*(a+b*arcsec(c*x))+-4//45*b*x*c^-5*(1+-1*c^-2*x^-2)^(1/2)+-2//45*b*c^-3*x^3*(1+-1*c^-2*x^-2)^(1/2)+-1//30*b*c^-1*x^5*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^4*(a+b*arcsec(c*x)), x) == :(1//5*x^5*(a+b*arcsec(c*x))+-3//40*b*c^-5*arctanh((1+-1*c^-2*x^-2)^(1/2))+-3//40*b*c^-3*x^2*(1+-1*c^-2*x^-2)^(1/2)+-1//20*b*c^-1*x^4*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^3*(a+b*arcsec(c*x)), x) == :(1//4*x^4*(a+b*arcsec(c*x))+-1//6*b*x*c^-3*(1+-1*c^-2*x^-2)^(1/2)+-1//12*b*c^-1*x^3*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^2*(a+b*arcsec(c*x)), x) == :(1//3*x^3*(a+b*arcsec(c*x))+-1//6*b*c^-3*arctanh((1+-1*c^-2*x^-2)^(1/2))+-1//6*b*c^-1*x^2*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x*(a+b*arcsec(c*x)), x) == :((1/2)*x^2*(a+b*arcsec(c*x))+-1//2*b*x*c^-1*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(a+b*arcsec(c*x), x) == :(a*x+b*x*arcsec(c*x)+-1*b*c^-1*arctanh((1+-1*c^-2*x^-2)^(1/2)))
	@test integrate(x^-1*(a+b*arcsec(c*x)), x) == :(-1*(a+b*arcsec(c*x))*log(1+exp(2*im*arcsec(c*x)))+(1/2)*im*b*Polylogarithms.polylog(2,-1*exp(2*im*arcsec(c*x)))+(1/2)*im*b^-1*(a+b*arcsec(c*x))^2)
	@test integrate(x^-2*(a+b*arcsec(c*x)), x) == :(-1*x^-1*(a+b*arcsec(c*x))+b*c*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^-3*(a+b*arcsec(c*x)), x) == :(-1//2*x^-2*(a+b*arcsec(c*x))+-1//4*b*c^2*arccsc(c*x)+1//4*b*c*x^-1*(1+-1*c^-2*x^-2)^(1/2))
end

@testset "5.5.2 Inverse secant functions.jl" begin
	@test integrate(x^-1*arcsec(a*x^5), x) == :(-1//5*arcsec(a*x^5)*log(1+exp(2*im*arcsec(a*x^5)))+1//10*im*arcsec(a*x^5)^2+1//10*im*Polylogarithms.polylog(2,-1*exp(2*im*arcsec(a*x^5))))
	@test integrate(x^3*arcsec(x^(1/2)), x) == :(-3//20*(-1+x)^5//2+-1//4*(-1+x)^(1/2)+-1//4*(-1+x)^3//2+-1//28*(-1+x)^7//2+1//4*x^4*arcsec(x^(1/2)))
	@test integrate(x^2*arcsec(x^(1/2)), x) == :(-2//9*(-1+x)^3//2+-1//3*(-1+x)^(1/2)+-1//15*(-1+x)^5//2+1//3*x^3*arcsec(x^(1/2)))
	@test integrate(x*arcsec(x^(1/2)), x) == :(-1//2*(-1+x)^(1/2)+-1//6*(-1+x)^3//2+(1/2)*x^2*arcsec(x^(1/2)))
	@test integrate(arcsec(x^(1/2)), x) == :(-1*(-1+x)^(1/2)+x*arcsec(x^(1/2)))
	@test integrate(x^-1*arcsec(x^(1/2)), x) == :(im*arcsec(x^(1/2))^2+im*Polylogarithms.polylog(2,-1*exp(2*im*arcsec(x^(1/2))))+-2*arcsec(x^(1/2))*log(1+exp(2*im*arcsec(x^(1/2)))))
	@test integrate(x^-2*arcsec(x^(1/2)), x) == :((1/2)*arctan((-1+x)^(1/2))+(1/2)*x^-1*(-1+x)^(1/2)+-1*x^-1*arcsec(x^(1/2)))
	@test integrate(x^-3*arcsec(x^(1/2)), x) == :(3//16*arctan((-1+x)^(1/2))+-1//2*x^-2*arcsec(x^(1/2))+1//8*x^-2*(-1+x)^(1/2)+3//16*x^-1*(-1+x)^(1/2))
	@test integrate(x^-4*arcsec(x^(1/2)), x) == :(5//48*arctan((-1+x)^(1/2))+-1//3*x^-3*arcsec(x^(1/2))+1//18*x^-3*(-1+x)^(1/2)+5//48*x^-1*(-1+x)^(1/2)+5//72*x^-2*(-1+x)^(1/2))
	@test integrate(x^2*arcsec(a*x^-1), x) == :(-1//3*a^3*(1+-1*a^-2*x^2)^(1/2)+1//3*x^3*arccos(x*a^-1)+1//9*a^3*(1+-1*a^-2*x^2)^3//2)
end

@testset "5.6.1 u (a+b arccsc(c x))^n.jl" begin
	@test integrate(x^6*(a+b*arccsc(c*x)), x) == :(1//7*x^7*(a+b*arccsc(c*x))+5//112*b*c^-7*arctanh((1+-1*c^-2*x^-2)^(1/2))+1//42*b*c^-1*x^6*(1+-1*c^-2*x^-2)^(1/2)+5//112*b*c^-5*x^2*(1+-1*c^-2*x^-2)^(1/2)+5//168*b*c^-3*x^4*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^5*(a+b*arccsc(c*x)), x) == :(1//6*x^6*(a+b*arccsc(c*x))+1//30*b*c^-1*x^5*(1+-1*c^-2*x^-2)^(1/2)+2//45*b*c^-3*x^3*(1+-1*c^-2*x^-2)^(1/2)+4//45*b*x*c^-5*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^4*(a+b*arccsc(c*x)), x) == :(1//5*x^5*(a+b*arccsc(c*x))+3//40*b*c^-5*arctanh((1+-1*c^-2*x^-2)^(1/2))+1//20*b*c^-1*x^4*(1+-1*c^-2*x^-2)^(1/2)+3//40*b*c^-3*x^2*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^3*(a+b*arccsc(c*x)), x) == :(1//4*x^4*(a+b*arccsc(c*x))+1//6*b*x*c^-3*(1+-1*c^-2*x^-2)^(1/2)+1//12*b*c^-1*x^3*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^2*(a+b*arccsc(c*x)), x) == :(1//3*x^3*(a+b*arccsc(c*x))+1//6*b*c^-3*arctanh((1+-1*c^-2*x^-2)^(1/2))+1//6*b*c^-1*x^2*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x*(a+b*arccsc(c*x)), x) == :((1/2)*x^2*(a+b*arccsc(c*x))+(1/2)*b*x*c^-1*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(a+b*arccsc(c*x), x) == :(a*x+b*x*arccsc(c*x)+b*c^-1*arctanh((1+-1*c^-2*x^-2)^(1/2)))
	@test integrate(x^-1*(a+b*arccsc(c*x)), x) == :(-1*(a+b*arccsc(c*x))*log(1+-1*exp(2*im*arccsc(c*x)))+(1/2)*im*b*Polylogarithms.polylog(2,exp(2*im*arccsc(c*x)))+(1/2)*im*b^-1*(a+b*arccsc(c*x))^2)
	@test integrate(x^-2*(a+b*arccsc(c*x)), x) == :(-1*x^-1*(a+b*arccsc(c*x))+-1*b*c*(1+-1*c^-2*x^-2)^(1/2))
	@test integrate(x^-3*(a+b*arccsc(c*x)), x) == :(-1//2*x^-2*(a+b*arccsc(c*x))+1//4*b*c^2*arccsc(c*x)+-1//4*b*c*x^-1*(1+-1*c^-2*x^-2)^(1/2))
end

@testset "5.6.2 Inverse cosecant functions.jl" begin
	@test integrate(x^-1*arccsc(a*x^5), x) == :(-1//5*arccsc(a*x^5)*log(1+-1*exp(2*im*arccsc(a*x^5)))+1//10*im*arccsc(a*x^5)^2+1//10*im*Polylogarithms.polylog(2,exp(2*im*arccsc(a*x^5))))
	@test integrate(x^3*arccsc(x^(1/2)), x) == :(1//4*(-1+x)^(1/2)+1//4*(-1+x)^3//2+1//28*(-1+x)^7//2+3//20*(-1+x)^5//2+1//4*x^4*arccsc(x^(1/2)))
	@test integrate(x^2*arccsc(x^(1/2)), x) == :(1//3*(-1+x)^(1/2)+1//15*(-1+x)^5//2+2//9*(-1+x)^3//2+1//3*x^3*arccsc(x^(1/2)))
	@test integrate(x*arccsc(x^(1/2)), x) == :((1/2)*(-1+x)^(1/2)+1//6*(-1+x)^3//2+(1/2)*x^2*arccsc(x^(1/2)))
	@test integrate(arccsc(x^(1/2)), x) == :((-1+x)^(1/2)+x*arccsc(x^(1/2)))
	@test integrate(x^-1*arccsc(x^(1/2)), x) == :(im*arccsc(x^(1/2))^2+im*Polylogarithms.polylog(2,exp(2*im*arccsc(x^(1/2))))+-2*arccsc(x^(1/2))*log(1+-1*exp(2*im*arccsc(x^(1/2)))))
	@test integrate(x^-2*arccsc(x^(1/2)), x) == :(-1//2*arctan((-1+x)^(1/2))+-1*x^-1*arccsc(x^(1/2))+-1//2*x^-1*(-1+x)^(1/2))
	@test integrate(x^-3*arccsc(x^(1/2)), x) == :(-3//16*arctan((-1+x)^(1/2))+-3//16*x^-1*(-1+x)^(1/2)+-1//2*x^-2*arccsc(x^(1/2))+-1//8*x^-2*(-1+x)^(1/2))
	@test integrate(x^2*arccsc(a*x^-1), x) == :(-1//9*a^3*(1+-1*a^-2*x^2)^3//2+1//3*a^3*(1+-1*a^-2*x^2)^(1/2)+1//3*x^3*arcsin(x*a^-1))
	@test integrate(x*arccsc(a*x^-1), x) == :((1/2)*x^2*arcsin(x*a^-1)+-1//4*a^2*arcsin(x*a^-1)+1//4*a*x*(1+-1*a^-2*x^2)^(1/2))
end

@testset "6.1.1 (c+d x)^m (a+b sinh)^n.jl" begin
	@test integrate((c+d*x)^4*sinh(a+b*x), x) == :(b^-1*(c+d*x)^4*cosh(a+b*x)+24*b^-5*d^4*cosh(a+b*x)+-24*b^-4*d^3*(c+d*x)*sinh(a+b*x)+-4*d*b^-2*(c+d*x)^3*sinh(a+b*x)+12*b^-3*d^2*(c+d*x)^2*cosh(a+b*x))
	@test integrate((c+d*x)^3*sinh(a+b*x), x) == :(b^-1*(c+d*x)^3*cosh(a+b*x)+-6*b^-4*d^3*sinh(a+b*x)+-3*d*b^-2*(c+d*x)^2*sinh(a+b*x)+6*b^-3*d^2*(c+d*x)*cosh(a+b*x))
	@test integrate((c+d*x)^2*sinh(a+b*x), x) == :(b^-1*(c+d*x)^2*cosh(a+b*x)+2*b^-3*d^2*cosh(a+b*x)+-2*d*b^-2*(c+d*x)*sinh(a+b*x))
	@test integrate((c+d*x)*sinh(a+b*x), x) == :(b^-1*(c+d*x)*cosh(a+b*x)+-1*d*b^-2*sinh(a+b*x))
	@test integrate((c+d*x)^-1*sinh(a+b*x), x) == :(d^-1*cosh(a+-1*b*c*d^-1)*sinhintegral(b*x+b*c*d^-1)+d^-1*coshintegral(b*x+b*c*d^-1)*sinh(a+-1*b*c*d^-1))
	@test integrate((c+d*x)^-2*sinh(a+b*x), x) == :(-1*d^-1*(c+d*x)^-1*sinh(a+b*x)+b*d^-2*cosh(a+-1*b*c*d^-1)*coshintegral(b*x+b*c*d^-1)+b*d^-2*sinh(a+-1*b*c*d^-1)*sinhintegral(b*x+b*c*d^-1))
	@test integrate((c+d*x)^-3*sinh(a+b*x), x) == :(-1//2*d^-1*(c+d*x)^-2*sinh(a+b*x)+(1/2)*b^2*d^-3*cosh(a+-1*b*c*d^-1)*sinhintegral(b*x+b*c*d^-1)+(1/2)*b^2*d^-3*coshintegral(b*x+b*c*d^-1)*sinh(a+-1*b*c*d^-1)+-1//2*b*d^-2*(c+d*x)^-1*cosh(a+b*x))
	@test integrate((c+d*x)^4*sinh(a+b*x)^2, x) == :(-1//10*d^-1*(c+d*x)^5+-3//4*x*b^-4*d^4+-1//2*d*b^-2*(c+d*x)^3+(1/2)*b^-1*(c+d*x)^4*cosh(a+b*x)*sinh(a+b*x)+-1*d*b^-2*(c+d*x)^3*sinh(a+b*x)^2+-3//2*b^-4*d^3*sinh(a+b*x)^2*(c+d*x)+3//4*b^-5*d^4*cosh(a+b*x)*sinh(a+b*x)+3//2*b^-3*d^2*(c+d*x)^2*cosh(a+b*x)*sinh(a+b*x))
	@test integrate((c+d*x)^3*sinh(a+b*x)^2, x) == :(-1//8*d^-1*(c+d*x)^4+-3//8*b^-4*d^3*sinh(a+b*x)^2+-3//8*b^-2*d^3*x^2+(1/2)*b^-1*(c+d*x)^3*cosh(a+b*x)*sinh(a+b*x)+-3//4*c*x*b^-2*d^2+-3//4*d*b^-2*(c+d*x)^2*sinh(a+b*x)^2+3//4*b^-3*d^2*(c+d*x)*cosh(a+b*x)*sinh(a+b*x))
	@test integrate((c+d*x)^2*sinh(a+b*x)^2, x) == :(-1//6*d^-1*(c+d*x)^3+-1//4*x*b^-2*d^2+(1/2)*b^-1*(c+d*x)^2*cosh(a+b*x)*sinh(a+b*x)+-1//2*d*b^-2*sinh(a+b*x)^2*(c+d*x)+1//4*b^-3*d^2*cosh(a+b*x)*sinh(a+b*x))
end

@testset "6.1.3 (e x)^m (a+b sinh(c+d x^n))^p.jl" begin
	@test integrate(x^3*sinh(a+b*x^2), x) == :(-1//2*b^-2*sinh(a+b*x^2)+(1/2)*b^-1*x^2*cosh(a+b*x^2))
	@test integrate(x^2*sinh(a+b*x^2), x) == :((1/2)*x*b^-1*cosh(a+b*x^2)+-1//8*pi^(1/2)*b^-3//2*erf(x*b^(1/2))*exp(-1a)+-1//8*pi^(1/2)*b^-3//2*erfi(x*b^(1/2))*exp(a))
	@test integrate(x*sinh(a+b*x^2), x) == :((1/2)*b^-1*cosh(a+b*x^2))
	@test integrate(sinh(a+b*x^2), x) == :(-1//4*pi^(1/2)*b^-1//2*erf(x*b^(1/2))*exp(-1a)+1//4*pi^(1/2)*b^-1//2*erfi(x*b^(1/2))*exp(a))
	@test integrate(x^-1*sinh(a+b*x^2), x) == :((1/2)*cosh(a)*sinhintegral(b*x^2)+(1/2)*coshintegral(b*x^2)*sinh(a))
	@test integrate(x^-2*sinh(a+b*x^2), x) == :(-1*x^-1*sinh(a+b*x^2)+(1/2)*pi^(1/2)*b^(1/2)*erf(x*b^(1/2))*exp(-1a)+(1/2)*pi^(1/2)*b^(1/2)*erfi(x*b^(1/2))*exp(a))
	@test integrate(x^-3*sinh(a+b*x^2), x) == :(-1//2*x^-2*sinh(a+b*x^2)+(1/2)*b*cosh(a)*coshintegral(b*x^2)+(1/2)*b*sinh(a)*sinhintegral(b*x^2))
	@test integrate(x^3*sinh(a+b*x^2)^2, x) == :(-1//8*x^4+-1//8*b^-2*sinh(a+b*x^2)^2+1//4*b^-1*x^2*cosh(a+b*x^2)*sinh(a+b*x^2))
	@test integrate(x^2*sinh(a+b*x^2)^2, x) == :(-1//6*x^3+1//8*x*b^-1*sinh(2a+2*b*x^2)+-1//64*2^(1/2)*pi^(1/2)*b^-3//2*erfi(x*2^(1/2)*b^(1/2))*exp(2a)+1//64*2^(1/2)*pi^(1/2)*b^-3//2*erf(x*2^(1/2)*b^(1/2))*exp(-2a))
	@test integrate(x*sinh(a+b*x^2)^2, x) == :(-1//4*x^2+1//4*b^-1*cosh(a+b*x^2)*sinh(a+b*x^2))
end

@testset "6.1.4 (d+e x)^m sinh(a+b x+c x^2)^n.jl" begin
	@test integrate(x^2*sinh(a+b*x+c*x^2), x) == :((1/2)*x*c^-1*cosh(a+b*x+c*x^2)+-1//4*b*c^-2*cosh(a+b*x+c*x^2)+-1//8*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+-1//8*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1)+-1//16*pi^(1/2)*b^2*c^-5//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//16*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
	@test integrate(x*sinh(a+b*x+c*x^2), x) == :((1/2)*c^-1*cosh(a+b*x+c*x^2)+-1//8*b*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1)+1//8*b*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1))
	@test integrate(sinh(a+b*x+c*x^2), x) == :(-1//4*pi^(1/2)*c^-1//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//4*pi^(1/2)*c^-1//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
	@test integrate(x^-2*sinh(a+b*x+c*x^2)+-1*b*x^-1*cosh(a+b*x+c*x^2), x) == :(-1*x^-1*sinh(a+b*x+c*x^2)+(1/2)*pi^(1/2)*c^(1/2)*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+(1/2)*pi^(1/2)*c^(1/2)*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
	@test integrate(x^2*sinh(a+b*x+-1*c*x^2), x) == :(-1//2*x*c^-1*cosh(a+b*x+-1*c*x^2)+-1//4*b*c^-2*cosh(a+b*x+-1*c*x^2)+-1//8*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+-1//8*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1)+-1//16*pi^(1/2)*b^2*c^-5//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+1//16*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(x*sinh(a+b*x+-1*c*x^2), x) == :(-1//2*c^-1*cosh(a+b*x+-1*c*x^2)+-1//8*b*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+1//8*b*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(sinh(a+b*x+-1*c*x^2), x) == :(-1//4*pi^(1/2)*c^-1//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+1//4*pi^(1/2)*c^-1//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(x^-2*sinh(a+b*x+-1*c*x^2)+-1*b*x^-1*cosh(a+b*x+-1*c*x^2), x) == :(-1*x^-1*sinh(a+b*x+-1*c*x^2)+(1/2)*pi^(1/2)*c^(1/2)*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+(1/2)*pi^(1/2)*c^(1/2)*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(x^2*sinh(1//4+x+x^2), x) == :(-1//4*cosh(1//4+x+x^2)+(1/2)*x*cosh(1//4+x+x^2)+-3//16*pi^(1/2)*erf(1/2+x)+-1//16*pi^(1/2)*erfi(1/2+x))
	@test integrate(x*sinh(1//4+x+x^2), x) == :((1/2)*cosh(1//4+x+x^2)+-1//8*pi^(1/2)*erfi(1/2+x)+1//8*pi^(1/2)*erf(1/2+x))
end

@testset "6.1.5 Hyperbolic sine functions.jl" begin
	@test integrate(sinh(a+b*x), x) == :(b^-1*cosh(a+b*x))
	@test integrate(sinh(a+b*x)^2, x) == :(-1//2*x+(1/2)*b^-1*cosh(a+b*x)*sinh(a+b*x))
	@test integrate(sinh(a+b*x)^3, x) == :(-1*b^-1*cosh(a+b*x)+1//3*b^-1*cosh(a+b*x)^3)
	@test integrate(sinh(a+b*x)^4, x) == :(3//8*x+-3//8*b^-1*cosh(a+b*x)*sinh(a+b*x)+1//4*b^-1*sinh(a+b*x)^3*cosh(a+b*x))
	@test integrate(sinh(a+b*x)^5, x) == :(b^-1*cosh(a+b*x)+-2//3*b^-1*cosh(a+b*x)^3+1//5*b^-1*cosh(a+b*x)^5)
	@test integrate(sinh(a+b*x)^6, x) == :(-5//16*x+-5//24*b^-1*sinh(a+b*x)^3*cosh(a+b*x)+1//6*b^-1*sinh(a+b*x)^5*cosh(a+b*x)+5//16*b^-1*cosh(a+b*x)*sinh(a+b*x))
	@test integrate(sinh(a+b*x)^7//2, x) == :(-10//21*b^-1*sinh(a+b*x)^(1/2)*cosh(a+b*x)+2//7*b^-1*sinh(a+b*x)^5//2*cosh(a+b*x)+-10//21*im*b^-1*(im*sinh(a+b*x))^(1/2)*sinh(a+b*x)^-1//2*Elliptic.F(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
	@test integrate(sinh(a+b*x)^5//2, x) == :(2//5*b^-1*sinh(a+b*x)^3//2*cosh(a+b*x)+6//5*im*b^-1*(im*sinh(a+b*x))^-1//2*sinh(a+b*x)^(1/2)*Elliptic.E(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
	@test integrate(sinh(a+b*x)^3//2, x) == :(2//3*b^-1*sinh(a+b*x)^(1/2)*cosh(a+b*x)+2//3*im*b^-1*(im*sinh(a+b*x))^(1/2)*sinh(a+b*x)^-1//2*Elliptic.F(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
	@test integrate(sinh(a+b*x)^(1/2), x) == :(-2*im*b^-1*(im*sinh(a+b*x))^-1//2*sinh(a+b*x)^(1/2)*Elliptic.E(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
end

@testset "6.1.7 hyper^m (a+b sinh^n)^p.jl" begin
	@test integrate(sinh(c+d*x)^4*(a+b*sinh(c+d*x)^2), x) == :(1//16*x*(-5b+6a)+-1//16*d^-1*(-5b+6a)*cosh(c+d*x)*sinh(c+d*x)+1//6*b*d^-1*sinh(c+d*x)^5*cosh(c+d*x)+1//24*d^-1*sinh(c+d*x)^3*(-5b+6a)*cosh(c+d*x))
	@test integrate(sinh(c+d*x)^3*(a+b*sinh(c+d*x)^2), x) == :(-1*d^-1*(a+-1b)*cosh(c+d*x)+1//3*d^-1*cosh(c+d*x)^3*(a+-2b)+1//5*b*d^-1*cosh(c+d*x)^5)
	@test integrate(sinh(c+d*x)^2*(a+b*sinh(c+d*x)^2), x) == :(-1//8*x*(-3b+4a)+1//4*b*d^-1*sinh(c+d*x)^3*cosh(c+d*x)+1//8*d^-1*(-3b+4a)*cosh(c+d*x)*sinh(c+d*x))
	@test integrate((a+b*sinh(c+d*x)^2)*sinh(c+d*x), x) == :(d^-1*(a+-1b)*cosh(c+d*x)+1//3*b*d^-1*cosh(c+d*x)^3)
	@test integrate(a+b*sinh(c+d*x)^2, x) == :(a*x+-1//2*b*x+(1/2)*b*d^-1*cosh(c+d*x)*sinh(c+d*x))
	@test integrate((a+b*sinh(c+d*x)^2)*csch(c+d*x), x) == :(b*d^-1*cosh(c+d*x)+-1*a*d^-1*arctanh(cosh(c+d*x)))
	@test integrate(csch(c+d*x)^2*(a+b*sinh(c+d*x)^2), x) == :(b*x+-1*a*d^-1*coth(c+d*x))
	@test integrate(csch(c+d*x)^3*(a+b*sinh(c+d*x)^2), x) == :((1/2)*d^-1*(a+-2b)*arctanh(cosh(c+d*x))+-1//2*a*d^-1*coth(c+d*x)*csch(c+d*x))
	@test integrate(csch(c+d*x)^4*(a+b*sinh(c+d*x)^2), x) == :(1//3*d^-1*(-3b+2a)*coth(c+d*x)+-1//3*a*d^-1*csch(c+d*x)^2*coth(c+d*x))
	@test integrate((a+b*sinh(c+d*x)^2)^2*sinh(c+d*x)^4, x) == :(x*(3//8*a^2+35//128*b^2+-5//8*a*b)+-1//128*d^-1*(80*a^2+93*b^2+-176*a*b)*cosh(c+d*x)*sinh(c+d*x)+1//8*b^2*d^-1*cosh(c+d*x)^3*sinh(c+d*x)^5+1//192*d^-1*cosh(c+d*x)^3*(48*a^2+139*b^2+-208*a*b)*sinh(c+d*x)+1//48*b*d^-1*cosh(c+d*x)^5*(-13b+16a)*sinh(c+d*x))
end

@testset "6.2.1 (c+d x)^m (a+b cosh)^n.jl" begin
	@test integrate((c+d*x)^4*cosh(a+b*x), x) == :(b^-1*(c+d*x)^4*sinh(a+b*x)+24*b^-5*d^4*sinh(a+b*x)+-24*b^-4*d^3*(c+d*x)*cosh(a+b*x)+-4*d*b^-2*(c+d*x)^3*cosh(a+b*x)+12*b^-3*d^2*(c+d*x)^2*sinh(a+b*x))
	@test integrate((c+d*x)^3*cosh(a+b*x), x) == :(b^-1*(c+d*x)^3*sinh(a+b*x)+-6*b^-4*d^3*cosh(a+b*x)+-3*d*b^-2*(c+d*x)^2*cosh(a+b*x)+6*b^-3*d^2*(c+d*x)*sinh(a+b*x))
	@test integrate((c+d*x)^2*cosh(a+b*x), x) == :(b^-1*(c+d*x)^2*sinh(a+b*x)+2*b^-3*d^2*sinh(a+b*x)+-2*d*b^-2*(c+d*x)*cosh(a+b*x))
	@test integrate((c+d*x)*cosh(a+b*x), x) == :(b^-1*(c+d*x)*sinh(a+b*x)+-1*d*b^-2*cosh(a+b*x))
	@test integrate((c+d*x)^-1*cosh(a+b*x), x) == :(d^-1*cosh(a+-1*b*c*d^-1)*coshintegral(b*x+b*c*d^-1)+d^-1*sinh(a+-1*b*c*d^-1)*sinhintegral(b*x+b*c*d^-1))
	@test integrate((c+d*x)^-2*cosh(a+b*x), x) == :(-1*d^-1*(c+d*x)^-1*cosh(a+b*x)+b*d^-2*cosh(a+-1*b*c*d^-1)*sinhintegral(b*x+b*c*d^-1)+b*d^-2*coshintegral(b*x+b*c*d^-1)*sinh(a+-1*b*c*d^-1))
	@test integrate((c+d*x)^-3*cosh(a+b*x), x) == :(-1//2*d^-1*(c+d*x)^-2*cosh(a+b*x)+(1/2)*b^2*d^-3*cosh(a+-1*b*c*d^-1)*coshintegral(b*x+b*c*d^-1)+(1/2)*b^2*d^-3*sinh(a+-1*b*c*d^-1)*sinhintegral(b*x+b*c*d^-1)+-1//2*b*d^-2*(c+d*x)^-1*sinh(a+b*x))
	@test integrate((c+d*x)^4*cosh(a+b*x)^2, x) == :(1//10*d^-1*(c+d*x)^5+(1/2)*d*b^-2*(c+d*x)^3+3//4*x*b^-4*d^4+(1/2)*b^-1*(c+d*x)^4*cosh(a+b*x)*sinh(a+b*x)+-1*d*b^-2*(c+d*x)^3*cosh(a+b*x)^2+-3//2*b^-4*d^3*cosh(a+b*x)^2*(c+d*x)+3//4*b^-5*d^4*cosh(a+b*x)*sinh(a+b*x)+3//2*b^-3*d^2*(c+d*x)^2*cosh(a+b*x)*sinh(a+b*x))
	@test integrate((c+d*x)^3*cosh(a+b*x)^2, x) == :(1//8*d^-1*(c+d*x)^4+-3//8*b^-4*d^3*cosh(a+b*x)^2+3//8*b^-2*d^3*x^2+(1/2)*b^-1*(c+d*x)^3*cosh(a+b*x)*sinh(a+b*x)+-3//4*d*b^-2*(c+d*x)^2*cosh(a+b*x)^2+3//4*c*x*b^-2*d^2+3//4*b^-3*d^2*(c+d*x)*cosh(a+b*x)*sinh(a+b*x))
	@test integrate((c+d*x)^2*cosh(a+b*x)^2, x) == :(1//6*d^-1*(c+d*x)^3+1//4*x*b^-2*d^2+(1/2)*b^-1*(c+d*x)^2*cosh(a+b*x)*sinh(a+b*x)+-1//2*d*b^-2*cosh(a+b*x)^2*(c+d*x)+1//4*b^-3*d^2*cosh(a+b*x)*sinh(a+b*x))
end

@testset "6.2.2 (e x)^m (a+b x^n)^p cosh.jl" begin
	@test integrate(x^3*(a+b*x)*cosh(c+d*x), x) == :(-6*a*d^-4*cosh(c+d*x)+24*b*d^-5*sinh(c+d*x)+a*d^-1*x^3*sinh(c+d*x)+b*d^-1*x^4*sinh(c+d*x)+-24*b*x*d^-4*cosh(c+d*x)+-4*b*d^-2*x^3*cosh(c+d*x)+-3*a*d^-2*x^2*cosh(c+d*x)+6*a*x*d^-3*sinh(c+d*x)+12*b*d^-3*x^2*sinh(c+d*x))
	@test integrate(x^2*(a+b*x)*cosh(c+d*x), x) == :(-6*b*d^-4*cosh(c+d*x)+2*a*d^-3*sinh(c+d*x)+a*d^-1*x^2*sinh(c+d*x)+b*d^-1*x^3*sinh(c+d*x)+-3*b*d^-2*x^2*cosh(c+d*x)+-2*a*x*d^-2*cosh(c+d*x)+6*b*x*d^-3*sinh(c+d*x))
	@test integrate(x*(a+b*x)*cosh(c+d*x), x) == :(-1*a*d^-2*cosh(c+d*x)+2*b*d^-3*sinh(c+d*x)+a*x*d^-1*sinh(c+d*x)+b*d^-1*x^2*sinh(c+d*x)+-2*b*x*d^-2*cosh(c+d*x))
	@test integrate((a+b*x)*cosh(c+d*x), x) == :(d^-1*(a+b*x)*sinh(c+d*x)+-1*b*d^-2*cosh(c+d*x))
	@test integrate(x^-1*(a+b*x)*cosh(c+d*x), x) == :(a*cosh(c)*coshintegral(d*x)+a*sinh(c)*sinhintegral(d*x)+b*d^-1*sinh(c+d*x))
	@test integrate(x^-2*(a+b*x)*cosh(c+d*x), x) == :(b*cosh(c)*coshintegral(d*x)+b*sinh(c)*sinhintegral(d*x)+-1*a*x^-1*cosh(c+d*x)+a*d*cosh(c)*sinhintegral(d*x)+a*d*coshintegral(d*x)*sinh(c))
	@test integrate(x^-3*(a+b*x)*cosh(c+d*x), x) == :(-1*b*x^-1*cosh(c+d*x)+-1//2*a*x^-2*cosh(c+d*x)+b*d*cosh(c)*sinhintegral(d*x)+b*d*coshintegral(d*x)*sinh(c)+(1/2)*a*d^2*cosh(c)*coshintegral(d*x)+(1/2)*a*d^2*sinh(c)*sinhintegral(d*x)+-1//2*a*d*x^-1*sinh(c+d*x))
	@test integrate(x^-4*(a+b*x)*cosh(c+d*x), x) == :(-1//2*b*x^-2*cosh(c+d*x)+-1//3*a*x^-3*cosh(c+d*x)+(1/2)*b*d^2*cosh(c)*coshintegral(d*x)+(1/2)*b*d^2*sinh(c)*sinhintegral(d*x)+-1//2*b*d*x^-1*sinh(c+d*x)+-1//6*a*d*x^-2*sinh(c+d*x)+-1//6*a*d^2*x^-1*cosh(c+d*x)+1//6*a*d^3*cosh(c)*sinhintegral(d*x)+1//6*a*d^3*coshintegral(d*x)*sinh(c))
	@test integrate(x^-5*(a+b*x)*cosh(c+d*x), x) == :(-1//3*b*x^-3*cosh(c+d*x)+-1//4*a*x^-4*cosh(c+d*x)+-1//6*b*d*x^-2*sinh(c+d*x)+-1//6*b*d^2*x^-1*cosh(c+d*x)+-1//12*a*d*x^-3*sinh(c+d*x)+-1//24*a*d^2*x^-2*cosh(c+d*x)+-1//24*a*d^3*x^-1*sinh(c+d*x)+1//6*b*d^3*cosh(c)*sinhintegral(d*x)+1//6*b*d^3*coshintegral(d*x)*sinh(c)+1//24*a*d^4*cosh(c)*coshintegral(d*x)+1//24*a*d^4*sinh(c)*sinhintegral(d*x))
	@test integrate(x^2*(a+b*x)^2*cosh(c+d*x), x) == :(2*a^2*d^-3*sinh(c+d*x)+24*b^2*d^-5*sinh(c+d*x)+a^2*d^-1*x^2*sinh(c+d*x)+b^2*d^-1*x^4*sinh(c+d*x)+-24*x*b^2*d^-4*cosh(c+d*x)+-12*a*b*d^-4*cosh(c+d*x)+-4*b^2*d^-2*x^3*cosh(c+d*x)+-2*x*a^2*d^-2*cosh(c+d*x)+12*b^2*d^-3*x^2*sinh(c+d*x)+-6*a*b*d^-2*x^2*cosh(c+d*x)+2*a*b*d^-1*x^3*sinh(c+d*x)+12*a*b*x*d^-3*sinh(c+d*x))
end

@testset "6.2.3 (e x)^m (a+b cosh(c+d x^n))^p.jl" begin
	@test integrate(x^3*cosh(a+b*x^2), x) == :(-1//2*b^-2*cosh(a+b*x^2)+(1/2)*b^-1*x^2*sinh(a+b*x^2))
	@test integrate(x^2*cosh(a+b*x^2), x) == :((1/2)*x*b^-1*sinh(a+b*x^2)+-1//8*pi^(1/2)*b^-3//2*erfi(x*b^(1/2))*exp(a)+1//8*pi^(1/2)*b^-3//2*erf(x*b^(1/2))*exp(-1a))
	@test integrate(x*cosh(a+b*x^2), x) == :((1/2)*b^-1*sinh(a+b*x^2))
	@test integrate(cosh(a+b*x^2), x) == :(1//4*pi^(1/2)*b^-1//2*erf(x*b^(1/2))*exp(-1a)+1//4*pi^(1/2)*b^-1//2*erfi(x*b^(1/2))*exp(a))
	@test integrate(x^-1*cosh(a+b*x^2), x) == :((1/2)*cosh(a)*coshintegral(b*x^2)+(1/2)*sinh(a)*sinhintegral(b*x^2))
	@test integrate(x^-2*cosh(a+b*x^2), x) == :(-1*x^-1*cosh(a+b*x^2)+(1/2)*pi^(1/2)*b^(1/2)*erfi(x*b^(1/2))*exp(a)+-1//2*pi^(1/2)*b^(1/2)*erf(x*b^(1/2))*exp(-1a))
	@test integrate(x^-3*cosh(a+b*x^2), x) == :(-1//2*x^-2*cosh(a+b*x^2)+(1/2)*b*cosh(a)*sinhintegral(b*x^2)+(1/2)*b*coshintegral(b*x^2)*sinh(a))
	@test integrate(x^3*cosh(a+b*x^2)^2, x) == :(1//8*x^4+-1//8*b^-2*cosh(a+b*x^2)^2+1//4*b^-1*x^2*cosh(a+b*x^2)*sinh(a+b*x^2))
	@test integrate(x^2*cosh(a+b*x^2)^2, x) == :(1//6*x^3+1//8*x*b^-1*sinh(2a+2*b*x^2)+-1//64*2^(1/2)*pi^(1/2)*b^-3//2*erfi(x*2^(1/2)*b^(1/2))*exp(2a)+1//64*2^(1/2)*pi^(1/2)*b^-3//2*erf(x*2^(1/2)*b^(1/2))*exp(-2a))
	@test integrate(x*cosh(a+b*x^2)^2, x) == :(1//4*x^2+1//4*b^-1*cosh(a+b*x^2)*sinh(a+b*x^2))
end

@testset "6.2.4 (d+e x)^m cosh(a+b x+c x^2)^n.jl" begin
	@test integrate(x^2*cosh(a+b*x+c*x^2), x) == :((1/2)*x*c^-1*sinh(a+b*x+c*x^2)+-1//4*b*c^-2*sinh(a+b*x+c*x^2)+-1//8*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1)+1//8*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//16*pi^(1/2)*b^2*c^-5//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//16*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
	@test integrate(x*cosh(a+b*x+c*x^2), x) == :((1/2)*c^-1*sinh(a+b*x+c*x^2)+-1//8*b*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+-1//8*b*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
	@test integrate(cosh(a+b*x+c*x^2), x) == :(1//4*pi^(1/2)*c^-1//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//4*pi^(1/2)*c^-1//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
	@test integrate(x^-2*cosh(a+b*x+c*x^2)+-1*b*x^-1*sinh(a+b*x+c*x^2), x) == :(-1*x^-1*cosh(a+b*x+c*x^2)+(1/2)*pi^(1/2)*c^(1/2)*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1)+-1//2*pi^(1/2)*c^(1/2)*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1))
	@test integrate(x^2*cosh(a+b*x+-1*c*x^2), x) == :(-1//2*x*c^-1*sinh(a+b*x+-1*c*x^2)+-1//4*b*c^-2*sinh(a+b*x+-1*c*x^2)+-1//8*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+1//8*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1)+-1//16*pi^(1/2)*b^2*c^-5//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+-1//16*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(x*cosh(a+b*x+-1*c*x^2), x) == :(-1//2*c^-1*sinh(a+b*x+-1*c*x^2)+-1//8*b*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+-1//8*b*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(cosh(a+b*x+-1*c*x^2), x) == :(-1//4*pi^(1/2)*c^-1//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+-1//4*pi^(1/2)*c^-1//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(x^-2*cosh(a+b*x+-1*c*x^2)+-1*b*x^-1*sinh(a+b*x+-1*c*x^2), x) == :(-1*x^-1*cosh(a+b*x+-1*c*x^2)+(1/2)*pi^(1/2)*c^(1/2)*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+-1//2*pi^(1/2)*c^(1/2)*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
	@test integrate(x^2*cosh(1//4+x+x^2), x) == :(-1//4*sinh(1//4+x+x^2)+(1/2)*x*sinh(1//4+x+x^2)+-1//16*pi^(1/2)*erfi(1/2+x)+3//16*pi^(1/2)*erf(1/2+x))
	@test integrate(x*cosh(1//4+x+x^2), x) == :((1/2)*sinh(1//4+x+x^2)+-1//8*pi^(1/2)*erf(1/2+x)+-1//8*pi^(1/2)*erfi(1/2+x))
end

@testset "6.2.5 Hyperbolic cosine functions.jl" begin
	@test integrate(cosh(a+b*x), x) == :(b^-1*sinh(a+b*x))
	@test integrate(cosh(a+b*x)^2, x) == :((1/2)*x+(1/2)*b^-1*cosh(a+b*x)*sinh(a+b*x))
	@test integrate(cosh(a+b*x)^3, x) == :(b^-1*sinh(a+b*x)+1//3*b^-1*sinh(a+b*x)^3)
	@test integrate(cosh(a+b*x)^4, x) == :(3//8*x+1//4*b^-1*cosh(a+b*x)^3*sinh(a+b*x)+3//8*b^-1*cosh(a+b*x)*sinh(a+b*x))
	@test integrate(cosh(a+b*x)^5, x) == :(b^-1*sinh(a+b*x)+1//5*b^-1*sinh(a+b*x)^5+2//3*b^-1*sinh(a+b*x)^3)
	@test integrate(cosh(a+b*x)^6, x) == :(5//16*x+1//6*b^-1*cosh(a+b*x)^5*sinh(a+b*x)+5//16*b^-1*cosh(a+b*x)*sinh(a+b*x)+5//24*b^-1*cosh(a+b*x)^3*sinh(a+b*x))
	@test integrate(cosh(a+b*x)^7//2, x) == :(-10//21*im*b^-1*Elliptic.F((1/2)*im*(a+b*x),2)+2//7*b^-1*cosh(a+b*x)^5//2*sinh(a+b*x)+10//21*b^-1*cosh(a+b*x)^(1/2)*sinh(a+b*x))
	@test integrate(cosh(a+b*x)^5//2, x) == :(-6//5*im*b^-1*Elliptic.E((1/2)*im*(a+b*x),2)+2//5*b^-1*cosh(a+b*x)^3//2*sinh(a+b*x))
	@test integrate(cosh(a+b*x)^3//2, x) == :(-2//3*im*b^-1*Elliptic.F((1/2)*im*(a+b*x),2)+2//3*b^-1*cosh(a+b*x)^(1/2)*sinh(a+b*x))
	@test integrate(cosh(a+b*x)^(1/2), x) == :(-2*im*b^-1*Elliptic.E((1/2)*im*(a+b*x),2))
end

@testset "6.2.7 hyper^m (a+b cosh^n)^p.jl" begin
	@test integrate((a+-1*a*cosh(x)^2)^-1*sinh(x)^4, x) == :((1/2)*x*a^-1+-1//2*a^-1*cosh(x)*sinh(x))
	@test integrate((a+-1*a*cosh(x)^2)^-1*sinh(x)^3, x) == :(-1*a^-1*cosh(x))
	@test integrate((a+-1*a*cosh(x)^2)^-1*sinh(x)^2, x) == :(-1*x*a^-1)
	@test integrate((a+-1*a*cosh(x)^2)^-1*csch(x)^2, x) == :(-1*a^-1*coth(x)+1//3*a^-1*coth(x)^3)
	@test integrate((a+-1*a*cosh(x)^2)^-1*csch(x)^4, x) == :(a^-1*coth(x)+-2//3*a^-1*coth(x)^3+1//5*a^-1*coth(x)^5)
	@test integrate((a+b*cosh(x)^2)^-1*sinh(x)^7, x) == :(1//5*b^-1*cosh(x)^5+b^-3*(a^2+3*b^2+3*a*b)*cosh(x)+-1//3*b^-2*cosh(x)^3*(a+3b)+-1*a^-1//2*b^-7//2*(a+b)^3*arctan(a^-1//2*b^(1/2)*cosh(x)))
	@test integrate((a+b*cosh(x)^2)^-1*sinh(x)^5, x) == :(1//3*b^-1*cosh(x)^3+-1*b^-2*(a+2b)*cosh(x)+a^-1//2*b^-5//2*(a+b)^2*arctan(a^-1//2*b^(1/2)*cosh(x)))
	@test integrate((a+b*cosh(x)^2)^-1*sinh(x)^3, x) == :(b^-1*cosh(x)+-1*a^-1//2*b^-3//2*(a+b)*arctan(a^-1//2*b^(1/2)*cosh(x)))
	@test integrate((a+b*cosh(x)^2)^-1*sinh(x), x) == :(a^-1//2*b^-1//2*arctan(a^-1//2*b^(1/2)*cosh(x)))
	@test integrate((a+b*cosh(x)^2)^-1*csch(x), x) == :(-1*(a+b)^-1*arctanh(cosh(x))+-1*a^-1//2*b^(1/2)*(a+b)^-1*arctan(a^-1//2*b^(1/2)*cosh(x)))
end

@testset "6.3.1 (c+d x)^m (a+b tanh)^n.jl" begin
	@test integrate((c+d*x)^3*tanh(e+f*x), x) == :(-1//4*d^-1*(c+d*x)^4+f^-1*(c+d*x)^3*log(1+exp(2*e+2*f*x))+3//4*d^3*f^-4*Polylogarithms.polylog(4,-1*exp(2*e+2*f*x))+-3//2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*exp(2*e+2*f*x))+3//2*d*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x)))
	@test integrate((c+d*x)^2*tanh(e+f*x), x) == :(-1//3*d^-1*(c+d*x)^3+f^-1*(c+d*x)^2*log(1+exp(2*e+2*f*x))+-1//2*d^2*f^-3*Polylogarithms.polylog(3,-1*exp(2*e+2*f*x))+d*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x)))
	@test integrate((c+d*x)*tanh(e+f*x), x) == :(-1//2*d^-1*(c+d*x)^2+f^-1*(c+d*x)*log(1+exp(2*e+2*f*x))+(1/2)*d*f^-2*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x)))
	@test integrate((c+d*x)^3*tanh(e+f*x)^2, x) == :(-1*f^-1*(c+d*x)^3+1//4*d^-1*(c+d*x)^4+-1*f^-1*(c+d*x)^3*tanh(e+f*x)+-3//2*d^3*f^-4*Polylogarithms.polylog(3,-1*exp(2*e+2*f*x))+3*d*f^-2*(c+d*x)^2*log(1+exp(2*e+2*f*x))+3*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x)))
	@test integrate((c+d*x)^2*tanh(e+f*x)^2, x) == :(-1*f^-1*(c+d*x)^2+1//3*d^-1*(c+d*x)^3+d^2*f^-3*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x))+-1*f^-1*(c+d*x)^2*tanh(e+f*x)+2*d*f^-2*(c+d*x)*log(1+exp(2*e+2*f*x)))
	@test integrate(tanh(e+f*x)^2*(c+d*x), x) == :(c*x+(1/2)*d*x^2+d*f^-2*log(cosh(e+f*x))+-1*f^-1*(c+d*x)*tanh(e+f*x))
	@test integrate((c+d*x)^3*tanh(e+f*x)^3, x) == :((1/2)*f^-1*(c+d*x)^3+-1//4*d^-1*(c+d*x)^4+f^-1*(c+d*x)^3*log(1+exp(2*e+2*f*x))+-3//2*d*f^-2*(c+d*x)^2+-1//2*f^-1*(c+d*x)^3*tanh(e+f*x)^2+3//2*d^3*f^-4*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x))+3//4*d^3*f^-4*Polylogarithms.polylog(4,-1*exp(2*e+2*f*x))+3*d^2*f^-3*(c+d*x)*log(1+exp(2*e+2*f*x))+-3//2*d*f^-2*(c+d*x)^2*tanh(e+f*x)+-3//2*d^2*f^-3*(c+d*x)*Polylogarithms.polylog(3,-1*exp(2*e+2*f*x))+3//2*d*f^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x)))
	@test integrate((c+d*x)^2*tanh(e+f*x)^3, x) == :(-1//3*d^-1*(c+d*x)^3+d^2*f^-3*log(cosh(e+f*x))+f^-1*(c+d*x)^2*log(1+exp(2*e+2*f*x))+(1/2)*d^2*f^-1*x^2+-1//2*d^2*f^-3*Polylogarithms.polylog(3,-1*exp(2*e+2*f*x))+-1//2*f^-1*(c+d*x)^2*tanh(e+f*x)^2+c*d*x*f^-1+d*f^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x))+-1*d*f^-2*(c+d*x)*tanh(e+f*x))
	@test integrate(tanh(e+f*x)^3*(c+d*x), x) == :(-1//2*d^-1*(c+d*x)^2+f^-1*(c+d*x)*log(1+exp(2*e+2*f*x))+(1/2)*d*x*f^-1+(1/2)*d*f^-2*Polylogarithms.polylog(2,-1*exp(2*e+2*f*x))+-1//2*d*f^-2*tanh(e+f*x)+-1//2*f^-1*tanh(e+f*x)^2*(c+d*x))
	@test integrate((b*tanh(e+f*x))^5//2*(c+d*x), x) == :(b^5//2*f^-1*(c+d*x)*arctanh(b^-1//2*(b*tanh(e+f*x))^(1/2))+(1/2)*d*b^5//2*f^-2*arctanh(b^-1//2*(b*tanh(e+f*x))^(1/2))^2+(1/2)*d*f^-2*(-1b)^5//2*Polylogarithms.polylog(2,1+-2*(1+(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1)+(1/2)*d*f^-2*(-1b)^5//2*Polylogarithms.polylog(2,1+-2*(1+-1*(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1)+-1*f^-1*(-1b)^5//2*(c+d*x)*arctanh((-1b)^-1//2*(b*tanh(e+f*x))^(1/2))+-4//3*d*b^2*f^-2*(b*tanh(e+f*x))^(1/2)+-2//3*b*f^-1*(b*tanh(e+f*x))^3//2*(c+d*x)+-1//2*d*b^5//2*f^-2*Polylogarithms.polylog(2,1+-2*b^(1/2)*(b^(1/2)+(b*tanh(e+f*x))^(1/2))^-1)+-1//2*d*b^5//2*f^-2*Polylogarithms.polylog(2,1+-2*b^(1/2)*(b^(1/2)+-1*(b*tanh(e+f*x))^(1/2))^-1)+-1//2*d*f^-2*(-1b)^5//2*arctanh((-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^2+-1//4*d*f^-2*(-1b)^5//2*Polylogarithms.polylog(2,1+(1+-1*(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1*((-1b)^(1/2)+-1*b^(1/2))^-1*(2*b^(1/2)+2*(b*tanh(e+f*x))^(1/2)))+-1//4*d*f^-2*(-1b)^5//2*Polylogarithms.polylog(2,1+-1*(1+-1*(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1*(b^(1/2)+(-1b)^(1/2))^-1*(-2*(b*tanh(e+f*x))^(1/2)+2*b^(1/2)))+1//4*d*b^5//2*f^-2*Polylogarithms.polylog(2,1+-2*b^(1/2)*(b^(1/2)+(-1b)^(1/2))^-1*(b^(1/2)+(b*tanh(e+f*x))^(1/2))^-1*((-1b)^(1/2)+(b*tanh(e+f*x))^(1/2)))+1//4*d*b^5//2*f^-2*Polylogarithms.polylog(2,1+-2*b^(1/2)*(b^(1/2)+(b*tanh(e+f*x))^(1/2))^-1*((-1b)^(1/2)+-1*b^(1/2))^-1*((-1b)^(1/2)+-1*(b*tanh(e+f*x))^(1/2)))+2//3*d*b^5//2*f^-2*arctan(b^-1//2*(b*tanh(e+f*x))^(1/2))+2//3*d*b^5//2*f^-2*arctanh(b^-1//2*(b*tanh(e+f*x))^(1/2))+d*b^5//2*f^-2*arctanh(b^-1//2*(b*tanh(e+f*x))^(1/2))*log(2*b^(1/2)*(b^(1/2)+(b*tanh(e+f*x))^(1/2))^-1)+d*f^-2*(-1b)^5//2*arctanh((-1b)^-1//2*(b*tanh(e+f*x))^(1/2))*log(2*(1+-1*(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1)+-1*d*b^5//2*f^-2*arctanh(b^-1//2*(b*tanh(e+f*x))^(1/2))*log(2*b^(1/2)*(b^(1/2)+-1*(b*tanh(e+f*x))^(1/2))^-1)+-1*d*f^-2*(-1b)^5//2*arctanh((-1b)^-1//2*(b*tanh(e+f*x))^(1/2))*log(2*(1+(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1)+-1//2*d*b^5//2*f^-2*arctanh(b^-1//2*(b*tanh(e+f*x))^(1/2))*log(2*b^(1/2)*(b^(1/2)+(-1b)^(1/2))^-1*(b^(1/2)+(b*tanh(e+f*x))^(1/2))^-1*((-1b)^(1/2)+(b*tanh(e+f*x))^(1/2)))+-1//2*d*b^5//2*f^-2*arctanh(b^-1//2*(b*tanh(e+f*x))^(1/2))*log(2*b^(1/2)*(b^(1/2)+(b*tanh(e+f*x))^(1/2))^-1*((-1b)^(1/2)+-1*b^(1/2))^-1*((-1b)^(1/2)+-1*(b*tanh(e+f*x))^(1/2)))+-1//2*d*f^-2*(-1b)^5//2*arctanh((-1b)^-1//2*(b*tanh(e+f*x))^(1/2))*log((1+-1*(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1*(b^(1/2)+(-1b)^(1/2))^-1*(-2*(b*tanh(e+f*x))^(1/2)+2*b^(1/2)))+-1//2*d*f^-2*(-1b)^5//2*arctanh((-1b)^-1//2*(b*tanh(e+f*x))^(1/2))*log(-1*(1+-1*(-1b)^-1//2*(b*tanh(e+f*x))^(1/2))^-1*((-1b)^(1/2)+-1*b^(1/2))^-1*(2*b^(1/2)+2*(b*tanh(e+f*x))^(1/2))))
end

@testset "6.3.2 Hyperbolic tangent functions.jl" begin
	@test integrate(tanh(a+b*x)^6, x) == :(x+-1*b^-1*tanh(a+b*x)+-1//3*b^-1*tanh(a+b*x)^3+-1//5*b^-1*tanh(a+b*x)^5)
	@test integrate(tanh(a+b*x)^5, x) == :(b^-1*log(cosh(a+b*x))+-1//2*b^-1*tanh(a+b*x)^2+-1//4*b^-1*tanh(a+b*x)^4)
	@test integrate(tanh(a+b*x)^4, x) == :(x+-1*b^-1*tanh(a+b*x)+-1//3*b^-1*tanh(a+b*x)^3)
	@test integrate(tanh(a+b*x)^3, x) == :(b^-1*log(cosh(a+b*x))+-1//2*b^-1*tanh(a+b*x)^2)
	@test integrate(tanh(a+b*x)^2, x) == :(x+-1*b^-1*tanh(a+b*x))
	@test integrate(tanh(a+b*x), x) == :(b^-1*log(cosh(a+b*x)))
	@test integrate(coth(a+b*x), x) == :(b^-1*log(sinh(a+b*x)))
	@test integrate(coth(a+b*x)^2, x) == :(x+-1*b^-1*coth(a+b*x))
	@test integrate(coth(a+b*x)^3, x) == :(b^-1*log(sinh(a+b*x))+-1//2*b^-1*coth(a+b*x)^2)
	@test integrate(coth(a+b*x)^4, x) == :(x+-1*b^-1*coth(a+b*x)+-1//3*b^-1*coth(a+b*x)^3)
end

@testset "6.3.7 (d hyper)^m (a+b (c tanh)^n)^p.jl" begin
	@test integrate(sinh(c+d*x)^4*(a+b*tanh(c+d*x)^2), x) == :(x*(3//8*a+15//8*b)+-1*b*d^-1*tanh(c+d*x)+-1//8*d^-1*(5a+9b)*cosh(c+d*x)*sinh(c+d*x)+1//4*d^-1*cosh(c+d*x)^3*(a+b)*sinh(c+d*x))
	@test integrate(sinh(c+d*x)^3*(a+b*tanh(c+d*x)^2), x) == :(-1*b*d^-1*sech(c+d*x)+-1*d^-1*(a+2b)*cosh(c+d*x)+1//3*d^-1*cosh(c+d*x)^3*(a+b))
	@test integrate(sinh(c+d*x)^2*(a+b*tanh(c+d*x)^2), x) == :(x*(-3//2*b+-1//2*a)+b*d^-1*tanh(c+d*x)+(1/2)*d^-1*(a+b)*cosh(c+d*x)*sinh(c+d*x))
	@test integrate((a+b*tanh(c+d*x)^2)*sinh(c+d*x), x) == :(b*d^-1*sech(c+d*x)+d^-1*(a+b)*cosh(c+d*x))
	@test integrate((a+b*tanh(c+d*x)^2)*csch(c+d*x), x) == :(-1*a*d^-1*arctanh(cosh(c+d*x))+-1*b*d^-1*sech(c+d*x))
	@test integrate(csch(c+d*x)^2*(a+b*tanh(c+d*x)^2), x) == :(b*d^-1*tanh(c+d*x)+-1*a*d^-1*coth(c+d*x))
	@test integrate(csch(c+d*x)^3*(a+b*tanh(c+d*x)^2), x) == :(b*d^-1*sech(c+d*x)+(1/2)*d^-1*(a+-2b)*arctanh(cosh(c+d*x))+-1//2*a*d^-1*coth(c+d*x)*csch(c+d*x))
	@test integrate(csch(c+d*x)^4*(a+b*tanh(c+d*x)^2), x) == :(d^-1*(a+-1b)*coth(c+d*x)+-1*b*d^-1*tanh(c+d*x)+-1//3*a*d^-1*coth(c+d*x)^3)
	@test integrate((a+b*tanh(c+d*x)^2)^2*sinh(c+d*x)^4, x) == :(x*(3//8*a^2+35//8*b^2+15//4*a*b)+-1//3*b^2*d^-1*tanh(c+d*x)^3+-1//4*d^-1*(a^2+13*b^2+10*a*b)*tanh(c+d*x)+1//4*d^-1*(a+b)^2*sinh(c+d*x)^4*tanh(c+d*x)+-1//8*d^-1*(a+b)*(a+9b)*cosh(c+d*x)*sinh(c+d*x))
	@test integrate((a+b*tanh(c+d*x)^2)^2*sinh(c+d*x)^3, x) == :(1//3*b^2*d^-1*sech(c+d*x)^3+1//3*d^-1*(a+b)^2*cosh(c+d*x)^3+-1*b*d^-1*(2a+3b)*sech(c+d*x)+-1*d^-1*(a+b)*(a+3b)*cosh(c+d*x))
end

@testset "6.4.1 (c+d x)^m (a+b coth)^n.jl" begin
	@test integrate(x^3*coth(a+b*x), x) == :(-1//4*x^4+3//4*b^-4*Polylogarithms.polylog(4,exp(2a+2*b*x))+b^-1*x^3*log(1+-1*exp(2a+2*b*x))+-3//2*x*b^-3*Polylogarithms.polylog(3,exp(2a+2*b*x))+3//2*b^-2*x^2*Polylogarithms.polylog(2,exp(2a+2*b*x)))
	@test integrate(x^2*coth(a+b*x), x) == :(-1//3*x^3+-1//2*b^-3*Polylogarithms.polylog(3,exp(2a+2*b*x))+x*b^-2*Polylogarithms.polylog(2,exp(2a+2*b*x))+b^-1*x^2*log(1+-1*exp(2a+2*b*x)))
	@test integrate(x*coth(a+b*x), x) == :(-1//2*x^2+(1/2)*b^-2*Polylogarithms.polylog(2,exp(2a+2*b*x))+x*b^-1*log(1+-1*exp(2a+2*b*x)))
	@test integrate(x^3*coth(a+b*x)^2, x) == :(1//4*x^4+-1*b^-1*x^3+-3//2*b^-4*Polylogarithms.polylog(3,exp(2a+2*b*x))+-1*b^-1*x^3*coth(a+b*x)+3*x*b^-3*Polylogarithms.polylog(2,exp(2a+2*b*x))+3*b^-2*x^2*log(1+-1*exp(2a+2*b*x)))
	@test integrate(x^2*coth(a+b*x)^2, x) == :(1//3*x^3+b^-3*Polylogarithms.polylog(2,exp(2a+2*b*x))+-1*b^-1*x^2+-1*b^-1*x^2*coth(a+b*x)+2*x*b^-2*log(1+-1*exp(2a+2*b*x)))
	@test integrate(x*coth(a+b*x)^2, x) == :((1/2)*x^2+b^-2*log(sinh(a+b*x))+-1*x*b^-1*coth(a+b*x))
	@test integrate(x^3*coth(a+b*x)^3, x) == :(-1//4*x^4+(1/2)*b^-1*x^3+-3//2*b^-2*x^2+3//2*b^-4*Polylogarithms.polylog(2,exp(2a+2*b*x))+3//4*b^-4*Polylogarithms.polylog(4,exp(2a+2*b*x))+b^-1*x^3*log(1+-1*exp(2a+2*b*x))+3*x*b^-3*log(1+-1*exp(2a+2*b*x))+-3//2*x*b^-3*Polylogarithms.polylog(3,exp(2a+2*b*x))+-3//2*b^-2*x^2*coth(a+b*x)+-1//2*b^-1*x^3*coth(a+b*x)^2+3//2*b^-2*x^2*Polylogarithms.polylog(2,exp(2a+2*b*x)))
	@test integrate(x^2*coth(a+b*x)^3, x) == :(-1//3*x^3+b^-3*log(sinh(a+b*x))+(1/2)*b^-1*x^2+-1//2*b^-3*Polylogarithms.polylog(3,exp(2a+2*b*x))+x*b^-2*Polylogarithms.polylog(2,exp(2a+2*b*x))+b^-1*x^2*log(1+-1*exp(2a+2*b*x))+-1*x*b^-2*coth(a+b*x)+-1//2*b^-1*x^2*coth(a+b*x)^2)
	@test integrate(x*coth(a+b*x)^3, x) == :(-1//2*x^2+(1/2)*x*b^-1+(1/2)*b^-2*Polylogarithms.polylog(2,exp(2a+2*b*x))+-1//2*b^-2*coth(a+b*x)+x*b^-1*log(1+-1*exp(2a+2*b*x))+-1//2*x*b^-1*coth(a+b*x)^2)
	@test integrate((a+a*coth(e+f*x))^-1*(c+d*x)^3, x) == :(-3//8*d^3*f^-4*(a+a*coth(e+f*x))^-1+-1//2*f^-1*(a+a*coth(e+f*x))^-1*(c+d*x)^3+1//4*a^-1*f^-1*(c+d*x)^3+1//8*a^-1*d^-1*(c+d*x)^4+-3//4*d*f^-2*(a+a*coth(e+f*x))^-1*(c+d*x)^2+-3//4*d^2*f^-3*(a+a*coth(e+f*x))^-1*(c+d*x)+3//8*d*a^-1*f^-2*(c+d*x)^2+3//8*x*a^-1*d^3*f^-3)
end

@testset "6.4.2 Hyperbolic cotangent functions.jl" begin
	@test integrate((b*coth(c+d*x))^7//2, x) == :(b^7//2*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2))+b^7//2*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2))+-2*b^3*d^-1*(b*coth(c+d*x))^(1/2)+-2//5*b*d^-1*(b*coth(c+d*x))^5//2)
	@test integrate((b*coth(c+d*x))^5//2, x) == :(b^5//2*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2))+-1*b^5//2*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2))+-2//3*b*d^-1*(b*coth(c+d*x))^3//2)
	@test integrate((b*coth(c+d*x))^3//2, x) == :(b^3//2*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2))+b^3//2*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2))+-2*b*d^-1*(b*coth(c+d*x))^(1/2))
	@test integrate((b*coth(c+d*x))^(1/2), x) == :(b^(1/2)*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2))+-1*b^(1/2)*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2)))
	@test integrate((b*coth(c+d*x))^-1//2, x) == :(b^-1//2*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2))+b^-1//2*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2)))
	@test integrate((b*coth(c+d*x))^-3//2, x) == :(b^-3//2*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2))+-1*b^-3//2*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2))+-2*b^-1*d^-1*(b*coth(c+d*x))^-1//2)
	@test integrate((b*coth(c+d*x))^-5//2, x) == :(b^-5//2*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2))+b^-5//2*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2))+-2//3*b^-1*d^-1*(b*coth(c+d*x))^-3//2)
	@test integrate((b*coth(c+d*x))^-7//2, x) == :(b^-7//2*d^-1*arctanh(b^-1//2*(b*coth(c+d*x))^(1/2))+-1*b^-7//2*d^-1*arctan(b^-1//2*(b*coth(c+d*x))^(1/2))+-2*b^-3*d^-1*(b*coth(c+d*x))^-1//2+-2//5*b^-1*d^-1*(b*coth(c+d*x))^-5//2)
	@test integrate((b*coth(c+d*x))^4//3, x) == :(b^4//3*d^-1*arctanh(b^-1//3*(b*coth(c+d*x))^1//3)+-3*b*d^-1*(b*coth(c+d*x))^1//3+-1//4*b^4//3*d^-1*log(b^2//3+(b*coth(c+d*x))^2//3+-1*b^1//3*(b*coth(c+d*x))^1//3)+1//4*b^4//3*d^-1*log(b^2//3+(b*coth(c+d*x))^2//3+b^1//3*(b*coth(c+d*x))^1//3)+(1/2)*3^(1/2)*b^4//3*d^-1*arctan(1//3*3^(1/2)*(1+2*b^-1//3*(b*coth(c+d*x))^1//3))+-1//2*3^(1/2)*b^4//3*d^-1*arctan(1//3*3^(1/2)*(1+-2*b^-1//3*(b*coth(c+d*x))^1//3)))
	@test integrate((b*coth(c+d*x))^2//3, x) == :(b^2//3*d^-1*arctanh(b^-1//3*(b*coth(c+d*x))^1//3)+-1//4*b^2//3*d^-1*log(b^2//3+(b*coth(c+d*x))^2//3+-1*b^1//3*(b*coth(c+d*x))^1//3)+1//4*b^2//3*d^-1*log(b^2//3+(b*coth(c+d*x))^2//3+b^1//3*(b*coth(c+d*x))^1//3)+(1/2)*3^(1/2)*b^2//3*d^-1*arctan(1//3*3^(1/2)*(1+-2*b^-1//3*(b*coth(c+d*x))^1//3))+-1//2*3^(1/2)*b^2//3*d^-1*arctan(1//3*3^(1/2)*(1+2*b^-1//3*(b*coth(c+d*x))^1//3)))
end

@testset "6.4.7 (d hyper)^m (a+b (c coth)^n)^p.jl" begin
	@test integrate((a+b*coth(c+d*x)^2)^5, x) == :(x*(a+b)^5+-1//9*b^5*d^-1*coth(c+d*x)^9+-1*b*d^-1*(b^4+5*a^4+5*a*b^3+10*b*a^3+10*a^2*b^2)*coth(c+d*x)+-1//3*b^2*d^-1*coth(c+d*x)^3*(b^3+10*a^3+5*a*b^2+10*b*a^2)+-1//5*b^3*d^-1*coth(c+d*x)^5*(b^2+10*a^2+5*a*b)+-1//7*b^4*d^-1*coth(c+d*x)^7*(b+5a))
	@test integrate((a+b*coth(c+d*x)^2)^4, x) == :(x*(a+b)^4+-1//7*b^4*d^-1*coth(c+d*x)^7+-1//3*b^2*d^-1*coth(c+d*x)^3*(b^2+6*a^2+4*a*b)+-1//5*b^3*d^-1*coth(c+d*x)^5*(b+4a)+-1*b*d^-1*(b+2a)*(b^2+2*a^2+2*a*b)*coth(c+d*x))
	@test integrate((a+b*coth(c+d*x)^2)^3, x) == :(x*(a+b)^3+-1//5*b^3*d^-1*coth(c+d*x)^5+-1*b*d^-1*(b^2+3*a^2+3*a*b)*coth(c+d*x)+-1//3*b^2*d^-1*coth(c+d*x)^3*(b+3a))
	@test integrate((a+b*coth(c+d*x)^2)^2, x) == :(x*(a+b)^2+-1//3*b^2*d^-1*coth(c+d*x)^3+-1*b*d^-1*(b+2a)*coth(c+d*x))
	@test integrate((a+b*coth(c+d*x)^2)^-1, x) == :(x*(a+b)^-1+-1*a^-1//2*b^(1/2)*d^-1*(a+b)^-1*arctan(a^(1/2)*b^-1//2*tanh(c+d*x)))
	@test integrate((a+b*coth(c+d*x)^2)^-2, x) == :(x*(a+b)^-2+(1/2)*b*a^-1*d^-1*(a+b)^-1*(a+b*coth(c+d*x)^2)^-1*coth(c+d*x)+-1//2*a^-3//2*b^(1/2)*d^-1*(a+b)^-2*(b+3a)*arctan(a^(1/2)*b^-1//2*tanh(c+d*x)))
	@test integrate((a+b*coth(c+d*x)^2)^-3, x) == :(x*(a+b)^-3+-1//8*a^-5//2*b^(1/2)*d^-1*(a+b)^-3*(3*b^2+15*a^2+10*a*b)*arctan(a^(1/2)*b^-1//2*tanh(c+d*x))+1//4*b*a^-1*d^-1*(a+b)^-1*(a+b*coth(c+d*x)^2)^-2*coth(c+d*x)+1//8*b*a^-2*d^-1*(a+b)^-2*(a+b*coth(c+d*x)^2)^-1*(3b+7a)*coth(c+d*x))
	@test integrate((a+b*coth(c+d*x)^2)^-4, x) == :(x*(a+b)^-4+-1//16*a^-7//2*b^(1/2)*d^-1*(a+b)^-4*(5*b^3+35*a^3+21*a*b^2+35*b*a^2)*arctan(a^(1/2)*b^-1//2*tanh(c+d*x))+1//6*b*a^-1*d^-1*(a+b)^-1*(a+b*coth(c+d*x)^2)^-3*coth(c+d*x)+1//16*b*a^-3*d^-1*(a+b)^-3*(a+b*coth(c+d*x)^2)^-1*(5*b^2+19*a^2+16*a*b)*coth(c+d*x)+1//24*b*a^-2*d^-1*(a+b)^-2*(a+b*coth(c+d*x)^2)^-2*(5b+11a)*coth(c+d*x))
	@test integrate((1+-2*coth(x)^2)^-1, x) == :(-1x+2^(1/2)*arctanh((1/2)*2^(1/2)*tanh(x)))
	@test integrate((1+-1*coth(x)^2)^(1/2), x) == :(arcsin(coth(x)))
end

@testset "6.5.1 (c+d x)^m (a+b sech)^n.jl" begin
	@test integrate((c+d*x)^3*sech(a+b*x), x) == :(2*b^-1*(c+d*x)^3*arctan(exp(a+b*x))+-6*im*b^-4*d^3*Polylogarithms.polylog(4,-1*im*exp(a+b*x))+6*im*b^-4*d^3*Polylogarithms.polylog(4,im*exp(a+b*x))+-6*im*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,im*exp(a+b*x))+-3*im*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*im*exp(a+b*x))+3*im*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,im*exp(a+b*x))+6*im*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,-1*im*exp(a+b*x)))
	@test integrate((c+d*x)^2*sech(a+b*x), x) == :(2*b^-1*(c+d*x)^2*arctan(exp(a+b*x))+-2*im*b^-3*d^2*Polylogarithms.polylog(3,im*exp(a+b*x))+2*im*b^-3*d^2*Polylogarithms.polylog(3,-1*im*exp(a+b*x))+-2*im*d*b^-2*(c+d*x)*Polylogarithms.polylog(2,-1*im*exp(a+b*x))+2*im*d*b^-2*(c+d*x)*Polylogarithms.polylog(2,im*exp(a+b*x)))
	@test integrate((c+d*x)*sech(a+b*x), x) == :(b^-1*(2c+2*d*x)*arctan(exp(a+b*x))+im*d*b^-2*Polylogarithms.polylog(2,im*exp(a+b*x))+-1*im*d*b^-2*Polylogarithms.polylog(2,-1*im*exp(a+b*x)))
	@test integrate((c+d*x)^3*sech(a+b*x)^2, x) == :(b^-1*(c+d*x)^3+b^-1*(c+d*x)^3*tanh(a+b*x)+3//2*b^-4*d^3*Polylogarithms.polylog(3,-1*exp(2a+2*b*x))+-3*d*b^-2*(c+d*x)^2*log(1+exp(2a+2*b*x))+-3*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(2a+2*b*x)))
	@test integrate((c+d*x)^2*sech(a+b*x)^2, x) == :(b^-1*(c+d*x)^2+b^-1*(c+d*x)^2*tanh(a+b*x)+-1*b^-3*d^2*Polylogarithms.polylog(2,-1*exp(2a+2*b*x))+-2*d*b^-2*(c+d*x)*log(1+exp(2a+2*b*x)))
	@test integrate(sech(a+b*x)^2*(c+d*x), x) == :(b^-1*(c+d*x)*tanh(a+b*x)+-1*d*b^-2*log(cosh(a+b*x)))
	@test integrate((c+d*x)^3*sech(a+b*x)^3, x) == :(b^-1*(c+d*x)^3*arctan(exp(a+b*x))+(1/2)*b^-1*(c+d*x)^3*sech(a+b*x)*tanh(a+b*x)+-6*b^-3*d^2*(c+d*x)*arctan(exp(a+b*x))+-3*im*b^-4*d^3*Polylogarithms.polylog(2,im*exp(a+b*x))+-3*im*b^-4*d^3*Polylogarithms.polylog(4,-1*im*exp(a+b*x))+3*im*b^-4*d^3*Polylogarithms.polylog(2,-1*im*exp(a+b*x))+3*im*b^-4*d^3*Polylogarithms.polylog(4,im*exp(a+b*x))+3//2*d*b^-2*(c+d*x)^2*sech(a+b*x)+-3*im*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,im*exp(a+b*x))+3*im*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,-1*im*exp(a+b*x))+-3//2*im*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*im*exp(a+b*x))+3//2*im*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,im*exp(a+b*x)))
	@test integrate((c+d*x)^2*sech(a+b*x)^3, x) == :(b^-1*(c+d*x)^2*arctan(exp(a+b*x))+-1*b^-3*d^2*arctan(sinh(a+b*x))+im*b^-3*d^2*Polylogarithms.polylog(3,-1*im*exp(a+b*x))+d*b^-2*(c+d*x)*sech(a+b*x)+(1/2)*b^-1*(c+d*x)^2*sech(a+b*x)*tanh(a+b*x)+-1*im*b^-3*d^2*Polylogarithms.polylog(3,im*exp(a+b*x))+im*d*b^-2*(c+d*x)*Polylogarithms.polylog(2,im*exp(a+b*x))+-1*im*d*b^-2*(c+d*x)*Polylogarithms.polylog(2,-1*im*exp(a+b*x)))
	@test integrate(sech(a+b*x)^3*(c+d*x), x) == :(b^-1*(c+d*x)*arctan(exp(a+b*x))+(1/2)*d*b^-2*sech(a+b*x)+(1/2)*im*d*b^-2*Polylogarithms.polylog(2,im*exp(a+b*x))+(1/2)*b^-1*(c+d*x)*sech(a+b*x)*tanh(a+b*x)+-1//2*im*d*b^-2*Polylogarithms.polylog(2,-1*im*exp(a+b*x)))
	@test integrate(x*sech(x)^-3//2+-1//3*x*sech(x)^(1/2), x) == :(-4//9*sech(x)^-3//2+2//3*x*sech(x)^-1//2*sinh(x))
end

@testset "6.5.2 (e x)^m (a+b sech(c+d x^n))^p.jl" begin
	@test integrate(x^5*(a+b*sech(c+d*x^2)), x) == :(1//6*a*x^6+im*b*d^-3*Polylogarithms.polylog(3,-1*im*exp(c+d*x^2))+b*d^-1*x^4*arctan(exp(c+d*x^2))+-1*im*b*d^-3*Polylogarithms.polylog(3,im*exp(c+d*x^2))+im*b*d^-2*x^2*Polylogarithms.polylog(2,im*exp(c+d*x^2))+-1*im*b*d^-2*x^2*Polylogarithms.polylog(2,-1*im*exp(c+d*x^2)))
	@test integrate(x^3*(a+b*sech(c+d*x^2)), x) == :(1//4*a*x^4+b*d^-1*x^2*arctan(exp(c+d*x^2))+(1/2)*im*b*d^-2*Polylogarithms.polylog(2,im*exp(c+d*x^2))+-1//2*im*b*d^-2*Polylogarithms.polylog(2,-1*im*exp(c+d*x^2)))
	@test integrate(x*(a+b*sech(c+d*x^2)), x) == :((1/2)*a*x^2+(1/2)*b*d^-1*arctan(sinh(c+d*x^2)))
	@test integrate(x^5*(a+b*sech(c+d*x^2))^2, x) == :(1//6*a^2*x^6+(1/2)*b^2*d^-1*x^4+-1//2*b^2*d^-3*Polylogarithms.polylog(2,-1*exp(2c+2*d*x^2))+(1/2)*b^2*d^-1*x^4*tanh(c+d*x^2)+-1*b^2*d^-2*x^2*log(1+exp(2c+2*d*x^2))+-2*im*a*b*d^-3*Polylogarithms.polylog(3,im*exp(c+d*x^2))+2*im*a*b*d^-3*Polylogarithms.polylog(3,-1*im*exp(c+d*x^2))+2*a*b*d^-1*x^4*arctan(exp(c+d*x^2))+-2*im*a*b*d^-2*x^2*Polylogarithms.polylog(2,-1*im*exp(c+d*x^2))+2*im*a*b*d^-2*x^2*Polylogarithms.polylog(2,im*exp(c+d*x^2)))
	@test integrate(x^3*(a+b*sech(c+d*x^2))^2, x) == :(1//4*a^2*x^4+-1//2*b^2*d^-2*log(cosh(c+d*x^2))+(1/2)*b^2*d^-1*x^2*tanh(c+d*x^2)+im*a*b*d^-2*Polylogarithms.polylog(2,im*exp(c+d*x^2))+-1*im*a*b*d^-2*Polylogarithms.polylog(2,-1*im*exp(c+d*x^2))+2*a*b*d^-1*x^2*arctan(exp(c+d*x^2)))
	@test integrate(x*(a+b*sech(c+d*x^2))^2, x) == :((1/2)*a^2*x^2+(1/2)*b^2*d^-1*tanh(c+d*x^2)+a*b*d^-1*arctan(sinh(c+d*x^2)))
	@test integrate(x*sech(a+b*x^2)^7, x) == :(5//32*b^-1*arctan(sinh(a+b*x^2))+1//12*b^-1*sech(a+b*x^2)^5*tanh(a+b*x^2)+5//32*b^-1*sech(a+b*x^2)*tanh(a+b*x^2)+5//48*b^-1*sech(a+b*x^2)^3*tanh(a+b*x^2))
	@test integrate(x^5*(a+b*sech(c+d*x^2))^-1, x) == :(1//6*a^-1*x^6+b*a^-1*d^-3*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(3,-1*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+-1*b*a^-1*d^-3*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(3,-1*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+b*a^-1*d^-2*x^2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+(1/2)*b*a^-1*d^-1*x^4*(b^2+-1*a^2)^-1//2*log(1+a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+-1*b*a^-1*d^-2*x^2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+-1//2*b*a^-1*d^-1*x^4*(b^2+-1*a^2)^-1//2*log(1+a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2)))
	@test integrate(x^3*(a+b*sech(c+d*x^2))^-1, x) == :(1//4*a^-1*x^4+(1/2)*b*a^-1*d^-2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+-1//2*b*a^-1*d^-2*(b^2+-1*a^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+(1/2)*b*a^-1*d^-1*x^2*(b^2+-1*a^2)^-1//2*log(1+a*(b+(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2))+-1//2*b*a^-1*d^-1*x^2*(b^2+-1*a^2)^-1//2*log(1+a*(b+-1*(b^2+-1*a^2)^(1/2))^-1*exp(c+d*x^2)))
	@test integrate(x*(a+b*sech(c+d*x^2))^-1, x) == :((1/2)*a^-1*x^2+-1*b*a^-1*d^-1*(a+b)^-1//2*(a+-1b)^-1//2*arctan((a+b)^-1//2*(a+-1b)^(1/2)*tanh((1/2)*c+(1/2)*d*x^2)))
end

@testset "6.5.3 Hyperbolic secant functions.jl" begin
	@test integrate(sech(a+b*x), x) == :(b^-1*arctan(sinh(a+b*x)))
	@test integrate(sech(a+b*x)^2, x) == :(b^-1*tanh(a+b*x))
	@test integrate(sech(a+b*x)^3, x) == :((1/2)*b^-1*arctan(sinh(a+b*x))+(1/2)*b^-1*sech(a+b*x)*tanh(a+b*x))
	@test integrate(sech(a+b*x)^4, x) == :(b^-1*tanh(a+b*x)+-1//3*b^-1*tanh(a+b*x)^3)
	@test integrate(sech(a+b*x)^5, x) == :(3//8*b^-1*arctan(sinh(a+b*x))+1//4*b^-1*sech(a+b*x)^3*tanh(a+b*x)+3//8*b^-1*sech(a+b*x)*tanh(a+b*x))
	@test integrate(sech(a+b*x)^6, x) == :(b^-1*tanh(a+b*x)+-2//3*b^-1*tanh(a+b*x)^3+1//5*b^-1*tanh(a+b*x)^5)
	@test integrate(sech(7x)^4, x) == :(-1//21*tanh(7x)^3+1//7*tanh(7x))
	@test integrate(sech(pi*x)^6, x) == :(pi^-1*tanh(pi*x)+-2//3*pi^-1*tanh(pi*x)^3+1//5*pi^-1*tanh(pi*x)^5)
	@test integrate(sech(a+b*x)^5//2, x) == :(2//3*b^-1*sech(a+b*x)^3//2*sinh(a+b*x)+-2//3*im*b^-1*cosh(a+b*x)^(1/2)*sech(a+b*x)^(1/2)*Elliptic.F((1/2)*im*(a+b*x),2))
	@test integrate(sech(a+b*x)^3//2, x) == :(2*b^-1*sech(a+b*x)^(1/2)*sinh(a+b*x)+2*im*b^-1*cosh(a+b*x)^(1/2)*sech(a+b*x)^(1/2)*Elliptic.E((1/2)*im*(a+b*x),2))
end

@testset "6.5.7 (d hyper)^m (a+b (c sech)^n)^p.jl" begin
	@test integrate(sinh(c+d*x)^4*(a+b*sech(c+d*x)^2), x) == :(x*(-3//2*b+3//8*a)+b*d^-1*tanh(c+d*x)+-1//8*d^-1*(-4b+5a)*cosh(c+d*x)*sinh(c+d*x)+1//4*a*d^-1*cosh(c+d*x)^3*sinh(c+d*x))
	@test integrate(sinh(c+d*x)^3*(a+b*sech(c+d*x)^2), x) == :(b*d^-1*sech(c+d*x)+-1*d^-1*(a+-1b)*cosh(c+d*x)+1//3*a*d^-1*cosh(c+d*x)^3)
	@test integrate(sinh(c+d*x)^2*(a+b*sech(c+d*x)^2), x) == :(x*(b+-1//2*a)+-1*b*d^-1*tanh(c+d*x)+(1/2)*a*d^-1*cosh(c+d*x)*sinh(c+d*x))
	@test integrate((a+b*sech(c+d*x)^2)*sinh(c+d*x), x) == :(a*d^-1*cosh(c+d*x)+-1*b*d^-1*sech(c+d*x))
	@test integrate((a+b*sech(c+d*x)^2)*csch(c+d*x), x) == :(b*d^-1*sech(c+d*x)+-1*d^-1*(a+b)*arctanh(cosh(c+d*x)))
	@test integrate(csch(c+d*x)^2*(a+b*sech(c+d*x)^2), x) == :(-1*b*d^-1*tanh(c+d*x)+-1*d^-1*(a+b)*coth(c+d*x))
	@test integrate(csch(c+d*x)^3*(a+b*sech(c+d*x)^2), x) == :((1/2)*d^-1*(a+3b)*arctanh(cosh(c+d*x))+-1*b*d^-1*sech(c+d*x)+-1//2*d^-1*(a+b)*coth(c+d*x)*csch(c+d*x))
	@test integrate(csch(c+d*x)^4*(a+b*sech(c+d*x)^2), x) == :(b*d^-1*tanh(c+d*x)+d^-1*(a+2b)*coth(c+d*x)+-1//3*d^-1*coth(c+d*x)^3*(a+b))
	@test integrate((a+b*sech(c+d*x)^2)^2*sinh(c+d*x)^4, x) == :(x*(b^2+3//8*a^2+-3*a*b)+-1//3*b^2*d^-1*tanh(c+d*x)^3+-1//4*d^-1*(a^2+4*b^2+-8*a*b)*tanh(c+d*x)+1//4*a^2*d^-1*sinh(c+d*x)^4*tanh(c+d*x)+-1//8*a*d^-1*(a+-8b)*cosh(c+d*x)*sinh(c+d*x))
	@test integrate((a+b*sech(c+d*x)^2)^2*sinh(c+d*x)^3, x) == :(1//3*a^2*d^-1*cosh(c+d*x)^3+1//3*b^2*d^-1*sech(c+d*x)^3+b*d^-1*(-1b+2a)*sech(c+d*x)+-1*a*d^-1*(a+-2b)*cosh(c+d*x))
end

@testset "6.6.1 (c+d x)^m (a+b csch)^n.jl" begin
	@test integrate((c+d*x)^3*csch(a+b*x), x) == :(-6*b^-4*d^3*Polylogarithms.polylog(4,-1*exp(a+b*x))+-2*b^-1*(c+d*x)^3*arctanh(exp(a+b*x))+6*b^-4*d^3*Polylogarithms.polylog(4,exp(a+b*x))+-6*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,exp(a+b*x))+-3*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(a+b*x))+3*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,exp(a+b*x))+6*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,-1*exp(a+b*x)))
	@test integrate((c+d*x)^2*csch(a+b*x), x) == :(-2*b^-1*(c+d*x)^2*arctanh(exp(a+b*x))+-2*b^-3*d^2*Polylogarithms.polylog(3,exp(a+b*x))+2*b^-3*d^2*Polylogarithms.polylog(3,-1*exp(a+b*x))+-2*d*b^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(a+b*x))+2*d*b^-2*(c+d*x)*Polylogarithms.polylog(2,exp(a+b*x)))
	@test integrate((c+d*x)*csch(a+b*x), x) == :(d*b^-2*Polylogarithms.polylog(2,exp(a+b*x))+-1*d*b^-2*Polylogarithms.polylog(2,-1*exp(a+b*x))+-1*b^-1*(2c+2*d*x)*arctanh(exp(a+b*x)))
	@test integrate((c+d*x)^3*csch(a+b*x)^2, x) == :(-1*b^-1*(c+d*x)^3+-1*b^-1*(c+d*x)^3*coth(a+b*x)+-3//2*b^-4*d^3*Polylogarithms.polylog(3,exp(2a+2*b*x))+3*d*b^-2*(c+d*x)^2*log(1+-1*exp(2a+2*b*x))+3*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(2,exp(2a+2*b*x)))
	@test integrate((c+d*x)^2*csch(a+b*x)^2, x) == :(-1*b^-1*(c+d*x)^2+b^-3*d^2*Polylogarithms.polylog(2,exp(2a+2*b*x))+-1*b^-1*(c+d*x)^2*coth(a+b*x)+2*d*b^-2*(c+d*x)*log(1+-1*exp(2a+2*b*x)))
	@test integrate(csch(a+b*x)^2*(c+d*x), x) == :(d*b^-2*log(sinh(a+b*x))+-1*b^-1*(c+d*x)*coth(a+b*x))
	@test integrate((c+d*x)^3*csch(a+b*x)^3, x) == :(b^-1*(c+d*x)^3*arctanh(exp(a+b*x))+-3*b^-4*d^3*Polylogarithms.polylog(2,-1*exp(a+b*x))+-3*b^-4*d^3*Polylogarithms.polylog(4,exp(a+b*x))+3*b^-4*d^3*Polylogarithms.polylog(2,exp(a+b*x))+3*b^-4*d^3*Polylogarithms.polylog(4,-1*exp(a+b*x))+-6*b^-3*d^2*(c+d*x)*arctanh(exp(a+b*x))+-3*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,-1*exp(a+b*x))+3*b^-3*d^2*(c+d*x)*Polylogarithms.polylog(3,exp(a+b*x))+-3//2*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,exp(a+b*x))+-3//2*d*b^-2*(c+d*x)^2*csch(a+b*x)+-1//2*b^-1*(c+d*x)^3*coth(a+b*x)*csch(a+b*x)+3//2*d*b^-2*(c+d*x)^2*Polylogarithms.polylog(2,-1*exp(a+b*x)))
	@test integrate((c+d*x)^2*csch(a+b*x)^3, x) == :(b^-1*(c+d*x)^2*arctanh(exp(a+b*x))+b^-3*d^2*Polylogarithms.polylog(3,exp(a+b*x))+-1*b^-3*d^2*Polylogarithms.polylog(3,-1*exp(a+b*x))+-1*b^-3*d^2*arctanh(cosh(a+b*x))+d*b^-2*(c+d*x)*Polylogarithms.polylog(2,-1*exp(a+b*x))+-1*d*b^-2*(c+d*x)*Polylogarithms.polylog(2,exp(a+b*x))+-1*d*b^-2*(c+d*x)*csch(a+b*x)+-1//2*b^-1*(c+d*x)^2*coth(a+b*x)*csch(a+b*x))
	@test integrate(csch(a+b*x)^3*(c+d*x), x) == :(b^-1*(c+d*x)*arctanh(exp(a+b*x))+(1/2)*d*b^-2*Polylogarithms.polylog(2,-1*exp(a+b*x))+-1//2*d*b^-2*Polylogarithms.polylog(2,exp(a+b*x))+-1//2*d*b^-2*csch(a+b*x)+-1//2*b^-1*(c+d*x)*coth(a+b*x)*csch(a+b*x))
	@test integrate(x*csch(x)^-3//2+1//3*x*csch(x)^(1/2), x) == :(-4//9*csch(x)^-3//2+2//3*x*csch(x)^-1//2*cosh(x))
end

@testset "6.6.2 (e x)^m (a+b csch(c+d x^n))^p.jl" begin
	@test integrate(x^5*(a+b*csch(c+d*x^2)), x) == :(1//6*a*x^6+b*d^-3*Polylogarithms.polylog(3,-1*exp(c+d*x^2))+-1*b*d^-3*Polylogarithms.polylog(3,exp(c+d*x^2))+b*d^-2*x^2*Polylogarithms.polylog(2,exp(c+d*x^2))+-1*b*d^-1*x^4*arctanh(exp(c+d*x^2))+-1*b*d^-2*x^2*Polylogarithms.polylog(2,-1*exp(c+d*x^2)))
	@test integrate(x^3*(a+b*csch(c+d*x^2)), x) == :(1//4*a*x^4+(1/2)*b*d^-2*Polylogarithms.polylog(2,exp(c+d*x^2))+-1//2*b*d^-2*Polylogarithms.polylog(2,-1*exp(c+d*x^2))+-1*b*d^-1*x^2*arctanh(exp(c+d*x^2)))
	@test integrate(x*(a+b*csch(c+d*x^2)), x) == :((1/2)*a*x^2+-1//2*b*d^-1*arctanh(cosh(c+d*x^2)))
	@test integrate(x^5*(a+b*csch(c+d*x^2))^2, x) == :(1//6*a^2*x^6+(1/2)*b^2*d^-3*Polylogarithms.polylog(2,exp(2c+2*d*x^2))+-1//2*b^2*d^-1*x^4+b^2*d^-2*x^2*log(1+-1*exp(2c+2*d*x^2))+-2*a*b*d^-3*Polylogarithms.polylog(3,exp(c+d*x^2))+2*a*b*d^-3*Polylogarithms.polylog(3,-1*exp(c+d*x^2))+-1//2*b^2*d^-1*x^4*coth(c+d*x^2)+-2*a*b*d^-1*x^4*arctanh(exp(c+d*x^2))+-2*a*b*d^-2*x^2*Polylogarithms.polylog(2,-1*exp(c+d*x^2))+2*a*b*d^-2*x^2*Polylogarithms.polylog(2,exp(c+d*x^2)))
	@test integrate(x^3*(a+b*csch(c+d*x^2))^2, x) == :(1//4*a^2*x^4+(1/2)*b^2*d^-2*log(sinh(c+d*x^2))+a*b*d^-2*Polylogarithms.polylog(2,exp(c+d*x^2))+-1*a*b*d^-2*Polylogarithms.polylog(2,-1*exp(c+d*x^2))+-1//2*b^2*d^-1*x^2*coth(c+d*x^2)+-2*a*b*d^-1*x^2*arctanh(exp(c+d*x^2)))
	@test integrate(x*(a+b*csch(c+d*x^2))^2, x) == :((1/2)*a^2*x^2+-1//2*b^2*d^-1*coth(c+d*x^2)+-1*a*b*d^-1*arctanh(cosh(c+d*x^2)))
	@test integrate(x*csch(a+b*x^2)^7, x) == :(5//32*b^-1*arctanh(cosh(a+b*x^2))+-5//32*b^-1*coth(a+b*x^2)*csch(a+b*x^2)+-1//12*b^-1*csch(a+b*x^2)^5*coth(a+b*x^2)+5//48*b^-1*csch(a+b*x^2)^3*coth(a+b*x^2))
	@test integrate(x^5*(a+b*csch(c+d*x^2))^-1, x) == :(1//6*a^-1*x^6+b*a^-1*d^-3*(a^2+b^2)^-1//2*Polylogarithms.polylog(3,-1*a*(b+-1*(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+-1*b*a^-1*d^-3*(a^2+b^2)^-1//2*Polylogarithms.polylog(3,-1*a*(b+(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+b*a^-1*d^-2*x^2*(a^2+b^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+(1/2)*b*a^-1*d^-1*x^4*(a^2+b^2)^-1//2*log(1+a*(b+(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+-1*b*a^-1*d^-2*x^2*(a^2+b^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+-1*(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+-1//2*b*a^-1*d^-1*x^4*(a^2+b^2)^-1//2*log(1+a*(b+-1*(a^2+b^2)^(1/2))^-1*exp(c+d*x^2)))
	@test integrate(x^3*(a+b*csch(c+d*x^2))^-1, x) == :(1//4*a^-1*x^4+(1/2)*b*a^-1*d^-2*(a^2+b^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+-1//2*b*a^-1*d^-2*(a^2+b^2)^-1//2*Polylogarithms.polylog(2,-1*a*(b+-1*(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+(1/2)*b*a^-1*d^-1*x^2*(a^2+b^2)^-1//2*log(1+a*(b+(a^2+b^2)^(1/2))^-1*exp(c+d*x^2))+-1//2*b*a^-1*d^-1*x^2*(a^2+b^2)^-1//2*log(1+a*(b+-1*(a^2+b^2)^(1/2))^-1*exp(c+d*x^2)))
	@test integrate(x*(a+b*csch(c+d*x^2))^-1, x) == :((1/2)*a^-1*x^2+b*a^-1*d^-1*(a^2+b^2)^-1//2*arctanh((a^2+b^2)^-1//2*(a+-1*b*tanh((1/2)*c+(1/2)*d*x^2))))
end

@testset "6.6.3 Hyperbolic cosecant functions.jl" begin
	@test integrate(csch(a+b*x), x) == :(-1*b^-1*arctanh(cosh(a+b*x)))
	@test integrate(csch(a+b*x)^2, x) == :(-1*b^-1*coth(a+b*x))
	@test integrate(csch(a+b*x)^3, x) == :((1/2)*b^-1*arctanh(cosh(a+b*x))+-1//2*b^-1*coth(a+b*x)*csch(a+b*x))
	@test integrate(csch(a+b*x)^4, x) == :(b^-1*coth(a+b*x)+-1//3*b^-1*coth(a+b*x)^3)
	@test integrate(csch(a+b*x)^5, x) == :(-3//8*b^-1*arctanh(cosh(a+b*x))+-1//4*b^-1*csch(a+b*x)^3*coth(a+b*x)+3//8*b^-1*coth(a+b*x)*csch(a+b*x))
	@test integrate(csch(a+b*x)^6, x) == :(-1*b^-1*coth(a+b*x)+-1//5*b^-1*coth(a+b*x)^5+2//3*b^-1*coth(a+b*x)^3)
	@test integrate(csch(a+b*x)^5//2, x) == :(-2//3*b^-1*csch(a+b*x)^3//2*cosh(a+b*x)+2//3*im*b^-1*(im*sinh(a+b*x))^(1/2)*csch(a+b*x)^(1/2)*Elliptic.F(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
	@test integrate(csch(a+b*x)^3//2, x) == :(-2*b^-1*csch(a+b*x)^(1/2)*cosh(a+b*x)+-2*im*b^-1*(im*sinh(a+b*x))^-1//2*csch(a+b*x)^-1//2*Elliptic.E(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
	@test integrate(csch(a+b*x)^(1/2), x) == :(-2*im*b^-1*(im*sinh(a+b*x))^(1/2)*csch(a+b*x)^(1/2)*Elliptic.F(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
	@test integrate(csch(a+b*x)^-1//2, x) == :(-2*im*b^-1*(im*sinh(a+b*x))^-1//2*csch(a+b*x)^-1//2*Elliptic.E(-1//4*pi+(1/2)*im*a+(1/2)*im*b*x,2))
end

@testset "6.6.7 (d hyper)^m (a+b (c csch)^n)^p.jl" begin
	@test integrate((a+b*csch(c+d*x)^2)^4, x) == :(x*a^4+-1//7*b^4*d^-1*coth(c+d*x)^7+-1//3*b^2*d^-1*coth(c+d*x)^3*(3*b^2+6*a^2+-8*a*b)+-1//5*b^3*d^-1*coth(c+d*x)^5*(-3b+4a)+-1*b*d^-1*(-1b+2a)*(b^2+2*a^2+-2*a*b)*coth(c+d*x))
	@test integrate((a+b*csch(c+d*x)^2)^3, x) == :(x*a^3+-1//5*b^3*d^-1*coth(c+d*x)^5+-1*b*d^-1*(b^2+3*a^2+-3*a*b)*coth(c+d*x)+-1//3*b^2*d^-1*coth(c+d*x)^3*(-2b+3a))
	@test integrate((a+b*csch(c+d*x)^2)^2, x) == :(x*a^2+-1//3*b^2*d^-1*coth(c+d*x)^3+-1*b*d^-1*(-1b+2a)*coth(c+d*x))
	@test integrate(a+b*csch(c+d*x)^2, x) == :(a*x+-1*b*d^-1*coth(c+d*x))
	@test integrate((a+b*csch(c+d*x)^2)^-1, x) == :(x*a^-1+-1*a^-1*b^(1/2)*d^-1*(a+-1b)^-1//2*arctan(b^-1//2*(a+-1b)^(1/2)*tanh(c+d*x)))
	@test integrate((a+b*csch(c+d*x)^2)^-2, x) == :(x*a^-2+(1/2)*b*a^-1*d^-1*(a+-1b)^-1*(a+-1b+b*coth(c+d*x)^2)^-1*coth(c+d*x)+-1//2*a^-2*b^(1/2)*d^-1*(a+-1b)^-3//2*(-2b+3a)*arctan(b^-1//2*(a+-1b)^(1/2)*tanh(c+d*x)))
	@test integrate((a+b*csch(c+d*x)^2)^-3, x) == :(x*a^-3+-1//8*a^-3*b^(1/2)*d^-1*(a+-1b)^-5//2*(8*b^2+15*a^2+-20*a*b)*arctan(b^-1//2*(a+-1b)^(1/2)*tanh(c+d*x))+1//4*b*a^-1*d^-1*(a+-1b)^-1*(a+-1b+b*coth(c+d*x)^2)^-2*coth(c+d*x)+1//8*b*a^-2*d^-1*(a+-1b)^-2*(a+-1b+b*coth(c+d*x)^2)^-1*(-4b+7a)*coth(c+d*x))
	@test integrate((a+b*csch(c+d*x)^2)^-4, x) == :(x*a^-4+-1//16*a^-4*b^(1/2)*d^-1*(a+-1b)^-7//2*(-16*b^3+35*a^3+-70*b*a^2+56*a*b^2)*arctan(b^-1//2*(a+-1b)^(1/2)*tanh(c+d*x))+1//6*b*a^-1*d^-1*(a+-1b)^-1*(a+-1b+b*coth(c+d*x)^2)^-3*coth(c+d*x)+1//16*b*a^-3*d^-1*(a+-1b)^-3*(a+-1b+b*coth(c+d*x)^2)^-1*(8*b^2+19*a^2+-22*a*b)*coth(c+d*x)+1//24*b*a^-2*d^-1*(a+-1b)^-2*(a+-1b+b*coth(c+d*x)^2)^-2*(-6b+11a)*coth(c+d*x))
	@test integrate((a+b*csch(c+d*x)^2)^5//2, x) == :(a^5//2*d^-1*arctanh(a^(1/2)*(a+-1b+b*coth(c+d*x)^2)^-1//2*coth(c+d*x))+-1//4*b*d^-1*(a+-1b+b*coth(c+d*x)^2)^3//2*coth(c+d*x)+-1//8*b^(1/2)*d^-1*(3*b^2+15*a^2+-10*a*b)*arctanh(b^(1/2)*(a+-1b+b*coth(c+d*x)^2)^-1//2*coth(c+d*x))+-1//8*b*d^-1*(a+-1b+b*coth(c+d*x)^2)^(1/2)*(-3b+7a)*coth(c+d*x))
	@test integrate((a+b*csch(c+d*x)^2)^3//2, x) == :(a^3//2*d^-1*arctanh(a^(1/2)*(a+-1b+b*coth(c+d*x)^2)^-1//2*coth(c+d*x))+-1//2*b*d^-1*(a+-1b+b*coth(c+d*x)^2)^(1/2)*coth(c+d*x)+-1//2*b^(1/2)*d^-1*(-1b+3a)*arctanh(b^(1/2)*(a+-1b+b*coth(c+d*x)^2)^-1//2*coth(c+d*x)))
end

@testset "6.7.1 Hyperbolic functions.jl" begin
	@test integrate(2*(-1+3*cosh(4+6x))^-1, x) == :(1//6*2^(1/2)*arctan(2^(1/2)*tanh(2+3x)))
	@test integrate((cosh(2+3x)^2+2*sinh(2+3x)^2)^-1, x) == :(1//6*2^(1/2)*arctan(2^(1/2)*tanh(2+3x)))
	@test integrate((1+2*tanh(2+3x)^2)^-1*sech(2+3x)^2, x) == :(1//6*2^(1/2)*arctan(2^(1/2)*tanh(2+3x)))
	@test integrate((2+coth(2+3x)^2)^-1*csch(2+3x)^2, x) == :(1//6*2^(1/2)*arctan(2^(1/2)*tanh(2+3x)))
	@test integrate((2+-1*coth(2+3x)^2)^-1*csch(2+3x)^2, x) == :(-1//6*2^(1/2)*arctanh(2^(1/2)*tanh(2+3x)))
	@test integrate((1+2*coth(2+3x)^2)^-1*csch(2+3x)^2, x) == :(1//6*2^(1/2)*arctan((1/2)*2^(1/2)*tanh(2+3x)))
	@test integrate((1+-2*coth(2+3x)^2)^-1*csch(2+3x)^2, x) == :(-1//6*2^(1/2)*arctanh((1/2)*2^(1/2)*tanh(2+3x)))
	@test integrate(cosh(a+b*x)*sinh(a+b*x), x) == :((1/2)*b^-1*sinh(a+b*x)^2)
	@test integrate(sinh(a+b*x)^n*cosh(a+b*x), x) == :(b^-1*(1+n)^-1*sinh(a+b*x)^(1+n))
	@test integrate(cosh(a+b*x)^3*sinh(a+b*x)^n, x) == :(b^-1*(1+n)^-1*sinh(a+b*x)^(1+n)+b^-1*(3+n)^-1*sinh(a+b*x)^(3+n))
end

@testset "7.1.2 (d x)^m (a+b arcsinh(c x))^n.jl" begin
	@test integrate(x^4*arcsinh(a*x), x) == :(-1//5*a^-5*(1+a^2*x^2)^(1/2)+-1//25*a^-5*(1+a^2*x^2)^5//2+1//5*x^5*arcsinh(a*x)+2//15*a^-5*(1+a^2*x^2)^3//2)
	@test integrate(x^3*arcsinh(a*x), x) == :(-3//32*a^-4*arcsinh(a*x)+1//4*x^4*arcsinh(a*x)+-1//16*a^-1*x^3*(1+a^2*x^2)^(1/2)+3//32*x*a^-3*(1+a^2*x^2)^(1/2))
	@test integrate(x^2*arcsinh(a*x), x) == :(-1//9*a^-3*(1+a^2*x^2)^3//2+1//3*a^-3*(1+a^2*x^2)^(1/2)+1//3*x^3*arcsinh(a*x))
	@test integrate(x*arcsinh(a*x), x) == :((1/2)*x^2*arcsinh(a*x)+1//4*a^-2*arcsinh(a*x)+-1//4*x*a^-1*(1+a^2*x^2)^(1/2))
	@test integrate(arcsinh(a*x), x) == :(x*arcsinh(a*x)+-1*a^-1*(1+a^2*x^2)^(1/2))
	@test integrate(x^-1*arcsinh(a*x), x) == :((1/2)*Polylogarithms.polylog(2,exp(2*arcsinh(a*x)))+-1//2*arcsinh(a*x)^2+arcsinh(a*x)*log(1+-1*exp(2*arcsinh(a*x))))
	@test integrate(x^-2*arcsinh(a*x), x) == :(-1*a*arctanh((1+a^2*x^2)^(1/2))+-1*x^-1*arcsinh(a*x))
	@test integrate(x^-3*arcsinh(a*x), x) == :(-1//2*x^-2*arcsinh(a*x)+-1//2*a*x^-1*(1+a^2*x^2)^(1/2))
	@test integrate(x^-4*arcsinh(a*x), x) == :(-1//3*x^-3*arcsinh(a*x)+1//6*a^3*arctanh((1+a^2*x^2)^(1/2))+-1//6*a*x^-2*(1+a^2*x^2)^(1/2))
	@test integrate(x^-5*arcsinh(a*x), x) == :(-1//4*x^-4*arcsinh(a*x)+-1//12*a*x^-3*(1+a^2*x^2)^(1/2)+1//6*a^3*x^-1*(1+a^2*x^2)^(1/2))
end

@testset "7.1.4a (f x)^m (d+c^2 d x^2)^p (a+b arcsinh(c x))^n.jl" begin
	@test integrate(x^4*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(1//5*d*x^5*(a+b*arcsinh(c*x))+-2//35*b*d*c^-5*(1+c^2*x^2)^(1/2)+-1//49*b*d*c^-5*(1+c^2*x^2)^7//2+-1//105*b*d*c^-5*(1+c^2*x^2)^3//2+1//7*d*c^2*x^7*(a+b*arcsinh(c*x))+8//175*b*d*c^-5*(1+c^2*x^2)^5//2)
	@test integrate(x^3*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(1//4*d*x^4*(a+b*arcsinh(c*x))+-1//24*b*d*c^-4*arcsinh(c*x)+1//6*d*c^2*x^6*(a+b*arcsinh(c*x))+-1//36*b*c*d*x^5*(1+c^2*x^2)^(1/2)+-1//36*b*d*c^-1*x^3*(1+c^2*x^2)^(1/2)+1//24*b*d*x*c^-3*(1+c^2*x^2)^(1/2))
	@test integrate(x^2*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(1//3*d*x^3*(a+b*arcsinh(c*x))+-1//25*b*d*c^-3*(1+c^2*x^2)^5//2+1//5*d*c^2*x^5*(a+b*arcsinh(c*x))+1//45*b*d*c^-3*(1+c^2*x^2)^3//2+2//15*b*d*c^-3*(1+c^2*x^2)^(1/2))
	@test integrate(x*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(-3//32*b*d*c^-2*arcsinh(c*x)+1//4*d*c^-2*(1+c^2*x^2)^2*(a+b*arcsinh(c*x))+-3//32*b*d*x*c^-1*(1+c^2*x^2)^(1/2)+-1//16*b*d*x*c^-1*(1+c^2*x^2)^3//2)
	@test integrate((a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(d*x*(a+b*arcsinh(c*x))+-2//3*b*d*c^-1*(1+c^2*x^2)^(1/2)+-1//9*b*d*c^-1*(1+c^2*x^2)^3//2+1//3*d*c^2*x^3*(a+b*arcsinh(c*x)))
	@test integrate(x^-1*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(d*(a+b*arcsinh(c*x))*log(1+-1*exp(2*arcsinh(c*x)))+(1/2)*b*d*Polylogarithms.polylog(2,exp(2*arcsinh(c*x)))+(1/2)*d*(1+c^2*x^2)*(a+b*arcsinh(c*x))+-1//2*d*b^-1*(a+b*arcsinh(c*x))^2+-1//4*b*d*arcsinh(c*x)+-1//4*b*c*d*x*(1+c^2*x^2)^(1/2))
	@test integrate(x^-2*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(-1*d*x^-1*(a+b*arcsinh(c*x))+d*x*c^2*(a+b*arcsinh(c*x))+-1*b*c*d*(1+c^2*x^2)^(1/2)+-1*b*c*d*arctanh((1+c^2*x^2)^(1/2)))
	@test integrate(x^-3*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(d*c^2*(a+b*arcsinh(c*x))*log(1+-1*exp(2*arcsinh(c*x)))+(1/2)*b*d*c^2*Polylogarithms.polylog(2,exp(2*arcsinh(c*x)))+(1/2)*b*d*c^2*arcsinh(c*x)+-1//2*d*b^-1*c^2*(a+b*arcsinh(c*x))^2+-1//2*d*x^-2*(1+c^2*x^2)*(a+b*arcsinh(c*x))+-1//2*b*c*d*x^-1*(1+c^2*x^2)^(1/2))
	@test integrate(x^-4*(a+b*arcsinh(c*x))*(d+d*c^2*x^2), x) == :(-1//3*d*x^-3*(a+b*arcsinh(c*x))+-1*d*c^2*x^-1*(a+b*arcsinh(c*x))+-5//6*b*d*c^3*arctanh((1+c^2*x^2)^(1/2))+-1//6*b*c*d*x^-2*(1+c^2*x^2)^(1/2))
	@test integrate(x^4*(d+d*c^2*x^2)^2*(a+b*arcsinh(c*x)), x) == :(1//5*d^2*x^5*(a+b*arcsinh(c*x))+-8//315*b*c^-5*d^2*(1+c^2*x^2)^(1/2)+-4//945*b*c^-5*d^2*(1+c^2*x^2)^3//2+-1//81*b*c^-5*d^2*(1+c^2*x^2)^9//2+-1//525*b*c^-5*d^2*(1+c^2*x^2)^5//2+1//9*c^4*d^2*x^9*(a+b*arcsinh(c*x))+2//7*c^2*d^2*x^7*(a+b*arcsinh(c*x))+10//441*b*c^-5*d^2*(1+c^2*x^2)^7//2)
end

@testset "7.1.4b (f x)^m (d+e x^2)^p (a+b arcsinh(c x))^n.jl" begin
	@test integrate((d+e*x^2)^4*(a+b*arcsinh(c*x)), x) == :(x*d^4*(a+b*arcsinh(c*x))+1//9*e^4*x^9*(a+b*arcsinh(c*x))+-1//81*b*c^-9*e^4*(1+c^2*x^2)^9//2+-1//315*b*c^-9*(1+c^2*x^2)^(1/2)*(35*e^4+315*c^8*d^4+-420*e*c^6*d^3+-180*d*c^2*e^3+378*c^4*d^2*e^2)+4//3*e*d^3*x^3*(a+b*arcsinh(c*x))+4//7*d*e^3*x^7*(a+b*arcsinh(c*x))+6//5*d^2*e^2*x^5*(a+b*arcsinh(c*x))+-4//441*b*c^-9*e^3*(1+c^2*x^2)^7//2*(-7*e+9*d*c^2)+-4//945*b*e*c^-9*(1+c^2*x^2)^3//2*(-35*e^3+105*c^6*d^3+-189*e*c^4*d^2+135*d*c^2*e^2)+-2//525*b*c^-9*e^2*(1+c^2*x^2)^5//2*(35*e^2+63*c^4*d^2+-90*d*e*c^2))
	@test integrate((d+e*x^2)^3*(a+b*arcsinh(c*x)), x) == :(x*d^3*(a+b*arcsinh(c*x))+1//7*e^3*x^7*(a+b*arcsinh(c*x))+e*d^2*x^3*(a+b*arcsinh(c*x))+-1//35*b*c^-7*(1+c^2*x^2)^(1/2)*(-5*e^3+35*c^6*d^3+-35*e*c^4*d^2+21*d*c^2*e^2)+-1//49*b*c^-7*e^3*(1+c^2*x^2)^7//2+3//5*d*e^2*x^5*(a+b*arcsinh(c*x))+-3//175*b*c^-7*e^2*(1+c^2*x^2)^5//2*(-5*e+7*d*c^2)+-1//105*b*e*c^-7*(1+c^2*x^2)^3//2*(15*e^2+35*c^4*d^2+-42*d*e*c^2))
	@test integrate((d+e*x^2)^2*(a+b*arcsinh(c*x)), x) == :(x*d^2*(a+b*arcsinh(c*x))+1//5*e^2*x^5*(a+b*arcsinh(c*x))+-1//15*b*c^-5*(1+c^2*x^2)^(1/2)*(3*e^2+15*c^4*d^2+-10*d*e*c^2)+-1//25*b*c^-5*e^2*(1+c^2*x^2)^5//2+2//3*d*e*x^3*(a+b*arcsinh(c*x))+-2//45*b*e*c^-5*(1+c^2*x^2)^3//2*(-3*e+5*d*c^2))
	@test integrate((a+b*arcsinh(c*x))*(d+e*x^2), x) == :(d*x*(a+b*arcsinh(c*x))+1//3*e*x^3*(a+b*arcsinh(c*x))+-1//3*b*c^-3*(1+c^2*x^2)^(1/2)*(-1*e+3*d*c^2)+-1//9*b*e*c^-3*(1+c^2*x^2)^3//2)
	@test integrate(a+b*arcsinh(c*x), x) == :(a*x+b*x*arcsinh(c*x)+-1*b*c^-1*(1+c^2*x^2)^(1/2))
	@test integrate((d+e*x^2)^-1*(a+b*arcsinh(c*x)), x) == :((1/2)*b*e^-1//2*(-1d)^-1//2*Polylogarithms.polylog(2,e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+(1/2)*b*e^-1//2*(-1d)^-1//2*Polylogarithms.polylog(2,e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+(1/2)*e^-1//2*(-1d)^-1//2*(a+b*arcsinh(c*x))*log(1+-1*e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+(1/2)*e^-1//2*(-1d)^-1//2*(a+b*arcsinh(c*x))*log(1+-1*e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//2*b*e^-1//2*(-1d)^-1//2*Polylogarithms.polylog(2,-1*e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//2*b*e^-1//2*(-1d)^-1//2*Polylogarithms.polylog(2,-1*e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//2*e^-1//2*(-1d)^-1//2*(a+b*arcsinh(c*x))*log(1+e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//2*e^-1//2*(-1d)^-1//2*(a+b*arcsinh(c*x))*log(1+e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x))))
	@test integrate((d+e*x^2)^-2*(a+b*arcsinh(c*x)), x) == :(-1//4*b*e^-1//2*(-1d)^-3//2*Polylogarithms.polylog(2,e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//4*b*e^-1//2*(-1d)^-3//2*Polylogarithms.polylog(2,e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//4*d^-1*e^-1//2*((-1d)^(1/2)+-1*x*e^(1/2))^-1*(a+b*arcsinh(c*x))+-1//4*e^-1//2*(-1d)^-3//2*(a+b*arcsinh(c*x))*log(1+-1*e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//4*e^-1//2*(-1d)^-3//2*(a+b*arcsinh(c*x))*log(1+-1*e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+1//4*b*e^-1//2*(-1d)^-3//2*Polylogarithms.polylog(2,-1*e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+1//4*b*e^-1//2*(-1d)^-3//2*Polylogarithms.polylog(2,-1*e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+1//4*d^-1*e^-1//2*((-1d)^(1/2)+x*e^(1/2))^-1*(a+b*arcsinh(c*x))+1//4*e^-1//2*(-1d)^-3//2*(a+b*arcsinh(c*x))*log(1+e^(1/2)*((e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+1//4*e^-1//2*(-1d)^-3//2*(a+b*arcsinh(c*x))*log(1+e^(1/2)*(-1*(e+-1*d*c^2)^(1/2)+c*(-1d)^(1/2))^-1*exp(arcsinh(c*x)))+-1//4*b*c*d^-1*e^-1//2*(-1*e+d*c^2)^-1//2*arctan((1+c^2*x^2)^-1//2*(-1*e+d*c^2)^-1//2*(e^(1/2)+x*c^2*(-1d)^(1/2)))+-1//4*b*c*d^-1*e^-1//2*(-1*e+d*c^2)^-1//2*arctan((1+c^2*x^2)^-1//2*(-1*e+d*c^2)^-1//2*(e^(1/2)+-1*x*c^2*(-1d)^(1/2))))
	@test integrate((a+b*arcsinh(c*x))^2*(d+e*x^2)^3, x) == :(x*d^3*(a+b*arcsinh(c*x))^2+2*x*b^2*d^3+1//7*e^3*x^7*(a+b*arcsinh(c*x))^2+2//343*b^2*e^3*x^7+e*d^2*x^3*(a+b*arcsinh(c*x))^2+-32//245*x*b^2*c^-6*e^3+-12//1225*b^2*c^-2*e^3*x^5+2//9*e*b^2*d^2*x^3+3//5*d*e^2*x^5*(a+b*arcsinh(c*x))^2+6//125*d*b^2*e^2*x^5+16//735*b^2*c^-4*e^3*x^3+-2*b*c^-1*d^3*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-8//75*d*b^2*c^-2*e^2*x^3+-4//3*e*x*b^2*c^-2*d^2+16//25*d*x*b^2*c^-4*e^2+32//245*b*c^-7*e^3*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-16//25*b*d*c^-5*e^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-16//245*b*c^-5*e^3*x^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-2//49*b*c^-1*e^3*x^6*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+4//3*b*e*c^-3*d^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+12//245*b*c^-3*e^3*x^4*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-6//25*b*d*c^-1*e^2*x^4*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-2//3*b*e*c^-1*d^2*x^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+8//25*b*d*c^-3*e^2*x^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x)))
	@test integrate((a+b*arcsinh(c*x))^2*(d+e*x^2)^2, x) == :(x*d^2*(a+b*arcsinh(c*x))^2+2*x*b^2*d^2+1//5*e^2*x^5*(a+b*arcsinh(c*x))^2+2//125*b^2*e^2*x^5+-8//225*b^2*c^-2*e^2*x^3+2//3*d*e*x^3*(a+b*arcsinh(c*x))^2+4//27*d*e*b^2*x^3+16//75*x*b^2*c^-4*e^2+-2*b*c^-1*d^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-16//75*b*c^-5*e^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-8//9*d*e*x*b^2*c^-2+-2//25*b*c^-1*e^2*x^4*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+8//9*b*d*e*c^-3*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+8//75*b*c^-3*e^2*x^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-4//9*b*d*e*c^-1*x^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x)))
	@test integrate((a+b*arcsinh(c*x))^2*(d+e*x^2), x) == :(d*x*(a+b*arcsinh(c*x))^2+2*d*x*b^2+1//3*e*x^3*(a+b*arcsinh(c*x))^2+2//27*e*b^2*x^3+-4//9*e*x*b^2*c^-2+-2*b*d*c^-1*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+4//9*b*e*c^-3*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x))+-2//9*b*e*c^-1*x^2*(1+c^2*x^2)^(1/2)*(a+b*arcsinh(c*x)))
end

@testset "7.1.5 Inverse hyperbolic sine functions.jl" begin
	@test integrate((d+e*x)^-1*arcsinh(c*x), x) == :(e^-1*Polylogarithms.polylog(2,-1*e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+e^-1*Polylogarithms.polylog(2,-1*e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+-1//2*e^-1*arcsinh(c*x)^2+e^-1*arcsinh(c*x)*log(1+e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+e^-1*arcsinh(c*x)*log(1+e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x))))
	@test integrate((d+e*x)^-1*arcsinh(c*x)^2, x) == :(-2*e^-1*Polylogarithms.polylog(3,-1*e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+-2*e^-1*Polylogarithms.polylog(3,-1*e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+-1//3*e^-1*arcsinh(c*x)^3+e^-1*arcsinh(c*x)^2*log(1+e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+e^-1*arcsinh(c*x)^2*log(1+e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+2*e^-1*Polylogarithms.polylog(2,-1*e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))*arcsinh(c*x)+2*e^-1*Polylogarithms.polylog(2,-1*e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))*arcsinh(c*x))
	@test integrate((d+e*x)^-1*arcsinh(c*x)^3, x) == :(6*e^-1*Polylogarithms.polylog(4,-1*e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+6*e^-1*Polylogarithms.polylog(4,-1*e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+-1//4*e^-1*arcsinh(c*x)^4+e^-1*arcsinh(c*x)^3*log(1+e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+e^-1*arcsinh(c*x)^3*log(1+e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+-6*e^-1*Polylogarithms.polylog(3,-1*e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))*arcsinh(c*x)+-6*e^-1*Polylogarithms.polylog(3,-1*e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))*arcsinh(c*x)+3*e^-1*arcsinh(c*x)^2*Polylogarithms.polylog(2,-1*e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+3*e^-1*arcsinh(c*x)^2*Polylogarithms.polylog(2,-1*e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x))))
	@test integrate((d+e*x)^3*(a+b*arcsinh(c*x)), x) == :(1//4*e^-1*(d+e*x)^4*(a+b*arcsinh(c*x))+-1//16*b*c^-1*(1+c^2*x^2)^(1/2)*(d+e*x)^3+-1//96*b*c^-3*(1+c^2*x^2)^(1/2)*(4*d*(-16*e^2+19*c^2*d^2)+e*x*(-9*e^2+26*c^2*d^2))+-7//48*b*d*c^-1*(1+c^2*x^2)^(1/2)*(d+e*x)^2+-1//32*b*c^-4*e^-1*(3*e^4+8*c^4*d^4+-24*c^2*d^2*e^2)*arcsinh(c*x))
	@test integrate((d+e*x)^2*(a+b*arcsinh(c*x)), x) == :(1//3*e^-1*(d+e*x)^3*(a+b*arcsinh(c*x))+-1//9*b*c^-1*(1+c^2*x^2)^(1/2)*(d+e*x)^2+-1//18*b*c^-3*(1+c^2*x^2)^(1/2)*(-4*e^2+16*c^2*d^2+5*d*e*x*c^2)+-1//6*b*d*e^-1*(2*d^2+-3*c^-2*e^2)*arcsinh(c*x))
	@test integrate((a+b*arcsinh(c*x))*(d+e*x), x) == :((1/2)*e^-1*(d+e*x)^2*(a+b*arcsinh(c*x))+-3//4*b*d*c^-1*(1+c^2*x^2)^(1/2)+-1//4*b*c^-1*(1+c^2*x^2)^(1/2)*(d+e*x)+-1//4*b*e^-1*(2*d^2+-1*c^-2*e^2)*arcsinh(c*x))
	@test integrate(a+b*arcsinh(c*x), x) == :(a*x+b*x*arcsinh(c*x)+-1*b*c^-1*(1+c^2*x^2)^(1/2))
	@test integrate((d+e*x)^-1*(a+b*arcsinh(c*x)), x) == :(b*e^-1*Polylogarithms.polylog(2,-1*e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+b*e^-1*Polylogarithms.polylog(2,-1*e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+e^-1*(a+b*arcsinh(c*x))*log(1+e*((e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+e^-1*(a+b*arcsinh(c*x))*log(1+e*(-1*(e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arcsinh(c*x)))+-1//2*b^-1*e^-1*(a+b*arcsinh(c*x))^2)
	@test integrate((d+e*x)^-2*(a+b*arcsinh(c*x)), x) == :(-1*e^-1*(d+e*x)^-1*(a+b*arcsinh(c*x))+-1*b*c*e^-1*(e^2+c^2*d^2)^-1//2*arctanh((1+c^2*x^2)^-1//2*(e^2+c^2*d^2)^-1//2*(e+-1*d*x*c^2)))
	@test integrate((d+e*x)^-3*(a+b*arcsinh(c*x)), x) == :(-1//2*e^-1*(d+e*x)^-2*(a+b*arcsinh(c*x))+-1*b*c*(1+c^2*x^2)^(1/2)*(d+e*x)^-1*(2*e^2+2*c^2*d^2)^-1+-1//2*b*d*c^3*e^-1*(e^2+c^2*d^2)^-3//2*arctanh((1+c^2*x^2)^-1//2*(e^2+c^2*d^2)^-1//2*(e+-1*d*x*c^2)))
end

@testset "7.2.2 (d x)^m (a+b arccosh(c x))^n.jl" begin
	@test integrate(x^4*arccosh(a*x), x) == :(1//5*x^5*arccosh(a*x)+-8//75*a^-5*(1+a*x)^(1/2)*(-1+a*x)^(1/2)+-4//75*a^-3*x^2*(1+a*x)^(1/2)*(-1+a*x)^(1/2)+-1//25*a^-1*x^4*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
	@test integrate(x^3*arccosh(a*x), x) == :(-3//32*a^-4*arccosh(a*x)+1//4*x^4*arccosh(a*x)+-3//32*x*a^-3*(1+a*x)^(1/2)*(-1+a*x)^(1/2)+-1//16*a^-1*x^3*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
	@test integrate(x^2*arccosh(a*x), x) == :(1//3*x^3*arccosh(a*x)+-2//9*a^-3*(1+a*x)^(1/2)*(-1+a*x)^(1/2)+-1//9*a^-1*x^2*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
	@test integrate(x*arccosh(a*x), x) == :((1/2)*x^2*arccosh(a*x)+-1//4*a^-2*arccosh(a*x)+-1//4*x*a^-1*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
	@test integrate(arccosh(a*x), x) == :(x*arccosh(a*x)+-1*a^-1*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
	@test integrate(x^-1*arccosh(a*x), x) == :((1/2)*Polylogarithms.polylog(2,-1*exp(2*arccosh(a*x)))+-1//2*arccosh(a*x)^2+arccosh(a*x)*log(1+exp(2*arccosh(a*x))))
	@test integrate(x^-2*arccosh(a*x), x) == :(a*arctan((1+a*x)^(1/2)*(-1+a*x)^(1/2))+-1*x^-1*arccosh(a*x))
	@test integrate(x^-3*arccosh(a*x), x) == :(-1//2*x^-2*arccosh(a*x)+(1/2)*a*x^-1*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
	@test integrate(x^-4*arccosh(a*x), x) == :(-1//3*x^-3*arccosh(a*x)+1//6*a^3*arctan((1+a*x)^(1/2)*(-1+a*x)^(1/2))+1//6*a*x^-2*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
	@test integrate(x^-5*arccosh(a*x), x) == :(-1//4*x^-4*arccosh(a*x)+1//6*a^3*x^-1*(1+a*x)^(1/2)*(-1+a*x)^(1/2)+1//12*a*x^-3*(1+a*x)^(1/2)*(-1+a*x)^(1/2))
end

@testset "7.2.4a (f x)^m (d-c^2 d x^2)^p (a+b arccosh(c x))^n.jl" begin
	@test integrate(x^4*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(1//5*d*x^5*(a+b*arccosh(c*x))+-1//7*d*c^2*x^7*(a+b*arccosh(c*x))+-152//3675*b*d*c^-5*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-76//3675*b*d*c^-3*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-19//1225*b*d*c^-1*x^4*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+1//49*b*c*d*x^6*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^3*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(1//4*d*x^4*(a+b*arccosh(c*x))+-1//6*d*c^2*x^6*(a+b*arccosh(c*x))+-1//24*b*d*c^-4*arccosh(c*x)+-1//24*b*d*x*c^-3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-1//36*b*d*c^-1*x^3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+1//36*b*c*d*x^5*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^2*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(1//3*d*x^3*(a+b*arccosh(c*x))+-1//5*d*c^2*x^5*(a+b*arccosh(c*x))+-26//225*b*d*c^-3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-13//225*b*d*c^-1*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+1//25*b*c*d*x^4*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(-1//4*d*c^-2*(1+-1*c^2*x^2)^2*(a+b*arccosh(c*x))+3//32*b*d*c^-2*arccosh(c*x)+-3//32*b*d*x*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+1//16*b*d*x*c^-1*(1+c*x)^3//2*(-1+c*x)^3//2)
	@test integrate((a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(d*x*(a+b*arccosh(c*x))+-1//3*d*c^2*x^3*(a+b*arccosh(c*x))+-7//9*b*d*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+1//9*b*c*d*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^-1*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(d*(a+b*arccosh(c*x))*log(1+exp(2*arccosh(c*x)))+(1/2)*b*d*Polylogarithms.polylog(2,-1*exp(2*arccosh(c*x)))+(1/2)*d*(1+-1*c^2*x^2)*(a+b*arccosh(c*x))+-1//2*d*b^-1*(a+b*arccosh(c*x))^2+-1//4*b*d*arccosh(c*x)+1//4*b*c*d*x*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^-2*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(-1*d*x^-1*(a+b*arccosh(c*x))+b*c*d*arctan((1+c*x)^(1/2)*(-1+c*x)^(1/2))+-1*d*x*c^2*(a+b*arccosh(c*x))+b*c*d*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^-3*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :((1/2)*d*b^-1*c^2*(a+b*arccosh(c*x))^2+-1*d*c^2*(a+b*arccosh(c*x))*log(1+exp(2*arccosh(c*x)))+-1//2*b*d*c^2*Polylogarithms.polylog(2,-1*exp(2*arccosh(c*x)))+-1//2*b*d*c^2*arccosh(c*x)+-1//2*d*x^-2*(1+-1*c^2*x^2)*(a+b*arccosh(c*x))+(1/2)*b*c*d*x^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^-4*(a+b*arccosh(c*x))*(d+-1*d*c^2*x^2), x) == :(-1//3*d*x^-3*(a+b*arccosh(c*x))+d*c^2*x^-1*(a+b*arccosh(c*x))+-5//6*b*d*c^3*arctan((1+c*x)^(1/2)*(-1+c*x)^(1/2))+1//6*b*c*d*x^-2*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x*(d+-1*d*c^2*x^2)^2*(a+b*arccosh(c*x)), x) == :(-1//6*c^-2*d^2*(1+-1*c^2*x^2)^3*(a+b*arccosh(c*x))+5//96*b*c^-2*d^2*arccosh(c*x)+-5//96*b*x*c^-1*d^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-1//36*b*x*c^-1*d^2*(1+c*x)^5//2*(-1+c*x)^5//2+5//144*b*x*c^-1*d^2*(1+c*x)^3//2*(-1+c*x)^3//2)
end

@testset "7.2.4b (f x)^m (d+e x^2)^p (a+b arccosh(c x))^n.jl" begin
	@test integrate(x^4*(a+b*arccosh(c*x))*(d+e*x^2), x) == :(1//5*d*x^5*(a+b*arccosh(c*x))+1//7*e*x^7*(a+b*arccosh(c*x))+-8//3675*b*c^-7*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(30*e+49*d*c^2)+-4//3675*b*c^-5*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(30*e+49*d*c^2)+-1//49*b*e*c^-1*x^6*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-1//1225*b*c^-3*x^4*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(30*e+49*d*c^2))
	@test integrate(x^3*(a+b*arccosh(c*x))*(d+e*x^2), x) == :(1//4*d*x^4*(a+b*arccosh(c*x))+1//6*e*x^6*(a+b*arccosh(c*x))+-1//96*b*c^-6*(5*e+9*d*c^2)*arccosh(c*x)+-1//36*b*e*c^-1*x^5*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-1//96*b*x*c^-5*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(5*e+9*d*c^2)+-1//144*b*c^-3*x^3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(5*e+9*d*c^2))
	@test integrate(x^2*(a+b*arccosh(c*x))*(d+e*x^2), x) == :(1//3*d*x^3*(a+b*arccosh(c*x))+1//5*e*x^5*(a+b*arccosh(c*x))+-2//225*b*c^-5*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(12*e+25*d*c^2)+-1//25*b*e*c^-1*x^4*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-1//225*b*c^-3*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(12*e+25*d*c^2))
	@test integrate(x*(a+b*arccosh(c*x))*(d+e*x^2), x) == :((1/2)*d*x^2*(a+b*arccosh(c*x))+1//4*e*x^4*(a+b*arccosh(c*x))+-1//32*b*c^-4*(3*e+8*d*c^2)*arccosh(c*x)+-1//16*b*e*c^-1*x^3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-1//32*b*x*c^-3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(3*e+8*d*c^2))
	@test integrate((a+b*arccosh(c*x))*(d+e*x^2), x) == :(d*x*(a+b*arccosh(c*x))+1//3*e*x^3*(a+b*arccosh(c*x))+-1//9*b*c^-3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(2*e+9*d*c^2)+-1//9*b*e*c^-1*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^-1*(a+b*arccosh(c*x))*(d+e*x^2), x) == :(d*(a+b*arccosh(c*x))*log(x)+(1/2)*e*x^2*(a+b*arccosh(c*x))+-1//4*b*e*c^-2*arccosh(c*x)+-1//4*b*e*x*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+b*d*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*arcsin(c*x)*log(1+-1*exp(2*im*arcsin(c*x)))+-1*b*d*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*arcsin(c*x)*log(x)+-1//2*im*b*d*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*arcsin(c*x)^2+-1//2*im*b*d*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*Polylogarithms.polylog(2,exp(2*im*arcsin(c*x))))
	@test integrate(x^-2*(a+b*arccosh(c*x))*(d+e*x^2), x) == :(e*x*(a+b*arccosh(c*x))+-1*d*x^-1*(a+b*arccosh(c*x))+b*c*d*arctan((1+c*x)^(1/2)*(-1+c*x)^(1/2))+-1*b*e*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^-3*(a+b*arccosh(c*x))*(d+e*x^2), x) == :(e*(a+b*arccosh(c*x))*log(x)+-1//2*d*x^-2*(a+b*arccosh(c*x))+(1/2)*b*c*d*x^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+b*e*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*arcsin(c*x)*log(1+-1*exp(2*im*arcsin(c*x)))+-1*b*e*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*arcsin(c*x)*log(x)+-1//2*im*b*e*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*arcsin(c*x)^2+-1//2*im*b*e*(1+c*x)^-1//2*(1+-1*c^2*x^2)^(1/2)*(-1+c*x)^-1//2*Polylogarithms.polylog(2,exp(2*im*arcsin(c*x))))
	@test integrate(x^-4*(a+b*arccosh(c*x))*(d+e*x^2), x) == :(-1*e*x^-1*(a+b*arccosh(c*x))+-1//3*d*x^-3*(a+b*arccosh(c*x))+1//6*b*c*(6*e+d*c^2)*arctan((1+c*x)^(1/2)*(-1+c*x)^(1/2))+1//6*b*c*d*x^-2*(1+c*x)^(1/2)*(-1+c*x)^(1/2))
	@test integrate(x^4*(d+e*x^2)^2*(a+b*arccosh(c*x)), x) == :(1//5*d^2*x^5*(a+b*arccosh(c*x))+1//9*e^2*x^9*(a+b*arccosh(c*x))+2//7*d*e*x^7*(a+b*arccosh(c*x))+-2//945*b*c^-9*(1+c*x)^-1//2*(1+-1*c^2*x^2)^2*(-1+c*x)^-1//2*(70*e^2+63*c^4*d^2+135*d*e*c^2)+1//81*b*c^-9*e^2*(1+c*x)^-1//2*(1+-1*c^2*x^2)^5*(-1+c*x)^-1//2+1//315*b*c^-9*(1+c*x)^-1//2*(-1+c*x)^-1//2*(1+-1*c^2*x^2)*(35*e^2+63*c^4*d^2+90*d*e*c^2)+1//525*b*c^-9*(1+c*x)^-1//2*(1+-1*c^2*x^2)^3*(-1+c*x)^-1//2*(70*e^2+21*c^4*d^2+90*d*e*c^2)+-2//441*b*e*c^-9*(1+c*x)^-1//2*(1+-1*c^2*x^2)^4*(-1+c*x)^-1//2*(14*e+9*d*c^2))
end

@testset "7.2.5 Inverse hyperbolic cosine functions.jl" begin
	@test integrate((d+e*x)^3*arccosh(c*x), x) == :(1//4*e^-1*(d+e*x)^4*arccosh(c*x)+-1//16*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(d+e*x)^3+-1//32*c^-4*e^-1*(3*e^4+8*c^4*d^4+24*c^2*d^2*e^2)*arccosh(c*x)+-1//96*c^-3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(4*d*(16*e^2+19*c^2*d^2)+e*x*(9*e^2+26*c^2*d^2))+-7//48*d*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(d+e*x)^2)
	@test integrate((d+e*x)^2*arccosh(c*x), x) == :(-1//6*d*(2*d^2*e^-1+3*e*c^-2)*arccosh(c*x)+1//3*e^-1*(d+e*x)^3*arccosh(c*x)+-1//9*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(d+e*x)^2+-1//18*c^-3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(4*e^2+16*c^2*d^2+5*d*e*x*c^2))
	@test integrate((d+e*x)*arccosh(c*x), x) == :(-1*((1/2)*d^2*e^-1+1//4*e*c^-2)*arccosh(c*x)+(1/2)*e^-1*(d+e*x)^2*arccosh(c*x)+-3//4*d*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)+-1//4*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(d+e*x))
	@test integrate((d+e*x)^-1*arccosh(c*x), x) == :(e^-1*Polylogarithms.polylog(2,-1*e*((-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))+e^-1*Polylogarithms.polylog(2,-1*e*(-1*(-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))+-1//2*e^-1*arccosh(c*x)^2+e^-1*arccosh(c*x)*log(1+e*((-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))+e^-1*arccosh(c*x)*log(1+e*(-1*(-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x))))
	@test integrate((d+e*x)^-2*arccosh(c*x), x) == :(-1*e^-1*(d+e*x)^-1*arccosh(c*x)+2*c*e^-1*(e+c*d)^-1//2*(-1*e+c*d)^-1//2*arctanh((1+c*x)^(1/2)*(-1+c*x)^-1//2*(e+c*d)^(1/2)*(-1*e+c*d)^-1//2))
	@test integrate((d+e*x)^-3*arccosh(c*x), x) == :(-1//2*e^-1*(d+e*x)^-2*arccosh(c*x)+-1*c*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*(d+e*x)^-1*(-2*e^2+2*c^2*d^2)^-1+d*c^3*e^-1*(e+c*d)^-3//2*(-1*e+c*d)^-3//2*arctanh((1+c*x)^(1/2)*(-1+c*x)^-1//2*(e+c*d)^(1/2)*(-1*e+c*d)^-1//2))
	@test integrate((d+e*x)^3*arccosh(c*x)^2, x) == :(2*x*d^3+1//32*e^3*x^4+-3//32*c^-4*e^3*arccosh(c*x)^2+-1//4*d^4*e^-1*arccosh(c*x)^2+1//4*e^-1*(d+e*x)^4*arccosh(c*x)^2+2//9*d*e^2*x^3+3//4*e*d^2*x^2+3//32*c^-2*e^3*x^2+-3//4*e*c^-2*d^2*arccosh(c*x)^2+4//3*d*x*c^-2*e^2+-2*c^-1*d^3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-4//3*d*c^-3*e^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-3//16*x*c^-3*e^3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-1//8*c^-1*e^3*x^3*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-3//2*e*x*c^-1*d^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-2//3*d*c^-1*e^2*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x))
	@test integrate((d+e*x)^2*arccosh(c*x)^2, x) == :(2*x*d^2+2//27*e^2*x^3+(1/2)*d*e*x^2+-1//3*d^3*e^-1*arccosh(c*x)^2+1//3*e^-1*(d+e*x)^3*arccosh(c*x)^2+4//9*x*c^-2*e^2+-1//2*d*e*c^-2*arccosh(c*x)^2+-2*c^-1*d^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-4//9*c^-3*e^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-2//9*c^-1*e^2*x^2*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-1*d*e*x*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x))
	@test integrate(arccosh(c*x)^2*(d+e*x), x) == :(2*d*x+1//4*e*x^2+(1/2)*e^-1*(d+e*x)^2*arccosh(c*x)^2+-1//2*d^2*e^-1*arccosh(c*x)^2+-1//4*e*c^-2*arccosh(c*x)^2+-2*d*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x)+-1//2*e*x*c^-1*(1+c*x)^(1/2)*(-1+c*x)^(1/2)*arccosh(c*x))
	@test integrate((d+e*x)^-1*arccosh(c*x)^2, x) == :(-2*e^-1*Polylogarithms.polylog(3,-1*e*((-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))+-2*e^-1*Polylogarithms.polylog(3,-1*e*(-1*(-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))+-1//3*e^-1*arccosh(c*x)^3+e^-1*arccosh(c*x)^2*log(1+e*((-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))+e^-1*arccosh(c*x)^2*log(1+e*(-1*(-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))+2*e^-1*Polylogarithms.polylog(2,-1*e*((-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))*arccosh(c*x)+2*e^-1*Polylogarithms.polylog(2,-1*e*(-1*(-1*e^2+c^2*d^2)^(1/2)+c*d)^-1*exp(arccosh(c*x)))*arccosh(c*x))
end

@testset "7.3.2 (d x)^m (a+b arctanh(c x^n))^p.jl" begin
	@test integrate(x^5*(a+b*arctanh(c*x)), x) == :(1//6*x^6*(a+b*arctanh(c*x))+-1//6*b*c^-6*arctanh(c*x)+1//6*b*x*c^-5+1//18*b*c^-3*x^3+1//30*b*c^-1*x^5)
	@test integrate(x^4*(a+b*arctanh(c*x)), x) == :(1//5*x^5*(a+b*arctanh(c*x))+1//10*b*c^-5*log(1+-1*c^2*x^2)+1//10*b*c^-3*x^2+1//20*b*c^-1*x^4)
	@test integrate(x^3*(a+b*arctanh(c*x)), x) == :(1//4*x^4*(a+b*arctanh(c*x))+-1//4*b*c^-4*arctanh(c*x)+1//4*b*x*c^-3+1//12*b*c^-1*x^3)
	@test integrate(x^2*(a+b*arctanh(c*x)), x) == :(1//3*x^3*(a+b*arctanh(c*x))+1//6*b*c^-1*x^2+1//6*b*c^-3*log(1+-1*c^2*x^2))
	@test integrate(x*(a+b*arctanh(c*x)), x) == :((1/2)*x^2*(a+b*arctanh(c*x))+(1/2)*b*x*c^-1+-1//2*b*c^-2*arctanh(c*x))
	@test integrate(a+b*arctanh(c*x), x) == :(a*x+b*x*arctanh(c*x)+(1/2)*b*c^-1*log(1+-1*c^2*x^2))
	@test integrate(x^-1*(a+b*arctanh(c*x)), x) == :(a*log(x)+(1/2)*b*Polylogarithms.polylog(2,c*x)+-1//2*b*Polylogarithms.polylog(2,-1*c*x))
	@test integrate(x^-2*(a+b*arctanh(c*x)), x) == :(-1*x^-1*(a+b*arctanh(c*x))+b*c*log(x)+-1//2*b*c*log(1+-1*c^2*x^2))
	@test integrate(x^-3*(a+b*arctanh(c*x)), x) == :(-1//2*x^-2*(a+b*arctanh(c*x))+(1/2)*b*c^2*arctanh(c*x)+-1//2*b*c*x^-1)
	@test integrate(x^-4*(a+b*arctanh(c*x)), x) == :(-1//3*x^-3*(a+b*arctanh(c*x))+-1//6*b*c*x^-2+-1//6*b*c^3*log(1+-1*c^2*x^2)+1//3*b*c^3*log(x))
end

@testset "7.3.3 (d+e x)^m (a+b arctanh(c x^n))^p.jl" begin
	@test integrate((d+e*x)^4*(a+b*arctanh(c*x)), x) == :(1//5*e^-1*(d+e*x)^5*(a+b*arctanh(c*x))+1//20*b*c^-1*e^4*x^4+-1//10*b*c^-5*e^-1*(-1*e+c*d)^5*log(1+c*x)+1//3*b*d*c^-1*e^3*x^3+1//10*b*c^-5*e^-1*(e+c*d)^5*log(1+-1*c*x)+1//10*b*c^-3*e^2*x^2*(e^2+10*c^2*d^2)+b*d*e*x*c^-3*(e^2+2*c^2*d^2))
	@test integrate((d+e*x)^3*(a+b*arctanh(c*x)), x) == :(1//4*e^-1*(d+e*x)^4*(a+b*arctanh(c*x))+1//12*b*c^-1*e^3*x^3+(1/2)*b*d*c^-1*e^2*x^2+-1//8*b*c^-4*e^-1*(-1*e+c*d)^4*log(1+c*x)+1//4*b*e*x*c^-3*(e^2+6*c^2*d^2)+1//8*b*c^-4*e^-1*(e+c*d)^4*log(1+-1*c*x))
	@test integrate((d+e*x)^2*(a+b*arctanh(c*x)), x) == :(1//3*e^-1*(d+e*x)^3*(a+b*arctanh(c*x))+1//6*b*c^-1*e^2*x^2+b*d*e*x*c^-1+-1//6*b*c^-3*e^-1*(-1*e+c*d)^3*log(1+c*x)+1//6*b*c^-3*e^-1*(e+c*d)^3*log(1+-1*c*x))
	@test integrate((a+b*arctanh(c*x))*(d+e*x), x) == :((1/2)*e^-1*(d+e*x)^2*(a+b*arctanh(c*x))+(1/2)*b*e*x*c^-1+-1//4*b*c^-2*e^-1*(-1*e+c*d)^2*log(1+c*x)+1//4*b*c^-2*e^-1*(e+c*d)^2*log(1+-1*c*x))
	@test integrate((d+e*x)^-1*(a+b*arctanh(c*x)), x) == :(e^-1*(a+b*arctanh(c*x))*log(2*c*(1+c*x)^-1*(e+c*d)^-1*(d+e*x))+(1/2)*b*e^-1*Polylogarithms.polylog(2,1+-2*(1+c*x)^-1)+-1*e^-1*(a+b*arctanh(c*x))*log(2*(1+c*x)^-1)+-1//2*b*e^-1*Polylogarithms.polylog(2,1+-2*c*(1+c*x)^-1*(e+c*d)^-1*(d+e*x)))
	@test integrate((d+e*x)^-2*(a+b*arctanh(c*x)), x) == :(-1*e^-1*(d+e*x)^-1*(a+b*arctanh(c*x))+-1*b*c*(-1*e^2+c^2*d^2)^-1*log(d+e*x)+b*c*e^-1*(-2*e+2*c*d)^-1*log(1+c*x)+-1//2*b*c*e^-1*(e+c*d)^-1*log(1+-1*c*x))
	@test integrate((d+e*x)^-3*(a+b*arctanh(c*x)), x) == :(-1//2*e^-1*(d+e*x)^-2*(a+b*arctanh(c*x))+b*c*(d+e*x)^-1*(-2*e^2+2*c^2*d^2)^-1+-1*b*d*c^3*(-1*e^2+c^2*d^2)^-2*log(d+e*x)+-1//4*b*c^2*e^-1*(e+c*d)^-2*log(1+-1*c*x)+1//4*b*c^2*e^-1*(-1*e+c*d)^-2*log(1+c*x))
	@test integrate((a+b*arctanh(c*x))^2*(d+e*x)^3, x) == :(1//4*e^-1*(a+b*arctanh(c*x))^2*(d+e*x)^4+d*c^-3*(a+b*arctanh(c*x))^2*(e^2+c^2*d^2)+-1//4*c^-4*e^-1*(a+b*arctanh(c*x))^2*(e^4+c^4*d^4+6*c^2*d^2*e^2)+1//12*b^2*c^-4*e^3*log(1+-1*c^2*x^2)+1//12*b^2*c^-2*e^3*x^2+d*x*b^2*c^-2*e^2+-1*d*b^2*c^-3*e^2*arctanh(c*x)+-1*d*b^2*c^-3*(e^2+c^2*d^2)*Polylogarithms.polylog(2,1+-2*(1+-1*c*x)^-1)+1//4*e*b^2*c^-4*(e^2+6*c^2*d^2)*log(1+-1*c^2*x^2)+1//6*b*c^-1*e^3*x^3*(a+b*arctanh(c*x))+b*d*c^-1*e^2*x^2*(a+b*arctanh(c*x))+(1/2)*a*b*e*x*c^-3*(e^2+6*c^2*d^2)+(1/2)*e*x*b^2*c^-3*(e^2+6*c^2*d^2)*arctanh(c*x)+-2*b*d*c^-3*(a+b*arctanh(c*x))*(e^2+c^2*d^2)*log(2*(1+-1*c*x)^-1))
	@test integrate((a+b*arctanh(c*x))^2*(d+e*x)^2, x) == :(1//3*c^-3*(a+b*arctanh(c*x))^2*(e^2+3*c^2*d^2)+1//3*e^-1*(a+b*arctanh(c*x))^2*(d+e*x)^3+-1//3*d*e^-1*(a+b*arctanh(c*x))^2*(d^2+3*c^-2*e^2)+-1//3*b^2*c^-3*e^2*arctanh(c*x)+-1//3*b^2*c^-3*(e^2+3*c^2*d^2)*Polylogarithms.polylog(2,1+-2*(1+-1*c*x)^-1)+1//3*x*b^2*c^-2*e^2+d*e*b^2*c^-2*log(1+-1*c^2*x^2)+-2//3*b*c^-3*(a+b*arctanh(c*x))*(e^2+3*c^2*d^2)*log(2*(1+-1*c*x)^-1)+1//3*b*c^-1*e^2*x^2*(a+b*arctanh(c*x))+2*a*b*d*e*x*c^-1+2*d*e*x*b^2*c^-1*arctanh(c*x))
	@test integrate((a+b*arctanh(c*x))^2*(d+e*x), x) == :(d*c^-1*(a+b*arctanh(c*x))^2+(1/2)*e^-1*(a+b*arctanh(c*x))^2*(d+e*x)^2+-1//2*e^-1*(a+b*arctanh(c*x))^2*(d^2+c^-2*e^2)+(1/2)*e*b^2*c^-2*log(1+-1*c^2*x^2)+-1*d*b^2*c^-1*Polylogarithms.polylog(2,1+-2*(1+-1*c*x)^-1)+a*b*e*x*c^-1+e*x*b^2*c^-1*arctanh(c*x)+-2*b*d*c^-1*(a+b*arctanh(c*x))*log(2*(1+-1*c*x)^-1))
end

@testset "7.3.4 u (a+b arctanh(c x))^p.jl" begin
	@test integrate(x^3*(a+b*arctanh(c*x))*(d+c*d*x), x) == :(1//4*d*x^4*(a+b*arctanh(c*x))+1//20*b*d*x^4+-1//40*b*d*c^-4*log(1+c*x)+1//4*b*d*x*c^-3+1//5*c*d*x^5*(a+b*arctanh(c*x))+1//10*b*d*c^-2*x^2+1//12*b*d*c^-1*x^3+9//40*b*d*c^-4*log(1+-1*c*x))
	@test integrate(x^2*(a+b*arctanh(c*x))*(d+c*d*x), x) == :(1//3*d*x^3*(a+b*arctanh(c*x))+1//12*b*d*x^3+1//4*b*d*x*c^-2+1//4*c*d*x^4*(a+b*arctanh(c*x))+1//6*b*d*c^-1*x^2+1//24*b*d*c^-3*log(1+c*x)+7//24*b*d*c^-3*log(1+-1*c*x))
	@test integrate(x*(a+b*arctanh(c*x))*(d+c*d*x), x) == :((1/2)*d*x^2*(a+b*arctanh(c*x))+1//6*b*d*x^2+(1/2)*b*d*x*c^-1+-1//12*b*d*c^-2*log(1+c*x)+1//3*c*d*x^3*(a+b*arctanh(c*x))+5//12*b*d*c^-2*log(1+-1*c*x))
	@test integrate((a+b*arctanh(c*x))*(d+c*d*x), x) == :((1/2)*b*d*x+b*d*c^-1*log(1+-1*c*x)+(1/2)*d*c^-1*(1+c*x)^2*(a+b*arctanh(c*x)))
	@test integrate(x^-1*(a+b*arctanh(c*x))*(d+c*d*x), x) == :(a*d*log(x)+(1/2)*b*d*Polylogarithms.polylog(2,c*x)+(1/2)*b*d*log(1+-1*c^2*x^2)+-1//2*b*d*Polylogarithms.polylog(2,-1*c*x)+a*c*d*x+b*c*d*x*arctanh(c*x))
	@test integrate(x^-2*(a+b*arctanh(c*x))*(d+c*d*x), x) == :(-1*d*x^-1*(a+b*arctanh(c*x))+a*c*d*log(x)+b*c*d*log(x)+(1/2)*b*c*d*Polylogarithms.polylog(2,c*x)+-1//2*b*c*d*Polylogarithms.polylog(2,-1*c*x)+-1//2*b*c*d*log(1+-1*c^2*x^2))
	@test integrate(x^-3*(a+b*arctanh(c*x))*(d+c*d*x), x) == :(b*d*c^2*log(x)+-1*b*d*c^2*log(1+-1*c*x)+-1//2*b*c*d*x^-1+-1//2*d*x^-2*(1+c*x)^2*(a+b*arctanh(c*x)))
	@test integrate(x^-4*(a+b*arctanh(c*x))*(d+c*d*x), x) == :(-1//3*d*x^-3*(a+b*arctanh(c*x))+-5//12*b*d*c^3*log(1+-1*c*x)+-1//2*b*d*c^2*x^-1+-1//2*c*d*x^-2*(a+b*arctanh(c*x))+-1//6*b*c*d*x^-2+1//3*b*d*c^3*log(x)+1//12*b*d*c^3*log(1+c*x))
	@test integrate(x^-5*(a+b*arctanh(c*x))*(d+c*d*x), x) == :(-1//4*d*x^-4*(a+b*arctanh(c*x))+-7//24*b*d*c^4*log(1+-1*c*x)+-1//3*c*d*x^-3*(a+b*arctanh(c*x))+-1//4*b*d*c^3*x^-1+-1//6*b*d*c^2*x^-2+-1//12*b*c*d*x^-3+-1//24*b*d*c^4*log(1+c*x)+1//3*b*d*c^4*log(x))
	@test integrate(x^3*(d+c*d*x)^2*(a+b*arctanh(c*x)), x) == :(1//4*d^2*x^4*(a+b*arctanh(c*x))+1//10*b*d^2*x^4+-1//120*b*c^-4*d^2*log(1+c*x)+1//5*b*c^-2*d^2*x^2+1//6*c^2*d^2*x^6*(a+b*arctanh(c*x))+1//30*b*c*d^2*x^5+2//5*c*d^2*x^5*(a+b*arctanh(c*x))+5//12*b*x*c^-3*d^2+5//36*b*c^-1*d^2*x^3+49//120*b*c^-4*d^2*log(1+-1*c*x))
end

@testset "7.3.5 u (a+b arctanh(c+d x))^p.jl" begin
	@test integrate(x^3*arctanh(a+b*x)^2, x) == :(1//4*x^4*arctanh(a+b*x)^2+1//12*b^-4*(a+b*x)^2+1//12*b^-4*log(1+-1*(a+b*x)^2)+a*b^-4*arctanh(a+b*x)+-1*a*x*b^-3+-1//4*b^-4*arctanh(a+b*x)^2*(1+a^4+6*a^2)+1//4*b^-4*(1+6*a^2)*log(1+-1*(a+b*x)^2)+1//6*b^-4*(a+b*x)^3*arctanh(a+b*x)+a*b^-4*(1+a^2)*Polylogarithms.polylog(2,-1*(1+-1a+-1*b*x)^-1*(1+a+b*x))+(1/2)*b^-4*(1+6*a^2)*(a+b*x)*arctanh(a+b*x)+-1*a*b^-4*(a+b*x)^2*arctanh(a+b*x)+-1*a*b^-4*arctanh(a+b*x)^2*(1+a^2)+2*a*b^-4*(1+a^2)*arctanh(a+b*x)*log(2*(1+-1a+-1*b*x)^-1))
	@test integrate(x^2*arctanh(a+b*x)^2, x) == :(-1//3*b^-3*arctanh(a+b*x)+1//3*x*b^-2+1//3*x^3*arctanh(a+b*x)^2+-1*a*b^-3*log(1+-1*(a+b*x)^2)+-1//3*b^-3*(1+3*a^2)*Polylogarithms.polylog(2,-1*(1+-1a+-1*b*x)^-1*(1+a+b*x))+1//3*b^-3*(a+b*x)^2*arctanh(a+b*x)+1//3*b^-3*arctanh(a+b*x)^2*(1+3*a^2)+-2*a*b^-3*(a+b*x)*arctanh(a+b*x)+-1//3*b^-3*(2+6*a^2)*arctanh(a+b*x)*log(2*(1+-1a+-1*b*x)^-1)+1//3*a*b^-3*arctanh(a+b*x)^2*(3+a^2))
	@test integrate(x*arctanh(a+b*x)^2, x) == :((1/2)*b^-2*log(1+-1*(a+b*x)^2)+(1/2)*x^2*arctanh(a+b*x)^2+a*b^-2*Polylogarithms.polylog(2,-1*(1+-1a+-1*b*x)^-1*(1+a+b*x))+b^-2*(a+b*x)*arctanh(a+b*x)+-1*a*b^-2*arctanh(a+b*x)^2+-1//2*b^-2*arctanh(a+b*x)^2*(1+a^2)+2*a*b^-2*arctanh(a+b*x)*log(2*(1+-1a+-1*b*x)^-1))
	@test integrate(arctanh(a+b*x)^2, x) == :(b^-1*arctanh(a+b*x)^2+-1*b^-1*Polylogarithms.polylog(2,-1*(1+-1a+-1*b*x)^-1*(1+a+b*x))+b^-1*arctanh(a+b*x)^2*(a+b*x)+-2*b^-1*arctanh(a+b*x)*log(2*(1+-1a+-1*b*x)^-1))
	@test integrate(x^-1*arctanh(a+b*x)^2, x) == :((1/2)*Polylogarithms.polylog(3,1+-2*(1+a+b*x)^-1)+-1//2*Polylogarithms.polylog(3,1+-2*b*x*(1+-1a)^-1*(1+a+b*x)^-1)+arctanh(a+b*x)^2*log(2*b*x*(1+-1a)^-1*(1+a+b*x)^-1)+Polylogarithms.polylog(2,1+-2*(1+a+b*x)^-1)*arctanh(a+b*x)+-1*arctanh(a+b*x)^2*log(2*(1+a+b*x)^-1)+-1*Polylogarithms.polylog(2,1+-2*b*x*(1+-1a)^-1*(1+a+b*x)^-1)*arctanh(a+b*x))
	@test integrate(x^-2*arctanh(a+b*x)^2, x) == :(-1*x^-1*arctanh(a+b*x)^2+b*(1+-1*a^2)^-1*Polylogarithms.polylog(2,1+-2*(1+a+b*x)^-1)+b*(2+-2a)^-1*Polylogarithms.polylog(2,-1*(1+-1a+-1*b*x)^-1*(1+a+b*x))+-1*b*(1+-1*a^2)^-1*Polylogarithms.polylog(2,1+-2*b*x*(1+-1a)^-1*(1+a+b*x)^-1)+-1*b*(2+2a)^-1*Polylogarithms.polylog(2,1+-2*(1+a+b*x)^-1)+b*(1+a)^-1*arctanh(a+b*x)*log(2*(1+a+b*x)^-1)+b*(1+-1a)^-1*arctanh(a+b*x)*log(2*(1+-1a+-1*b*x)^-1)+-2*b*(1+-1*a^2)^-1*arctanh(a+b*x)*log(2*(1+a+b*x)^-1)+2*b*(1+-1*a^2)^-1*arctanh(a+b*x)*log(2*b*x*(1+-1a)^-1*(1+a+b*x)^-1))
	@test integrate(x^-3*arctanh(a+b*x)^2, x) == :(-1//2*x^-2*arctanh(a+b*x)^2+b^2*(1+-1*a^2)^-2*log(x)+1//4*b^2*(1+a)^-2*Polylogarithms.polylog(2,1+-2*(1+a+b*x)^-1)+1//4*b^2*(1+-1a)^-2*Polylogarithms.polylog(2,-1*(1+-1a+-1*b*x)^-1*(1+a+b*x))+a*b^2*(1+-1*a^2)^-2*Polylogarithms.polylog(2,1+-2*(1+a+b*x)^-1)+(1/2)*b^2*(1+-1a)^-2*arctanh(a+b*x)*log(2*(1+-1a+-1*b*x)^-1)+-1*a*b^2*(1+-1*a^2)^-2*Polylogarithms.polylog(2,1+-2*b*x*(1+-1a)^-1*(1+a+b*x)^-1)+-1*b*x^-1*(1+-1*a^2)^-1*arctanh(a+b*x)+-1*b^2*(1+a)^-2*(2+-2a)^-1*log(1+a+b*x)+-1//2*b^2*(1+a)^-1*(1+-1a)^-2*log(1+-1a+-1*b*x)+-1//2*b^2*(1+a)^-2*arctanh(a+b*x)*log(2*(1+a+b*x)^-1)+-2*a*b^2*(1+-1*a^2)^-2*arctanh(a+b*x)*log(2*(1+a+b*x)^-1)+2*a*b^2*(1+-1*a^2)^-2*arctanh(a+b*x)*log(2*b*x*(1+-1a)^-1*(1+a+b*x)^-1))
	@test integrate(x^-1*arctanh(1+b*x)^2, x) == :((1/2)*Polylogarithms.polylog(3,1+2*b^-1*x^-1)+-1*arctanh(1+b*x)^2*log(-2*b^-1*x^-1)+-1*Polylogarithms.polylog(2,1+2*b^-1*x^-1)*arctanh(1+b*x))
	@test integrate((c*e+d*e*x)^3*(a+b*arctanh(c+d*x)), x) == :(1//4*b*x*e^3+-1//4*b*d^-1*e^3*arctanh(c+d*x)+1//4*d^-1*e^3*(c+d*x)^4*(a+b*arctanh(c+d*x))+1//12*b*d^-1*e^3*(c+d*x)^3)
	@test integrate((c*e+d*e*x)^2*(a+b*arctanh(c+d*x)), x) == :(1//3*d^-1*e^2*(c+d*x)^3*(a+b*arctanh(c+d*x))+1//6*b*d^-1*e^2*(c+d*x)^2+1//6*b*d^-1*e^2*log(1+-1*(c+d*x)^2))
end

@testset "7.3.6 Exponentials of inverse hyperbolic tangent functions.jl" begin
	@test integrate(x^4*exp(arctanh(a*x)), x) == :(3//8*a^-5*arcsin(a*x)+-4//15*a^-3*x^2*(1+-1*a^2*x^2)^(1/2)+-1//4*a^-2*x^3*(1+-1*a^2*x^2)^(1/2)+-1//5*a^-1*x^4*(1+-1*a^2*x^2)^(1/2)+-1//120*a^-5*(1+-1*a^2*x^2)^(1/2)*(64+45*a*x))
	@test integrate(x^3*exp(arctanh(a*x)), x) == :(3//8*a^-4*arcsin(a*x)+-1//3*a^-2*x^2*(1+-1*a^2*x^2)^(1/2)+-1//4*a^-1*x^3*(1+-1*a^2*x^2)^(1/2)+-1//24*a^-4*(1+-1*a^2*x^2)^(1/2)*(16+9*a*x))
	@test integrate(x^2*exp(arctanh(a*x)), x) == :((1/2)*a^-3*arcsin(a*x)+-1*a^-3*(1+-1*a^2*x^2)^(1/2)+1//3*a^-3*(1+-1*a^2*x^2)^3//2+-1//2*x*a^-2*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x*exp(arctanh(a*x)), x) == :((1/2)*a^-2*arcsin(a*x)+-1//2*a^-2*(1+-1*a^2*x^2)^(1/2)*(2+a*x))
	@test integrate(exp(arctanh(a*x)), x) == :(a^-1*arcsin(a*x)+-1*a^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-1*exp(arctanh(a*x)), x) == :(-1*arctanh((1+-1*a^2*x^2)^(1/2))+arcsin(a*x))
	@test integrate(x^-2*exp(arctanh(a*x)), x) == :(-1*a*arctanh((1+-1*a^2*x^2)^(1/2))+-1*x^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-3*exp(arctanh(a*x)), x) == :(-1//2*a^2*arctanh((1+-1*a^2*x^2)^(1/2))+-1//2*x^-2*(1+-1*a^2*x^2)^(1/2)+-1*a*x^-1*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-4*exp(arctanh(a*x)), x) == :(-1//2*a^3*arctanh((1+-1*a^2*x^2)^(1/2))+-1//3*x^-3*(1+-1*a^2*x^2)^(1/2)+-2//3*a^2*x^-1*(1+-1*a^2*x^2)^(1/2)+-1//2*a*x^-2*(1+-1*a^2*x^2)^(1/2))
	@test integrate(x^-5*exp(arctanh(a*x)), x) == :(-3//8*a^4*arctanh((1+-1*a^2*x^2)^(1/2))+-1//4*x^-4*(1+-1*a^2*x^2)^(1/2)+-3//8*a^2*x^-2*(1+-1*a^2*x^2)^(1/2)+-2//3*a^3*x^-1*(1+-1*a^2*x^2)^(1/2)+-1//3*a*x^-3*(1+-1*a^2*x^2)^(1/2))
end

@testset "7.3.7 Inverse hyperbolic tangent functions.jl" begin
	@test integrate(x^5*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(1//6*x^6*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//36*e^-1//2*x^5*(d+e*x^2)^(1/2)+5//96*d^3*e^-3*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-5//96*x*d^2*e^-5//2*(d+e*x^2)^(1/2)+5//144*d*e^-3//2*x^3*(d+e*x^2)^(1/2))
	@test integrate(x^3*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(1//4*x^4*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-3//32*d^2*e^-2*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//16*e^-1//2*x^3*(d+e*x^2)^(1/2)+3//32*d*x*e^-3//2*(d+e*x^2)^(1/2))
	@test integrate(x*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :((1/2)*x^2*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//4*x*e^-1//2*(d+e*x^2)^(1/2)+1//4*d*e^-1*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2))
	@test integrate(x^-1*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)*log(x)+(1/2)*d^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*Polylogarithms.polylog(2,exp(2*arcsinh(x*d^-1//2*e^(1/2))))+-1//2*d^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*arcsinh(x*d^-1//2*e^(1/2))^2+d^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*arcsinh(x*d^-1//2*e^(1/2))*log(1+-1*exp(2*arcsinh(x*d^-1//2*e^(1/2))))+-1*d^(1/2)*(1+e*d^-1*x^2)^(1/2)*(d+e*x^2)^-1//2*arcsinh(x*d^-1//2*e^(1/2))*log(x))
	@test integrate(x^-3*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//2*x^-2*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//2*d^-1*e^(1/2)*x^-1*(d+e*x^2)^(1/2))
	@test integrate(x^-5*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//4*x^-4*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//12*d^-1*e^(1/2)*x^-3*(d+e*x^2)^(1/2)+1//6*d^-2*e^3//2*x^-1*(d+e*x^2)^(1/2))
	@test integrate(x^-7*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//6*x^-6*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-4//45*d^-3*e^5//2*x^-1*(d+e*x^2)^(1/2)+-1//30*d^-1*e^(1/2)*x^-5*(d+e*x^2)^(1/2)+2//45*d^-2*e^3//2*x^-3*(d+e*x^2)^(1/2))
	@test integrate(x^-9*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//8*x^-8*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//35*d^-3*e^5//2*x^-3*(d+e*x^2)^(1/2)+-1//56*d^-1*e^(1/2)*x^-7*(d+e*x^2)^(1/2)+2//35*d^-4*e^7//2*x^-1*(d+e*x^2)^(1/2)+3//140*d^-2*e^3//2*x^-5*(d+e*x^2)^(1/2))
	@test integrate(x^6*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//49*e^-7//2*(d+e*x^2)^7//2+1//7*x^7*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//7*d^2*e^-7//2*(d+e*x^2)^3//2+1//7*d^3*e^-7//2*(d+e*x^2)^(1/2)+3//35*d*e^-7//2*(d+e*x^2)^5//2)
	@test integrate(x^4*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2), x) == :(-1//25*e^-5//2*(d+e*x^2)^5//2+1//5*x^5*arctanh(x*e^(1/2)*(d+e*x^2)^-1//2)+-1//5*d^2*e^-5//2*(d+e*x^2)^(1/2)+2//15*d*e^-5//2*(d+e*x^2)^3//2)
end

@testset "7.4.1 Inverse hyperbolic cotangent functions.jl" begin
	@test integrate(x^5*arccoth(a*x), x) == :(-1//6*a^-6*arctanh(a*x)+1//6*x*a^-5+1//6*x^6*arccoth(a*x)+1//18*a^-3*x^3+1//30*a^-1*x^5)
	@test integrate(x^4*arccoth(a*x), x) == :(1//5*x^5*arccoth(a*x)+1//10*a^-5*log(1+-1*a^2*x^2)+1//10*a^-3*x^2+1//20*a^-1*x^4)
	@test integrate(x^3*arccoth(a*x), x) == :(-1//4*a^-4*arctanh(a*x)+1//4*x*a^-3+1//4*x^4*arccoth(a*x)+1//12*a^-1*x^3)
	@test integrate(x^2*arccoth(a*x), x) == :(1//3*x^3*arccoth(a*x)+1//6*a^-1*x^2+1//6*a^-3*log(1+-1*a^2*x^2))
	@test integrate(x*arccoth(a*x), x) == :((1/2)*x*a^-1+(1/2)*x^2*arccoth(a*x)+-1//2*a^-2*arctanh(a*x))
	@test integrate(arccoth(a*x), x) == :(x*arccoth(a*x)+(1/2)*a^-1*log(1+-1*a^2*x^2))
	@test integrate(x^-1*arccoth(a*x), x) == :((1/2)*Polylogarithms.polylog(2,-1*a^-1*x^-1)+-1//2*Polylogarithms.polylog(2,a^-1*x^-1))
	@test integrate(x^-2*arccoth(a*x), x) == :(a*log(x)+-1*x^-1*arccoth(a*x)+-1//2*a*log(1+-1*a^2*x^2))
	@test integrate(x^-3*arccoth(a*x), x) == :((1/2)*a^2*arctanh(a*x)+-1//2*a*x^-1+-1//2*x^-2*arccoth(a*x))
	@test integrate(x^-4*arccoth(a*x), x) == :(-1//3*x^-3*arccoth(a*x)+-1//6*a*x^-2+-1//6*a^3*log(1+-1*a^2*x^2)+1//3*a^3*log(x))
end

@testset "7.4.2 Exponentials of inverse hyperbolic cotangent functions.jl" begin
	@test integrate(x^3*exp(arccoth(a*x)), x) == :(1//4*x^4*(1+-1*a^-2*x^-2)^(1/2)+3//8*a^-4*arctanh((1+-1*a^-2*x^-2)^(1/2))+1//3*a^-1*x^3*(1+-1*a^-2*x^-2)^(1/2)+2//3*x*a^-3*(1+-1*a^-2*x^-2)^(1/2)+3//8*a^-2*x^2*(1+-1*a^-2*x^-2)^(1/2))
	@test integrate(x^2*exp(arccoth(a*x)), x) == :((1/2)*a^-3*arctanh((1+-1*a^-2*x^-2)^(1/2))+1//3*x^3*(1+-1*a^-2*x^-2)^(1/2)+(1/2)*a^-1*x^2*(1+-1*a^-2*x^-2)^(1/2)+2//3*x*a^-2*(1+-1*a^-2*x^-2)^(1/2))
	@test integrate(x*exp(arccoth(a*x)), x) == :((1/2)*a^-2*arctanh((1+-1*a^-2*x^-2)^(1/2))+(1/2)*x^2*(1+-1*a^-2*x^-2)^(1/2)+x*a^-1*(1+-1*a^-2*x^-2)^(1/2))
	@test integrate(exp(arccoth(a*x)), x) == :(x*(1+-1*a^-2*x^-2)^(1/2)+a^-1*arctanh((1+-1*a^-2*x^-2)^(1/2)))
	@test integrate(x^-1*exp(arccoth(a*x)), x) == :(-1*arccsc(a*x)+arctanh((1+-1*a^-2*x^-2)^(1/2)))
	@test integrate(x^-2*exp(arccoth(a*x)), x) == :(a*(1+-1*a^-2*x^-2)^(1/2)+-1*a*arccsc(a*x))
	@test integrate(x^-3*exp(arccoth(a*x)), x) == :(-1//2*a^2*arccsc(a*x)+(1/2)*a*(1+-1*a^-2*x^-2)^(1/2)*(x^-1+2a))
	@test integrate(x^-4*exp(arccoth(a*x)), x) == :(a^3*(1+-1*a^-2*x^-2)^(1/2)+-1//2*a^3*arccsc(a*x)+-1//3*a^3*(1+-1*a^-2*x^-2)^3//2+(1/2)*a^2*x^-1*(1+-1*a^-2*x^-2)^(1/2))
	@test integrate(x^-5*exp(arccoth(a*x)), x) == :(-3//8*a^4*arccsc(a*x)+1//3*a^2*x^-2*(1+-1*a^-2*x^-2)^(1/2)+1//4*a*x^-3*(1+-1*a^-2*x^-2)^(1/2)+1//24*a^3*(1+-1*a^-2*x^-2)^(1/2)*(9*x^-1+16a))
	@test integrate(x^3*exp(2*arccoth(a*x)), x) == :(1//4*x^4+a^-2*x^2+2*x*a^-3+2*a^-4*log(1+-1*a*x)+2//3*a^-1*x^3)
end

@testset "7.5.1 u (a+b arcsech(c x))^n.jl" begin
	@test integrate(x^4*arcsech(a*x)^2, x) == :(-3//20*x*a^-4+-1//30*a^-2*x^3+1//5*x^5*arcsech(a*x)^2+-3//10*a^-5*arcsech(a*x)*arctan(exp(arcsech(a*x)))+-3//20*im*a^-5*Polylogarithms.polylog(2,im*exp(arcsech(a*x)))+3//20*im*a^-5*Polylogarithms.polylog(2,-1*im*exp(arcsech(a*x)))+-3//20*x*a^-4*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x)+-1//10*a^-2*x^3*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x))
	@test integrate(x^3*arcsech(a*x)^2, x) == :(-1//3*a^-4*log(x)+-1//12*a^-2*x^2+1//4*x^4*arcsech(a*x)^2+-1//3*a^-4*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x)+-1//6*a^-2*x^2*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x))
	@test integrate(x^2*arcsech(a*x)^2, x) == :(-1//3*x*a^-2+1//3*x^3*arcsech(a*x)^2+-2//3*a^-3*arcsech(a*x)*arctan(exp(arcsech(a*x)))+-1//3*im*a^-3*Polylogarithms.polylog(2,im*exp(arcsech(a*x)))+1//3*im*a^-3*Polylogarithms.polylog(2,-1*im*exp(arcsech(a*x)))+-1//3*x*a^-2*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x))
	@test integrate(x*arcsech(a*x)^2, x) == :((1/2)*x^2*arcsech(a*x)^2+-1*a^-2*log(x)+-1*a^-2*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x))
	@test integrate(arcsech(a*x)^2, x) == :(x*arcsech(a*x)^2+-4*a^-1*arcsech(a*x)*arctan(exp(arcsech(a*x)))+-2*im*a^-1*Polylogarithms.polylog(2,im*exp(arcsech(a*x)))+2*im*a^-1*Polylogarithms.polylog(2,-1*im*exp(arcsech(a*x))))
	@test integrate(x^-1*arcsech(a*x)^2, x) == :((1/2)*Polylogarithms.polylog(3,-1*exp(2*arcsech(a*x)))+1//3*arcsech(a*x)^3+-1*arcsech(a*x)^2*log(1+exp(2*arcsech(a*x)))+-1*Polylogarithms.polylog(2,-1*exp(2*arcsech(a*x)))*arcsech(a*x))
	@test integrate(x^-2*arcsech(a*x)^2, x) == :(-2*x^-1+-1*x^-1*arcsech(a*x)^2+2*x^-1*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x))
	@test integrate(x^-3*arcsech(a*x)^2, x) == :(-1//4*a^2*arcsech(a*x)^2+-1//4*x^-2*(1+a*x)*(1+-1*a*x)+(1/2)*x^-2*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x)+-1//2*x^-2*arcsech(a*x)^2*(1+a*x)*(1+-1*a*x))
	@test integrate(x^-4*arcsech(a*x)^2, x) == :(-2//27*x^-3+-4//9*a^2*x^-1+-1//3*x^-3*arcsech(a*x)^2+2//9*x^-3*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x)+4//9*a^2*x^-1*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)*arcsech(a*x))
	@test integrate(x^4*arcsech(a*x)^3, x) == :((1/2)*a^-5*arctan(a^-1*x^-1*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x))+1//5*x^5*arcsech(a*x)^3+-9//20*im*a^-5*Polylogarithms.polylog(3,-1*im*exp(arcsech(a*x)))+-9//20*x*a^-4*arcsech(a*x)+-9//20*a^-5*arcsech(a*x)^2*arctan(exp(arcsech(a*x)))+-1//10*a^-2*x^3*arcsech(a*x)+9//20*im*a^-5*Polylogarithms.polylog(3,im*exp(arcsech(a*x)))+-9//20*im*a^-5*Polylogarithms.polylog(2,im*exp(arcsech(a*x)))*arcsech(a*x)+1//20*x*a^-4*((1+a*x)^-1*(1+-1*a*x))^(1/2)*(1+a*x)+9//20*im*a^-5*Polylogarithms.polylog(2,-1*im*exp(arcsech(a*x)))*arcsech(a*x)+-9//40*x*a^-4*((1+a*x)^-1*(1+-1*a*x))^(1/2)*arcsech(a*x)^2*(1+a*x)+-3//20*a^-2*x^3*((1+a*x)^-1*(1+-1*a*x))^(1/2)*arcsech(a*x)^2*(1+a*x))
end

@testset "7.5.2 Inverse hyperbolic secant functions.jl" begin
	@test integrate(x^3*arcsech(a+b*x), x) == :(1//4*x^4*arcsech(a+b*x)+-1//4*a^4*b^-4*arcsech(a+b*x)+(1/2)*a*b^-4*(1+2*a^2)*arctan(((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(a+b*x)^-1*(1+a+b*x))+-1//12*b^-4*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(2+17*a^2)*(1+a+b*x)+-1//12*b^-2*x^2*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+a+b*x)+1//3*a*b^-4*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(a+b*x)*(1+a+b*x))
	@test integrate(x^2*arcsech(a+b*x), x) == :(1//3*x^3*arcsech(a+b*x)+-1//6*b^-3*(1+6*a^2)*arctan(((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(a+b*x)^-1*(1+a+b*x))+1//3*a^3*b^-3*arcsech(a+b*x)+-1//6*x*b^-2*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+a+b*x)+5//6*a*b^-3*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+a+b*x))
	@test integrate(x*arcsech(a+b*x), x) == :((1/2)*x^2*arcsech(a+b*x)+a*b^-2*arctan(((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(a+b*x)^-1*(1+a+b*x))+-1//2*a^2*b^-2*arcsech(a+b*x)+-1//2*b^-2*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+a+b*x))
	@test integrate(arcsech(a+b*x), x) == :(-2*b^-1*arctan(((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2))+b^-1*(a+b*x)*arcsech(a+b*x))
	@test integrate(x^-1*arcsech(a+b*x), x) == :(-1//2*Polylogarithms.polylog(2,-1*exp(2*arcsech(a+b*x)))+arcsech(a+b*x)*log(1+-1*a*(1+(1+-1*a^2)^(1/2))^-1*exp(arcsech(a+b*x)))+arcsech(a+b*x)*log(1+-1*a*(1+-1*(1+-1*a^2)^(1/2))^-1*exp(arcsech(a+b*x)))+-1*arcsech(a+b*x)*log(1+exp(2*arcsech(a+b*x)))+Polylogarithms.polylog(2,a*(1+(1+-1*a^2)^(1/2))^-1*exp(arcsech(a+b*x)))+Polylogarithms.polylog(2,a*(1+-1*(1+-1*a^2)^(1/2))^-1*exp(arcsech(a+b*x))))
	@test integrate(x^-2*arcsech(a+b*x), x) == :(-1*x^-1*arcsech(a+b*x)+-1*b*a^-1*arcsech(a+b*x)+2*b*a^-1*(1+-1*a^2)^-1//2*arctanh((1+a)^(1/2)*(1+-1a)^-1//2*tanh((1/2)*arcsech(a+b*x))))
	@test integrate(x^-3*arcsech(a+b*x), x) == :(-1//2*x^-2*arcsech(a+b*x)+(1/2)*a^-2*b^2*arcsech(a+b*x)+-1*a^-2*b^2*(1+-1*a^2)^-3//2*(1+-2*a^2)*arctanh((1+a)^(1/2)*(1+-1a)^-1//2*tanh((1/2)*arcsech(a+b*x)))+(1/2)*b*a^-1*x^-1*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+-1*a^2)^-1*(1+a+b*x))
	@test integrate(x^-4*arcsech(a+b*x), x) == :(-1//3*x^-3*arcsech(a+b*x)+-1//3*a^-3*b^3*arcsech(a+b*x)+1//3*a^-3*b^3*(1+-1*a^2)^-5//2*(2+-5*a^2+6*a^4)*arctanh((1+a)^(1/2)*(1+-1a)^-1//2*tanh((1/2)*arcsech(a+b*x)))+1//6*b*a^-1*x^-2*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+-1*a^2)^-1*(1+a+b*x)+-1//6*a^-2*b^2*x^-1*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+-1*a^2)^-2*(2+-5*a^2)*(1+a+b*x))
	@test integrate(x^2*arcsech(a+b*x)^2, x) == :(-1//3*x*b^-2+1//3*x^3*arcsech(a+b*x)^2+2*a*b^-3*log(a+b*x)+-2//3*b^-3*arcsech(a+b*x)*arctan(exp(arcsech(a+b*x)))+-1//3*im*b^-3*Polylogarithms.polylog(2,im*exp(arcsech(a+b*x)))+1//3*im*b^-3*Polylogarithms.polylog(2,-1*im*exp(arcsech(a+b*x)))+1//3*a^3*b^-3*arcsech(a+b*x)^2+-4*a^2*b^-3*arcsech(a+b*x)*arctan(exp(arcsech(a+b*x)))+-2*im*a^2*b^-3*Polylogarithms.polylog(2,im*exp(arcsech(a+b*x)))+2*im*a^2*b^-3*Polylogarithms.polylog(2,-1*im*exp(arcsech(a+b*x)))+2*a*b^-3*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+a+b*x)*arcsech(a+b*x)+-1//3*b^-3*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(a+b*x)*(1+a+b*x)*arcsech(a+b*x))
	@test integrate(x*arcsech(a+b*x)^2, x) == :((1/2)*x^2*arcsech(a+b*x)^2+-1*b^-2*log(a+b*x)+-1//2*a^2*b^-2*arcsech(a+b*x)^2+-1*b^-2*((1+a+b*x)^-1*(1+-1a+-1*b*x))^(1/2)*(1+a+b*x)*arcsech(a+b*x)+-2*im*a*b^-2*Polylogarithms.polylog(2,-1*im*exp(arcsech(a+b*x)))+2*im*a*b^-2*Polylogarithms.polylog(2,im*exp(arcsech(a+b*x)))+4*a*b^-2*arcsech(a+b*x)*arctan(exp(arcsech(a+b*x))))
end

@testset "7.6.1 u (a+b arccsch(c x))^n.jl" begin
	@test integrate(x^6*(a+b*arccsch(c*x)), x) == :(1//7*x^7*(a+b*arccsch(c*x))+-5//112*b*c^-7*arctanh((1+c^-2*x^-2)^(1/2))+-5//168*b*c^-3*x^4*(1+c^-2*x^-2)^(1/2)+1//42*b*c^-1*x^6*(1+c^-2*x^-2)^(1/2)+5//112*b*c^-5*x^2*(1+c^-2*x^-2)^(1/2))
	@test integrate(x^5*(a+b*arccsch(c*x)), x) == :(1//6*x^6*(a+b*arccsch(c*x))+-2//45*b*c^-3*x^3*(1+c^-2*x^-2)^(1/2)+1//30*b*c^-1*x^5*(1+c^-2*x^-2)^(1/2)+4//45*b*x*c^-5*(1+c^-2*x^-2)^(1/2))
	@test integrate(x^4*(a+b*arccsch(c*x)), x) == :(1//5*x^5*(a+b*arccsch(c*x))+3//40*b*c^-5*arctanh((1+c^-2*x^-2)^(1/2))+-3//40*b*c^-3*x^2*(1+c^-2*x^-2)^(1/2)+1//20*b*c^-1*x^4*(1+c^-2*x^-2)^(1/2))
	@test integrate(x^3*(a+b*arccsch(c*x)), x) == :(1//4*x^4*(a+b*arccsch(c*x))+-1//6*b*x*c^-3*(1+c^-2*x^-2)^(1/2)+1//12*b*c^-1*x^3*(1+c^-2*x^-2)^(1/2))
	@test integrate(x^2*(a+b*arccsch(c*x)), x) == :(1//3*x^3*(a+b*arccsch(c*x))+-1//6*b*c^-3*arctanh((1+c^-2*x^-2)^(1/2))+1//6*b*c^-1*x^2*(1+c^-2*x^-2)^(1/2))
	@test integrate(x*(a+b*arccsch(c*x)), x) == :((1/2)*x^2*(a+b*arccsch(c*x))+(1/2)*b*x*c^-1*(1+c^-2*x^-2)^(1/2))
	@test integrate(a+b*arccsch(c*x), x) == :(a*x+b*x*arccsch(c*x)+b*c^-1*arctanh((1+c^-2*x^-2)^(1/2)))
	@test integrate(x^-1*(a+b*arccsch(c*x)), x) == :((1/2)*b^-1*(a+b*arccsch(c*x))^2+-1*(a+b*arccsch(c*x))*log(1+-1*exp(2*arccsch(c*x)))+-1//2*b*Polylogarithms.polylog(2,exp(2*arccsch(c*x))))
	@test integrate(x^-2*(a+b*arccsch(c*x)), x) == :(-1*x^-1*(a+b*arccsch(c*x))+b*c*(1+c^-2*x^-2)^(1/2))
	@test integrate(x^-3*(a+b*arccsch(c*x)), x) == :(-1//2*x^-2*(a+b*arccsch(c*x))+-1//4*b*c^2*arccsch(c*x)+1//4*b*c*x^-1*(1+c^-2*x^-2)^(1/2))
end

@testset "7.6.2 Inverse hyperbolic cosecant functions.jl" begin
	@test integrate(x^3*arccsch(a+b*x), x) == :(1//4*x^4*arccsch(a+b*x)+-1//4*a^4*b^-4*arccsch(a+b*x)+(1/2)*a*b^-4*(1+-2*a^2)*arctanh((1+(a+b*x)^-2)^(1/2))+-1//3*a*b^-4*(1+(a+b*x)^-2)^(1/2)*(a+b*x)^2+-1//12*b^-4*(1+(a+b*x)^-2)^(1/2)*(2+-17*a^2)*(a+b*x)+1//12*b^-2*x^2*(1+(a+b*x)^-2)^(1/2)*(a+b*x))
	@test integrate(x^2*arccsch(a+b*x), x) == :(1//3*x^3*arccsch(a+b*x)+-1//6*b^-3*(1+-6*a^2)*arctanh((1+(a+b*x)^-2)^(1/2))+1//3*a^3*b^-3*arccsch(a+b*x)+-5//6*a*b^-3*(1+(a+b*x)^-2)^(1/2)*(a+b*x)+1//6*x*b^-2*(1+(a+b*x)^-2)^(1/2)*(a+b*x))
	@test integrate(x*arccsch(a+b*x), x) == :((1/2)*x^2*arccsch(a+b*x)+(1/2)*b^-2*(1+(a+b*x)^-2)^(1/2)*(a+b*x)+-1*a*b^-2*arctanh((1+(a+b*x)^-2)^(1/2))+-1//2*a^2*b^-2*arccsch(a+b*x))
	@test integrate(x^-1*arccsch(a+b*x), x) == :(-1//2*Polylogarithms.polylog(2,exp(2*arccsch(a+b*x)))+arccsch(a+b*x)*log(1+-1*a*(1+(1+a^2)^(1/2))^-1*exp(arccsch(a+b*x)))+arccsch(a+b*x)*log(1+-1*a*(1+-1*(1+a^2)^(1/2))^-1*exp(arccsch(a+b*x)))+-1*arccsch(a+b*x)*log(1+-1*exp(2*arccsch(a+b*x)))+Polylogarithms.polylog(2,a*(1+(1+a^2)^(1/2))^-1*exp(arccsch(a+b*x)))+Polylogarithms.polylog(2,a*(1+-1*(1+a^2)^(1/2))^-1*exp(arccsch(a+b*x))))
	@test integrate(x^-2*arccsch(a+b*x), x) == :(-1*x^-1*arccsch(a+b*x)+-1*b*a^-1*arccsch(a+b*x)+2*b*a^-1*(1+a^2)^-1//2*arctanh((1+a^2)^-1//2*(a+tanh((1/2)*arccsch(a+b*x)))))
	@test integrate(x^-3*arccsch(a+b*x), x) == :(-1//2*x^-2*arccsch(a+b*x)+(1/2)*a^-2*b^2*arccsch(a+b*x)+-1*a^-2*b^2*(1+a^2)^-3//2*(1+2*a^2)*arctanh((1+a^2)^-1//2*(a+tanh((1/2)*arccsch(a+b*x))))+(1/2)*b*a^-1*x^-1*(1+a^2)^-1*(1+(a+b*x)^-2)^(1/2)*(a+b*x))
	@test integrate((a+b*arccsch(c+d*x))^2*(e+f*x)^3, x) == :(1//4*f^-1*(a+b*arccsch(c+d*x))^2*(e+f*x)^4+-2*b^2*d^-4*(d*e+-1*c*f)^3*Polylogarithms.polylog(2,exp(arccsch(c+d*x)))+2*b^2*d^-4*(d*e+-1*c*f)^3*Polylogarithms.polylog(2,-1*exp(arccsch(c+d*x)))+-1//3*b^2*d^-4*f^3*log(c+d*x)+-1//4*d^-4*f^-1*(a+b*arccsch(c+d*x))^2*(d*e+-1*c*f)^4+1//12*b^2*d^-4*f^3*(c+d*x)^2+x*b^2*d^-3*f^2*(d*e+-1*c*f)+b^2*d^-4*f^2*(d*e+-1*c*f)*Polylogarithms.polylog(2,exp(arccsch(c+d*x)))+-1*b^2*d^-4*f^2*(d*e+-1*c*f)*Polylogarithms.polylog(2,-1*exp(arccsch(c+d*x)))+3*f*b^2*d^-4*(d*e+-1*c*f)^2*log(c+d*x)+4*b*d^-4*(d*e+-1*c*f)^3*(a+b*arccsch(c+d*x))*arctanh(exp(arccsch(c+d*x)))+-2*b*d^-4*f^2*(a+b*arccsch(c+d*x))*(d*e+-1*c*f)*arctanh(exp(arccsch(c+d*x)))+-1//3*b*d^-4*f^3*(1+(c+d*x)^-2)^(1/2)*(a+b*arccsch(c+d*x))*(c+d*x)+1//6*b*d^-4*f^3*(1+(c+d*x)^-2)^(1/2)*(c+d*x)^3*(a+b*arccsch(c+d*x))+b*d^-4*f^2*(1+(c+d*x)^-2)^(1/2)*(c+d*x)^2*(a+b*arccsch(c+d*x))*(d*e+-1*c*f)+3*b*f*d^-4*(1+(c+d*x)^-2)^(1/2)*(d*e+-1*c*f)^2*(a+b*arccsch(c+d*x))*(c+d*x))
	@test integrate((a+b*arccsch(c+d*x))^2*(e+f*x)^2, x) == :(1//3*f^-1*(a+b*arccsch(c+d*x))^2*(e+f*x)^3+-2*b^2*d^-3*(d*e+-1*c*f)^2*Polylogarithms.polylog(2,exp(arccsch(c+d*x)))+2*b^2*d^-3*(d*e+-1*c*f)^2*Polylogarithms.polylog(2,-1*exp(arccsch(c+d*x)))+-1//3*b^2*d^-3*f^2*Polylogarithms.polylog(2,-1*exp(arccsch(c+d*x)))+-1//3*d^-3*f^-1*(a+b*arccsch(c+d*x))^2*(d*e+-1*c*f)^3+1//3*x*b^2*d^-2*f^2+1//3*b^2*d^-3*f^2*Polylogarithms.polylog(2,exp(arccsch(c+d*x)))+2*f*b^2*d^-3*(d*e+-1*c*f)*log(c+d*x)+4*b*d^-3*(d*e+-1*c*f)^2*(a+b*arccsch(c+d*x))*arctanh(exp(arccsch(c+d*x)))+-2//3*b*d^-3*f^2*(a+b*arccsch(c+d*x))*arctanh(exp(arccsch(c+d*x)))+1//3*b*d^-3*f^2*(1+(c+d*x)^-2)^(1/2)*(c+d*x)^2*(a+b*arccsch(c+d*x))+2*b*f*d^-3*(1+(c+d*x)^-2)^(1/2)*(a+b*arccsch(c+d*x))*(c+d*x)*(d*e+-1*c*f))
	@test integrate((a+b*arccsch(c+d*x))^2*(e+f*x), x) == :((1/2)*f^-1*(a+b*arccsch(c+d*x))^2*(e+f*x)^2+f*b^2*d^-2*log(c+d*x)+-2*b^2*d^-2*(d*e+-1*c*f)*Polylogarithms.polylog(2,exp(arccsch(c+d*x)))+2*b^2*d^-2*(d*e+-1*c*f)*Polylogarithms.polylog(2,-1*exp(arccsch(c+d*x)))+-1//2*d^-2*f^-1*(a+b*arccsch(c+d*x))^2*(d*e+-1*c*f)^2+4*b*d^-2*(a+b*arccsch(c+d*x))*(d*e+-1*c*f)*arctanh(exp(arccsch(c+d*x)))+b*f*d^-2*(1+(c+d*x)^-2)^(1/2)*(a+b*arccsch(c+d*x))*(c+d*x))
	@test integrate((a+b*arccsch(c+d*x))^2, x) == :(d^-1*(a+b*arccsch(c+d*x))^2*(c+d*x)+-2*b^2*d^-1*Polylogarithms.polylog(2,exp(arccsch(c+d*x)))+2*b^2*d^-1*Polylogarithms.polylog(2,-1*exp(arccsch(c+d*x)))+4*b*d^-1*(a+b*arccsch(c+d*x))*arctanh(exp(arccsch(c+d*x))))
end

@testset "8.1 Error functions.jl" begin
	@test integrate(x^5*erf(b*x), x) == :(-5//16*b^-6*erf(b*x)+1//6*x^6*erf(b*x)+1//6*pi^-1//2*b^-1*x^5*exp(-1*b^2*x^2)+5//8*x*pi^-1//2*b^-5*exp(-1*b^2*x^2)+5//12*pi^-1//2*b^-3*x^3*exp(-1*b^2*x^2))
	@test integrate(x^3*erf(b*x), x) == :(-3//16*b^-4*erf(b*x)+1//4*x^4*erf(b*x)+1//4*pi^-1//2*b^-1*x^3*exp(-1*b^2*x^2)+3//8*x*pi^-1//2*b^-3*exp(-1*b^2*x^2))
	@test integrate(x*erf(b*x), x) == :((1/2)*x^2*erf(b*x)+-1//4*b^-2*erf(b*x)+(1/2)*x*pi^-1//2*b^-1*exp(-1*b^2*x^2))
	@test integrate(x^-3*erf(b*x), x) == :(-1*b^2*erf(b*x)+-1//2*x^-2*erf(b*x)+-1*b*pi^-1//2*x^-1*exp(-1*b^2*x^2))
	@test integrate(x^-5*erf(b*x), x) == :(-1//4*x^-4*erf(b*x)+1//3*b^4*erf(b*x)+-1//6*b*pi^-1//2*x^-3*exp(-1*b^2*x^2)+1//3*pi^-1//2*b^3*x^-1*exp(-1*b^2*x^2))
	@test integrate(x^-7*erf(b*x), x) == :(-4//45*b^6*erf(b*x)+-1//6*x^-6*erf(b*x)+-4//45*pi^-1//2*b^5*x^-1*exp(-1*b^2*x^2)+-1//15*b*pi^-1//2*x^-5*exp(-1*b^2*x^2)+2//45*pi^-1//2*b^3*x^-3*exp(-1*b^2*x^2))
	@test integrate(x^6*erf(b*x), x) == :(1//7*x^7*erf(b*x)+6//7*pi^-1//2*b^-7*exp(-1*b^2*x^2)+1//7*pi^-1//2*b^-1*x^6*exp(-1*b^2*x^2)+3//7*pi^-1//2*b^-3*x^4*exp(-1*b^2*x^2)+6//7*pi^-1//2*b^-5*x^2*exp(-1*b^2*x^2))
	@test integrate(x^4*erf(b*x), x) == :(1//5*x^5*erf(b*x)+2//5*pi^-1//2*b^-5*exp(-1*b^2*x^2)+1//5*pi^-1//2*b^-1*x^4*exp(-1*b^2*x^2)+2//5*pi^-1//2*b^-3*x^2*exp(-1*b^2*x^2))
	@test integrate(x^2*erf(b*x), x) == :(1//3*x^3*erf(b*x)+1//3*pi^-1//2*b^-3*exp(-1*b^2*x^2)+1//3*pi^-1//2*b^-1*x^2*exp(-1*b^2*x^2))
	@test integrate(erf(b*x), x) == :(x*erf(b*x)+pi^-1//2*b^-1*exp(-1*b^2*x^2))
end

@testset "8.2 Fresnel integral functions.jl" begin
	@test integrate(x^7*fresnels(b*x), x) == :(1//8*x^8*fresnels(b*x)+-105//8*pi^-4*b^-8*fresnels(b*x)+-35//8*pi^-3*b^-5*x^3*cos((1/2)*pi*b^2*x^2)+-7//8*pi^-2*b^-3*x^5*sin((1/2)*pi*b^2*x^2)+1//8*pi^-1*b^-1*x^7*cos((1/2)*pi*b^2*x^2)+105//8*x*pi^-4*b^-7*sin((1/2)*pi*b^2*x^2))
	@test integrate(x^6*fresnels(b*x), x) == :(1//7*x^7*fresnels(b*x)+48//7*pi^-4*b^-7*sin((1/2)*pi*b^2*x^2)+-24//7*pi^-3*b^-5*x^2*cos((1/2)*pi*b^2*x^2)+-6//7*pi^-2*b^-3*x^4*sin((1/2)*pi*b^2*x^2)+1//7*pi^-1*b^-1*x^6*cos((1/2)*pi*b^2*x^2))
	@test integrate(x^5*fresnels(b*x), x) == :(1//6*x^6*fresnels(b*x)+5//2*pi^-3*b^-6*fresnelc(b*x)+-5//2*x*pi^-3*b^-5*cos((1/2)*pi*b^2*x^2)+-5//6*pi^-2*b^-3*x^3*sin((1/2)*pi*b^2*x^2)+1//6*pi^-1*b^-1*x^5*cos((1/2)*pi*b^2*x^2))
	@test integrate(x^4*fresnels(b*x), x) == :(1//5*x^5*fresnels(b*x)+-8//5*pi^-3*b^-5*cos((1/2)*pi*b^2*x^2)+-4//5*pi^-2*b^-3*x^2*sin((1/2)*pi*b^2*x^2)+1//5*pi^-1*b^-1*x^4*cos((1/2)*pi*b^2*x^2))
	@test integrate(x^3*fresnels(b*x), x) == :(1//4*x^4*fresnels(b*x)+3//4*pi^-2*b^-4*fresnels(b*x)+-3//4*x*pi^-2*b^-3*sin((1/2)*pi*b^2*x^2)+1//4*pi^-1*b^-1*x^3*cos((1/2)*pi*b^2*x^2))
	@test integrate(x^2*fresnels(b*x), x) == :(1//3*x^3*fresnels(b*x)+-2//3*pi^-2*b^-3*sin((1/2)*pi*b^2*x^2)+1//3*pi^-1*b^-1*x^2*cos((1/2)*pi*b^2*x^2))
	@test integrate(x*fresnels(b*x), x) == :((1/2)*x^2*fresnels(b*x)+-1//2*pi^-1*b^-2*fresnelc(b*x)+(1/2)*x*pi^-1*b^-1*cos((1/2)*pi*b^2*x^2))
	@test integrate(fresnels(b*x), x) == :(x*fresnels(b*x)+pi^-1*b^-1*cos((1/2)*pi*b^2*x^2))
	@test integrate(x^-2*fresnels(b*x), x) == :((1/2)*b*sinintegral((1/2)*pi*b^2*x^2)+-1*x^-1*fresnels(b*x))
	@test integrate(x^-3*fresnels(b*x), x) == :(-1//2*x^-2*fresnels(b*x)+(1/2)*pi*b^2*fresnelc(b*x)+-1//2*b*x^-1*sin((1/2)*pi*b^2*x^2))
end

@testset "8.3 Exponential integral functions.jl" begin
	@test integrate(x^2*SpecialFunctions.expint(1,b*x), x) == :(-1//3*x^3*SpecialFunctions.expint(-2,b*x)+1//3*x^3*SpecialFunctions.expint(1,b*x))
	@test integrate(x*SpecialFunctions.expint(1,b*x), x) == :((1/2)*x^2*SpecialFunctions.expint(1,b*x)+-1//2*x^2*SpecialFunctions.expint(-1,b*x))
	@test integrate(SpecialFunctions.expint(1,b*x), x) == :(-1*b^-1*SpecialFunctions.expint(2,b*x))
	@test integrate(x^-2*SpecialFunctions.expint(1,b*x), x) == :(x^-1*SpecialFunctions.expint(2,b*x)+-1*x^-1*SpecialFunctions.expint(1,b*x))
	@test integrate(x^-3*SpecialFunctions.expint(1,b*x), x) == :((1/2)*x^-2*SpecialFunctions.expint(3,b*x)+-1//2*x^-2*SpecialFunctions.expint(1,b*x))
	@test integrate(x^-4*SpecialFunctions.expint(1,b*x), x) == :(-1//3*x^-3*SpecialFunctions.expint(1,b*x)+1//3*x^-3*SpecialFunctions.expint(4,b*x))
	@test integrate(x^2*SpecialFunctions.expint(2,b*x), x) == :(-1//4*x^3*SpecialFunctions.expint(-2,b*x)+1//4*x^3*SpecialFunctions.expint(2,b*x))
	@test integrate(x*SpecialFunctions.expint(2,b*x), x) == :(-1//3*x^2*SpecialFunctions.expint(-1,b*x)+1//3*x^2*SpecialFunctions.expint(2,b*x))
	@test integrate(SpecialFunctions.expint(2,b*x), x) == :(-1*b^-1*SpecialFunctions.expint(3,b*x))
	@test integrate(x^-1*SpecialFunctions.expint(2,b*x), x) == :(-1*SpecialFunctions.expint(1,b*x)+SpecialFunctions.expint(2,b*x))
end

@testset "8.4 Trig integral functions.jl" begin
	@test integrate(x^m*sinintegral(b*x), x) == :(x^(1+m)*(1+m)^-1*sinintegral(b*x)+(1/2)*b^-1*x^m*(im*b*x)^(-1m)*(1+m)^-1*SpecialFunctions.gamma(1+m,im*b*x)+(1/2)*b^-1*x^m*(-1*im*b*x)^(-1m)*(1+m)^-1*SpecialFunctions.gamma(1+m,-1*im*b*x))
	@test integrate(x^3*sinintegral(b*x), x) == :(1//4*x^4*sinintegral(b*x)+3//2*b^-4*sin(b*x)+-3//2*x*b^-3*cos(b*x)+-3//4*b^-2*x^2*sin(b*x)+1//4*b^-1*x^3*cos(b*x))
	@test integrate(x^2*sinintegral(b*x), x) == :(-2//3*b^-3*cos(b*x)+1//3*x^3*sinintegral(b*x)+-2//3*x*b^-2*sin(b*x)+1//3*b^-1*x^2*cos(b*x))
	@test integrate(x*sinintegral(b*x), x) == :((1/2)*x^2*sinintegral(b*x)+-1//2*b^-2*sin(b*x)+(1/2)*x*b^-1*cos(b*x))
	@test integrate(sinintegral(b*x), x) == :(x*sinintegral(b*x)+b^-1*cos(b*x))
	@test integrate(x^-2*sinintegral(b*x), x) == :(b*cosintegral(b*x)+-1*x^-1*sin(b*x)+-1*x^-1*sinintegral(b*x))
	@test integrate(x^-3*sinintegral(b*x), x) == :(-1//2*x^-2*sinintegral(b*x)+-1//4*b^2*sinintegral(b*x)+-1//4*x^-2*sin(b*x)+-1//4*b*x^-1*cos(b*x))
	@test integrate(x^3*sinintegral(b*x)^2, x) == :((1/2)*b^-2*x^2+2*b^-4*sin(b*x)^2+-3//2*b^-4*log(x)+1//4*x^4*sinintegral(b*x)^2+3//2*b^-4*cosintegral(2*b*x)+3*b^-4*sin(b*x)*sinintegral(b*x)+-1//4*b^-2*x^2*sin(b*x)^2+(1/2)*b^-1*x^3*cos(b*x)*sinintegral(b*x)+-1*x*b^-3*cos(b*x)*sin(b*x)+-3*x*b^-3*cos(b*x)*sinintegral(b*x)+-3//2*b^-2*x^2*sin(b*x)*sinintegral(b*x))
	@test integrate(x^2*sinintegral(b*x)^2, x) == :(1//3*x^3*sinintegral(b*x)^2+2//3*b^-3*sinintegral(2*b*x)+5//6*x*b^-2+-5//6*b^-3*cos(b*x)*sin(b*x)+-4//3*b^-3*cos(b*x)*sinintegral(b*x)+-1//3*x*b^-2*sin(b*x)^2+-4//3*x*b^-2*sin(b*x)*sinintegral(b*x)+2//3*b^-1*x^2*cos(b*x)*sinintegral(b*x))
	@test integrate(x*sinintegral(b*x)^2, x) == :((1/2)*b^-2*log(x)+(1/2)*x^2*sinintegral(b*x)^2+-1//2*b^-2*sin(b*x)^2+-1//2*b^-2*cosintegral(2*b*x)+-1*b^-2*sin(b*x)*sinintegral(b*x)+x*b^-1*cos(b*x)*sinintegral(b*x))
end

@testset "8.5 Hyperbolic integral functions.jl" begin
	@test integrate(x^m*sinhintegral(b*x), x) == :(x^(1+m)*(1+m)^-1*sinhintegral(b*x)+-1//2*b^-1*x^m*(b*x)^(-1m)*(1+m)^-1*SpecialFunctions.gamma(1+m,b*x)+-1//2*b^-1*x^m*(-1*b*x)^(-1m)*(1+m)^-1*SpecialFunctions.gamma(1+m,-1*b*x))
	@test integrate(x^3*sinhintegral(b*x), x) == :(1//4*x^4*sinhintegral(b*x)+3//2*b^-4*sinh(b*x)+-3//2*x*b^-3*cosh(b*x)+-1//4*b^-1*x^3*cosh(b*x)+3//4*b^-2*x^2*sinh(b*x))
	@test integrate(x^2*sinhintegral(b*x), x) == :(-2//3*b^-3*cosh(b*x)+1//3*x^3*sinhintegral(b*x)+-1//3*b^-1*x^2*cosh(b*x)+2//3*x*b^-2*sinh(b*x))
	@test integrate(x*sinhintegral(b*x), x) == :((1/2)*b^-2*sinh(b*x)+(1/2)*x^2*sinhintegral(b*x)+-1//2*x*b^-1*cosh(b*x))
	@test integrate(sinhintegral(b*x), x) == :(x*sinhintegral(b*x)+-1*b^-1*cosh(b*x))
	@test integrate(x^-2*sinhintegral(b*x), x) == :(b*coshintegral(b*x)+-1*x^-1*sinh(b*x)+-1*x^-1*sinhintegral(b*x))
	@test integrate(x^-3*sinhintegral(b*x), x) == :(-1//2*x^-2*sinhintegral(b*x)+-1//4*x^-2*sinh(b*x)+1//4*b^2*sinhintegral(b*x)+-1//4*b*x^-1*cosh(b*x))
	@test integrate(x^3*sinhintegral(b*x)^2, x) == :((1/2)*b^-2*x^2+2*b^-4*sinh(b*x)^2+-3//2*b^-4*coshintegral(2*b*x)+1//4*x^4*sinhintegral(b*x)^2+3//2*b^-4*log(x)+3*b^-4*sinh(b*x)*sinhintegral(b*x)+1//4*b^-2*x^2*sinh(b*x)^2+-1*x*b^-3*cosh(b*x)*sinh(b*x)+-3*x*b^-3*cosh(b*x)*sinhintegral(b*x)+-1//2*b^-1*x^3*cosh(b*x)*sinhintegral(b*x)+3//2*b^-2*x^2*sinh(b*x)*sinhintegral(b*x))
	@test integrate(x^2*sinhintegral(b*x)^2, x) == :(1//3*x^3*sinhintegral(b*x)^2+2//3*b^-3*sinhintegral(2*b*x)+5//6*x*b^-2+-5//6*b^-3*cosh(b*x)*sinh(b*x)+-4//3*b^-3*cosh(b*x)*sinhintegral(b*x)+1//3*x*b^-2*sinh(b*x)^2+-2//3*b^-1*x^2*cosh(b*x)*sinhintegral(b*x)+4//3*x*b^-2*sinh(b*x)*sinhintegral(b*x))
	@test integrate(x*sinhintegral(b*x)^2, x) == :((1/2)*b^-2*sinh(b*x)^2+(1/2)*b^-2*log(x)+(1/2)*x^2*sinhintegral(b*x)^2+-1//2*b^-2*coshintegral(2*b*x)+b^-2*sinh(b*x)*sinhintegral(b*x)+-1*x*b^-1*cosh(b*x)*sinhintegral(b*x))
end

@testset "8.6 Gamma functions.jl" begin
	@test integrate(x^100*SpecialFunctions.gamma(0,a*x), x) == :(-1//101*a^-101*SpecialFunctions.gamma(101,a*x)+1//101*x^101*SpecialFunctions.gamma(0,a*x))
	@test integrate(x^2*SpecialFunctions.gamma(0,a*x), x) == :(-1//3*a^-3*SpecialFunctions.gamma(3,a*x)+1//3*x^3*SpecialFunctions.gamma(0,a*x))
	@test integrate(x*SpecialFunctions.gamma(0,a*x), x) == :((1/2)*x^2*SpecialFunctions.gamma(0,a*x)+-1//2*a^-2*SpecialFunctions.gamma(2,a*x))
	@test integrate(SpecialFunctions.gamma(0,a*x), x) == :(x*SpecialFunctions.gamma(0,a*x)+-1*a^-1*exp(-1*a*x))
	@test integrate(x^-2*SpecialFunctions.gamma(0,a*x), x) == :(a*SpecialFunctions.gamma(-1,a*x)+-1*x^-1*SpecialFunctions.gamma(0,a*x))
	@test integrate(x^-3*SpecialFunctions.gamma(0,a*x), x) == :((1/2)*a^2*SpecialFunctions.gamma(-2,a*x)+-1//2*x^-2*SpecialFunctions.gamma(0,a*x))
	@test integrate(x^-4*SpecialFunctions.gamma(0,a*x), x) == :(-1//3*x^-3*SpecialFunctions.gamma(0,a*x)+1//3*a^3*SpecialFunctions.gamma(-3,a*x))
	@test integrate(x^3*SpecialFunctions.gamma(1,a*x), x) == :(-6*a^-4*exp(-1*a*x)+-1*a^-1*x^3*exp(-1*a*x)+-6*x*a^-3*exp(-1*a*x)+-3*a^-2*x^2*exp(-1*a*x))
	@test integrate(x^2*SpecialFunctions.gamma(1,a*x), x) == :(-2*a^-3*exp(-1*a*x)+-1*a^-1*x^2*exp(-1*a*x)+-2*x*a^-2*exp(-1*a*x))
	@test integrate(x*SpecialFunctions.gamma(1,a*x), x) == :(-1*a^-2*exp(-1*a*x)+-1*x*a^-1*exp(-1*a*x))
end

@testset "8.7 Zeta function.jl" begin
	@test integrate(x^2*SpecialFunctions.zeta(2,a+b*x), x) == :(2*b^-3*SpecialFunctions.polygamma(-2,x)+b^-1*x^2*SpecialFunctions.polygamma(0,x)+-2*x*b^-2*loggamma(a+b*x))
	@test integrate(x*SpecialFunctions.zeta(2,a+b*x), x) == :(-1*b^-2*loggamma(a+b*x)+x*b^-1*SpecialFunctions.polygamma(0,x))
	@test integrate(SpecialFunctions.zeta(2,a+b*x), x) == :(b^-1*SpecialFunctions.polygamma(0,x))
	@test integrate(x^-2*SpecialFunctions.zeta(2,a+b*x)+-1*b*x^-1*SpecialFunctions.polygamma(2,x), x) == :(-1*x^-1*SpecialFunctions.polygamma(1,x))
	@test integrate(x*SpecialFunctions.zeta(s,a+b*x), x) == :(x*b^-1*(1+-1s)^-1*SpecialFunctions.zeta(-1+s,a+b*x)+-1*b^-2*(1+-1s)^-1*(2+-1s)^-1*SpecialFunctions.zeta(-2+s,a+b*x))
	@test integrate(SpecialFunctions.zeta(s,a+b*x), x) == :(b^-1*(1+-1s)^-1*SpecialFunctions.zeta(-1+s,a+b*x))
	@test integrate(x^-2*SpecialFunctions.zeta(s,a+b*x)+b*s*x^-1*SpecialFunctions.zeta(1+s,a+b*x), x) == :(-1*x^-1*SpecialFunctions.zeta(s,a+b*x))
end

@testset "8.8 Polylogarithm function.jl" begin
	@test integrate(x^4*Polylogarithms.polylog(2,a*x), x) == :(-1//125*x^5+-1//25*x*a^-4+-1//25*a^-5*log(1+-1*a*x)+-1//50*a^-3*x^2+-1//75*a^-2*x^3+-1//100*a^-1*x^4+1//5*x^5*Polylogarithms.polylog(2,a*x)+1//25*x^5*log(1+-1*a*x))
	@test integrate(x^3*Polylogarithms.polylog(2,a*x), x) == :(-1//64*x^4+-1//16*x*a^-3+-1//16*a^-4*log(1+-1*a*x)+-1//32*a^-2*x^2+-1//48*a^-1*x^3+1//4*x^4*Polylogarithms.polylog(2,a*x)+1//16*x^4*log(1+-1*a*x))
	@test integrate(x^2*Polylogarithms.polylog(2,a*x), x) == :(-1//27*x^3+-1//9*x*a^-2+-1//9*a^-3*log(1+-1*a*x)+-1//18*a^-1*x^2+1//3*x^3*Polylogarithms.polylog(2,a*x)+1//9*x^3*log(1+-1*a*x))
	@test integrate(x*Polylogarithms.polylog(2,a*x), x) == :(-1//8*x^2+(1/2)*x^2*Polylogarithms.polylog(2,a*x)+-1//4*x*a^-1+-1//4*a^-2*log(1+-1*a*x)+1//4*x^2*log(1+-1*a*x))
	@test integrate(Polylogarithms.polylog(2,a*x), x) == :(-1x+x*Polylogarithms.polylog(2,a*x)+-1*a^-1*(1+-1*a*x)*log(1+-1*a*x))
	@test integrate(x^-1*Polylogarithms.polylog(2,a*x), x) == :(Polylogarithms.polylog(3,a*x))
	@test integrate(x^-2*Polylogarithms.polylog(2,a*x), x) == :(a*log(x)+x^-1*log(1+-1*a*x)+-1*a*log(1+-1*a*x)+-1*x^-1*Polylogarithms.polylog(2,a*x))
	@test integrate(x^-3*Polylogarithms.polylog(2,a*x), x) == :(-1//2*x^-2*Polylogarithms.polylog(2,a*x)+-1//4*a*x^-1+-1//4*a^2*log(1+-1*a*x)+1//4*a^2*log(x)+1//4*x^-2*log(1+-1*a*x))
	@test integrate(x^-4*Polylogarithms.polylog(2,a*x), x) == :(-1//3*x^-3*Polylogarithms.polylog(2,a*x)+-1//9*a^2*x^-1+-1//9*a^3*log(1+-1*a*x)+-1//18*a*x^-2+1//9*a^3*log(x)+1//9*x^-3*log(1+-1*a*x))
	@test integrate(x^-5*Polylogarithms.polylog(2,a*x), x) == :(-1//4*x^-4*Polylogarithms.polylog(2,a*x)+-1//16*a^3*x^-1+-1//16*a^4*log(1+-1*a*x)+-1//32*a^2*x^-2+-1//48*a*x^-3+1//16*a^4*log(x)+1//16*x^-4*log(1+-1*a*x))
end

@testset "8.9 Product logarithm function.jl" begin
	@test integrate(productlog(a+b*x)^4, x) == :(96x+b^-1*productlog(a+b*x)^2*(16a+16*b*x)+b^-1*productlog(a+b*x)^4*(a+b*x)+-1*b^-1*productlog(a+b*x)^-1*(96a+96*b*x)+-1*b^-1*productlog(a+b*x)^3*(4a+4*b*x)+-1*b^-1*(48a+48*b*x)*productlog(a+b*x))
	@test integrate(productlog(a+b*x)^3, x) == :(-18x+b^-1*productlog(a+b*x)^-1*(18a+18*b*x)+b^-1*productlog(a+b*x)^3*(a+b*x)+b^-1*(9a+9*b*x)*productlog(a+b*x)+-1*b^-1*productlog(a+b*x)^2*(3a+3*b*x))
	@test integrate(productlog(a+b*x)^2, x) == :(4x+b^-1*productlog(a+b*x)^2*(a+b*x)+-1*b^-1*productlog(a+b*x)^-1*(4a+4*b*x)+-1*b^-1*(2a+2*b*x)*productlog(a+b*x))
	@test integrate(productlog(a+b*x), x) == :(-1x+b^-1*productlog(a+b*x)^-1*(a+b*x)+b^-1*(a+b*x)*productlog(a+b*x))
	@test integrate(productlog(a+b*x)^-1, x) == :(b^-1*expintegralei(productlog(a+b*x))+b^-1*productlog(a+b*x)^-1*(a+b*x))
	@test integrate(productlog(a+b*x)^-2, x) == :(2*b^-1*expintegralei(productlog(a+b*x))+-1*b^-1*productlog(a+b*x)^-2*(a+b*x))
	@test integrate(productlog(a+b*x)^-3, x) == :(3//2*b^-1*expintegralei(productlog(a+b*x))+-1//2*b^-1*productlog(a+b*x)^-3*(a+b*x)+-1//2*b^-1*productlog(a+b*x)^-2*(3a+3*b*x))
	@test integrate(productlog(a+b*x)^-4, x) == :(2//3*b^-1*expintegralei(productlog(a+b*x))+-1//3*b^-1*productlog(a+b*x)^-4*(a+b*x)+-1//3*b^-1*productlog(a+b*x)^-3*(2a+2*b*x)+-1//3*b^-1*productlog(a+b*x)^-2*(2a+2*b*x))
	@test integrate(productlog(a+b*x)^-5, x) == :(5//24*b^-1*expintegralei(productlog(a+b*x))+-1//4*b^-1*productlog(a+b*x)^-5*(a+b*x)+-1//12*b^-1*productlog(a+b*x)^-4*(5a+5*b*x)+-1//24*b^-1*productlog(a+b*x)^-3*(5a+5*b*x)+-1//24*b^-1*productlog(a+b*x)^-2*(5a+5*b*x))
	@test integrate((c*productlog(a+b*x))^5//2, x) == :(b^-1*(c*productlog(a+b*x))^5//2*(a+b*x)+-75//8*b^-1*c^3*(c*productlog(a+b*x))^-1//2*(a+b*x)+-5//2*c*b^-1*(c*productlog(a+b*x))^3//2*(a+b*x)+25//4*b^-1*c^2*(c*productlog(a+b*x))^(1/2)*(a+b*x)+75//16*pi^(1/2)*b^-1*c^5//2*erfi(c^-1//2*(c*productlog(a+b*x))^(1/2)))
end


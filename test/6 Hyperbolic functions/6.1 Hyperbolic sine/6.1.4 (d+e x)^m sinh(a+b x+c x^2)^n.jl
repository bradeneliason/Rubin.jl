using Rubin
using Tests
using Elliptic
using HypergeometricFunctions
using Polylogarithms
using SpecialFunctions

@test integrate(x^2*sinh(a+b*x+c*x^2), x) == :((1/2)*x*c^-1*cosh(a+b*x+c*x^2)+-1//4*b*c^-2*cosh(a+b*x+c*x^2)+-1//8*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+-1//8*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1)+-1//16*pi^(1/2)*b^2*c^-5//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//16*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
@test integrate(x*sinh(a+b*x+c*x^2), x) == :((1/2)*c^-1*cosh(a+b*x+c*x^2)+-1//8*b*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1)+1//8*b*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1))
@test integrate(sinh(a+b*x+c*x^2), x) == :(-1//4*pi^(1/2)*c^-1//2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//4*pi^(1/2)*c^-1//2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
@test integrate(x^-2*sinh(a+b*x+c*x^2)+-1*b*x^-1*cosh(a+b*x+c*x^2), x) == :(-1*x^-1*sinh(a+b*x+c*x^2)+(1/2)*pi^(1/2)*c^(1/2)*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+(1/2)*pi^(1/2)*c^(1/2)*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
@test integrate(x^2*sinh(a+b*x+-1*c*x^2), x) == :(-1//2*x*c^-1*cosh(a+b*x+-1*c*x^2)+-1//4*b*c^-2*cosh(a+b*x+-1*c*x^2)+-1//8*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+-1//8*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1)+-1//16*pi^(1/2)*b^2*c^-5//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+1//16*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
@test integrate(x*sinh(a+b*x+-1*c*x^2), x) == :(-1//2*c^-1*cosh(a+b*x+-1*c*x^2)+-1//8*b*pi^(1/2)*c^-3//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+1//8*b*pi^(1/2)*c^-3//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
@test integrate(sinh(a+b*x+-1*c*x^2), x) == :(-1//4*pi^(1/2)*c^-1//2*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+1//4*pi^(1/2)*c^-1//2*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
@test integrate(x^-2*sinh(a+b*x+-1*c*x^2)+-1*b*x^-1*cosh(a+b*x+-1*c*x^2), x) == :(-1*x^-1*sinh(a+b*x+-1*c*x^2)+(1/2)*pi^(1/2)*c^(1/2)*erf((1/2)*c^-1//2*(b+-2*c*x))*exp(a+1//4*b^2*c^-1)+(1/2)*pi^(1/2)*c^(1/2)*erfi((1/2)*c^-1//2*(b+-2*c*x))*exp(-1a+-1//4*b^2*c^-1))
@test integrate(x^2*sinh(1//4+x+x^2), x) == :(-1//4*cosh(1//4+x+x^2)+(1/2)*x*cosh(1//4+x+x^2)+-3//16*pi^(1/2)*erf(1/2+x)+-1//16*pi^(1/2)*erfi(1/2+x))
@test integrate(x*sinh(1//4+x+x^2), x) == :((1/2)*cosh(1//4+x+x^2)+-1//8*pi^(1/2)*erfi(1/2+x)+1//8*pi^(1/2)*erf(1/2+x))
@test integrate(sinh(1//4+x+x^2), x) == :(-1//4*pi^(1/2)*erf(1/2+x)+1//4*pi^(1/2)*erfi(1/2+x))
@test integrate(x^2*sinh(a+b*x+c*x^2)^2, x) == :(-1//6*x^3+-1//16*b*c^-2*sinh(2a+2*b*x+2*c*x^2)+1//8*x*c^-1*sinh(2a+2*b*x+2*c*x^2)+-1//64*2^(1/2)*pi^(1/2)*c^-3//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(2a+-1//2*b^2*c^-1)+1//64*2^(1/2)*pi^(1/2)*c^-3//2*erf((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(-2a+(1/2)*b^2*c^-1)+1//64*2^(1/2)*pi^(1/2)*b^2*c^-5//2*erf((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(-2a+(1/2)*b^2*c^-1)+1//64*2^(1/2)*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(2a+-1//2*b^2*c^-1))
@test integrate(x*sinh(a+b*x+c*x^2)^2, x) == :(-1//4*x^2+1//8*c^-1*sinh(2a+2*b*x+2*c*x^2)+-1//32*b*2^(1/2)*pi^(1/2)*c^-3//2*erf((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(-2a+(1/2)*b^2*c^-1)+-1//32*b*2^(1/2)*pi^(1/2)*c^-3//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(2a+-1//2*b^2*c^-1))
@test integrate(sinh(a+b*x+c*x^2)^2, x) == :(-1//2*x+1//16*2^(1/2)*pi^(1/2)*c^-1//2*erf((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(-2a+(1/2)*b^2*c^-1)+1//16*2^(1/2)*pi^(1/2)*c^-1//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(2a+-1//2*b^2*c^-1))
@test integrate(x^2*sinh(a+b*x+-1*c*x^2)^2, x) == :(-1//6*x^3+-1//8*x*c^-1*sinh(2a+-2*c*x^2+2*b*x)+-1//16*b*c^-2*sinh(2a+-2*c*x^2+2*b*x)+-1//64*2^(1/2)*pi^(1/2)*c^-3//2*erf((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(2a+(1/2)*b^2*c^-1)+1//64*2^(1/2)*pi^(1/2)*c^-3//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(-2a+-1//2*b^2*c^-1)+-1//64*2^(1/2)*pi^(1/2)*b^2*c^-5//2*erf((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(2a+(1/2)*b^2*c^-1)+-1//64*2^(1/2)*pi^(1/2)*b^2*c^-5//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(-2a+-1//2*b^2*c^-1))
@test integrate(x*sinh(a+b*x+-1*c*x^2)^2, x) == :(-1//4*x^2+-1//8*c^-1*sinh(2a+-2*c*x^2+2*b*x)+-1//32*b*2^(1/2)*pi^(1/2)*c^-3//2*erf((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(2a+(1/2)*b^2*c^-1)+-1//32*b*2^(1/2)*pi^(1/2)*c^-3//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(-2a+-1//2*b^2*c^-1))
@test integrate(sinh(a+b*x+-1*c*x^2)^2, x) == :(-1//2*x+-1//16*2^(1/2)*pi^(1/2)*c^-1//2*erf((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(2a+(1/2)*b^2*c^-1)+-1//16*2^(1/2)*pi^(1/2)*c^-1//2*erfi((1/2)*2^(1/2)*c^-1//2*(b+-2*c*x))*exp(-2a+-1//2*b^2*c^-1))
@test integrate(x^2*sinh(1//4+x+x^2)^2, x) == :(-1//6*x^3+-1//16*sinh(1/2+2x+2*x^2)+1//8*x*sinh(1/2+2x+2*x^2)+1//32*2^(1/2)*pi^(1/2)*erf((1/2)*2^(1/2)*(1+2x)))
@test integrate(x*sinh(1//4+x+x^2)^2, x) == :(-1//4*x^2+1//8*sinh(1/2+2x+2*x^2)+-1//32*2^(1/2)*pi^(1/2)*erf((1/2)*2^(1/2)*(1+2x))+-1//32*2^(1/2)*pi^(1/2)*erfi((1/2)*2^(1/2)*(1+2x)))
@test integrate(sinh(1//4+x+x^2)^2, x) == :(-1//2*x+1//16*2^(1/2)*pi^(1/2)*erf((1/2)*2^(1/2)*(1+2x))+1//16*2^(1/2)*pi^(1/2)*erfi((1/2)*2^(1/2)*(1+2x)))
@test integrate((d+e*x)^2*sinh(a+b*x+c*x^2), x) == :((1/2)*e*c^-1*(d+e*x)*cosh(a+b*x+c*x^2)+1//4*e*c^-2*(-1*b*e+2*c*d)*cosh(a+b*x+c*x^2)+-1//8*pi^(1/2)*c^-3//2*e^2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+-1//8*pi^(1/2)*c^-3//2*e^2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1)+-1//16*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//16*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
@test integrate((d+e*x)*sinh(a+b*x+c*x^2), x) == :((1/2)*e*c^-1*cosh(a+b*x+c*x^2)+-1//8*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*erf((1/2)*c^-1//2*(b+2*c*x))*exp(-1a+1//4*b^2*c^-1)+1//8*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*erfi((1/2)*c^-1//2*(b+2*c*x))*exp(a+-1//4*b^2*c^-1))
@test integrate((d+e*x)^2*sinh(a+b*x+c*x^2)^2, x) == :(-1//6*e^-1*(d+e*x)^3+1//8*e*c^-1*(d+e*x)*sinh(2a+2*b*x+2*c*x^2)+1//16*e*c^-2*(-1*b*e+2*c*d)*sinh(2a+2*b*x+2*c*x^2)+-1//64*2^(1/2)*pi^(1/2)*c^-3//2*e^2*erfi((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(2a+-1//2*b^2*c^-1)+1//64*2^(1/2)*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*erf((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(-2a+(1/2)*b^2*c^-1)+1//64*2^(1/2)*pi^(1/2)*c^-5//2*(-1*b*e+2*c*d)^2*erfi((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(2a+-1//2*b^2*c^-1)+1//64*2^(1/2)*pi^(1/2)*c^-3//2*e^2*erf((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(-2a+(1/2)*b^2*c^-1))
@test integrate(sinh(a+b*x+c*x^2)^2*(d+e*x), x) == :(-1//4*e^-1*(d+e*x)^2+1//8*e*c^-1*sinh(2a+2*b*x+2*c*x^2)+1//32*2^(1/2)*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*erf((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(-2a+(1/2)*b^2*c^-1)+1//32*2^(1/2)*pi^(1/2)*c^-3//2*(-1*b*e+2*c*d)*erfi((1/2)*2^(1/2)*c^-1//2*(b+2*c*x))*exp(2a+-1//2*b^2*c^-1))
